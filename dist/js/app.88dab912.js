(function(){"use strict";var e={3036:function(e,t,o){var n=o(9242),r=o(3396);function i(e,t){const o=(0,r.up)("router-link"),n=(0,r.up)("router-view");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("nav",null,[(0,r.Wm)(o,{to:"/"},{default:(0,r.w5)((()=>[(0,r.Uk)("Home")])),_:1}),(0,r.Uk)(" | "),(0,r.Wm)(o,{to:"/about"},{default:(0,r.w5)((()=>[(0,r.Uk)("About")])),_:1})]),(0,r.Wm)(n)],64)}var s=o(89);const a={},c=(0,s.Z)(a,[["render",i]]);var u=c,l=o(5431);(0,l.z)("/ypu/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh."),alert("new update, please close the app & reopen")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var d=o(2483);const p={class:"home"};function f(e,t,o,n,i,s){const a=(0,r.up)("WebsocketBus"),c=(0,r.up)("TodosPush"),u=(0,r.up)("TodosView"),l=(0,r.up)("PendingView"),d=(0,r.up)("DoneView");return(0,r.wg)(),(0,r.iD)("div",p,[(0,r.Wm)(a),(0,r.Wm)(c),(0,r.Wm)(u),(0,r.Wm)(l),(0,r.Wm)(d)])}var m=o(7139);const g=e=>((0,r.dD)("data-v-2d02320e"),e=e(),(0,r.Cn)(),e),h={class:"websocket-bus"},v=g((()=>(0,r._)("br",null,null,-1)));function w(e,t,o,i,s,a){return(0,r.wg)(),(0,r.iD)("div",h,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.config.server=e),placeholder:"config.server"},null,512),[[n.nr,s.config.server]]),(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>s.config.room=e),placeholder:"config.room"},null,512),[[n.nr,s.config.room]]),(0,r._)("button",{onClick:t[2]||(t[2]=(...e)=>a.connect&&a.connect(...e))},"Connect"),(0,r._)("button",{onClick:t[3]||(t[3]=(...t)=>e.local&&e.local(...t))},"Local"),(0,r._)("button",{onClick:t[4]||(t[4]=(...e)=>a.remote&&a.remote(...e))},"Remote"),v,(0,r.Uk)(" Websocket Bus : "+(0,m.zw)(a.status),1)])}var y={name:"WebsocketBus",data(){return{config:{server:"",room:"my-ypu"},locale_url:"ws://"+window.location.hostname+":1234",remote_url:"wss://ypu.glitch.me/"}},created(){"127.0.0.1"==window.location.hostname?this.locale():this.remote()},methods:{connect(){this.$initWebSocketBus(this.config)},locale(){this.config.server=this.locale_url,this.$initWebSocketBus(this.config)},remote(){this.config.server=this.remote_url,this.$initWebSocketBus(this.config)}},computed:{status(){return this.$store.state.ypu.status}}};const b=(0,s.Z)(y,[["render",w],["__scopeId","data-v-2d02320e"]]);var k=b;o(7658);const T={class:"todos-push"};function D(e,t,o,i,s,a){return(0,r.wg)(),(0,r.iD)("div",T,[(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.wt=e),placeholder:"waitTime in ms, default:100",type:"number",min:"0",onChange:t[1]||(t[1]=(...e)=>a.setWaitTime&&a.setWaitTime(...e))},null,544),[[n.nr,s.wt]]),(0,r._)("button",{onClick:t[2]||(t[2]=(...e)=>a.toggleActif&&a.toggleActif(...e))},"Actif: "+(0,m.zw)(a.actif),1),(0,r.wy)((0,r._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.operation=e),placeholder:"operation",onKeyup:t[4]||(t[4]=(0,n.D2)(((...e)=>a.push&&a.push(...e)),["enter"]))},null,544),[[n.nr,s.operation]]),(0,r._)("button",{onClick:t[5]||(t[5]=(...e)=>a.push&&a.push(...e))},"Push to todos"),(0,r._)("button",{onClick:t[6]||(t[6]=(...e)=>a.cleanTodos&&a.cleanTodos(...e))},"Debug: Clean todos"),(0,r.wy)((0,r._)("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>s.numberOfTodos=e)},null,512),[[n.nr,s.numberOfTodos]]),(0,r._)("button",{onClick:t[8]||(t[8]=(...e)=>a.pushH&&a.pushH(...e))},"Push many to todos")])}var _={name:"TodosPush",data(){return{operation:"",numberOfTodos:100,wt:0}},created(){this.wt=this.$store.state.ypu.waitTime},methods:{toggleActif(){this.$store.commit("ypu/setActif",!this.actif),this.$prepare()},push(){this.$pushToTodos(this.operation),this.operation=""},pushH(){for(let e=0;e<this.numberOfTodos;e++){let t={ope:"reverse",data:e+"--"+Date.now()};this.$pushToTodos(t)}this.operation=""},cleanTodos(){this.$cleanTodos()},setWaitTime(){console.log("set waitTime ",this.wt),this.$store.commit("ypu/setWaitTime",this.wt)}},watch:{waitTime(){this.wt=this.waitTime}},computed:{actif(){return this.$store.state.ypu.actif},waitTime(){return this.$store.state.ypu.waitTime}}};const P=(0,s.Z)(_,[["render",D],["__scopeId","data-v-73873437"]]);var $=P;const W=e=>((0,r.dD)("data-v-672a4096"),e=e(),(0,r.Cn)(),e),j={class:"todos-view"},C=W((()=>(0,r._)("hr",null,null,-1)));function V(e,t,o,n,i,s){const a=(0,r.up)("ListView");return(0,r.wg)(),(0,r.iD)("div",j,[(0,r.Uk)(" TodosView : "),(0,r.Wm)(a,{object:s.todos},null,8,["object"]),C])}const O={class:"list-view"},A={key:0,style:{height:"200px","overflow-y":"scroll"}},I={key:0},S={key:1};function U(e,t,o,n,i,s){return(0,r.wg)(),(0,r.iD)("div",O,[(0,r.Uk)((0,m.zw)(s.clientID)+" / "+(0,m.zw)(i.items.length)+" ",1),null!=o.object?((0,r.wg)(),(0,r.iD)("ul",A,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(i.items,(e=>((0,r.wg)(),(0,r.iD)("li",{key:e.key},[e.worker==s.clientID?((0,r.wg)(),(0,r.iD)("b",I,"ME")):((0,r.wg)(),(0,r.iD)("span",S,(0,m.zw)(e.worker),1)),(0,r.Uk)(" "+(0,m.zw)(e),1)])))),128))])):(0,r.kq)("",!0)])}var E={name:"ListView",props:["object","reverse"],data(){return{items:[]}},watch:{object(){this.items="true"==this.reverse?Object.values(this.object).reverse():Object.values(this.object)}},computed:{clientID(){return this.$store.state.ypu.clientID}}};const L=(0,s.Z)(E,[["render",U],["__scopeId","data-v-5a1aed6d"]]);var B=L,M={name:"TodosView",components:{ListView:B},computed:{todos(){return this.$store.state.ypu.todos}}};const N=(0,s.Z)(M,[["render",V],["__scopeId","data-v-672a4096"]]);var Z=N;const z=e=>((0,r.dD)("data-v-2333a823"),e=e(),(0,r.Cn)(),e),H={class:"pending-view"},x=z((()=>(0,r._)("hr",null,null,-1)));function F(e,t,o,n,i,s){const a=(0,r.up)("ListView");return(0,r.wg)(),(0,r.iD)("div",H,[(0,r._)("button",{onClick:t[0]||(t[0]=(...e)=>s.cleanPending&&s.cleanPending(...e))},"Debug: Clean pending"),(0,r.Uk)(" PendingView : "),(0,r.Wm)(a,{object:s.pending},null,8,["object"]),x])}var R={name:"PendingView",components:{ListView:B},methods:{cleanPending(){this.$cleanPending()}},computed:{pending(){return this.$store.state.ypu.pending}}};const q=(0,s.Z)(R,[["render",F],["__scopeId","data-v-2333a823"]]);var J=q;const K={class:"done-view"};function Y(e,t,o,n,i,s){const a=(0,r.up)("ListView");return(0,r.wg)(),(0,r.iD)("div",K,[(0,r._)("button",{onClick:t[0]||(t[0]=(...e)=>s.cleanDone&&s.cleanDone(...e))},"Debug: Clean done"),(0,r.Uk)(" DoneView : "),(0,r.Wm)(a,{object:s.done,reverse:"true"},null,8,["object"])])}var G={name:"DoneView",components:{ListView:B},computed:{done(){return this.$store.state.ypu.done}},methods:{cleanDone(){this.$cleanDone()}}};const Q=(0,s.Z)(G,[["render",Y],["__scopeId","data-v-35c4fe37"]]);var X=Q,ee={name:"HomeView",components:{WebsocketBus:k,TodosPush:$,TodosView:Z,PendingView:J,DoneView:X}};const te=(0,s.Z)(ee,[["render",f]]);var oe=te;const ne=[{path:"/",name:"home",component:oe},{path:"/about",name:"about",component:()=>o.e(443).then(o.bind(o,7381))}],re=(0,d.p7)({history:(0,d.PO)("/ypu/"),routes:ne});var ie=re,se=o(65);const ae=()=>({doc:null,wsProvider:null,status:null,memory:null,todos:null,pending:null,done:null,ready:!1,actif:!1,clientID:null,waitTime:100}),ce={setDoc(e,t){e.doc=t},setStatus(e,t){e.status=t},setWsProvider(e,t){e.wsProvider=t},setMemory(e,t){e.memory=t},setTodos(e,t){e.todos=t},setPending(e,t){e.pending=t},setDone(e,t){e.done=t},setReady(e,t){e.ready=t},setClientID(e,t){e.clientID=t},setWaitTime(e,t){e.waitTime=t},setActif(e,t){console.log(t),e.actif=t,1==e.actif&&0==e.ready&&(e.ready=!0)}},ue={};var le={namespaced:!0,state:ae,actions:ue,mutations:ce},de=(0,se.MT)({state:{},getters:{},mutations:{},actions:{},modules:{ypu:le}}),pe=o(2942),fe=o(8340),me=o(114),ge=o(536),he={install:(e,t)=>{let o,n,r,i=t.store,s=null,a=null,c=null,u=null,l=null;e.config.globalProperties.$initWebSocketBus=async function(t){s=new pe.QW,c=new me.GL(s),i.commit("ypu/setClientID",c.clientID),a=new fe.VU(t.server,t.room,s),i.commit("ypu/setDoc",s),i.commit("ypu/setWsProvider",a),a.on("status",(e=>{console.log(e.status),i.commit("ypu/setStatus",e.status)})),u=s.getArray("memory"),l=s.getArray("registers"),o=s.getMap("todos"),n=s.getMap("pending"),r=s.getMap("done"),u.observe((e=>{e.target,i.commit("ypu/setMemory",u.toArray()),console.log(e.changes.delta)})),o.observe((t=>{i.commit("ypu/setTodos",o.toJSON()),t.changes.keys.forEach(((t,o)=>{"add"===t.action&&e.config.globalProperties.$prepare(o)}))})),n.observe((e=>{e.target,i.commit("ypu/setPending",n.toJSON())})),r.observe((e=>{e.target,i.commit("ypu/setDone",r.toJSON())})),l.observe((e=>{e.target,console.log(e.changes.delta)})),c.on("change",(e=>{console.log(e),this.awareness.getStates().forEach((e=>{console.log(e)}))}))},e.config.globalProperties.$pushToTodos=async function(e){o.set((0,ge.Z)(),{operation:e,asker:c.clientID})},e.config.globalProperties.$cleanTodos=async function(){for(const e of o.keys())o.delete(e)},e.config.globalProperties.$cleanPending=async function(){for(const e of n.keys())n.delete(e)},e.config.globalProperties.$cleanDone=async function(){for(const e of r.keys())r.delete(e)},e.config.globalProperties.$prepare=async function(t){if(console.log("key",t),1==i.state.ypu.actif&&1==i.state.ypu.ready){void 0==t&&(t=Array.from(o.keys())[0]),console.log(t);let r=o.get(t);if(void 0!=r){i.commit("ypu/setReady",!1);let s={key:t,data:r,worker:c.clientID,start:Date.now()};n.set(t,s),o.delete(t),e.config.globalProperties.$process(s)}else console.log("bizarre not found ",t,r)}},e.config.globalProperties.$process=async function(t){console.log("processing ",t);let o=i.state.ypu.waitTime;setTimeout((function(){console.log("Executed after ms ",o),t.end=Date.now(),t.result="Wahou c'est ok",r.set(t.key,t),n.delete(t.key),i.commit("ypu/setReady",!0),e.config.globalProperties.$prepare()}),o)}}};(0,n.ri)(u).use(de).use(ie).use(he,{store:de}).mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,i){if(!n){var s=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],i=e[l][2];for(var a=!0,c=0;c<n.length;c++)(!1&i||s>=i)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(a=!1,i<s&&(s=i));if(a){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,r,i]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/about.3167c641.js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="ypu:";o.l=function(n,r,i,s){if(e[n])e[n].push(r);else{var a,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+i){a=d;break}}a||(c=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+i),a.src=n),e[n]=[r];var p=function(t,o){a.onerror=a.onload=null,clearTimeout(f);var r=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((function(e){return e(o)})),t)return t(o)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),c&&document.head.appendChild(a)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/ypu/"}(),function(){var e={143:0};o.f.j=function(t,n){var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var i=new Promise((function(o,n){r=e[t]=[o,n]}));n.push(r[2]=i);var s=o.p+o.u(t),a=new Error,c=function(n){if(o.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var i=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",a.name="ChunkLoadError",a.type=i,a.request=s,r[1](a)}};o.l(s,c,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,i,s=n[0],a=n[1],c=n[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(c)var l=c(o)}for(t&&t(n);u<s.length;u++)i=s[u],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(l)},n=self["webpackChunkypu"]=self["webpackChunkypu"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(3036)}));n=o.O(n)})();
//# sourceMappingURL=app.88dab912.js.map