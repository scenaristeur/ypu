(function(){"use strict";var e={1361:function(e,t,o){var n=o(9242),s=o(3396);function r(e,t){const o=(0,s.up)("router-link"),n=(0,s.up)("router-view");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("nav",null,[(0,s.Wm)(o,{to:"/"},{default:(0,s.w5)((()=>[(0,s.Uk)("Home")])),_:1}),(0,s.Uk)(" | "),(0,s.Wm)(o,{to:"/about"},{default:(0,s.w5)((()=>[(0,s.Uk)("About")])),_:1})]),(0,s.Wm)(n)],64)}var i=o(89);const a={},c=(0,i.Z)(a,[["render",r]]);var l=c,u=o(5431);(0,u.z)("/ypu/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh."),alert("new update, please close the app & reopen")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var d=o(2483);const p=e=>((0,s.dD)("data-v-bc117e58"),e=e(),(0,s.Cn)(),e),m={class:"home"},f=(0,s.uE)('<h1 data-v-bc117e58>A decentralized computer</h1><small data-v-bc117e58><i data-v-bc117e58>15/12/2022</i></small><p data-v-bc117e58> Let&#39;s say we want to build a decentralized computer, for many reason : <ul data-v-bc117e58><li data-v-bc117e58>my computer is not very efficient and i want more resources</li><li data-v-bc117e58>reducing the ecological impact of computers, by sharing under-used resources</li><li data-v-bc117e58>accessing GPU for Machine Learning</li><li data-v-bc117e58>use quantum computer for specific operations</li><li data-v-bc117e58>...</li></ul></p><p data-v-bc117e58>Imagine you just have to open a webpage or connect to a service to instantly accessing many resources for free.</p><p data-v-bc117e58>First, let&#39;s imagine every single task as a document that computer could share and interact, without they know the meaning of this task. And imagine the document representing this task could be instantly shared all over the world. Any computer connected free of charge at the moment when this task is created can (if it is capable) do the task and update the task document, updating it as done.</p><h1 data-v-bc117e58>Sharing a task document</h1><p data-v-bc117e58>To share a document, we can, for example use <a href="https://docs.yjs.dev/" target="_blank" data-v-bc117e58>YJS</a>, a javascript library that allow us to build complexes documents and sync them between many devices with the help of <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API" target="_blank" data-v-bc117e58>websockets</a>. </p><p data-v-bc117e58> A <a href="https://glitch.com/edit/#!/ypu" target="_blank" data-v-bc117e58>websocket server</a> has just been prepared for sharing the task document that we need and can be used with the protocol+url <b data-v-bc117e58>wss://ypu.glitch.me/</b>. This allow us to share documents on a channel like <b data-v-bc117e58>my-ypu</b></p>',8),h=p((()=>(0,s._)("hr",null,null,-1)));function g(e,t,o,n,r,i){const a=(0,s.up)("WebsocketBus"),c=(0,s.up)("TodosPush"),l=(0,s.up)("TodosView"),u=(0,s.up)("PendingView"),d=(0,s.up)("DoneView");return(0,s.wg)(),(0,s.iD)("div",m,[f,(0,s.Wm)(a),h,(0,s.Wm)(c),(0,s.Wm)(l),(0,s.Wm)(u),(0,s.Wm)(d)])}var b=o(7139);const v=e=>((0,s.dD)("data-v-0f1b79b7"),e=e(),(0,s.Cn)(),e),w={class:"websocket-bus"},y=v((()=>(0,s._)("legend",null,"Websocket",-1))),k=v((()=>(0,s._)("b",null,"remote",-1))),_=v((()=>(0,s._)("br",null,null,-1))),T=v((()=>(0,s._)("br",null,null,-1))),D=v((()=>(0,s._)("small",null,[(0,s._)("i",null,"when using 'wss://ypu.glitch.me/', please wait eventualy 30 seconds for the server to be started, because if nobody is using it at the moment, it can be stopped")],-1))),P=v((()=>(0,s._)("br",null,null,-1)));function j(e,t,o,r,i,a){return(0,s.wg)(),(0,s.iD)("div",w,[(0,s._)("fieldset",null,[y,(0,s.Uk)(" Choose the "),(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>a.remote&&a.remote(...e))},[k,(0,s.Uk)(" '"+(0,b.zw)(i.remote_url)+"'",1)]),(0,s.Uk)(" (default) url (or for developpement on your local machine, use the "),(0,s._)("button",{onClick:t[1]||(t[1]=(...t)=>e.local&&e.local(...t))},"local "),_,(0,s.Uk)(" server : "),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>i.config.server=e),placeholder:"config.server"},null,512),[[n.nr,i.config.server]]),(0,s.Uk)(" channel : "),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>i.config.room=e),placeholder:"config.room"},null,512),[[n.nr,i.config.room]]),T,(0,s.Uk)(" and "),(0,s._)("button",{onClick:t[4]||(t[4]=(...e)=>a.connect&&a.connect(...e))},"Connect"),D,P,(0,s.Uk)(' Here is the "Websocket Bus status" : '+(0,b.zw)(a.status),1)])])}var W={name:"WebsocketBus",data(){return{config:{server:"",room:"my-ypu"},locale_url:"ws://"+window.location.hostname+":1234",remote_url:"wss://ypu.glitch.me/"}},created(){"127.0.0.1"==window.location.hostname?this.locale():this.remote()},methods:{connect(){this.$initWebSocketBus(this.config)},locale(){this.config.server=this.locale_url},remote(){this.config.server=this.remote_url,this.$initWebSocketBus(this.config)}},computed:{status(){return this.$store.state.ypu.status}}};const C=(0,i.Z)(W,[["render",j],["__scopeId","data-v-0f1b79b7"]]);var $=C;o(7658);const V={class:"todos-push"};function A(e,t,o,r,i,a){return(0,s.wg)(),(0,s.iD)("div",V,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.wt=e),placeholder:"waitTime in ms, default:100",type:"number",min:"0",onChange:t[1]||(t[1]=(...e)=>a.setWaitTime&&a.setWaitTime(...e))},null,544),[[n.nr,i.wt]]),(0,s._)("button",{onClick:t[2]||(t[2]=(...e)=>a.toggleActif&&a.toggleActif(...e))},"Actif: "+(0,b.zw)(a.actif),1),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>i.operation=e),placeholder:"operation",onKeyup:t[4]||(t[4]=(0,n.D2)(((...e)=>a.push&&a.push(...e)),["enter"]))},null,544),[[n.nr,i.operation]]),(0,s._)("button",{onClick:t[5]||(t[5]=(...e)=>a.push&&a.push(...e))},"Push to todos"),(0,s._)("button",{onClick:t[6]||(t[6]=(...e)=>a.cleanTodos&&a.cleanTodos(...e))},"Debug: Clean todos"),(0,s.wy)((0,s._)("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>i.numberOfTodos=e)},null,512),[[n.nr,i.numberOfTodos]]),(0,s._)("button",{onClick:t[8]||(t[8]=(...e)=>a.pushH&&a.pushH(...e))},"Push many to todos")])}var O={name:"TodosPush",data(){return{operation:"",numberOfTodos:100,wt:0}},created(){this.wt=this.$store.state.ypu.waitTime},methods:{toggleActif(){this.$store.commit("ypu/setActif",!this.actif),this.$prepare()},push(){this.$pushToTodos(this.operation),this.operation=""},pushH(){for(let e=0;e<this.numberOfTodos;e++){let t={ope:"reverse",data:e+"--"+Date.now()};this.$pushToTodos(t)}this.operation=""},cleanTodos(){this.$cleanTodos()},setWaitTime(){console.log("set waitTime ",this.wt),this.$store.commit("ypu/setWaitTime",this.wt)}},watch:{waitTime(){this.wt=this.waitTime}},computed:{actif(){return this.$store.state.ypu.actif},waitTime(){return this.$store.state.ypu.waitTime}}};const U=(0,i.Z)(O,[["render",A],["__scopeId","data-v-73873437"]]);var I=U;const S=e=>((0,s.dD)("data-v-672a4096"),e=e(),(0,s.Cn)(),e),z={class:"todos-view"},E=S((()=>(0,s._)("hr",null,null,-1)));function L(e,t,o,n,r,i){const a=(0,s.up)("ListView");return(0,s.wg)(),(0,s.iD)("div",z,[(0,s.Uk)(" TodosView : "),(0,s.Wm)(a,{object:i.todos},null,8,["object"]),E])}const M={class:"list-view"},B={key:0,style:{height:"200px","overflow-y":"scroll"}},N={key:0},Z={key:1};function x(e,t,o,n,r,i){return(0,s.wg)(),(0,s.iD)("div",M,[(0,s.Uk)((0,b.zw)(i.clientID)+" / "+(0,b.zw)(r.items.length)+" ",1),null!=o.object?((0,s.wg)(),(0,s.iD)("ul",B,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.items,(e=>((0,s.wg)(),(0,s.iD)("li",{key:e.key},[e.worker==i.clientID?((0,s.wg)(),(0,s.iD)("b",N,"ME")):((0,s.wg)(),(0,s.iD)("span",Z,(0,b.zw)(e.worker),1)),(0,s.Uk)(" "+(0,b.zw)(e),1)])))),128))])):(0,s.kq)("",!0)])}var H={name:"ListView",props:["object","reverse"],data(){return{items:[]}},watch:{object(){this.items="true"==this.reverse?Object.values(this.object).reverse():Object.values(this.object)}},computed:{clientID(){return this.$store.state.ypu.clientID}}};const F=(0,i.Z)(H,[["render",x],["__scopeId","data-v-5a1aed6d"]]);var q=F,J={name:"TodosView",components:{ListView:q},computed:{todos(){return this.$store.state.ypu.todos}}};const R=(0,i.Z)(J,[["render",L],["__scopeId","data-v-672a4096"]]);var Y=R;const G=e=>((0,s.dD)("data-v-2333a823"),e=e(),(0,s.Cn)(),e),K={class:"pending-view"},Q=G((()=>(0,s._)("hr",null,null,-1)));function X(e,t,o,n,r,i){const a=(0,s.up)("ListView");return(0,s.wg)(),(0,s.iD)("div",K,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>i.cleanPending&&i.cleanPending(...e))},"Debug: Clean pending"),(0,s.Uk)(" PendingView : "),(0,s.Wm)(a,{object:i.pending},null,8,["object"]),Q])}var ee={name:"PendingView",components:{ListView:q},methods:{cleanPending(){this.$cleanPending()}},computed:{pending(){return this.$store.state.ypu.pending}}};const te=(0,i.Z)(ee,[["render",X],["__scopeId","data-v-2333a823"]]);var oe=te;const ne={class:"done-view"};function se(e,t,o,n,r,i){const a=(0,s.up)("ListView");return(0,s.wg)(),(0,s.iD)("div",ne,[(0,s._)("button",{onClick:t[0]||(t[0]=(...e)=>i.cleanDone&&i.cleanDone(...e))},"Debug: Clean done"),(0,s.Uk)(" DoneView : "),(0,s.Wm)(a,{object:i.done,reverse:"true"},null,8,["object"])])}var re={name:"DoneView",components:{ListView:q},computed:{done(){return this.$store.state.ypu.done}},methods:{cleanDone(){this.$cleanDone()}}};const ie=(0,i.Z)(re,[["render",se],["__scopeId","data-v-35c4fe37"]]);var ae=ie,ce={name:"HomeView",components:{WebsocketBus:$,TodosPush:I,TodosView:Y,PendingView:oe,DoneView:ae}};const le=(0,i.Z)(ce,[["render",g],["__scopeId","data-v-bc117e58"]]);var ue=le;const de=[{path:"/",name:"home",component:ue},{path:"/about",name:"about",component:()=>o.e(443).then(o.bind(o,7381))}],pe=(0,d.p7)({history:(0,d.PO)("/ypu/"),routes:de});var me=pe,fe=o(65);const he=()=>({doc:null,wsProvider:null,status:"unknown",memory:null,todos:null,pending:null,done:null,ready:!1,actif:!1,clientID:null,waitTime:100}),ge={setDoc(e,t){e.doc=t},setStatus(e,t){e.status=t},setWsProvider(e,t){e.wsProvider=t},setMemory(e,t){e.memory=t},setTodos(e,t){e.todos=t},setPending(e,t){e.pending=t},setDone(e,t){e.done=t},setReady(e,t){e.ready=t},setClientID(e,t){e.clientID=t},setWaitTime(e,t){e.waitTime=t},setActif(e,t){console.log(t),e.actif=t,1==e.actif&&0==e.ready&&(e.ready=!0)}},be={};var ve={namespaced:!0,state:he,actions:be,mutations:ge},we=(0,fe.MT)({state:{},getters:{},mutations:{},actions:{},modules:{ypu:ve}}),ye=o(2942),ke=o(8340),_e=o(114),Te=o(536),De={install:(e,t)=>{let o,n,s,r=t.store,i=null,a=null,c=null,l=null,u=null;e.config.globalProperties.$initWebSocketBus=async function(t){i=new ye.QW,c=new _e.GL(i),r.commit("ypu/setClientID",c.clientID),a=new ke.VU(t.server,t.room,i),r.commit("ypu/setDoc",i),r.commit("ypu/setWsProvider",a),a.on("status",(e=>{console.log(e.status),r.commit("ypu/setStatus",e.status)})),l=i.getArray("memory"),u=i.getArray("registers"),o=i.getMap("todos"),n=i.getMap("pending"),s=i.getMap("done"),l.observe((e=>{e.target,r.commit("ypu/setMemory",l.toArray()),console.log(e.changes.delta)})),o.observe((t=>{r.commit("ypu/setTodos",o.toJSON()),t.changes.keys.forEach(((t,o)=>{"add"===t.action&&e.config.globalProperties.$prepare(o)}))})),n.observe((e=>{e.target,r.commit("ypu/setPending",n.toJSON())})),s.observe((e=>{e.target,r.commit("ypu/setDone",s.toJSON())})),u.observe((e=>{e.target,console.log(e.changes.delta)})),c.on("change",(e=>{console.log(e),this.awareness.getStates().forEach((e=>{console.log(e)}))}))},e.config.globalProperties.$pushToTodos=async function(e){o.set((0,Te.Z)(),{operation:e,asker:c.clientID})},e.config.globalProperties.$cleanTodos=async function(){for(const e of o.keys())o.delete(e)},e.config.globalProperties.$cleanPending=async function(){for(const e of n.keys())n.delete(e)},e.config.globalProperties.$cleanDone=async function(){for(const e of s.keys())s.delete(e)},e.config.globalProperties.$prepare=async function(t){if(console.log("key",t),1==r.state.ypu.actif&&1==r.state.ypu.ready){void 0==t&&(t=Array.from(o.keys())[0]),console.log(t);let s=o.get(t);if(void 0!=s){r.commit("ypu/setReady",!1);let i={key:t,data:s,worker:c.clientID,start:Date.now()};n.set(t,i),o.delete(t),e.config.globalProperties.$process(i)}else console.log("bizarre not found ",t,s)}},e.config.globalProperties.$process=async function(t){console.log("processing ",t);let o=r.state.ypu.waitTime;setTimeout((function(){console.log("Executed after ms ",o),t.end=Date.now(),t.result="Wahou c'est ok",s.set(t.key,t),n.delete(t.key),r.commit("ypu/setReady",!0),e.config.globalProperties.$prepare()}),o)}}};(0,n.ri)(l).use(we).use(me).use(De,{store:we}).mount("#app")}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,n,s,r){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],s=e[u][1],r=e[u][2];for(var a=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(o.O).every((function(e){return o.O[e](n[c])}))?n.splice(c--,1):(a=!1,r<i&&(i=r));if(a){e.splice(u--,1);var l=s();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,s,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/about.d36b28f9.js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="ypu:";o.l=function(n,s,r,i){if(e[n])e[n].push(s);else{var a,c;if(void 0!==r)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+r){a=d;break}}a||(c=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+r),a.src=n),e[n]=[s];var p=function(t,o){a.onerror=a.onload=null,clearTimeout(m);var s=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((function(e){return e(o)})),t)return t(o)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),c&&document.head.appendChild(a)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/ypu/"}(),function(){var e={143:0};o.f.j=function(t,n){var s=o.o(e,t)?e[t]:void 0;if(0!==s)if(s)n.push(s[2]);else{var r=new Promise((function(o,n){s=e[t]=[o,n]}));n.push(s[2]=r);var i=o.p+o.u(t),a=new Error,c=function(n){if(o.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var r=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",a.name="ChunkLoadError",a.type=r,a.request=i,s[1](a)}};o.l(i,c,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,r,i=n[0],a=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(s in a)o.o(a,s)&&(o.m[s]=a[s]);if(c)var u=c(o)}for(t&&t(n);l<i.length;l++)r=i[l],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(u)},n=self["webpackChunkypu"]=self["webpackChunkypu"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(1361)}));n=o.O(n)})();
//# sourceMappingURL=app.c701b12c.js.map