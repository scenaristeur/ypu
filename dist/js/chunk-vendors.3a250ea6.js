(self["webpackChunkypu"]=self["webpackChunkypu"]||[]).push([[998],{9662:function(e,t,n){var r=n(614),s=n(6330),i=TypeError;e.exports=function(e){if(r(e))return e;throw i(s(e)+" is not a function")}},6077:function(e,t,n){var r=n(614),s=String,i=TypeError;e.exports=function(e){if("object"==typeof e||r(e))return e;throw i("Can't set "+s(e)+" as a prototype")}},5787:function(e,t,n){var r=n(7976),s=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw s("Incorrect invocation")}},9670:function(e,t,n){var r=n(111),s=String,i=TypeError;e.exports=function(e){if(r(e))return e;throw i(s(e)+" is not an object")}},1318:function(e,t,n){var r=n(5656),s=n(1400),i=n(6244),o=function(e){return function(t,n,o){var a,c=r(t),l=i(c),u=s(o,l);if(e&&n!=n){while(l>u)if(a=c[u++],a!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},3658:function(e,t,n){"use strict";var r=n(9781),s=n(3157),i=TypeError,o=Object.getOwnPropertyDescriptor,a=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=a?function(e,t){if(s(e)&&!o(e,"length").writable)throw i("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},206:function(e,t,n){var r=n(1702);e.exports=r([].slice)},4326:function(e,t,n){var r=n(1702),s=r({}.toString),i=r("".slice);e.exports=function(e){return i(s(e),8,-1)}},648:function(e,t,n){var r=n(1694),s=n(614),i=n(4326),o=n(5112),a=o("toStringTag"),c=Object,l="Arguments"==i(function(){return arguments}()),u=function(e,t){try{return e[t]}catch(n){}};e.exports=r?i:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=u(t=c(e),a))?n:l?i(t):"Object"==(r=i(t))&&s(t.callee)?"Arguments":r}},9920:function(e,t,n){var r=n(2597),s=n(3887),i=n(1236),o=n(3070);e.exports=function(e,t,n){for(var a=s(t),c=o.f,l=i.f,u=0;u<a.length;u++){var h=a[u];r(e,h)||n&&r(n,h)||c(e,h,l(t,h))}}},8880:function(e,t,n){var r=n(9781),s=n(3070),i=n(9114);e.exports=r?function(e,t,n){return s.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7045:function(e,t,n){var r=n(6339),s=n(3070);e.exports=function(e,t,n){return n.get&&r(n.get,t,{getter:!0}),n.set&&r(n.set,t,{setter:!0}),s.f(e,t,n)}},8052:function(e,t,n){var r=n(614),s=n(3070),i=n(6339),o=n(3072);e.exports=function(e,t,n,a){a||(a={});var c=a.enumerable,l=void 0!==a.name?a.name:t;if(r(n)&&i(n,l,a),a.global)c?e[t]=n:o(t,n);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(u){}c?e[t]=n:s.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},3072:function(e,t,n){var r=n(7854),s=Object.defineProperty;e.exports=function(e,t){try{s(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},5117:function(e,t,n){"use strict";var r=n(6330),s=TypeError;e.exports=function(e,t){if(!delete e[t])throw s("Cannot delete property "+r(t)+" of "+r(e))}},9781:function(e,t,n){var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(e){var t="object"==typeof document&&document.all,n="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},317:function(e,t,n){var r=n(7854),s=n(111),i=r.document,o=s(i)&&s(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},7207:function(e){var t=TypeError,n=9007199254740991;e.exports=function(e){if(e>n)throw t("Maximum allowed index exceeded");return e}},3678:function(e){e.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},6833:function(e,t,n){var r=n(8113);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},5268:function(e,t,n){var r=n(4326),s=n(7854);e.exports="process"==r(s.process)},8113:function(e,t,n){var r=n(5005);e.exports=r("navigator","userAgent")||""},7392:function(e,t,n){var r,s,i=n(7854),o=n(8113),a=i.process,c=i.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(r=u.split("."),s=r[0]>0&&r[0]<4?1:+(r[0]+r[1])),!s&&o&&(r=o.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/),r&&(s=+r[1]))),e.exports=s},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},1060:function(e,t,n){var r=n(1702),s=Error,i=r("".replace),o=function(e){return String(s(e).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,c=a.test(o);e.exports=function(e,t){if(c&&"string"==typeof e&&!s.prepareStackTrace)while(t--)e=i(e,a,"");return e}},2109:function(e,t,n){var r=n(7854),s=n(1236).f,i=n(8880),o=n(8052),a=n(3072),c=n(9920),l=n(4705);e.exports=function(e,t){var n,u,h,d,f,p,g=e.target,y=e.global,m=e.stat;if(u=y?r:m?r[g]||a(g,{}):(r[g]||{}).prototype,u)for(h in t){if(f=t[h],e.dontCallGetSet?(p=s(u,h),d=p&&p.value):d=u[h],n=l(y?h:g+(m?".":"#")+h,e.forced),!n&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&i(f,"sham",!0),o(u,h,f,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},2104:function(e,t,n){var r=n(4374),s=Function.prototype,i=s.apply,o=s.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(i):function(){return o.apply(i,arguments)})},9974:function(e,t,n){var r=n(1470),s=n(9662),i=n(4374),o=r(r.bind);e.exports=function(e,t){return s(e),void 0===t?e:i?o(e,t):function(){return e.apply(t,arguments)}}},4374:function(e,t,n){var r=n(7293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:function(e,t,n){var r=n(4374),s=Function.prototype.call;e.exports=r?s.bind(s):function(){return s.apply(s,arguments)}},6530:function(e,t,n){var r=n(9781),s=n(2597),i=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=s(i,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&o(i,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},1470:function(e,t,n){var r=n(4326),s=n(1702);e.exports=function(e){if("Function"===r(e))return s(e)}},1702:function(e,t,n){var r=n(4374),s=Function.prototype,i=s.call,o=r&&s.bind.bind(i,i);e.exports=r?o:function(e){return function(){return i.apply(e,arguments)}}},5005:function(e,t,n){var r=n(7854),s=n(614),i=function(e){return s(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e]):r[e]&&r[e][t]}},8173:function(e,t,n){var r=n(9662),s=n(8554);e.exports=function(e,t){var n=e[t];return s(n)?void 0:r(n)}},7854:function(e,t,n){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:function(e,t,n){var r=n(1702),s=n(7908),i=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return i(s(e),t)}},3501:function(e){e.exports={}},490:function(e,t,n){var r=n(5005);e.exports=r("document","documentElement")},4664:function(e,t,n){var r=n(9781),s=n(7293),i=n(317);e.exports=!r&&!s((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},8361:function(e,t,n){var r=n(1702),s=n(7293),i=n(4326),o=Object,a=r("".split);e.exports=s((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"==i(e)?a(e,""):o(e)}:o},9587:function(e,t,n){var r=n(614),s=n(111),i=n(7674);e.exports=function(e,t,n){var o,a;return i&&r(o=t.constructor)&&o!==n&&s(a=o.prototype)&&a!==n.prototype&&i(e,a),e}},2788:function(e,t,n){var r=n(1702),s=n(614),i=n(5465),o=r(Function.toString);s(i.inspectSource)||(i.inspectSource=function(e){return o(e)}),e.exports=i.inspectSource},9909:function(e,t,n){var r,s,i,o=n(4811),a=n(7854),c=n(111),l=n(8880),u=n(2597),h=n(5465),d=n(6200),f=n(3501),p="Object already initialized",g=a.TypeError,y=a.WeakMap,m=function(e){return i(e)?s(e):r(e,{})},w=function(e){return function(t){var n;if(!c(t)||(n=s(t)).type!==e)throw g("Incompatible receiver, "+e+" required");return n}};if(o||h.state){var b=h.state||(h.state=new y);b.get=b.get,b.has=b.has,b.set=b.set,r=function(e,t){if(b.has(e))throw g(p);return t.facade=e,b.set(e,t),t},s=function(e){return b.get(e)||{}},i=function(e){return b.has(e)}}else{var v=d("state");f[v]=!0,r=function(e,t){if(u(e,v))throw g(p);return t.facade=e,l(e,v,t),t},s=function(e){return u(e,v)?e[v]:{}},i=function(e){return u(e,v)}}e.exports={set:r,get:s,has:i,enforce:m,getterFor:w}},3157:function(e,t,n){var r=n(4326);e.exports=Array.isArray||function(e){return"Array"==r(e)}},614:function(e,t,n){var r=n(4154),s=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===s}:function(e){return"function"==typeof e}},4705:function(e,t,n){var r=n(7293),s=n(614),i=/#|\.prototype\./,o=function(e,t){var n=c[a(e)];return n==u||n!=l&&(s(t)?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},8554:function(e){e.exports=function(e){return null===e||void 0===e}},111:function(e,t,n){var r=n(614),s=n(4154),i=s.all;e.exports=s.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===i}:function(e){return"object"==typeof e?null!==e:r(e)}},1913:function(e){e.exports=!1},2190:function(e,t,n){var r=n(5005),s=n(614),i=n(7976),o=n(3307),a=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return s(t)&&i(t.prototype,a(e))}},6244:function(e,t,n){var r=n(7466);e.exports=function(e){return r(e.length)}},6339:function(e,t,n){var r=n(7293),s=n(614),i=n(2597),o=n(9781),a=n(6530).CONFIGURABLE,c=n(2788),l=n(9909),u=l.enforce,h=l.get,d=Object.defineProperty,f=o&&!r((function(){return 8!==d((function(){}),"length",{value:8}).length})),p=String(String).split("String"),g=e.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!i(e,"name")||a&&e.name!==t)&&(o?d(e,"name",{value:t,configurable:!0}):e.name=t),f&&n&&i(n,"arity")&&e.length!==n.arity&&d(e,"length",{value:n.arity});try{n&&i(n,"constructor")&&n.constructor?o&&d(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(s){}var r=u(e);return i(r,"source")||(r.source=p.join("string"==typeof t?t:"")),e};Function.prototype.toString=g((function(){return s(this)&&h(this).source||c(this)}),"toString")},4758:function(e){var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},6277:function(e,t,n){var r=n(1340);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},3070:function(e,t,n){var r=n(9781),s=n(4664),i=n(3353),o=n(9670),a=n(4948),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";t.f=r?i?function(e,t,n){if(o(e),t=a(t),o(n),"function"===typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var r=u(e,t);r&&r[f]&&(e[t]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(o(e),t=a(t),o(n),s)try{return l(e,t,n)}catch(r){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:function(e,t,n){var r=n(9781),s=n(6916),i=n(5296),o=n(9114),a=n(5656),c=n(4948),l=n(2597),u=n(4664),h=Object.getOwnPropertyDescriptor;t.f=r?h:function(e,t){if(e=a(e),t=c(t),u)try{return h(e,t)}catch(n){}if(l(e,t))return o(!s(i.f,e,t),e[t])}},8006:function(e,t,n){var r=n(6324),s=n(748),i=s.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},7976:function(e,t,n){var r=n(1702);e.exports=r({}.isPrototypeOf)},6324:function(e,t,n){var r=n(1702),s=n(2597),i=n(5656),o=n(1318).indexOf,a=n(3501),c=r([].push);e.exports=function(e,t){var n,r=i(e),l=0,u=[];for(n in r)!s(a,n)&&s(r,n)&&c(u,n);while(t.length>l)s(r,n=t[l++])&&(~o(u,n)||c(u,n));return u}},5296:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,s=r&&!n.call({1:2},1);t.f=s?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7674:function(e,t,n){var r=n(1702),s=n(9670),i=n(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(n,[]),t=n instanceof Array}catch(o){}return function(n,r){return s(n),i(r),t?e(n,r):n.__proto__=r,n}}():void 0)},2140:function(e,t,n){var r=n(6916),s=n(614),i=n(111),o=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&s(n=e.toString)&&!i(a=r(n,e)))return a;if(s(n=e.valueOf)&&!i(a=r(n,e)))return a;if("string"!==t&&s(n=e.toString)&&!i(a=r(n,e)))return a;throw o("Can't convert object to primitive value")}},3887:function(e,t,n){var r=n(5005),s=n(1702),i=n(8006),o=n(5181),a=n(9670),c=s([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=i.f(a(e)),n=o.f;return n?c(t,n(e)):t}},7066:function(e,t,n){"use strict";var r=n(9670);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},4488:function(e,t,n){var r=n(8554),s=TypeError;e.exports=function(e){if(r(e))throw s("Can't call method on "+e);return e}},6200:function(e,t,n){var r=n(2309),s=n(9711),i=r("keys");e.exports=function(e){return i[e]||(i[e]=s(e))}},5465:function(e,t,n){var r=n(7854),s=n(3072),i="__core-js_shared__",o=r[i]||s(i,{});e.exports=o},2309:function(e,t,n){var r=n(1913),s=n(5465);(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.26.1",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(e,t,n){var r=n(7392),s=n(7293);e.exports=!!Object.getOwnPropertySymbols&&!s((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},261:function(e,t,n){var r,s,i,o,a=n(7854),c=n(2104),l=n(9974),u=n(614),h=n(2597),d=n(7293),f=n(490),p=n(206),g=n(317),y=n(8053),m=n(6833),w=n(5268),b=a.setImmediate,v=a.clearImmediate,_=a.process,E=a.Dispatch,S=a.Function,k=a.MessageChannel,I=a.String,A=0,T={},R="onreadystatechange";try{r=a.location}catch(D){}var C=function(e){if(h(T,e)){var t=T[e];delete T[e],t()}},P=function(e){return function(){C(e)}},N=function(e){C(e.data)},O=function(e){a.postMessage(I(e),r.protocol+"//"+r.host)};b&&v||(b=function(e){y(arguments.length,1);var t=u(e)?e:S(e),n=p(arguments,1);return T[++A]=function(){c(t,void 0,n)},s(A),A},v=function(e){delete T[e]},w?s=function(e){_.nextTick(P(e))}:E&&E.now?s=function(e){E.now(P(e))}:k&&!m?(i=new k,o=i.port2,i.port1.onmessage=N,s=l(o.postMessage,o)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!d(O)?(s=O,a.addEventListener("message",N,!1)):s=R in g("script")?function(e){f.appendChild(g("script"))[R]=function(){f.removeChild(this),C(e)}}:function(e){setTimeout(P(e),0)}),e.exports={set:b,clear:v}},1400:function(e,t,n){var r=n(9303),s=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?s(n+t,0):i(n,t)}},5656:function(e,t,n){var r=n(8361),s=n(4488);e.exports=function(e){return r(s(e))}},9303:function(e,t,n){var r=n(4758);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},7466:function(e,t,n){var r=n(9303),s=Math.min;e.exports=function(e){return e>0?s(r(e),9007199254740991):0}},7908:function(e,t,n){var r=n(4488),s=Object;e.exports=function(e){return s(r(e))}},7593:function(e,t,n){var r=n(6916),s=n(111),i=n(2190),o=n(8173),a=n(2140),c=n(5112),l=TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!s(e)||i(e))return e;var n,c=o(e,u);if(c){if(void 0===t&&(t="default"),n=r(c,e,t),!s(n)||i(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},4948:function(e,t,n){var r=n(7593),s=n(2190);e.exports=function(e){var t=r(e,"string");return s(t)?t:t+""}},1694:function(e,t,n){var r=n(5112),s=r("toStringTag"),i={};i[s]="z",e.exports="[object z]"===String(i)},1340:function(e,t,n){var r=n(648),s=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return s(e)}},6330:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},9711:function(e,t,n){var r=n(1702),s=0,i=Math.random(),o=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++s+i,36)}},3307:function(e,t,n){var r=n(6293);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,n){var r=n(9781),s=n(7293);e.exports=r&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8053:function(e){var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},4811:function(e,t,n){var r=n(7854),s=n(614),i=r.WeakMap;e.exports=s(i)&&/native code/.test(String(i))},5112:function(e,t,n){var r=n(7854),s=n(2309),i=n(2597),o=n(9711),a=n(6293),c=n(3307),l=s("wks"),u=r.Symbol,h=u&&u["for"],d=c?u:u&&u.withoutSetter||o;e.exports=function(e){if(!i(l,e)||!a&&"string"!=typeof l[e]){var t="Symbol."+e;a&&i(u,e)?l[e]=u[e]:l[e]=c&&h?h(t):d(t)}return l[e]}},7658:function(e,t,n){"use strict";var r=n(2109),s=n(7908),i=n(6244),o=n(3658),a=n(7207),c=n(7293),l=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),u=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();r({target:"Array",proto:!0,arity:1,forced:l||u},{push:function(e){var t=s(this),n=i(t),r=arguments.length;a(n+r);for(var c=0;c<r;c++)t[n]=arguments[c],n++;return o(t,n),n}})},541:function(e,t,n){"use strict";var r=n(2109),s=n(7908),i=n(6244),o=n(3658),a=n(5117),c=n(7207),l=1!==[].unshift(0),u=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}();r({target:"Array",proto:!0,arity:1,forced:l||u},{unshift:function(e){var t=s(this),n=i(t),r=arguments.length;if(r){c(n+r);var l=n;while(l--){var u=l+r;l in t?t[u]=t[l]:a(t,u)}for(var h=0;h<r;h++)t[h]=arguments[h]}return o(t,n+r)}})},2087:function(e,t,n){var r=n(7854),s=n(9781),i=n(7045),o=n(7066),a=n(7293),c=r.RegExp,l=c.prototype,u=s&&a((function(){var e=!0;try{c(".","d")}catch(u){e=!1}var t={},n="",r=e?"dgimsy":"gimsy",s=function(e,r){Object.defineProperty(t,e,{get:function(){return n+=r,!0}})},i={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var o in e&&(i.hasIndices="d"),i)s(o,i[o]);var a=Object.getOwnPropertyDescriptor(l,"flags").get.call(t);return a!==r||n!==r}));u&&i(l,"flags",{configurable:!0,get:o})},1091:function(e,t,n){var r=n(2109),s=n(7854),i=n(261).clear;r({global:!0,bind:!0,enumerable:!0,forced:s.clearImmediate!==i},{clearImmediate:i})},2801:function(e,t,n){"use strict";var r=n(2109),s=n(7854),i=n(5005),o=n(9114),a=n(3070).f,c=n(2597),l=n(5787),u=n(9587),h=n(6277),d=n(3678),f=n(1060),p=n(9781),g=n(1913),y="DOMException",m=i("Error"),w=i(y),b=function(){l(this,v);var e=arguments.length,t=h(e<1?void 0:arguments[0]),n=h(e<2?void 0:arguments[1],"Error"),r=new w(t,n),s=m(t);return s.name=y,a(r,"stack",o(1,f(s.stack,1))),u(r,this,b),r},v=b.prototype=w.prototype,_="stack"in m(y),E="stack"in new w(1,2),S=w&&p&&Object.getOwnPropertyDescriptor(s,y),k=!!S&&!(S.writable&&S.configurable),I=_&&!k&&!E;r({global:!0,constructor:!0,forced:g||I},{DOMException:I?b:w});var A=i(y),T=A.prototype;if(T.constructor!==A)for(var R in g||a(T,"constructor",o(1,A)),d)if(c(d,R)){var C=d[R],P=C.s;c(A,P)||a(A,P,o(6,C.c))}},4633:function(e,t,n){n(1091),n(2986)},2986:function(e,t,n){var r=n(2109),s=n(7854),i=n(261).set;r({global:!0,bind:!0,enumerable:!0,forced:s.setImmediate!==i},{setImmediate:i})},5713:function(e,t,n){"use strict";n(7658);const r=-8,s=-4,i=0,o=1,a=1,c=2,l=5,u=1024,h=2048,d=8192,f=0,p=4,g=8,y=12,m=12,w=16,b="undefined"!==typeof BigUint64Array,v=Symbol(),_=1024;function E(e,t){const n=new Uint32Array(e),r=new Uint16Array(e);var i=n[t+s>>>2]>>>1,o=t>>>1;if(i<=_)return String.fromCharCode.apply(String,r.subarray(o,o+i));const a=[];do{const e=r[o+_-1],t=e>=55296&&e<56320?_-1:_;a.push(String.fromCharCode.apply(String,r.subarray(o,o+=t))),i-=t}while(i>_);return a.join("")+String.fromCharCode.apply(String,r.subarray(o,o+i))}function S(e){const t={};function n(e,t){return e?E(e.buffer,t):"<yet unknown>"}const r=e.env=e.env||{};return r.abort=r.abort||function(e,s,i,o){const a=t.memory||r.memory;throw Error("abort: "+n(a,e)+" at "+n(a,s)+":"+i+":"+o)},r.trace=r.trace||function(e,s){const i=t.memory||r.memory;console.log("trace: "+n(i,e)+(s?" ":"")+Array.prototype.slice.call(arguments,2,2+s).join(", "))},e.Math=e.Math||Math,e.Date=e.Date||Date,t}function k(e,t){const n=t.exports,v=n.memory,_=n.table,S=n["__alloc"],k=n["__retain"],I=n["__rtti_base"]||-1;function A(e){const t=new Uint32Array(v.buffer),n=t[I>>>2];if((e>>>=0)>=n)throw Error("invalid id: "+e);return t[(I+4>>>2)+2*e]}function T(e){const t=new Uint32Array(v.buffer),n=t[I>>>2];if((e>>>=0)>=n)throw Error("invalid id: "+e);return t[(I+4>>>2)+2*e+1]}function R(e){return 31-Math.clz32(e>>>l&31)}function P(e){const t=e.length,n=S(t<<1,o),r=new Uint16Array(v.buffer);for(var s=0,i=n>>>1;s<t;++s)r[i+s]=e.charCodeAt(s);return n}function N(e){const t=v.buffer,n=new Uint32Array(t)[e+r>>>2];if(n!==o)throw Error("not a string: "+e);return E(t,e)}function O(e,t,n){const r=v.buffer;if(n)switch(e){case 2:return new Float32Array(r);case 3:return new Float64Array(r)}else switch(e){case 0:return new(t?Int8Array:Uint8Array)(r);case 1:return new(t?Int16Array:Uint16Array)(r);case 2:return new(t?Int32Array:Uint32Array)(r);case 3:return new(t?BigInt64Array:BigUint64Array)(r)}throw Error("unsupported align: "+e)}function D(e,t){const n=A(e);if(!(n&(a|c)))throw Error("not an array: "+e+" @ "+n);const r=R(n),s=t.length,o=S(s<<r,i),l=S(n&c?w:y,e),b=new Uint32Array(v.buffer);b[l+f>>>2]=k(o),b[l+p>>>2]=o,b[l+g>>>2]=s<<r,n&c&&(b[l+m>>>2]=s);const _=O(r,n&u,n&h);if(n&d)for(let i=0;i<s;++i)_[(o>>>r)+i]=k(t[i]);else _.set(t,o>>>r);return l}function L(e){const t=new Uint32Array(v.buffer),n=t[e+r>>>2],i=A(n);if(!(i&a))throw Error("not an array: "+n);const o=R(i);var l=t[e+p>>>2];const d=i&c?t[e+m>>>2]:t[l+s>>>2]>>>o;return O(o,i&u,i&h).subarray(l>>>=o,l+d)}function x(e){const t=L(e),n=t.length,r=new Array(n);for(let s=0;s<n;s++)r[s]=t[s];return r}function B(e){const t=v.buffer,n=new Uint32Array(t)[e+s>>>2];return t.slice(e,e+n)}function M(e,t,n){return new e(U(e,t,n))}function U(e,t,n){const r=v.buffer,i=new Uint32Array(r),o=i[n+p>>>2];return new e(r,o,i[o+s>>>2]>>>t)}function F(e,t){const n=new Uint32Array(v.buffer);var s=n[e+r>>>2];if(s<=n[I>>>2])do{if(s==t)return!0}while(s=T(s));return!1}return e.__allocString=P,e.__getString=N,e.__allocArray=D,e.__getArrayView=L,e.__getArray=x,e.__getArrayBuffer=B,e.__getInt8Array=M.bind(null,Int8Array,0),e.__getInt8ArrayView=U.bind(null,Int8Array,0),e.__getUint8Array=M.bind(null,Uint8Array,0),e.__getUint8ArrayView=U.bind(null,Uint8Array,0),e.__getUint8ClampedArray=M.bind(null,Uint8ClampedArray,0),e.__getUint8ClampedArrayView=U.bind(null,Uint8ClampedArray,0),e.__getInt16Array=M.bind(null,Int16Array,1),e.__getInt16ArrayView=U.bind(null,Int16Array,1),e.__getUint16Array=M.bind(null,Uint16Array,1),e.__getUint16ArrayView=U.bind(null,Uint16Array,1),e.__getInt32Array=M.bind(null,Int32Array,2),e.__getInt32ArrayView=U.bind(null,Int32Array,2),e.__getUint32Array=M.bind(null,Uint32Array,2),e.__getUint32ArrayView=U.bind(null,Uint32Array,2),b&&(e.__getInt64Array=M.bind(null,BigInt64Array,3),e.__getInt64ArrayView=U.bind(null,BigInt64Array,3),e.__getUint64Array=M.bind(null,BigUint64Array,3),e.__getUint64ArrayView=U.bind(null,BigUint64Array,3)),e.__getFloat32Array=M.bind(null,Float32Array,2),e.__getFloat32ArrayView=U.bind(null,Float32Array,2),e.__getFloat64Array=M.bind(null,Float64Array,3),e.__getFloat64ArrayView=U.bind(null,Float64Array,3),e.__instanceof=F,e.memory=e.memory||v,e.table=e.table||_,C(n,e)}function I(e){return"undefined"!==typeof Response&&e instanceof Response}async function A(e,t){return I(e=await e)?R(e,t):k(S(t||(t={})),await WebAssembly.instantiate(e instanceof WebAssembly.Module?e:await WebAssembly.compile(e),t))}function T(e,t){return k(S(t||(t={})),new WebAssembly.Instance(e instanceof WebAssembly.Module?e:new WebAssembly.Module(e),t))}async function R(e,t){return WebAssembly.instantiateStreaming?k(S(t||(t={})),(await WebAssembly.instantiateStreaming(e,t)).instance):A(I(e=await e)?e.arrayBuffer():e,t)}function C(e,t){var n=t?Object.create(t):{},r=e["__argumentsLength"]?function(t){e["__argumentsLength"].value=t}:e["__setArgumentsLength"]||e["__setargc"]||function(){};for(let s in e){if(!Object.prototype.hasOwnProperty.call(e,s))continue;const t=e[s];let i=s.split("."),o=n;while(i.length>1){let e=i.shift();Object.prototype.hasOwnProperty.call(o,e)||(o[e]={}),o=o[e]}let a=i[0],c=a.indexOf("#");if(c>=0){let n=a.substring(0,c),i=o[n];if("undefined"===typeof i||!i.prototype){let e=function(...t){return e.wrap(e.prototype.constructor(0,...t))};e.prototype={valueOf:function(){return this[v]}},e.wrap=function(t){return Object.create(e.prototype,{[v]:{value:t,writable:!1}})},i&&Object.getOwnPropertyNames(i).forEach((t=>Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t)))),o[n]=e}if(a=a.substring(c+1),o=o[n].prototype,/^(get|set):/.test(a)){if(!Object.prototype.hasOwnProperty.call(o,a=a.substring(4))){let t=e[s.replace("set:","get:")],n=e[s.replace("get:","set:")];Object.defineProperty(o,a,{get:function(){return t(this[v])},set:function(e){n(this[v],e)},enumerable:!0})}}else"constructor"===a?(o[a]=(...e)=>(r(e.length),t(...e))).original=t:(o[a]=function(...e){return r(e.length),t(this[v],...e)}).original=t}else/^(get|set):/.test(a)?Object.prototype.hasOwnProperty.call(o,a=a.substring(4))||Object.defineProperty(o,a,{get:e[s.replace("set:","get:")],set:e[s.replace("get:","set:")],enumerable:!0}):"function"===typeof t&&t!==r?(o[a]=(...e)=>(r(e.length),t(...e))).original=t:o[a]=t}return n}t.instantiate=A,t.instantiateSync=T,t.instantiateStreaming=R,t.demangle=C},5797:function(e,t,n){"use strict";e.exports=n(3946)},3946:function(e,t,n){"use strict";var r=t;function s(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(6991),r.BufferWriter=n(7764),r.Reader=n(796),r.BufferReader=n(2821),r.util=n(3586),r.rpc=n(1668),r.roots=n(9995),r.configure=s,s()},796:function(e,t,n){"use strict";e.exports=c;var r,s=n(3586),i=s.LongBits,o=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return s.Buffer?function(e){return(c.create=function(e){return s.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:while(4!==(e=7&this.uint32()))this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=u(),r._configure();var t=s.Long?"toLong":"toNumber";s.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},2821:function(e,t,n){"use strict";e.exports=i;var r=n(796);(i.prototype=Object.create(r.prototype)).constructor=i;var s=n(3586);function i(e){r.call(this,e)}i._configure=function(){s.Buffer&&(i.prototype._slice=s.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},9995:function(e){"use strict";e.exports={}},1668:function(e,t,n){"use strict";var r=t;r.Service=n(6692)},6692:function(e,t,n){"use strict";e.exports=s;var r=n(3586);function s(e,t,n){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(s.prototype=Object.create(r.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,n,s,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return r.asPromise(e,a,t,n,s,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof s))try{n=s[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){o(c)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},6555:function(e,t,n){"use strict";e.exports=s;var r=n(3586);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=s.zero=new s(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new s(n,r)},s.from=function(e){if("number"===typeof e)return s.fromNumber(e);if(r.isString(e)){if(!r.Long)return s.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):i},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?i:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},3586:function(e,t,n){"use strict";var r=t;function s(e,t,n){for(var r=Object.keys(t),s=0;s<r.length;++s)void 0!==e[r[s]]&&n||(e[r[s]]=t[r[s]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&s(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(5186),r.base64=n(8673),r.EventEmitter=n(8825),r.float=n(2913),r.inquire=n(6332),r.utf8=n(9561),r.pool=n(1168),r.LongBits=n(6555),r.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"===typeof e||e instanceof String},r.isObject=function(e){return e&&"object"===typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"===typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=s,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},6991:function(e,t,n){"use strict";e.exports=h;var r,s=n(3586),i=s.LongBits,o=s.base64,a=s.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return s.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,n){t[n]=255&e}function p(e,t,n){while(e>127)t[n++]=127&e|128,e>>>=7;t[n]=e}function g(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,n){while(e.hi)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;while(e.lo>127)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function m(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=d(),h.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(h.alloc=s.pool(h.alloc,s.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},g.prototype=Object.create(c.prototype),g.prototype.fn=p,h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new g((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(y,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(y,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(y,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var w=s.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(s.isString(e)){var n=h.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(w,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){var e=this.head.next,t=this.constructor.alloc(this.len),n=0;while(e)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=d(),r._configure()}},7764:function(e,t,n){"use strict";e.exports=i;var r=n(6991);(i.prototype=Object.create(r.prototype)).constructor=i;var s=n(3586);function i(){r.call(this)}function o(e,t,n){e.length<40?s.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=s._Buffer_allocUnsafe,i.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},5186:function(e){"use strict";function t(e,t){var n=new Array(arguments.length-1),r=0,s=2,i=!0;while(s<arguments.length)n[r++]=arguments[s++];return new Promise((function(s,o){n[r]=function(e){if(i)if(i=!1,e)o(e);else{var t=new Array(arguments.length-1),n=0;while(n<t.length)t[n++]=arguments[n];s.apply(null,t)}};try{e.apply(t||null,n)}catch(a){i&&(i=!1,o(a))}}))}e.exports=t},8673:function(e,t,n){"use strict";n(7658);var r=t;r.length=function(e){var t=e.length;if(!t)return 0;var n=0;while(--t%4>1&&"="===e.charAt(t))++n;return Math.ceil(3*e.length)/4-n};for(var s=new Array(64),i=new Array(123),o=0;o<64;)i[s[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,n){var r,i=null,o=[],a=0,c=0;while(t<n){var l=e[t++];switch(c){case 0:o[a++]=s[l>>2],r=(3&l)<<4,c=1;break;case 1:o[a++]=s[r|l>>4],r=(15&l)<<2,c=2;break;case 2:o[a++]=s[r|l>>6],o[a++]=s[63&l],c=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=s[r],o[a++]=61,1===c&&(o[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};var a="invalid encoding";r.decode=function(e,t,n){for(var r,s=n,o=0,c=0;c<e.length;){var l=e.charCodeAt(c++);if(61===l&&o>1)break;if(void 0===(l=i[l]))throw Error(a);switch(o){case 0:r=l,o=1;break;case 1:t[n++]=r<<2|(48&l)>>4,r=l,o=2;break;case 2:t[n++]=(15&r)<<4|(60&l)>>2,r=l,o=3;break;case 3:t[n++]=(3&r)<<6|l,o=0;break}}if(1===o)throw Error(a);return n-s},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},8825:function(e,t,n){"use strict";function r(){this._listeners={}}n(7658),e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},2913:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function s(e,r,s){t[0]=e,r[s]=n[0],r[s+1]=n[1],r[s+2]=n[2],r[s+3]=n[3]}function i(e,r,s){t[0]=e,r[s]=n[3],r[s+1]=n[2],r[s+2]=n[1],r[s+3]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function a(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?s:i,e.writeFloatBE=r?i:s,e.readFloatLE=r?o:a,e.readFloatBE=r?a:o}():function(){function t(e,t,n,r){var s=t<0?1:0;if(s&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((s<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((s<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(t)/Math.LN2),o=8388607&Math.round(t*Math.pow(2,-i)*8388608);e((s<<31|i+127<<23|o)>>>0,n,r)}}function o(e,t,n){var r=e(t,n),s=2*(r>>31)+1,i=r>>>23&255,o=8388607&r;return 255===i?o?NaN:s*(1/0):0===i?1401298464324817e-60*s*o:s*Math.pow(2,i-150)*(o+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=o.bind(null,s),e.readFloatBE=o.bind(null,i)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function s(e,r,s){t[0]=e,r[s]=n[0],r[s+1]=n[1],r[s+2]=n[2],r[s+3]=n[3],r[s+4]=n[4],r[s+5]=n[5],r[s+6]=n[6],r[s+7]=n[7]}function i(e,r,s){t[0]=e,r[s]=n[7],r[s+1]=n[6],r[s+2]=n[5],r[s+3]=n[4],r[s+4]=n[3],r[s+5]=n[2],r[s+6]=n[1],r[s+7]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function a(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?s:i,e.writeDoubleBE=r?i:s,e.readDoubleLE=r?o:a,e.readDoubleBE=r?a:o}():function(){function t(e,t,n,r,s,i){var o=r<0?1:0;if(o&&(r=-r),0===r)e(0,s,i+t),e(1/r>0?0:2147483648,s,i+n);else if(isNaN(r))e(0,s,i+t),e(2146959360,s,i+n);else if(r>17976931348623157e292)e(0,s,i+t),e((o<<31|2146435072)>>>0,s,i+n);else{var a;if(r<22250738585072014e-324)a=r/5e-324,e(a>>>0,s,i+t),e((o<<31|a/4294967296)>>>0,s,i+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),a=r*Math.pow(2,-c),e(4503599627370496*a>>>0,s,i+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,s,i+n)}}}function o(e,t,n,r,s){var i=e(r,s+t),o=e(r,s+n),a=2*(o>>31)+1,c=o>>>20&2047,l=4294967296*(1048575&o)+i;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=o.bind(null,s,0,4),e.readDoubleBE=o.bind(null,i,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},6332:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},1168:function(e){"use strict";function t(e,t,n){var r=n||8192,s=r>>>1,i=null,o=r;return function(n){if(n<1||n>s)return e(n);o+n>r&&(i=e(r),o=0);var a=t.call(i,o,o+=n);return 7&o&&(o=1+(7|o)),a}}e.exports=t},9561:function(e,t,n){"use strict";n(7658);var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)n=e.charCodeAt(r),n<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){var r=n-t;if(r<1)return"";var s,i=null,o=[],a=0;while(t<n)s=e[t++],s<128?o[a++]=s:s>191&&s<224?o[a++]=(31&s)<<6|63&e[t++]:s>239&&s<365?(s=((7&s)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(s>>10),o[a++]=56320+(1023&s)):o[a++]=(15&s)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,n){for(var r,s,i=n,o=0;o<e.length;++o)r=e.charCodeAt(o),r<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296===(64512&r)&&56320===(64512&(s=e.charCodeAt(o+1)))?(r=65536+((1023&r)<<10)+(1023&s),++o,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-i}},2267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9763);function s(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}function i(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0}function o(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16}function a(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0}function c(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}function l(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}function u(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function h(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function d(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function f(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function p(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}function g(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}function y(e,t){void 0===t&&(t=0);var n=u(e,t),r=u(e,t+4);return 4294967296*n+r-4294967296*(r>>31)}function m(e,t){void 0===t&&(t=0);var n=h(e,t),r=h(e,t+4);return 4294967296*n+r}function w(e,t){void 0===t&&(t=0);var n=d(e,t),r=d(e,t+4);return 4294967296*r+n-4294967296*(n>>31)}function b(e,t){void 0===t&&(t=0);var n=f(e,t),r=f(e,t+4);return 4294967296*r+n}function v(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),p(e/4294967296>>>0,t,n),p(e>>>0,t,n+4),t}function _(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),g(e>>>0,t,n),g(e/4294967296>>>0,t,n+4),t}function E(e,t,n){if(void 0===n&&(n=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,s=1,i=e/8+n-1;i>=n;i--)r+=t[i]*s,s*=256;return r}function S(e,t,n){if(void 0===n&&(n=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,s=1,i=n;i<n+e/8;i++)r+=t[i]*s,s*=256;return r}function k(e,t,n,s){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===s&&(s=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!r.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,o=e/8+s-1;o>=s;o--)n[o]=t/i&255,i*=256;return n}function I(e,t,n,s){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===s&&(s=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!r.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,o=s;o<s+e/8;o++)n[o]=t/i&255,i*=256;return n}function A(e,t){void 0===t&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t)}function T(e,t){void 0===t&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t,!0)}function R(e,t){void 0===t&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t)}function C(e,t){void 0===t&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t,!0)}function P(e,t,n){void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat32(n,e),t}function N(e,t,n){void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat32(n,e,!0),t}function O(e,t,n){void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat64(n,e),t}function D(e,t,n){void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat64(n,e,!0),t}t.readInt16BE=s,t.readUint16BE=i,t.readInt16LE=o,t.readUint16LE=a,t.writeUint16BE=c,t.writeInt16BE=c,t.writeUint16LE=l,t.writeInt16LE=l,t.readInt32BE=u,t.readUint32BE=h,t.readInt32LE=d,t.readUint32LE=f,t.writeUint32BE=p,t.writeInt32BE=p,t.writeUint32LE=g,t.writeInt32LE=g,t.readInt64BE=y,t.readUint64BE=m,t.readInt64LE=w,t.readUint64LE=b,t.writeUint64BE=v,t.writeInt64BE=v,t.writeUint64LE=_,t.writeInt64LE=_,t.readUintBE=E,t.readUintLE=S,t.writeUintBE=k,t.writeUintLE=I,t.readFloat32BE=A,t.readFloat32LE=T,t.readFloat64BE=R,t.readFloat64LE=C,t.writeFloat32BE=P,t.writeFloat32LE=N,t.writeFloat64BE=O,t.writeFloat64LE=D},3038:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2267),s=n(5279),i=20;function o(e,t,n){for(var s=1634760805,o=857760878,a=2036477234,c=1797285236,l=n[3]<<24|n[2]<<16|n[1]<<8|n[0],u=n[7]<<24|n[6]<<16|n[5]<<8|n[4],h=n[11]<<24|n[10]<<16|n[9]<<8|n[8],d=n[15]<<24|n[14]<<16|n[13]<<8|n[12],f=n[19]<<24|n[18]<<16|n[17]<<8|n[16],p=n[23]<<24|n[22]<<16|n[21]<<8|n[20],g=n[27]<<24|n[26]<<16|n[25]<<8|n[24],y=n[31]<<24|n[30]<<16|n[29]<<8|n[28],m=t[3]<<24|t[2]<<16|t[1]<<8|t[0],w=t[7]<<24|t[6]<<16|t[5]<<8|t[4],b=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],_=s,E=o,S=a,k=c,I=l,A=u,T=h,R=d,C=f,P=p,N=g,O=y,D=m,L=w,x=b,B=v,M=0;M<i;M+=2)_=_+I|0,D^=_,D=D>>>16|D<<16,C=C+D|0,I^=C,I=I>>>20|I<<12,E=E+A|0,L^=E,L=L>>>16|L<<16,P=P+L|0,A^=P,A=A>>>20|A<<12,S=S+T|0,x^=S,x=x>>>16|x<<16,N=N+x|0,T^=N,T=T>>>20|T<<12,k=k+R|0,B^=k,B=B>>>16|B<<16,O=O+B|0,R^=O,R=R>>>20|R<<12,S=S+T|0,x^=S,x=x>>>24|x<<8,N=N+x|0,T^=N,T=T>>>25|T<<7,k=k+R|0,B^=k,B=B>>>24|B<<8,O=O+B|0,R^=O,R=R>>>25|R<<7,E=E+A|0,L^=E,L=L>>>24|L<<8,P=P+L|0,A^=P,A=A>>>25|A<<7,_=_+I|0,D^=_,D=D>>>24|D<<8,C=C+D|0,I^=C,I=I>>>25|I<<7,_=_+A|0,B^=_,B=B>>>16|B<<16,N=N+B|0,A^=N,A=A>>>20|A<<12,E=E+T|0,D^=E,D=D>>>16|D<<16,O=O+D|0,T^=O,T=T>>>20|T<<12,S=S+R|0,L^=S,L=L>>>16|L<<16,C=C+L|0,R^=C,R=R>>>20|R<<12,k=k+I|0,x^=k,x=x>>>16|x<<16,P=P+x|0,I^=P,I=I>>>20|I<<12,S=S+R|0,L^=S,L=L>>>24|L<<8,C=C+L|0,R^=C,R=R>>>25|R<<7,k=k+I|0,x^=k,x=x>>>24|x<<8,P=P+x|0,I^=P,I=I>>>25|I<<7,E=E+T|0,D^=E,D=D>>>24|D<<8,O=O+D|0,T^=O,T=T>>>25|T<<7,_=_+A|0,B^=_,B=B>>>24|B<<8,N=N+B|0,A^=N,A=A>>>25|A<<7;r.writeUint32LE(_+s|0,e,0),r.writeUint32LE(E+o|0,e,4),r.writeUint32LE(S+a|0,e,8),r.writeUint32LE(k+c|0,e,12),r.writeUint32LE(I+l|0,e,16),r.writeUint32LE(A+u|0,e,20),r.writeUint32LE(T+h|0,e,24),r.writeUint32LE(R+d|0,e,28),r.writeUint32LE(C+f|0,e,32),r.writeUint32LE(P+p|0,e,36),r.writeUint32LE(N+g|0,e,40),r.writeUint32LE(O+y|0,e,44),r.writeUint32LE(D+m|0,e,48),r.writeUint32LE(L+w|0,e,52),r.writeUint32LE(x+b|0,e,56),r.writeUint32LE(B+v|0,e,60)}function a(e,t,n,r,i){if(void 0===i&&(i=0),32!==e.length)throw new Error("ChaCha: key size must be 32 bytes");if(r.length<n.length)throw new Error("ChaCha: destination is shorter than source");var a,c;if(0===i){if(8!==t.length&&12!==t.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),c=a.length-t.length,a.set(t,c)}else{if(16!==t.length)throw new Error("ChaCha nonce with counter must be 16 bytes");a=t,c=i}for(var u=new Uint8Array(64),h=0;h<n.length;h+=64){o(u,a,e);for(var d=h;d<h+64&&d<n.length;d++)r[d]=n[d]^u[d-h];l(a,0,c)}return s.wipe(u),0===i&&s.wipe(a),r}function c(e,t,n,r){return void 0===r&&(r=0),s.wipe(n),a(e,t,n,n,r)}function l(e,t,n){var r=1;while(n--)r=r+(255&e[t])|0,e[t]=255&r,r>>>=8,t++;if(r>0)throw new Error("ChaCha: counter overflow")}t.streamXOR=a,t.stream=c},2130:function(e,t,n){"use strict";var r=n(3038),s=n(5910),i=n(5279),o=n(2267),a=n(4501);t.Cv=32,t.WH=12,t.pg=16;var c=new Uint8Array(16),l=function(){function e(e){if(this.nonceLength=t.WH,this.tagLength=t.pg,e.length!==t.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,n,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var a=new Uint8Array(32);r.stream(this._key,o,a,4);var c,l=t.length+this.tagLength;if(s){if(s.length!==l)throw new Error("ChaCha20Poly1305: incorrect destination length");c=s}else c=new Uint8Array(l);return r.streamXOR(this._key,o,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),n),i.wipe(o),c},e.prototype.open=function(e,t,n,s){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var o=new Uint8Array(16);o.set(e,o.length-e.length);var c=new Uint8Array(32);r.stream(this._key,o,c,4);var l=new Uint8Array(this.tagLength);if(this._authenticate(l,c,t.subarray(0,t.length-this.tagLength),n),!a.equal(l,t.subarray(t.length-this.tagLength,t.length)))return null;var u,h=t.length-this.tagLength;if(s){if(s.length!==h)throw new Error("ChaCha20Poly1305: incorrect destination length");u=s}else u=new Uint8Array(h);return r.streamXOR(this._key,o,t.subarray(0,t.length-this.tagLength),u,4),i.wipe(o),u},e.prototype.clean=function(){return i.wipe(this._key),this},e.prototype._authenticate=function(e,t,n,r){var a=new s.Poly1305(t);r&&(a.update(r),r.length%16>0&&a.update(c.subarray(r.length%16))),a.update(n),n.length%16>0&&a.update(c.subarray(n.length%16));var l=new Uint8Array(8);r&&o.writeUint64LE(r.length,l),a.update(l),o.writeUint64LE(n.length,l),a.update(l);for(var u=a.digest(),h=0;h<u.length;h++)e[h]=u[h];a.clean(),i.wipe(u),i.wipe(l)},e}();t.OK=l},4501:function(e,t){"use strict";function n(e,t,n){return~(e-1)&t|e-1&n}function r(e,t){return(0|e)-(0|t)-1>>>31&1}function s(e,t){if(e.length!==t.length)return 0;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 1&n-1>>>8}function i(e,t){return 0!==e.length&&0!==t.length&&0!==s(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.select=n,t.lessOrEqual=r,t.compare=s,t.equal=i},2270:function(e,t){"use strict";function n(e){return"undefined"!==typeof e.saveState&&"undefined"!==typeof e.restoreState&&"undefined"!==typeof e.cleanSavedState}Object.defineProperty(t,"__esModule",{value:!0}),t.isSerializableHash=n},6711:function(e,t,n){"use strict";var r=n(6702),s=n(5279),i=function(){function e(e,t,n,s){void 0===n&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=s;var i=r.hmac(this._hash,n,t);this._hmac=new r.HMAC(e,i),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(e){for(var t=new Uint8Array(e),n=0;n<t.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[n]=this._buffer[this._bufpos++];return t},e.prototype.clean=function(){this._hmac.clean(),s.wipe(this._buffer),s.wipe(this._counter),this._bufpos=0},e}();t.t=i},6702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2270),s=n(4501),i=n(5279),o=function(){function e(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(n).clean():n.set(t);for(var s=0;s<n.length;s++)n[s]^=54;this._inner.update(n);for(s=0;s<n.length;s++)n[s]^=106;this._outer.update(n),r.isSerializableHash(this._inner)&&r.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),i.wipe(n)}return e.prototype.reset=function(){if(!r.isSerializableHash(this._inner)||!r.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){r.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),r.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(e){return this._inner.update(e),this},e.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(!r.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(e){if(!r.isSerializableHash(this._inner)||!r.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(e){if(!r.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},e}();function a(e,t,n){var r=new o(e,t);r.update(n);var s=r.digest();return r.clean(),s}t.HMAC=o,t.hmac=a,t.equal=s.equal},9763:function(e,t){"use strict";function n(e,t){var n=e>>>16&65535,r=65535&e,s=t>>>16&65535,i=65535&t;return r*i+(n*i+r*s<<16>>>0)|0}function r(e,t){return e+t|0}function s(e,t){return e-t|0}function i(e,t){return e<<t|e>>>32-t}function o(e,t){return e<<32-t|e>>>t}function a(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e}Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||n,t.add=r,t.sub=s,t.rotl=i,t.rotr=o,t.isInteger=Number.isInteger||a,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},5910:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4501),s=n(5279);t.DIGEST_LENGTH=16;var i=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var n=e[0]|e[1]<<8;this._r[0]=8191&n;var r=e[2]|e[3]<<8;this._r[1]=8191&(n>>>13|r<<3);var s=e[4]|e[5]<<8;this._r[2]=7939&(r>>>10|s<<6);var i=e[6]|e[7]<<8;this._r[3]=8191&(s>>>7|i<<9);var o=e[8]|e[9]<<8;this._r[4]=255&(i>>>4|o<<12),this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=8191&(o>>>14|a<<2);var c=e[12]|e[13]<<8;this._r[7]=8065&(a>>>11|c<<5);var l=e[14]|e[15]<<8;this._r[8]=8191&(c>>>8|l<<8),this._r[9]=l>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,n){var r=this._fin?0:2048,s=this._h[0],i=this._h[1],o=this._h[2],a=this._h[3],c=this._h[4],l=this._h[5],u=this._h[6],h=this._h[7],d=this._h[8],f=this._h[9],p=this._r[0],g=this._r[1],y=this._r[2],m=this._r[3],w=this._r[4],b=this._r[5],v=this._r[6],_=this._r[7],E=this._r[8],S=this._r[9];while(n>=16){var k=e[t+0]|e[t+1]<<8;s+=8191&k;var I=e[t+2]|e[t+3]<<8;i+=8191&(k>>>13|I<<3);var A=e[t+4]|e[t+5]<<8;o+=8191&(I>>>10|A<<6);var T=e[t+6]|e[t+7]<<8;a+=8191&(A>>>7|T<<9);var R=e[t+8]|e[t+9]<<8;c+=8191&(T>>>4|R<<12),l+=R>>>1&8191;var C=e[t+10]|e[t+11]<<8;u+=8191&(R>>>14|C<<2);var P=e[t+12]|e[t+13]<<8;h+=8191&(C>>>11|P<<5);var N=e[t+14]|e[t+15]<<8;d+=8191&(P>>>8|N<<8),f+=N>>>5|r;var O=0,D=O;D+=s*p,D+=i*(5*S),D+=o*(5*E),D+=a*(5*_),D+=c*(5*v),O=D>>>13,D&=8191,D+=l*(5*b),D+=u*(5*w),D+=h*(5*m),D+=d*(5*y),D+=f*(5*g),O+=D>>>13,D&=8191;var L=O;L+=s*g,L+=i*p,L+=o*(5*S),L+=a*(5*E),L+=c*(5*_),O=L>>>13,L&=8191,L+=l*(5*v),L+=u*(5*b),L+=h*(5*w),L+=d*(5*m),L+=f*(5*y),O+=L>>>13,L&=8191;var x=O;x+=s*y,x+=i*g,x+=o*p,x+=a*(5*S),x+=c*(5*E),O=x>>>13,x&=8191,x+=l*(5*_),x+=u*(5*v),x+=h*(5*b),x+=d*(5*w),x+=f*(5*m),O+=x>>>13,x&=8191;var B=O;B+=s*m,B+=i*y,B+=o*g,B+=a*p,B+=c*(5*S),O=B>>>13,B&=8191,B+=l*(5*E),B+=u*(5*_),B+=h*(5*v),B+=d*(5*b),B+=f*(5*w),O+=B>>>13,B&=8191;var M=O;M+=s*w,M+=i*m,M+=o*y,M+=a*g,M+=c*p,O=M>>>13,M&=8191,M+=l*(5*S),M+=u*(5*E),M+=h*(5*_),M+=d*(5*v),M+=f*(5*b),O+=M>>>13,M&=8191;var U=O;U+=s*b,U+=i*w,U+=o*m,U+=a*y,U+=c*g,O=U>>>13,U&=8191,U+=l*p,U+=u*(5*S),U+=h*(5*E),U+=d*(5*_),U+=f*(5*v),O+=U>>>13,U&=8191;var F=O;F+=s*v,F+=i*b,F+=o*w,F+=a*m,F+=c*y,O=F>>>13,F&=8191,F+=l*g,F+=u*p,F+=h*(5*S),F+=d*(5*E),F+=f*(5*_),O+=F>>>13,F&=8191;var j=O;j+=s*_,j+=i*v,j+=o*b,j+=a*w,j+=c*m,O=j>>>13,j&=8191,j+=l*y,j+=u*g,j+=h*p,j+=d*(5*S),j+=f*(5*E),O+=j>>>13,j&=8191;var V=O;V+=s*E,V+=i*_,V+=o*v,V+=a*b,V+=c*w,O=V>>>13,V&=8191,V+=l*m,V+=u*y,V+=h*g,V+=d*p,V+=f*(5*S),O+=V>>>13,V&=8191;var z=O;z+=s*S,z+=i*E,z+=o*_,z+=a*v,z+=c*b,O=z>>>13,z&=8191,z+=l*w,z+=u*m,z+=h*y,z+=d*g,z+=f*p,O+=z>>>13,z&=8191,O=(O<<2)+O|0,O=O+D|0,D=8191&O,O>>>=13,L+=O,s=D,i=L,o=x,a=B,c=M,l=U,u=F,h=j,d=V,f=z,t+=16,n-=16}this._h[0]=s,this._h[1]=i,this._h[2]=o,this._h[3]=a,this._h[4]=c,this._h[5]=l,this._h[6]=u,this._h[7]=h,this._h[8]=d,this._h[9]=f},e.prototype.finish=function(e,t){void 0===t&&(t=0);var n,r,s,i,o=new Uint16Array(10);if(this._leftover){for(i=this._leftover,this._buffer[i++]=1;i<16;i++)this._buffer[i]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,i=2;i<10;i++)this._h[i]+=n,n=this._h[i]>>>13,this._h[i]&=8191;for(this._h[0]+=5*n,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,o[0]=this._h[0]+5,n=o[0]>>>13,o[0]&=8191,i=1;i<10;i++)o[i]=this._h[i]+n,n=o[i]>>>13,o[i]&=8191;for(o[9]-=8192,r=(1^n)-1,i=0;i<10;i++)o[i]&=r;for(r=~r,i=0;i<10;i++)this._h[i]=this._h[i]&r|o[i];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),s=this._h[0]+this._pad[0],this._h[0]=65535&s,i=1;i<8;i++)s=(this._h[i]+this._pad[i]|0)+(s>>>16)|0,this._h[i]=65535&s;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,n=0,r=e.length;if(this._leftover){t=16-this._leftover,t>r&&(t=r);for(var s=0;s<t;s++)this._buffer[this._leftover+s]=e[n+s];if(r-=t,n+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(r>=16&&(t=r-r%16,this._blocks(e,n,t),n+=t,r-=t),r){for(s=0;s<r;s++)this._buffer[this._leftover+s]=e[n+s];this._leftover+=r}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return s.wipe(this._buffer),s.wipe(this._r),s.wipe(this._h),s.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();function o(e,t){var n=new i(e);n.update(t);var r=n.digest();return n.clean(),r}function a(e,n){return e.length===t.DIGEST_LENGTH&&n.length===t.DIGEST_LENGTH&&r.equal(e,n)}t.Poly1305=i,t.oneTimeAuth=o,t.equal=a},1257:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const r=n(1299),s=n(2267),i=n(5279);function o(e,n=t.defaultRandomSource){return n.randomBytes(e)}function a(e=t.defaultRandomSource){const n=o(4,e),r=(0,s.readUint32LE)(n);return(0,i.wipe)(n),r}t.defaultRandomSource=new r.SystemRandomSource,t.randomBytes=o,t.randomUint32=a;const c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(e,n=c,r=t.defaultRandomSource){if(n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");let s="";const a=n.length,l=256-256%a;while(e>0){const t=o(Math.ceil(256*e/l),r);for(let r=0;r<t.length&&e>0;r++){const i=t[r];i<l&&(s+=n.charAt(i%a),e--)}(0,i.wipe)(t)}return s}function u(e,n=c,r=t.defaultRandomSource){const s=Math.ceil(e/(Math.log(n.length)/Math.LN2));return l(s,n,r)}t.randomString=l,t.randomStringForEntropy=u},169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrowserRandomSource=void 0;const n=65536;class r{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e="undefined"!==typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let r=0;r<t.length;r+=n)this._crypto.getRandomValues(t.subarray(r,r+Math.min(t.length-r,n)));return t}}t.BrowserRandomSource=r},9378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeRandomSource=void 0;const r=n(5279);class s{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{const e=n(5883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let r=0;r<n.length;r++)n[r]=t[r];return(0,r.wipe)(t),n}}t.NodeRandomSource=s},1299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SystemRandomSource=void 0;const r=n(169),s=n(9378);class i{constructor(){return this.isAvailable=!1,this.name="",this._source=new r.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new s.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}t.SystemRandomSource=i},4185:function(e,t,n){"use strict";var r=n(2267),s=n(5279);t.k=32,t.cn=64;var i=function(){function e(){this.digestLength=t.k,this.blockSize=t.cn,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){s.wipe(this._buffer),s.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=t,this._bufferLength>0){while(this._bufferLength<this.blockSize&&t>0)this._buffer[this._bufferLength++]=e[n++],t--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}t>=this.blockSize&&(n=a(this._temp,this._state,e,n,t),t%=this.blockSize);while(t>0)this._buffer[this._bufferLength++]=e[n++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,n=this._bufferLength,s=t/536870912|0,i=t<<3,o=t%64<56?64:128;this._buffer[n]=128;for(var c=n+1;c<o-8;c++)this._buffer[c]=0;r.writeUint32BE(s,this._buffer,o-8),r.writeUint32BE(i,this._buffer,o-4),a(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(c=0;c<this.digestLength/4;c++)r.writeUint32BE(this._state[c],e,4*c);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){s.wipe(e.state),e.buffer&&s.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.mE=i;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(e,t,n,s,i){while(i>=64){for(var a=t[0],c=t[1],l=t[2],u=t[3],h=t[4],d=t[5],f=t[6],p=t[7],g=0;g<16;g++){var y=s+4*g;e[g]=r.readUint32BE(n,y)}for(g=16;g<64;g++){var m=e[g-2],w=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10;m=e[g-15];var b=(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3;e[g]=(w+e[g-7]|0)+(b+e[g-16]|0)}for(g=0;g<64;g++){w=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&d^~h&f)|0)+(p+(o[g]+e[g]|0)|0)|0,b=((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+(a&c^a&l^c&l)|0;p=f,f=d,d=h,h=u+w|0,u=l,l=c,c=a,a=w+b|0}t[0]+=a,t[1]+=c,t[2]+=l,t[3]+=u,t[4]+=h,t[5]+=d,t[6]+=f,t[7]+=p,s+=64,i-=64}return s}function c(e){var t=new i;t.update(e);var n=t.digest();return t.clean(),n}t.vp=c},5279:function(e,t){"use strict";function n(e){for(var t=0;t<e.length;t++)e[t]=0;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=n},2982:function(e,t,n){"use strict";t.gi=t.Au=t._w=t.KS=t.kz=void 0;const r=n(1257),s=n(5279);function i(e){const t=new Float64Array(16);if(e)for(let n=0;n<e.length;n++)t[n]=e[n];return t}t.kz=32,t.KS=32;const o=new Uint8Array(32);o[0]=9;const a=i([56129,1]);function c(e){let t=1;for(let n=0;n<16;n++){let r=e[n]+t+65535;t=Math.floor(r/65536),e[n]=r-65536*t}e[0]+=t-1+37*(t-1)}function l(e,t,n){const r=~(n-1);for(let s=0;s<16;s++){const n=r&(e[s]^t[s]);e[s]^=n,t[s]^=n}}function u(e,t){const n=i(),r=i();for(let s=0;s<16;s++)r[s]=t[s];c(r),c(r),c(r);for(let s=0;s<2;s++){n[0]=r[0]-65517;for(let t=1;t<15;t++)n[t]=r[t]-65535-(n[t-1]>>16&1),n[t-1]&=65535;n[15]=r[15]-32767-(n[14]>>16&1);const e=n[15]>>16&1;n[14]&=65535,l(r,n,1-e)}for(let s=0;s<16;s++)e[2*s]=255&r[s],e[2*s+1]=r[s]>>8}function h(e,t){for(let n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function d(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]+n[r]}function f(e,t,n){for(let r=0;r<16;r++)e[r]=t[r]-n[r]}function p(e,t,n){let r,s,i=0,o=0,a=0,c=0,l=0,u=0,h=0,d=0,f=0,p=0,g=0,y=0,m=0,w=0,b=0,v=0,_=0,E=0,S=0,k=0,I=0,A=0,T=0,R=0,C=0,P=0,N=0,O=0,D=0,L=0,x=0,B=n[0],M=n[1],U=n[2],F=n[3],j=n[4],V=n[5],z=n[6],$=n[7],K=n[8],H=n[9],q=n[10],W=n[11],G=n[12],Y=n[13],Q=n[14],X=n[15];r=t[0],i+=r*B,o+=r*M,a+=r*U,c+=r*F,l+=r*j,u+=r*V,h+=r*z,d+=r*$,f+=r*K,p+=r*H,g+=r*q,y+=r*W,m+=r*G,w+=r*Y,b+=r*Q,v+=r*X,r=t[1],o+=r*B,a+=r*M,c+=r*U,l+=r*F,u+=r*j,h+=r*V,d+=r*z,f+=r*$,p+=r*K,g+=r*H,y+=r*q,m+=r*W,w+=r*G,b+=r*Y,v+=r*Q,_+=r*X,r=t[2],a+=r*B,c+=r*M,l+=r*U,u+=r*F,h+=r*j,d+=r*V,f+=r*z,p+=r*$,g+=r*K,y+=r*H,m+=r*q,w+=r*W,b+=r*G,v+=r*Y,_+=r*Q,E+=r*X,r=t[3],c+=r*B,l+=r*M,u+=r*U,h+=r*F,d+=r*j,f+=r*V,p+=r*z,g+=r*$,y+=r*K,m+=r*H,w+=r*q,b+=r*W,v+=r*G,_+=r*Y,E+=r*Q,S+=r*X,r=t[4],l+=r*B,u+=r*M,h+=r*U,d+=r*F,f+=r*j,p+=r*V,g+=r*z,y+=r*$,m+=r*K,w+=r*H,b+=r*q,v+=r*W,_+=r*G,E+=r*Y,S+=r*Q,k+=r*X,r=t[5],u+=r*B,h+=r*M,d+=r*U,f+=r*F,p+=r*j,g+=r*V,y+=r*z,m+=r*$,w+=r*K,b+=r*H,v+=r*q,_+=r*W,E+=r*G,S+=r*Y,k+=r*Q,I+=r*X,r=t[6],h+=r*B,d+=r*M,f+=r*U,p+=r*F,g+=r*j,y+=r*V,m+=r*z,w+=r*$,b+=r*K,v+=r*H,_+=r*q,E+=r*W,S+=r*G,k+=r*Y,I+=r*Q,A+=r*X,r=t[7],d+=r*B,f+=r*M,p+=r*U,g+=r*F,y+=r*j,m+=r*V,w+=r*z,b+=r*$,v+=r*K,_+=r*H,E+=r*q,S+=r*W,k+=r*G,I+=r*Y,A+=r*Q,T+=r*X,r=t[8],f+=r*B,p+=r*M,g+=r*U,y+=r*F,m+=r*j,w+=r*V,b+=r*z,v+=r*$,_+=r*K,E+=r*H,S+=r*q,k+=r*W,I+=r*G,A+=r*Y,T+=r*Q,R+=r*X,r=t[9],p+=r*B,g+=r*M,y+=r*U,m+=r*F,w+=r*j,b+=r*V,v+=r*z,_+=r*$,E+=r*K,S+=r*H,k+=r*q,I+=r*W,A+=r*G,T+=r*Y,R+=r*Q,C+=r*X,r=t[10],g+=r*B,y+=r*M,m+=r*U,w+=r*F,b+=r*j,v+=r*V,_+=r*z,E+=r*$,S+=r*K,k+=r*H,I+=r*q,A+=r*W,T+=r*G,R+=r*Y,C+=r*Q,P+=r*X,r=t[11],y+=r*B,m+=r*M,w+=r*U,b+=r*F,v+=r*j,_+=r*V,E+=r*z,S+=r*$,k+=r*K,I+=r*H,A+=r*q,T+=r*W,R+=r*G,C+=r*Y,P+=r*Q,N+=r*X,r=t[12],m+=r*B,w+=r*M,b+=r*U,v+=r*F,_+=r*j,E+=r*V,S+=r*z,k+=r*$,I+=r*K,A+=r*H,T+=r*q,R+=r*W,C+=r*G,P+=r*Y,N+=r*Q,O+=r*X,r=t[13],w+=r*B,b+=r*M,v+=r*U,_+=r*F,E+=r*j,S+=r*V,k+=r*z,I+=r*$,A+=r*K,T+=r*H,R+=r*q,C+=r*W,P+=r*G,N+=r*Y,O+=r*Q,D+=r*X,r=t[14],b+=r*B,v+=r*M,_+=r*U,E+=r*F,S+=r*j,k+=r*V,I+=r*z,A+=r*$,T+=r*K,R+=r*H,C+=r*q,P+=r*W,N+=r*G,O+=r*Y,D+=r*Q,L+=r*X,r=t[15],v+=r*B,_+=r*M,E+=r*U,S+=r*F,k+=r*j,I+=r*V,A+=r*z,T+=r*$,R+=r*K,C+=r*H,P+=r*q,N+=r*W,O+=r*G,D+=r*Y,L+=r*Q,x+=r*X,i+=38*_,o+=38*E,a+=38*S,c+=38*k,l+=38*I,u+=38*A,h+=38*T,d+=38*R,f+=38*C,p+=38*P,g+=38*N,y+=38*O,m+=38*D,w+=38*L,b+=38*x,s=1,r=i+s+65535,s=Math.floor(r/65536),i=r-65536*s,r=o+s+65535,s=Math.floor(r/65536),o=r-65536*s,r=a+s+65535,s=Math.floor(r/65536),a=r-65536*s,r=c+s+65535,s=Math.floor(r/65536),c=r-65536*s,r=l+s+65535,s=Math.floor(r/65536),l=r-65536*s,r=u+s+65535,s=Math.floor(r/65536),u=r-65536*s,r=h+s+65535,s=Math.floor(r/65536),h=r-65536*s,r=d+s+65535,s=Math.floor(r/65536),d=r-65536*s,r=f+s+65535,s=Math.floor(r/65536),f=r-65536*s,r=p+s+65535,s=Math.floor(r/65536),p=r-65536*s,r=g+s+65535,s=Math.floor(r/65536),g=r-65536*s,r=y+s+65535,s=Math.floor(r/65536),y=r-65536*s,r=m+s+65535,s=Math.floor(r/65536),m=r-65536*s,r=w+s+65535,s=Math.floor(r/65536),w=r-65536*s,r=b+s+65535,s=Math.floor(r/65536),b=r-65536*s,r=v+s+65535,s=Math.floor(r/65536),v=r-65536*s,i+=s-1+37*(s-1),s=1,r=i+s+65535,s=Math.floor(r/65536),i=r-65536*s,r=o+s+65535,s=Math.floor(r/65536),o=r-65536*s,r=a+s+65535,s=Math.floor(r/65536),a=r-65536*s,r=c+s+65535,s=Math.floor(r/65536),c=r-65536*s,r=l+s+65535,s=Math.floor(r/65536),l=r-65536*s,r=u+s+65535,s=Math.floor(r/65536),u=r-65536*s,r=h+s+65535,s=Math.floor(r/65536),h=r-65536*s,r=d+s+65535,s=Math.floor(r/65536),d=r-65536*s,r=f+s+65535,s=Math.floor(r/65536),f=r-65536*s,r=p+s+65535,s=Math.floor(r/65536),p=r-65536*s,r=g+s+65535,s=Math.floor(r/65536),g=r-65536*s,r=y+s+65535,s=Math.floor(r/65536),y=r-65536*s,r=m+s+65535,s=Math.floor(r/65536),m=r-65536*s,r=w+s+65535,s=Math.floor(r/65536),w=r-65536*s,r=b+s+65535,s=Math.floor(r/65536),b=r-65536*s,r=v+s+65535,s=Math.floor(r/65536),v=r-65536*s,i+=s-1+37*(s-1),e[0]=i,e[1]=o,e[2]=a,e[3]=c,e[4]=l,e[5]=u,e[6]=h,e[7]=d,e[8]=f,e[9]=p,e[10]=g,e[11]=y,e[12]=m,e[13]=w,e[14]=b,e[15]=v}function g(e,t){p(e,t,t)}function y(e,t){const n=i();for(let r=0;r<16;r++)n[r]=t[r];for(let r=253;r>=0;r--)g(n,n),2!==r&&4!==r&&p(n,n,t);for(let r=0;r<16;r++)e[r]=n[r]}function m(e,t){const n=new Uint8Array(32),r=new Float64Array(80),s=i(),o=i(),c=i(),m=i(),w=i(),b=i();for(let i=0;i<31;i++)n[i]=e[i];n[31]=127&e[31]|64,n[0]&=248,h(r,t);for(let i=0;i<16;i++)o[i]=r[i];s[0]=m[0]=1;for(let i=254;i>=0;--i){const e=n[i>>>3]>>>(7&i)&1;l(s,o,e),l(c,m,e),d(w,s,c),f(s,s,c),d(c,o,m),f(o,o,m),g(m,w),g(b,s),p(s,c,s),p(c,o,w),d(w,s,c),f(s,s,c),g(o,s),f(c,m,b),p(s,c,a),d(s,s,m),p(c,c,s),p(s,m,b),p(m,o,r),g(o,w),l(s,o,e),l(c,m,e)}for(let i=0;i<16;i++)r[i+16]=s[i],r[i+32]=c[i],r[i+48]=o[i],r[i+64]=m[i];const v=r.subarray(32),_=r.subarray(16);y(v,v),p(_,_,v);const E=new Uint8Array(32);return u(E,_),E}function w(e){return m(e,o)}function b(e){if(e.length!==t.KS)throw new Error(`x25519: seed must be ${t.KS} bytes`);const n=new Uint8Array(e),r=w(n);return{publicKey:r,secretKey:n}}function v(e){const t=(0,r.randomBytes)(32,e),n=b(t);return(0,s.wipe)(t),n}function _(e,n,r=!1){if(e.length!==t.kz)throw new Error("X25519: incorrect secret key length");if(n.length!==t.kz)throw new Error("X25519: incorrect public key length");const s=m(e,n);if(r){let e=0;for(let t=0;t<s.length;t++)e|=s[t];if(0===e)throw new Error("X25519: invalid shared key")}return s}t._w=b,t.Au=v,t.gi=_},1346:function(e,t,n){"use strict";n.d(t,{QB:function(){return W},ms:function(){return ke},wI:function(){return Te}});var r={};n.r(r),n.d(r,{$reactive:function(){return R},$reactiveproxy:function(){return C},$skipreactive:function(){return T},Atom:function(){return F},Observer:function(){return h},Reaction:function(){return f},autorun:function(){return M},autorunAsync:function(){return U},createAtom:function(){return j},hasRunningReaction:function(){return p},isActionRunning:function(){return l},isReactive:function(){return P},isTrackingDisabled:function(){return w},markRaw:function(){return N},reaction:function(){return y},reactive:function(){return L},runInAction:function(){return u},runningReaction:function(){return g},untracked:function(){return b},untrackedCB:function(){return v}});n(541),n(7658);function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var c=0;function l(){return c>0}function u(e){c++;try{return e()}finally{c--,0===c&&E()}}var h=function(){function e(e){this.trigger=e,this.observing=new Map}var t=e.prototype;return t.registerConnection=function(e){var t=this.observing.get(e.observable);t||(t={byKey:new Set,iterate:!1},this.observing.set(e.observable,t)),"iterate"===e.type?t.iterate=!0:t.byKey.add(e.key)},t.removeObservers=function(){var e=this;this.observing.forEach((function(t,n){t.iterate&&n[R].connections.iterate.delete(e),t.byKey.forEach((function(t){n[R].connections.byKey.get(t).delete(e)}))})),this.observing.clear()},e}(),d=[],f=function(e){function t(t,n,r){var s;if(s=e.call(this,(function(){return s._trigger()}))||this,s.func=t,s.options=n,s.effect=r,s.isInitial=!0,s.reaction=function(){d.push(a(s));try{s.func()}finally{d.pop()}!s.effect||s.isInitial&&!s.options.fireImmediately||s.effect(),s.isInitial=!1},!r&&!s.options.fireImmediately)throw new Error("if no effect function passed, should always fireImmediately");return s.reaction(),s}i(t,e);var n=t.prototype;return n._trigger=function(){if(d.includes(this))throw new Error("already running reaction");this.removeObservers(),this.reaction()},t}(h);function p(){return!!d.length}function g(){return d.length?d[d.length-1]:void 0}function y(e,t,n){var r=s({name:"unnamed",fireImmediately:!0},n),i=new f(e,r,t);return i}var m=!1;function w(){return m}function b(e){m=!0;try{e()}finally{m=!1}}function v(e){return function(){return b(e)}}var _=[];function E(){var e=[].concat(_);_=[],S(e)}function S(e){var t=new Set;e.forEach((function(e){var n;"add"!==e.type&&"delete"!==e.type||e.observable[R].connections.iterate.forEach((function(e){t.add(e)})),null==(n=e.observable[R].connections.byKey.get(e.key))||n.forEach((function(e){t.add(e)}))})),t.forEach((function(e){e.trigger()}))}function k(e){l()?_.push(e):S([e])}function I(e,t){if("iterate"===e.type)e.observable[R].connections.iterate.add(t);else{var n=e.observable[R].connections.byKey.get(e.key);n||(n=new Set,e.observable[R].connections.byKey.set(e.key,n)),n.add(t)}}function A(e,t){if(!w()){var n=g();n&&(I(e,n),n.registerConnection(e)),t&&(I(e,t),t.registerConnection(e))}}var T=Symbol("$skipreactive"),R=Symbol("$reactive"),C=Symbol("$reactiveproxy");function P(e,t){return!(!e||!e[C]||e[C].implicitObserver!==t)}function N(e){return e[T]=!0,e}function O(e){return!(!e||P(e)||!e[R])}function D(e,t,n){if(void 0===n&&(n=!1),e[T])return e;if(P(e,t))return e;var r=x(e,n);if(!t)return r;var s=r[R].proxiesWithImplicitObserver.get(t);if(!s){var i={implicitObserver:t};Object.setPrototypeOf(i,B),s=new Proxy(r[R].raw,i),r[R].proxiesWithImplicitObserver.set(t,s)}return s}var L=D;function x(e,t){if(void 0===t&&(t=!1),P(e))return e;if(O(e))return e[R].proxy;if(e[R]||e[C])throw new Error("unexpected");var n={connections:{iterate:new Set,byKey:new Map},proxy:{},raw:e,proxiesWithImplicitObserver:new Map,shallow:t};Object.defineProperty(e,R,{enumerable:!1,writable:!0,configurable:!0,value:n});var r=new Proxy(e,B);return n.proxy=r,r}var B={has:function(e,t){var n=Reflect.has(e,t);return"symbol"===typeof t||A({observable:e,key:t,type:"has"},this.implicitObserver),n},get:function(e,t,n){if(t===C)return{implicitObserver:this.implicitObserver};var r=Reflect.get(e,t,n);if("symbol"===typeof t)return r;if("length"===t&&Array.isArray(e)?A({observable:e,type:"iterate"},this.implicitObserver):A({observable:e,key:t,type:"get"},this.implicitObserver),O(r))return D(r,this.implicitObserver);if(e[R].shallow)return r;if("object"===typeof r&&null!==r&&!P(r,this.implicitObserver)&&!Object.isFrozen(r)){var s=Reflect.getOwnPropertyDescriptor(e,t);if((!s||!1!==s.writable||!1!==s.configurable)&&(p()||this.implicitObserver))return D(r,this.implicitObserver)}return r},ownKeys:function(e){return A({observable:e,type:"iterate"},this.implicitObserver),Reflect.ownKeys(e)},set:function(e,t,n,r){return u((function(){if("symbol"===typeof t)return Reflect.set(e,t,n,r);var s=Object.hasOwnProperty.call(e,t),i=Reflect.get(e,t,r),o=Reflect.set(e,t,n,r);if(s){if(n!==i)if("length"===t&&Array.isArray(e))if(i<n);else for(var a=n+1;a<=i;a++)k({observable:e,key:""+(a-1),oldValue:void 0,type:"delete"});else k({observable:e,key:t,value:n,oldValue:i,type:"update"})}else k({observable:e,key:t,value:n,type:"add"});return o}))},deleteProperty:function(e,t){return u((function(){if("symbol"===typeof t)return Reflect.deleteProperty(e,t);var n=Object.hasOwnProperty.call(e,t),r=Reflect.get(e,t),s=Reflect.deleteProperty(e,t);return n&&k({observable:e,key:t,oldValue:r,type:"delete"}),s}))},preventExtensions:function(e){throw new Error("Dynamic observable objects cannot be frozen")}};function M(e,t){var n=s({name:"unnamed",fireImmediately:!0},t),r=new f(e,n);return r}function U(e,t,n){var r=s({name:"unnamed",fireImmediately:!0},n),i=new f((function(){e(t)}),r);return t=L(t,i),t.bla=4,r.fireImmediately&&i.trigger(),i}var F=function(){function e(){this._observable=L({_key:1})}var t=e.prototype;return t.reportObserved=function(e){return L(this._observable,e)._key},t.reportChanged=function(){this._observable._key++},e}();function j(e,t,n){return new F}var V,z,$=n(2942),K=function(e){return e()};function H(e,t){return z?z(e,t):void K(e)}function q(e,t,n){if(V)return V.apply(null,arguments);throw new Error("observable implementation not provided. Call enableReactiveBindings, enableVueBindings or enableMobxBindings.")}function W(e){V=function(t,n){var r=0,s=e.reactive({data:r}),i={reportObserved:function(){return s.data},reportChanged:function(){s.data=++r}};return n&&n(),i},z=void 0}function G(e){V=function(t,n,r){var s=e.createAtom(t);return n&&n(),s},z=function(t,n){return e.reaction(t,n,{fireImmediately:!1})}}var Y=new WeakSet;function Q(e){if(Y.has(e))return e;var t;Y.add(e);var n=new Map;function r(){if(!t){var n=function(e){(e.changes.added.size||e.changes.deleted.size||e.changes.keys.size||e.changes.delta.length)&&t.reportChanged()};t=q("map",(function(){e.observe(n)}),(function(){e.unobserve(n)}))}t.reportObserved(e._implicitObserver)}function s(t){var r=n.get(t);if(!r){var s=function(e){r.reportChanged()};r=q(t+"",(function(){e.observe(s)}),(function(){e.unobserve(s)})),n.set(t,r)}r.reportObserved(e._implicitObserver)}var i=e.get;function o(t){var n=e[t];e[t]=function(){r();var e=Reflect.apply(n,this,arguments);return e}}function a(t){var n=e,s=Object.getOwnPropertyDescriptor(n,t);if(s||(n=Object.getPrototypeOf(n),s=Object.getOwnPropertyDescriptor(n,t)),s||(n=Object.getPrototypeOf(n),s=Object.getOwnPropertyDescriptor(n,t)),!s)throw new Error("property not found");var i=s.get;s.get=function(){this._disableTracking||r();var e=Reflect.apply(i,this,arguments);return e},Object.defineProperty(e,t,s)}function c(t,n){var r=e,s=Object.getOwnPropertyDescriptor(r,t);if(s||(r=Object.getPrototypeOf(r),s=Object.getOwnPropertyDescriptor(r,t)),s||(r=Object.getPrototypeOf(r),s=Object.getOwnPropertyDescriptor(r,t)),!s)throw new Error("property not found");Object.defineProperty(e,n,s)}e.get=function(e){if("number"!==typeof e)throw new Error("unexpected");s(e);var t=Reflect.apply(i,this,arguments);return t},o("forEach"),o("toJSON"),o("toArray"),o("slice"),o("map"),c("length","lengthUntracked"),a("length");var l=e.push;e.push=function(e){this._disableTracking=!0;var t=l.call(this,e);return this._disableTracking=!1,t};var u=e.slice;return e.slice=function(e,t){this._disableTracking=!0;var n=u.call(this,e,t);return this._disableTracking=!1,n},e}var X=new WeakSet;function J(e){if(X.has(e))return e;var t;function n(){if(!t){var n=Array.from(e.share.keys()),r=function(r){var s=Array.from(e.share.keys());JSON.stringify(n)!==JSON.stringify(s)&&(n=s,t.reportChanged())};t=q("map",(function(){e.on("beforeObserverCalls",r)}),(function(){e.off("beforeObserverCalls",r)}))}t.reportObserved(e._implicitObserver)}X.add(e);var r=e.get;function s(r){var s,i=e[r];e[r]=function(){var r,o=arguments;return n(),s&&s.removeObservers(),s=H((function(){return r=Reflect.apply(i,e,o),r}),(function(){return t.reportChanged()})),r}}return e.get=function(e){if("string"!==typeof e)throw new Error("unexpected");var t=Reflect.apply(r,this,arguments);return ie(t),t},s("toJSON"),Object.defineProperty(e,"keys",{get:function(){return n(),Object.keys(e.share)}}),e}var Z=new WeakSet;function ee(e){if(Z.has(e))return e;var t;Z.add(e);var n=new Map;function r(){if(!t){var n=function(e){(e.changes.added.size||e.changes.deleted.size||e.changes.keys.size||e.changes.delta.length)&&t.reportChanged()};t=q("map",(function(){e.observe(n)}),(function(){e.unobserve(n)}))}t.reportObserved(e._implicitObserver)}function s(t){var r=n.get(t);if(!r){var s=function(e){e.keysChanged.has(t)&&(e.changes.added.size||e.changes.deleted.size||e.changes.keys.size||e.changes.delta.length)&&r.reportChanged()};r=q(t,(function(){e.observe(s)}),(function(){e.unobserve(s)})),n.set(t,r)}r.reportObserved(e._implicitObserver)}var i=e.get;function o(t){var n=e[t];e[t]=function(){r();var e=Reflect.apply(n,this,arguments);return e}}return e.get=function(e){if("string"!==typeof e)throw new Error("unexpected");s(e);var t=Reflect.apply(i,this,arguments);return t},o("values"),o("entries"),o("keys"),o("forEach"),o("toJSON"),e}var te=new WeakSet;function ne(e){if(te.has(e))return e;var t;te.add(e);var n=function(e){t.reportChanged()};function r(n){var r=e[n];e[n]=function(){t.reportObserved(this._implicitObserver);var e=Reflect.apply(r,this,arguments);return e}}return t=q("text",(function(){e.observe(n)}),(function(){e.unobserve(n)})),r("toString"),r("toJSON"),e}var re=new WeakSet;function se(e){if(re.has(e))return e;var t;re.add(e);var n=function(e){(e.changes.added.size||e.changes.deleted.size||e.changes.keys.size||e.changes.delta.length)&&t.reportChanged()};function r(n){var r=e[n];e[n]=function(){t.reportObserved(this._implicitObserver);var e=Reflect.apply(r,this,arguments);return e}}function s(n){var r=e,s=Object.getOwnPropertyDescriptor(r,n);if(s||(r=Object.getPrototypeOf(r),s=Object.getOwnPropertyDescriptor(r,n)),s||(r=Object.getPrototypeOf(r),s=Object.getOwnPropertyDescriptor(r,n)),!s)throw new Error("property not found");var i=s.get;s.get=function(){t.reportObserved(this._implicitObserver);var e=Reflect.apply(i,this,arguments);return e},Object.defineProperty(e,n,s)}return t=q("xml",(function(){e.observe(n)}),(function(){e.unobserve(n)})),r("toString"),r("toDOM"),r("toArray"),r("getAttribute"),s("firstChild"),e}function ie(e){return e instanceof $.eI||e instanceof $.xv?ne(e):e instanceof $.mJ?Q(e):e instanceof $.D5?ee(e):e instanceof $.QW||Object.prototype.hasOwnProperty.call(e,"autoLoad")?J(e):e instanceof $.sI||e instanceof $.lt?se(e):e}function oe(e){e.share.forEach((function(e){e.constructor!==$.QP&&ie(e)}))}function ae(e,t){for(var n=e.length-1;n>=t;n--){var r=e[n];if(!r.deleted){var s;if(r instanceof $.GC)continue;null==(s=r.content)||s.getContent().forEach((function(e){e instanceof $.QP&&ie(e)}))}}}var ce=new WeakSet;function le(e){ce.has(e)||(ce.add(e),ie(e),e.store.clients.forEach((function(e){e&&ae(e,0)})),oe(e),e.on("beforeObserverCalls",(function(t){oe(e),t.afterState.forEach((function(e,n){var r=t.beforeState.get(n)||0;if(r!==e){var s=t.doc.store.clients.get(n);if(!s)return;var i=$.g4(s,r);ae(s,i)}}))})))}var ue=function(e){this.value=void 0,this.value=e};function he(e){return ArrayBuffer.isView(e)?new ue(e):new ue(Object.freeze(e))}function de(e){var t=function(){var t,n=null==(t=this[C])?void 0:t.implicitObserver;e._implicitObserver=n;var r=e.slice.bind(e).apply(e,arguments);return r.map((function(e){var t=we(e,n);return n&&"object"===typeof t?L(t,n):t}))},n=function(e){return e.map((function(e){var t=be(e),n=Ie(t)||t;if(n instanceof ue&&(n=n.value),n instanceof $.QP&&n.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return n}))},r=function(){return[].findIndex.apply(t.apply(this),arguments)},s={slice:t,unshift:function(){return e.unshift(n([].slice.call(arguments))),e.lengthUntracked},push:function(){return e.push(n([].slice.call(arguments))),e.lengthUntracked},insert:e.insert.bind(e),toJSON:e.toJSON.bind(e),forEach:function(){return[].forEach.apply(t.apply(this),arguments)},every:function(){return[].every.apply(t.apply(this),arguments)},filter:function(){return[].filter.apply(t.apply(this),arguments)},find:function(){return[].find.apply(t.apply(this),arguments)},findIndex:r,some:function(){return[].some.apply(t.apply(this),arguments)},includes:function(){return[].includes.apply(t.apply(this),arguments)},map:function(){return[].map.apply(t.apply(this),arguments)},indexOf:function(){var e=arguments[0];return r.call(this,(function(t){return Ae(t,e)}))},splice:function(){var r=arguments[0]<0?e.length-Math.abs(arguments[0]):arguments[0],s=arguments[1],i=Array.from(Array.from(arguments).slice(2)),o=t.apply(this,[r,Number.isInteger(s)?r+s:void 0]);return e.doc?e.doc.transact((function(){e.delete(r,s),e.insert(r,n(i))})):(e.delete(r,s),e.insert(r,n(i))),o}},i=[];for(var o in s)i[o]=s[o];return i}function fe(e){if("string"===typeof e&&e.trim().length){var t=Number(e);if(Number.isInteger(t))return t}return e}function pe(e,t){if(void 0===t&&(t=new $.mJ),t[R])throw new Error("unexpected");var n=de(t),r=new Proxy(n,{set:function(e,t,n){var r=fe(t);if("number"!==typeof r)throw new Error;throw new Error("array assignment is not implemented / supported")},get:function(e,n,r){var s=fe(n);if(s===Se)return t;if("number"===typeof s){var i,o;if(r&&r[C])i=null==(o=r[C])?void 0:o.implicitObserver,t._implicitObserver=i;var a=t.get(s);return a=we(a,i),a}if(s===Symbol.toStringTag)return"Array";if(s===Symbol.iterator){var c=t.slice();return Reflect.get(c,s)}if("length"===s)return t.length;var l=Reflect.get(e,s,r);return l},deleteProperty:function(e,n){var r=fe(n);if("number"!==typeof r)throw new Error;return r<t.lengthUntracked&&r>=0&&(t.delete(r),!0)},has:function(e,n){var r=fe(n);return"number"!==typeof r?Reflect.has(e,r):r<t.lengthUntracked&&r>=0},getOwnPropertyDescriptor:function(e,n){var r=fe(n);return"length"===r?{enumerable:!1,configurable:!1,writable:!0}:"number"===typeof r&&r>=0&&r<t.lengthUntracked?{enumerable:!0,configurable:!0,writable:!0}:void 0},ownKeys:function(e){for(var n=[],r=0;r<t.length;r++)n.push(r+"");return n.push("length"),n}});return n.push.apply(r,e),r}function ge(e,t){if(void 0===t&&(t=new $.D5),t[R])throw new Error("unexpected");var n=new Proxy({},{set:function(e,n,r){if("string"!==typeof n)throw new Error;var s=be(r),i=Ie(s)||s;if(i instanceof ue&&(i=i.value),i instanceof $.QP&&i.parent)throw new Error("Not supported: reassigning object that already occurs in the tree.");return t.set(n,i),!0},get:function(e,n,r){if(n===Se)return t;if("string"!==typeof n)return Reflect.get(e,n);var s,i;r&&r[C]&&(s=null==(i=r[C])?void 0:i.implicitObserver,t._implicitObserver=s);var o=t.get(n);return o=we(o,s),o},deleteProperty:function(e,n){if("string"!==typeof n)throw new Error;return!!t.has(n)&&(t.delete(n),!0)},has:function(e,n){return!("string"!==typeof n||!t.has(n))},getOwnPropertyDescriptor:function(e,n){if("string"===typeof n&&t.has(n))return{enumerable:!0,configurable:!0}},ownKeys:function(e){return Array.from(t.keys())}});for(var r in me.set(t,n),e)n[r]=e[r];return n}function ye(e){return e instanceof $.QP}var me=new WeakMap;function we(e,t){if(ye(e)){if(e._implicitObserver=t,e instanceof $.mJ||e instanceof $.D5){if(!me.has(e)){var n=be(e);me.set(e,n)}e=me.get(e)}else{if(!(e instanceof $.lt||e instanceof $.sI||e instanceof $.eI||e instanceof $.yP||e instanceof $.xv))throw new Error("unknown YType");N(e),e.__v_skip=!0}return e}return null===e?null:"object"===typeof e?he(e):e}function be(e){if(null===e||void 0===e)return e;if(e=Ie(e)||e,e instanceof $.mJ)return pe([],e);if(e instanceof $.D5)return ge({},e);if("string"===typeof e)return e;if(Array.isArray(e))return pe(e);if(e instanceof $.lt||e instanceof $.sI||e instanceof $.eI||e instanceof $.yP)return e;if(e instanceof $.xv)return e;if("object"===typeof e)return e instanceof ue?e:ge(e);if("number"===typeof e||"boolean"===typeof e)return e;throw new Error("invalid")}function ve(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=n[t],s=r[1];if(Array.isArray(s)){if(0!==s.length)throw new Error("Root Array initializer must always be empty array")}else if(s&&"object"===typeof s){if(0!==Object.keys(s).length||Object.getPrototypeOf(s)!==Object.prototype)throw new Error("Root Object initializer must always be {}")}else if("xml"!==s&&"text"!==s)throw new Error("unknown Root initializer")}}function _e(e,t,n){var r=t[n];if(r)return"xml"===r?e.getXmlFragment(n):"text"===r?e.getText(n):Array.isArray(r)?e.getArray(n):e.getMap(n);"__v_raw"!==n&&"__v_isRef"!==n&&"__v_isReadonly"!==n&&console.warn("property not found on root doc",n)}function Ee(e,t){if(e[R])throw new Error("unexpected");ve(t);var n=new Proxy({},{set:function(e,t,n){if("string"!==typeof t)throw new Error;throw new Error("cannot set new elements on root doc")},get:function(n,r,s){if(r===Se)return e;if("string"!==typeof r)return Reflect.get(n,r);var i,o;s&&s[C]&&(i=null==(o=s[C])?void 0:o.implicitObserver,e._implicitObserver=i);if("toJSON"===r){for(var a=0,c=Object.keys(t);a<c.length;a++){var l=c[a];_e(e,t,l)}var u=Reflect.get(e,r);return u}var h=_e(e,t,r);return h=we(h,i),h},deleteProperty:function(e,t){throw new Error("deleteProperty not available for doc")},has:function(t,n){return!("string"!==typeof n||!e.share.has(n))},getOwnPropertyDescriptor:function(t,n){if("string"===typeof n&&e.share.has(n)||"toJSON"===n)return{enumerable:!0,configurable:!0}},ownKeys:function(t){return Array.from(e.share.keys())}});return me.set(e,n),n}G(r);var Se=Symbol("INTERNAL_SYMBOL");function ke(e){var t=Ie(e);if(!(t instanceof $.QW))throw new Error("store is not a valid syncedStore that maps to a Y.Doc");return t}function Ie(e){if("object"===typeof e&&null!==e){var t=e[Se];return t&&(N(t),t.__v_skip=!0),t}}function Ae(e,t){if(e===t)return!0;if("object"===typeof e&&"object"===typeof t){var n=Ie(e),r=Ie(t);return!(!n||!r)&&n===r}return!1}function Te(e,t){return void 0===t&&(t=new $.QW),le(t),Ee(t,e)}},5670:function(e,t){"use strict";const n=Math.exp;e.exports=function(e){if("number"!==typeof e)throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,r,s=0,i=0,o=0,a={};function c(t,r){return 1-n(-(t-r)/e)}return a.push=function(e,n){if(r){const a=c(e,r),l=n-t,u=a*l;t=a*n+(1-a)*t,s=(1-a)*(s+l*u),i=Math.sqrt(s),o=t+a*l}else t=n;r=e},a.movingAverage=function(){return t},a.variance=function(){return s},a.deviation=function(){return i},a.forecast=function(){return o},a}},4870:function(e,t,n){"use strict";n.d(t,{$y:function(){return Le},B:function(){return o},BK:function(){return et},Bj:function(){return i},EB:function(){return l},Fl:function(){return it},IU:function(){return Me},Jd:function(){return R},OT:function(){return Pe},PG:function(){return De},SU:function(){return Ye},Um:function(){return Ce},Vh:function(){return nt},WL:function(){return Xe},X$:function(){return O},X3:function(){return Be},XI:function(){return He},Xl:function(){return Ue},YS:function(){return Ne},ZM:function(){return Ze},cE:function(){return k},dq:function(){return $e},iH:function(){return Ke},j:function(){return P},lk:function(){return C},nZ:function(){return c},oR:function(){return Ge},qj:function(){return Re},qq:function(){return E},sT:function(){return I},yT:function(){return xe}});n(7658);var r=n(7139);let s;class i{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=s,!e&&s&&(this.index=(s.scopes||(s.scopes=[])).push(this)-1)}run(e){if(this.active){const t=s;try{return s=this,e()}finally{s=t}}else 0}on(){s=this}off(){s=this.parent}stop(e){if(this.active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0,this.active=!1}}}function o(e){return new i(e)}function a(e,t=s){t&&t.active&&t.effects.push(e)}function c(){return s}function l(e){s&&s.cleanups.push(e)}const u=e=>{const t=new Set(e);return t.w=0,t.n=0,t},h=e=>(e.w&m)>0,d=e=>(e.n&m)>0,f=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=m},p=e=>{const{deps:t}=e;if(t.length){let n=0;for(let r=0;r<t.length;r++){const s=t[r];h(s)&&!d(s)?s.delete(e):t[n++]=s,s.w&=~m,s.n&=~m}t.length=n}},g=new WeakMap;let y=0,m=1;const w=30;let b;const v=Symbol(""),_=Symbol("");class E{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,a(this,n)}run(){if(!this.active)return this.fn();let e=b,t=A;while(e){if(e===this)return;e=e.parent}try{return this.parent=b,b=this,A=!0,m=1<<++y,y<=w?f(this):S(this),this.fn()}finally{y<=w&&p(this),m=1<<--y,b=this.parent,A=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){b===this?this.deferStop=!0:this.active&&(S(this),this.onStop&&this.onStop(),this.active=!1)}}function S(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}function k(e,t){e.effect&&(e=e.effect.fn);const n=new E(e);t&&((0,r.l7)(n,t),t.scope&&a(n,t.scope)),t&&t.lazy||n.run();const s=n.run.bind(n);return s.effect=n,s}function I(e){e.effect.stop()}let A=!0;const T=[];function R(){T.push(A),A=!1}function C(){const e=T.pop();A=void 0===e||e}function P(e,t,n){if(A&&b){let t=g.get(e);t||g.set(e,t=new Map);let r=t.get(n);r||t.set(n,r=u());const s=void 0;N(r,s)}}function N(e,t){let n=!1;y<=w?d(e)||(e.n|=m,n=!h(e)):n=!e.has(b),n&&(e.add(b),b.deps.push(e))}function O(e,t,n,s,i,o){const a=g.get(e);if(!a)return;let c=[];if("clear"===t)c=[...a.values()];else if("length"===n&&(0,r.kJ)(e)){const e=(0,r.He)(s);a.forEach(((t,n)=>{("length"===n||n>=e)&&c.push(t)}))}else switch(void 0!==n&&c.push(a.get(n)),t){case"add":(0,r.kJ)(e)?(0,r.S0)(n)&&c.push(a.get("length")):(c.push(a.get(v)),(0,r._N)(e)&&c.push(a.get(_)));break;case"delete":(0,r.kJ)(e)||(c.push(a.get(v)),(0,r._N)(e)&&c.push(a.get(_)));break;case"set":(0,r._N)(e)&&c.push(a.get(v));break}if(1===c.length)c[0]&&D(c[0]);else{const e=[];for(const t of c)t&&e.push(...t);D(u(e))}}function D(e,t){const n=(0,r.kJ)(e)?e:[...e];for(const r of n)r.computed&&L(r,t);for(const r of n)r.computed||L(r,t)}function L(e,t){(e!==b||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const x=(0,r.fY)("__proto__,__v_isRef,__isVue"),B=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(r.yk)),M=$(),U=$(!1,!0),F=$(!0),j=$(!0,!0),V=z();function z(){const e={};return["includes","indexOf","lastIndexOf"].forEach((t=>{e[t]=function(...e){const n=Me(this);for(let t=0,s=this.length;t<s;t++)P(n,"get",t+"");const r=n[t](...e);return-1===r||!1===r?n[t](...e.map(Me)):r}})),["push","pop","shift","unshift","splice"].forEach((t=>{e[t]=function(...e){R();const n=Me(this)[t].apply(this,e);return C(),n}})),e}function $(e=!1,t=!1){return function(n,s,i){if("__v_isReactive"===s)return!e;if("__v_isReadonly"===s)return e;if("__v_isShallow"===s)return t;if("__v_raw"===s&&i===(e?t?Ie:ke:t?Se:Ee).get(n))return n;const o=(0,r.kJ)(n);if(!e&&o&&(0,r.RI)(V,s))return Reflect.get(V,s,i);const a=Reflect.get(n,s,i);return((0,r.yk)(s)?B.has(s):x(s))?a:(e||P(n,"get",s),t?a:$e(a)?o&&(0,r.S0)(s)?a:a.value:(0,r.Kn)(a)?e?Pe(a):Re(a):a)}}const K=q(),H=q(!0);function q(e=!1){return function(t,n,s,i){let o=t[n];if(Le(o)&&$e(o)&&!$e(s))return!1;if(!e&&(xe(s)||Le(s)||(o=Me(o),s=Me(s)),!(0,r.kJ)(t)&&$e(o)&&!$e(s)))return o.value=s,!0;const a=(0,r.kJ)(t)&&(0,r.S0)(n)?Number(n)<t.length:(0,r.RI)(t,n),c=Reflect.set(t,n,s,i);return t===Me(i)&&(a?(0,r.aU)(s,o)&&O(t,"set",n,s,o):O(t,"add",n,s)),c}}function W(e,t){const n=(0,r.RI)(e,t),s=e[t],i=Reflect.deleteProperty(e,t);return i&&n&&O(e,"delete",t,void 0,s),i}function G(e,t){const n=Reflect.has(e,t);return(0,r.yk)(t)&&B.has(t)||P(e,"has",t),n}function Y(e){return P(e,"iterate",(0,r.kJ)(e)?"length":v),Reflect.ownKeys(e)}const Q={get:M,set:K,deleteProperty:W,has:G,ownKeys:Y},X={get:F,set(e,t){return!0},deleteProperty(e,t){return!0}},J=(0,r.l7)({},Q,{get:U,set:H}),Z=(0,r.l7)({},X,{get:j}),ee=e=>e,te=e=>Reflect.getPrototypeOf(e);function ne(e,t,n=!1,r=!1){e=e["__v_raw"];const s=Me(e),i=Me(t);n||(t!==i&&P(s,"get",t),P(s,"get",i));const{has:o}=te(s),a=r?ee:n?je:Fe;return o.call(s,t)?a(e.get(t)):o.call(s,i)?a(e.get(i)):void(e!==s&&e.get(t))}function re(e,t=!1){const n=this["__v_raw"],r=Me(n),s=Me(e);return t||(e!==s&&P(r,"has",e),P(r,"has",s)),e===s?n.has(e):n.has(e)||n.has(s)}function se(e,t=!1){return e=e["__v_raw"],!t&&P(Me(e),"iterate",v),Reflect.get(e,"size",e)}function ie(e){e=Me(e);const t=Me(this),n=te(t),r=n.has.call(t,e);return r||(t.add(e),O(t,"add",e,e)),this}function oe(e,t){t=Me(t);const n=Me(this),{has:s,get:i}=te(n);let o=s.call(n,e);o||(e=Me(e),o=s.call(n,e));const a=i.call(n,e);return n.set(e,t),o?(0,r.aU)(t,a)&&O(n,"set",e,t,a):O(n,"add",e,t),this}function ae(e){const t=Me(this),{has:n,get:r}=te(t);let s=n.call(t,e);s||(e=Me(e),s=n.call(t,e));const i=r?r.call(t,e):void 0,o=t.delete(e);return s&&O(t,"delete",e,void 0,i),o}function ce(){const e=Me(this),t=0!==e.size,n=void 0,r=e.clear();return t&&O(e,"clear",void 0,void 0,n),r}function le(e,t){return function(n,r){const s=this,i=s["__v_raw"],o=Me(i),a=t?ee:e?je:Fe;return!e&&P(o,"iterate",v),i.forEach(((e,t)=>n.call(r,a(e),a(t),s)))}}function ue(e,t,n){return function(...s){const i=this["__v_raw"],o=Me(i),a=(0,r._N)(o),c="entries"===e||e===Symbol.iterator&&a,l="keys"===e&&a,u=i[e](...s),h=n?ee:t?je:Fe;return!t&&P(o,"iterate",l?_:v),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:c?[h(e[0]),h(e[1])]:h(e),done:t}},[Symbol.iterator](){return this}}}}function he(e){return function(...t){return"delete"!==e&&this}}function de(){const e={get(e){return ne(this,e)},get size(){return se(this)},has:re,add:ie,set:oe,delete:ae,clear:ce,forEach:le(!1,!1)},t={get(e){return ne(this,e,!1,!0)},get size(){return se(this)},has:re,add:ie,set:oe,delete:ae,clear:ce,forEach:le(!1,!0)},n={get(e){return ne(this,e,!0)},get size(){return se(this,!0)},has(e){return re.call(this,e,!0)},add:he("add"),set:he("set"),delete:he("delete"),clear:he("clear"),forEach:le(!0,!1)},r={get(e){return ne(this,e,!0,!0)},get size(){return se(this,!0)},has(e){return re.call(this,e,!0)},add:he("add"),set:he("set"),delete:he("delete"),clear:he("clear"),forEach:le(!0,!0)},s=["keys","values","entries",Symbol.iterator];return s.forEach((s=>{e[s]=ue(s,!1,!1),n[s]=ue(s,!0,!1),t[s]=ue(s,!1,!0),r[s]=ue(s,!0,!0)})),[e,n,t,r]}const[fe,pe,ge,ye]=de();function me(e,t){const n=t?e?ye:ge:e?pe:fe;return(t,s,i)=>"__v_isReactive"===s?!e:"__v_isReadonly"===s?e:"__v_raw"===s?t:Reflect.get((0,r.RI)(n,s)&&s in t?n:t,s,i)}const we={get:me(!1,!1)},be={get:me(!1,!0)},ve={get:me(!0,!1)},_e={get:me(!0,!0)};const Ee=new WeakMap,Se=new WeakMap,ke=new WeakMap,Ie=new WeakMap;function Ae(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Te(e){return e["__v_skip"]||!Object.isExtensible(e)?0:Ae((0,r.W7)(e))}function Re(e){return Le(e)?e:Oe(e,!1,Q,we,Ee)}function Ce(e){return Oe(e,!1,J,be,Se)}function Pe(e){return Oe(e,!0,X,ve,ke)}function Ne(e){return Oe(e,!0,Z,_e,Ie)}function Oe(e,t,n,s,i){if(!(0,r.Kn)(e))return e;if(e["__v_raw"]&&(!t||!e["__v_isReactive"]))return e;const o=i.get(e);if(o)return o;const a=Te(e);if(0===a)return e;const c=new Proxy(e,2===a?s:n);return i.set(e,c),c}function De(e){return Le(e)?De(e["__v_raw"]):!(!e||!e["__v_isReactive"])}function Le(e){return!(!e||!e["__v_isReadonly"])}function xe(e){return!(!e||!e["__v_isShallow"])}function Be(e){return De(e)||Le(e)}function Me(e){const t=e&&e["__v_raw"];return t?Me(t):e}function Ue(e){return(0,r.Nj)(e,"__v_skip",!0),e}const Fe=e=>(0,r.Kn)(e)?Re(e):e,je=e=>(0,r.Kn)(e)?Pe(e):e;function Ve(e){A&&b&&(e=Me(e),N(e.dep||(e.dep=u())))}function ze(e,t){e=Me(e),e.dep&&D(e.dep)}function $e(e){return!(!e||!0!==e.__v_isRef)}function Ke(e){return qe(e,!1)}function He(e){return qe(e,!0)}function qe(e,t){return $e(e)?e:new We(e,t)}class We{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Me(e),this._value=t?e:Fe(e)}get value(){return Ve(this),this._value}set value(e){const t=this.__v_isShallow||xe(e)||Le(e);e=t?e:Me(e),(0,r.aU)(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:Fe(e),ze(this,e))}}function Ge(e){ze(e,void 0)}function Ye(e){return $e(e)?e.value:e}const Qe={get:(e,t,n)=>Ye(Reflect.get(e,t,n)),set:(e,t,n,r)=>{const s=e[t];return $e(s)&&!$e(n)?(s.value=n,!0):Reflect.set(e,t,n,r)}};function Xe(e){return De(e)?e:new Proxy(e,Qe)}class Je{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:t,set:n}=e((()=>Ve(this)),(()=>ze(this)));this._get=t,this._set=n}get value(){return this._get()}set value(e){this._set(e)}}function Ze(e){return new Je(e)}function et(e){const t=(0,r.kJ)(e)?new Array(e.length):{};for(const n in e)t[n]=nt(e,n);return t}class tt{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return void 0===e?this._defaultValue:e}set value(e){this._object[this._key]=e}}function nt(e,t,n){const r=e[t];return $e(r)?r:new tt(e,t,n)}var rt;class st{constructor(e,t,n,r){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[rt]=!1,this._dirty=!0,this.effect=new E(e,(()=>{this._dirty||(this._dirty=!0,ze(this))})),this.effect.computed=this,this.effect.active=this._cacheable=!r,this["__v_isReadonly"]=n}get value(){const e=Me(this);return Ve(e),!e._dirty&&e._cacheable||(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function it(e,t,n=!1){let s,i;const o=(0,r.mf)(e);o?(s=e,i=r.dG):(s=e.get,i=e.set);const a=new st(s,i,o||!i,n);return a}rt="__v_isReadonly"},3396:function(e,t,n){"use strict";n.d(t,{$d:function(){return a},$y:function(){return r.$y},Ah:function(){return Xe},B:function(){return r.B},BK:function(){return r.BK},Bj:function(){return r.Bj},Bz:function(){return Tr},C3:function(){return jn},C_:function(){return s.C_},Cn:function(){return V},EB:function(){return r.EB},Eo:function(){return un},F4:function(){return Wn},FN:function(){return ar},Fl:function(){return Ir},G:function(){return Kr},HX:function(){return z},HY:function(){return kn},Ho:function(){return Gn},IU:function(){return r.IU},JJ:function(){return le},Jd:function(){return Qe},KU:function(){return o},Ko:function(){return dt},LL:function(){return ct},MW:function(){return Ar},MX:function(){return jr},Mr:function(){return Fr},Nv:function(){return ft},OT:function(){return r.OT},Ob:function(){return Be},P$:function(){return Se},PG:function(){return r.PG},Q2:function(){return lt},Q6:function(){return Ce},RC:function(){return Oe},Rh:function(){return de},Rr:function(){return Pr},S3:function(){return c},SU:function(){return r.SU},U2:function(){return Ie},Uc:function(){return Mr},Uk:function(){return Yn},Um:function(){return r.Um},Us:function(){return ln},Vh:function(){return r.Vh},WI:function(){return pt},WL:function(){return r.WL},WY:function(){return Rr},Wm:function(){return Hn},X3:function(){return r.X3},XI:function(){return r.XI},Xl:function(){return r.Xl},Xn:function(){return Ge},Y1:function(){return mr},Y3:function(){return b},Y8:function(){return ve},YP:function(){return ge},YS:function(){return r.YS},Yq:function(){return Ze},ZK:function(){return i},ZM:function(){return r.ZM},Zq:function(){return Ur},_:function(){return Kn},_A:function(){return s._A},aZ:function(){return Pe},b9:function(){return Cr},bT:function(){return et},bv:function(){return We},cE:function(){return r.cE},d1:function(){return tt},dD:function(){return j},dG:function(){return tr},dl:function(){return Ue},dq:function(){return r.dq},ec:function(){return D},eq:function(){return Hr},f3:function(){return ue},h:function(){return Br},hR:function(){return s.hR},i8:function(){return zr},iD:function(){return Bn},iH:function(){return r.iH},ic:function(){return Ye},j4:function(){return Mn},j5:function(){return s.j5},kC:function(){return s.kC},kq:function(){return Xn},l1:function(){return Nr},lA:function(){return Un},lR:function(){return En},m0:function(){return he},mW:function(){return P},mv:function(){return xr},mx:function(){return yt},n4:function(){return Z},nK:function(){return Re},nQ:function(){return Vr},nZ:function(){return r.nZ},oR:function(){return r.oR},of:function(){return wr},p1:function(){return Lr},qG:function(){return Tn},qZ:function(){return Ln},qb:function(){return k},qj:function(){return r.qj},qq:function(){return r.qq},ry:function(){return qr},sT:function(){return r.sT},se:function(){return Fe},sv:function(){return An},uE:function(){return Qn},u_:function(){return Dr},up:function(){return ot},vl:function(){return Je},vs:function(){return s.vs},w5:function(){return $},wF:function(){return qe},wg:function(){return Pn},wy:function(){return nt},xv:function(){return In},yT:function(){return r.yT},yX:function(){return fe},zw:function(){return s.zw}});n(7658),n(541);var r=n(4870),s=n(7139);function i(e,...t){}function o(e,t,n,r){let s;try{s=r?e(...r):e()}catch(i){c(i,t,n)}return s}function a(e,t,n,r){if((0,s.mf)(e)){const i=o(e,t,n,r);return i&&(0,s.tI)(i)&&i.catch((e=>{c(e,t,n)})),i}const i=[];for(let s=0;s<e.length;s++)i.push(a(e[s],t,n,r));return i}function c(e,t,n,r=!0){const s=t?t.vnode:null;if(t){let r=t.parent;const s=t.proxy,i=n;while(r){const t=r.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,s,i))return;r=r.parent}const a=t.appContext.config.errorHandler;if(a)return void o(a,null,10,[e,s,i])}l(e,n,s,r)}function l(e,t,n,r=!0){console.error(e)}let u=!1,h=!1;const d=[];let f=0;const p=[];let g=null,y=0;const m=Promise.resolve();let w=null;function b(e){const t=w||m;return e?t.then(this?e.bind(this):e):t}function v(e){let t=f+1,n=d.length;while(t<n){const r=t+n>>>1,s=T(d[r]);s<e?t=r+1:n=r}return t}function _(e){d.length&&d.includes(e,u&&e.allowRecurse?f+1:f)||(null==e.id?d.push(e):d.splice(v(e.id),0,e),E())}function E(){u||h||(h=!0,w=m.then(C))}function S(e){const t=d.indexOf(e);t>f&&d.splice(t,1)}function k(e){(0,s.kJ)(e)?p.push(...e):g&&g.includes(e,e.allowRecurse?y+1:y)||p.push(e),E()}function I(e,t=(u?f+1:0)){for(0;t<d.length;t++){const e=d[t];e&&e.pre&&(d.splice(t,1),t--,e())}}function A(e){if(p.length){const e=[...new Set(p)];if(p.length=0,g)return void g.push(...e);for(g=e,g.sort(((e,t)=>T(e)-T(t))),y=0;y<g.length;y++)g[y]();g=null,y=0}}const T=e=>null==e.id?1/0:e.id,R=(e,t)=>{const n=T(e)-T(t);if(0===n){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function C(e){h=!1,u=!0,d.sort(R);s.dG;try{for(f=0;f<d.length;f++){const e=d[f];e&&!1!==e.active&&o(e,null,14)}}finally{f=0,d.length=0,A(e),u=!1,w=null,(d.length||p.length)&&C(e)}}new Set;new Map;let P,N=[],O=!1;function D(e,t){var n,r;if(P=e,P)P.enabled=!0,N.forEach((({event:e,args:t})=>P.emit(e,...t))),N=[];else if("undefined"!==typeof window&&window.HTMLElement&&!(null===(r=null===(n=window.navigator)||void 0===n?void 0:n.userAgent)||void 0===r?void 0:r.includes("jsdom"))){const e=t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[];e.push((e=>{D(e,t)})),setTimeout((()=>{P||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,O=!0,N=[])}),3e3)}else O=!0,N=[]}function L(e,t,...n){if(e.isUnmounted)return;const r=e.vnode.props||s.kT;let i=n;const o=t.startsWith("update:"),c=o&&t.slice(7);if(c&&c in r){const e=`${"modelValue"===c?"model":c}Modifiers`,{number:t,trim:o}=r[e]||s.kT;o&&(i=n.map((e=>(0,s.HD)(e)?e.trim():e))),t&&(i=n.map(s.He))}let l;let u=r[l=(0,s.hR)(t)]||r[l=(0,s.hR)((0,s._A)(t))];!u&&o&&(u=r[l=(0,s.hR)((0,s.rs)(t))]),u&&a(u,e,6,i);const h=r[l+"Once"];if(h){if(e.emitted){if(e.emitted[l])return}else e.emitted={};e.emitted[l]=!0,a(h,e,6,i)}}function x(e,t,n=!1){const r=t.emitsCache,i=r.get(e);if(void 0!==i)return i;const o=e.emits;let a={},c=!1;if(!(0,s.mf)(e)){const r=e=>{const n=x(e,t,!0);n&&(c=!0,(0,s.l7)(a,n))};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}return o||c?((0,s.kJ)(o)?o.forEach((e=>a[e]=null)):(0,s.l7)(a,o),(0,s.Kn)(e)&&r.set(e,a),a):((0,s.Kn)(e)&&r.set(e,null),null)}function B(e,t){return!(!e||!(0,s.F7)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,s.RI)(e,t[0].toLowerCase()+t.slice(1))||(0,s.RI)(e,(0,s.rs)(t))||(0,s.RI)(e,t))}let M=null,U=null;function F(e){const t=M;return M=e,U=e&&e.type.__scopeId||null,t}function j(e){U=e}function V(){U=null}const z=e=>$;function $(e,t=M,n){if(!t)return e;if(e._n)return e;const r=(...n)=>{r._d&&Ln(-1);const s=F(t);let i;try{i=e(...n)}finally{F(s),r._d&&Ln(1)}return i};return r._n=!0,r._c=!0,r._d=!0,r}function K(e){const{type:t,vnode:n,proxy:r,withProxy:i,props:o,propsOptions:[a],slots:l,attrs:u,emit:h,render:d,renderCache:f,data:p,setupState:g,ctx:y,inheritAttrs:m}=e;let w,b;const v=F(e);try{if(4&n.shapeFlag){const e=i||r;w=Jn(d.call(e,e,f,o,g,p,y)),b=u}else{const e=t;0,w=Jn(e.length>1?e(o,{attrs:u,slots:l,emit:h}):e(o,null)),b=t.props?u:q(u)}}catch(E){Rn.length=0,c(E,e,1),w=Hn(An)}let _=w;if(b&&!1!==m){const e=Object.keys(b),{shapeFlag:t}=_;e.length&&7&t&&(a&&e.some(s.tR)&&(b=W(b,a)),_=Gn(_,b))}return n.dirs&&(_=Gn(_),_.dirs=_.dirs?_.dirs.concat(n.dirs):n.dirs),n.transition&&(_.transition=n.transition),w=_,F(v),w}function H(e){let t;for(let n=0;n<e.length;n++){const r=e[n];if(!Un(r))return;if(r.type!==An||"v-if"===r.children){if(t)return;t=r}}return t}const q=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,s.F7)(n))&&((t||(t={}))[n]=e[n]);return t},W=(e,t)=>{const n={};for(const r in e)(0,s.tR)(r)&&r.slice(9)in t||(n[r]=e[r]);return n};function G(e,t,n){const{props:r,children:s,component:i}=e,{props:o,children:a,patchFlag:c}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&c>=0))return!(!s&&!a||a&&a.$stable)||r!==o&&(r?!o||Y(r,o,l):!!o);if(1024&c)return!0;if(16&c)return r?Y(r,o,l):!!o;if(8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(o[n]!==r[n]&&!B(l,n))return!0}}return!1}function Y(e,t,n){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(t[i]!==e[i]&&!B(n,i))return!0}return!1}function Q({vnode:e,parent:t},n){while(t&&t.subTree===e)(e=t.vnode).el=n,t=t.parent}const X=e=>e.__isSuspense,J={name:"Suspense",__isSuspense:!0,process(e,t,n,r,s,i,o,a,c,l){null==e?te(t,n,r,s,i,o,a,c,l):ne(e,t,n,r,s,o,a,c,l)},hydrate:se,create:re,normalize:ie},Z=J;function ee(e,t){const n=e.props&&e.props[t];(0,s.mf)(n)&&n()}function te(e,t,n,r,s,i,o,a,c){const{p:l,o:{createElement:u}}=c,h=u("div"),d=e.suspense=re(e,s,r,t,h,n,i,o,a,c);l(null,d.pendingBranch=e.ssContent,h,null,r,d,i,o),d.deps>0?(ee(e,"onPending"),ee(e,"onFallback"),l(null,e.ssFallback,t,n,r,null,i,o),ce(d,e.ssFallback)):d.resolve()}function ne(e,t,n,r,s,i,o,a,{p:c,um:l,o:{createElement:u}}){const h=t.suspense=e.suspense;h.vnode=t,t.el=e.el;const d=t.ssContent,f=t.ssFallback,{activeBranch:p,pendingBranch:g,isInFallback:y,isHydrating:m}=h;if(g)h.pendingBranch=d,Fn(d,g)?(c(g,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0?h.resolve():y&&(c(p,f,n,r,s,null,i,o,a),ce(h,f))):(h.pendingId++,m?(h.isHydrating=!1,h.activeBranch=g):l(g,s,h),h.deps=0,h.effects.length=0,h.hiddenContainer=u("div"),y?(c(null,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0?h.resolve():(c(p,f,n,r,s,null,i,o,a),ce(h,f))):p&&Fn(d,p)?(c(p,d,n,r,s,h,i,o,a),h.resolve(!0)):(c(null,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0&&h.resolve()));else if(p&&Fn(d,p))c(p,d,n,r,s,h,i,o,a),ce(h,d);else if(ee(t,"onPending"),h.pendingBranch=d,h.pendingId++,c(null,d,h.hiddenContainer,null,s,h,i,o,a),h.deps<=0)h.resolve();else{const{timeout:e,pendingId:t}=h;e>0?setTimeout((()=>{h.pendingId===t&&h.fallback(f)}),e):0===e&&h.fallback(f)}}function re(e,t,n,r,i,o,a,l,u,h,d=!1){const{p:f,m:p,um:g,n:y,o:{parentNode:m,remove:w}}=h,b=(0,s.He)(e.props&&e.props.timeout),v={vnode:e,parent:t,parentComponent:n,isSVG:a,container:r,hiddenContainer:i,anchor:o,deps:0,pendingId:0,timeout:"number"===typeof b?b:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:d,isUnmounted:!1,effects:[],resolve(e=!1){const{vnode:t,activeBranch:n,pendingBranch:r,pendingId:s,effects:i,parentComponent:o,container:a}=v;if(v.isHydrating)v.isHydrating=!1;else if(!e){const e=n&&r.transition&&"out-in"===r.transition.mode;e&&(n.transition.afterLeave=()=>{s===v.pendingId&&p(r,a,t,0)});let{anchor:t}=v;n&&(t=y(n),g(n,o,v,!0)),e||p(r,a,t,0)}ce(v,r),v.pendingBranch=null,v.isInFallback=!1;let c=v.parent,l=!1;while(c){if(c.pendingBranch){c.effects.push(...i),l=!0;break}c=c.parent}l||k(i),v.effects=[],ee(t,"onResolve")},fallback(e){if(!v.pendingBranch)return;const{vnode:t,activeBranch:n,parentComponent:r,container:s,isSVG:i}=v;ee(t,"onFallback");const o=y(n),a=()=>{v.isInFallback&&(f(null,e,s,o,r,null,i,l,u),ce(v,e))},c=e.transition&&"out-in"===e.transition.mode;c&&(n.transition.afterLeave=a),v.isInFallback=!0,g(n,r,null,!0),c||a()},move(e,t,n){v.activeBranch&&p(v.activeBranch,e,t,n),v.container=e},next(){return v.activeBranch&&y(v.activeBranch)},registerDep(e,t){const n=!!v.pendingBranch;n&&v.deps++;const r=e.vnode.el;e.asyncDep.catch((t=>{c(t,e,0)})).then((s=>{if(e.isUnmounted||v.isUnmounted||v.pendingId!==e.suspenseId)return;e.asyncResolved=!0;const{vnode:i}=e;yr(e,s,!1),r&&(i.el=r);const o=!r&&e.subTree.el;t(e,i,m(r||e.subTree.el),r?null:y(e.subTree),v,a,u),o&&w(o),Q(e,i.el),n&&0===--v.deps&&v.resolve()}))},unmount(e,t){v.isUnmounted=!0,v.activeBranch&&g(v.activeBranch,n,e,t),v.pendingBranch&&g(v.pendingBranch,n,e,t)}};return v}function se(e,t,n,r,s,i,o,a,c){const l=t.suspense=re(t,r,n,e.parentNode,document.createElement("div"),null,s,i,o,a,!0),u=c(e,l.pendingBranch=t.ssContent,n,l,i,o);return 0===l.deps&&l.resolve(),u}function ie(e){const{shapeFlag:t,children:n}=e,r=32&t;e.ssContent=oe(r?n.default:n),e.ssFallback=r?oe(n.fallback):Hn(An)}function oe(e){let t;if((0,s.mf)(e)){const n=Dn&&e._c;n&&(e._d=!1,Pn()),e=e(),n&&(e._d=!0,t=Cn,Nn())}if((0,s.kJ)(e)){const t=H(e);0,e=t}return e=Jn(e),t&&!e.dynamicChildren&&(e.dynamicChildren=t.filter((t=>t!==e))),e}function ae(e,t){t&&t.pendingBranch?(0,s.kJ)(e)?t.effects.push(...e):t.effects.push(e):k(e)}function ce(e,t){e.activeBranch=t;const{vnode:n,parentComponent:r}=e,s=n.el=t.el;r&&r.subTree===n&&(r.vnode.el=s,Q(r,s))}function le(e,t){if(or){let n=or.provides;const r=or.parent&&or.parent.provides;r===n&&(n=or.provides=Object.create(r)),n[e]=t}else 0}function ue(e,t,n=!1){const r=or||M;if(r){const i=null==r.parent?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return n&&(0,s.mf)(t)?t.call(r.proxy):t}else 0}function he(e,t){return ye(e,null,t)}function de(e,t){return ye(e,null,{flush:"post"})}function fe(e,t){return ye(e,null,{flush:"sync"})}const pe={};function ge(e,t,n){return ye(e,t,n)}function ye(e,t,{immediate:n,deep:i,flush:c,onTrack:l,onTrigger:u}=s.kT){const h=or;let d,f,p=!1,g=!1;if((0,r.dq)(e)?(d=()=>e.value,p=(0,r.yT)(e)):(0,r.PG)(e)?(d=()=>e,i=!0):(0,s.kJ)(e)?(g=!0,p=e.some((e=>(0,r.PG)(e)||(0,r.yT)(e))),d=()=>e.map((e=>(0,r.dq)(e)?e.value:(0,r.PG)(e)?be(e):(0,s.mf)(e)?o(e,h,2):void 0))):d=(0,s.mf)(e)?t?()=>o(e,h,2):()=>{if(!h||!h.isUnmounted)return f&&f(),a(e,h,3,[m])}:s.dG,t&&i){const e=d;d=()=>be(e())}let y,m=e=>{f=E.onStop=()=>{o(e,h,4)}};if(fr){if(m=s.dG,t?n&&a(t,h,3,[d(),g?[]:void 0,m]):d(),"sync"!==c)return s.dG;{const e=Ur();y=e.__watcherHandles||(e.__watcherHandles=[])}}let w=g?new Array(e.length).fill(pe):pe;const b=()=>{if(E.active)if(t){const e=E.run();(i||p||(g?e.some(((e,t)=>(0,s.aU)(e,w[t]))):(0,s.aU)(e,w)))&&(f&&f(),a(t,h,3,[e,w===pe?void 0:g&&w[0]===pe?[]:w,m]),w=e)}else E.run()};let v;b.allowRecurse=!!t,"sync"===c?v=b:"post"===c?v=()=>cn(b,h&&h.suspense):(b.pre=!0,h&&(b.id=h.uid),v=()=>_(b));const E=new r.qq(d,v);t?n?b():w=E.run():"post"===c?cn(E.run.bind(E),h&&h.suspense):E.run();const S=()=>{E.stop(),h&&h.scope&&(0,s.Od)(h.scope.effects,E)};return y&&y.push(S),S}function me(e,t,n){const r=this.proxy,i=(0,s.HD)(e)?e.includes(".")?we(r,e):()=>r[e]:e.bind(r,r);let o;(0,s.mf)(t)?o=t:(o=t.handler,n=t);const a=or;cr(this);const c=ye(i,o.bind(r),n);return a?cr(a):lr(),c}function we(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}function be(e,t){if(!(0,s.Kn)(e)||e["__v_skip"])return e;if(t=t||new Set,t.has(e))return e;if(t.add(e),(0,r.dq)(e))be(e.value,t);else if((0,s.kJ)(e))for(let n=0;n<e.length;n++)be(e[n],t);else if((0,s.DM)(e)||(0,s._N)(e))e.forEach((e=>{be(e,t)}));else if((0,s.PO)(e))for(const n in e)be(e[n],t);return e}function ve(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return We((()=>{e.isMounted=!0})),Qe((()=>{e.isUnmounting=!0})),e}const _e=[Function,Array],Ee={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:_e,onEnter:_e,onAfterEnter:_e,onEnterCancelled:_e,onBeforeLeave:_e,onLeave:_e,onAfterLeave:_e,onLeaveCancelled:_e,onBeforeAppear:_e,onAppear:_e,onAfterAppear:_e,onAppearCancelled:_e},setup(e,{slots:t}){const n=ar(),s=ve();let i;return()=>{const o=t.default&&Ce(t.default(),!0);if(!o||!o.length)return;let a=o[0];if(o.length>1){let e=!1;for(const t of o)if(t.type!==An){0,a=t,e=!0;break}}const c=(0,r.IU)(e),{mode:l}=c;if(s.isLeaving)return Ae(a);const u=Te(a);if(!u)return Ae(a);const h=Ie(u,c,s,n);Re(u,h);const d=n.subTree,f=d&&Te(d);let p=!1;const{getTransitionKey:g}=u.type;if(g){const e=g();void 0===i?i=e:e!==i&&(i=e,p=!0)}if(f&&f.type!==An&&(!Fn(u,f)||p)){const e=Ie(f,c,s,n);if(Re(f,e),"out-in"===l)return s.isLeaving=!0,e.afterLeave=()=>{s.isLeaving=!1,!1!==n.update.active&&n.update()},Ae(a);"in-out"===l&&u.type!==An&&(e.delayLeave=(e,t,n)=>{const r=ke(s,f);r[String(f.key)]=f,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete h.delayedLeave},h.delayedLeave=n})}return a}}},Se=Ee;function ke(e,t){const{leavingVNodes:n}=e;let r=n.get(t.type);return r||(r=Object.create(null),n.set(t.type,r)),r}function Ie(e,t,n,r){const{appear:i,mode:o,persisted:c=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:h,onEnterCancelled:d,onBeforeLeave:f,onLeave:p,onAfterLeave:g,onLeaveCancelled:y,onBeforeAppear:m,onAppear:w,onAfterAppear:b,onAppearCancelled:v}=t,_=String(e.key),E=ke(n,e),S=(e,t)=>{e&&a(e,r,9,t)},k=(e,t)=>{const n=t[1];S(e,t),(0,s.kJ)(e)?e.every((e=>e.length<=1))&&n():e.length<=1&&n()},I={mode:o,persisted:c,beforeEnter(t){let r=l;if(!n.isMounted){if(!i)return;r=m||l}t._leaveCb&&t._leaveCb(!0);const s=E[_];s&&Fn(e,s)&&s.el._leaveCb&&s.el._leaveCb(),S(r,[t])},enter(e){let t=u,r=h,s=d;if(!n.isMounted){if(!i)return;t=w||u,r=b||h,s=v||d}let o=!1;const a=e._enterCb=t=>{o||(o=!0,S(t?s:r,[e]),I.delayedLeave&&I.delayedLeave(),e._enterCb=void 0)};t?k(t,[e,a]):a()},leave(t,r){const s=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return r();S(f,[t]);let i=!1;const o=t._leaveCb=n=>{i||(i=!0,r(),S(n?y:g,[t]),t._leaveCb=void 0,E[s]===e&&delete E[s])};E[s]=e,p?k(p,[t,o]):o()},clone(e){return Ie(e,t,n,r)}};return I}function Ae(e){if(Le(e))return e=Gn(e),e.children=null,e}function Te(e){return Le(e)?e.children?e.children[0]:void 0:e}function Re(e,t){6&e.shapeFlag&&e.component?Re(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ce(e,t=!1,n){let r=[],s=0;for(let i=0;i<e.length;i++){let o=e[i];const a=null==n?o.key:String(n)+String(null!=o.key?o.key:i);o.type===kn?(128&o.patchFlag&&s++,r=r.concat(Ce(o.children,t,a))):(t||o.type!==An)&&r.push(null!=a?Gn(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}function Pe(e){return(0,s.mf)(e)?{setup:e,name:e.name}:e}const Ne=e=>!!e.type.__asyncLoader;function Oe(e){(0,s.mf)(e)&&(e={loader:e});const{loader:t,loadingComponent:n,errorComponent:i,delay:o=200,timeout:a,suspensible:l=!0,onError:u}=e;let h,d=null,f=0;const p=()=>(f++,d=null,g()),g=()=>{let e;return d||(e=d=t().catch((e=>{if(e=e instanceof Error?e:new Error(String(e)),u)return new Promise(((t,n)=>{const r=()=>t(p()),s=()=>n(e);u(e,r,s,f+1)}));throw e})).then((t=>e!==d&&d?d:(t&&(t.__esModule||"Module"===t[Symbol.toStringTag])&&(t=t.default),h=t,t))))};return Pe({name:"AsyncComponentWrapper",__asyncLoader:g,get __asyncResolved(){return h},setup(){const e=or;if(h)return()=>De(h,e);const t=t=>{d=null,c(t,e,13,!i)};if(l&&e.suspense||fr)return g().then((t=>()=>De(t,e))).catch((e=>(t(e),()=>i?Hn(i,{error:e}):null)));const s=(0,r.iH)(!1),u=(0,r.iH)(),f=(0,r.iH)(!!o);return o&&setTimeout((()=>{f.value=!1}),o),null!=a&&setTimeout((()=>{if(!s.value&&!u.value){const e=new Error(`Async component timed out after ${a}ms.`);t(e),u.value=e}}),a),g().then((()=>{s.value=!0,e.parent&&Le(e.parent.vnode)&&_(e.parent.update)})).catch((e=>{t(e),u.value=e})),()=>s.value&&h?De(h,e):u.value&&i?Hn(i,{error:u.value}):n&&!f.value?Hn(n):void 0}})}function De(e,t){const{ref:n,props:r,children:s,ce:i}=t.vnode,o=Hn(e,r,s);return o.ref=n,o.ce=i,delete t.vnode.ce,o}const Le=e=>e.type.__isKeepAlive,xe={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(e,{slots:t}){const n=ar(),r=n.ctx;if(!r.renderer)return()=>{const e=t.default&&t.default();return e&&1===e.length?e[0]:e};const i=new Map,o=new Set;let a=null;const c=n.suspense,{renderer:{p:l,m:u,um:h,o:{createElement:d}}}=r,f=d("div");function p(e){ze(e),h(e,n,c,!0)}function g(e){i.forEach(((t,n)=>{const r=Sr(t.type);!r||e&&e(r)||y(n)}))}function y(e){const t=i.get(e);a&&t.type===a.type?a&&ze(a):p(t),i.delete(e),o.delete(e)}r.activate=(e,t,n,r,i)=>{const o=e.component;u(e,t,n,0,c),l(o.vnode,e,t,n,o,c,r,e.slotScopeIds,i),cn((()=>{o.isDeactivated=!1,o.a&&(0,s.ir)(o.a);const t=e.props&&e.props.onVnodeMounted;t&&nr(t,o.parent,e)}),c)},r.deactivate=e=>{const t=e.component;u(e,f,null,1,c),cn((()=>{t.da&&(0,s.ir)(t.da);const n=e.props&&e.props.onVnodeUnmounted;n&&nr(n,t.parent,e),t.isDeactivated=!0}),c)},ge((()=>[e.include,e.exclude]),(([e,t])=>{e&&g((t=>Me(e,t))),t&&g((e=>!Me(t,e)))}),{flush:"post",deep:!0});let m=null;const w=()=>{null!=m&&i.set(m,$e(n.subTree))};return We(w),Ye(w),Qe((()=>{i.forEach((e=>{const{subTree:t,suspense:r}=n,s=$e(t);if(e.type!==s.type)p(e);else{ze(s);const e=s.component.da;e&&cn(e,r)}}))})),()=>{if(m=null,!t.default)return null;const n=t.default(),r=n[0];if(n.length>1)return a=null,n;if(!Un(r)||!(4&r.shapeFlag)&&!(128&r.shapeFlag))return a=null,r;let s=$e(r);const c=s.type,l=Sr(Ne(s)?s.type.__asyncResolved||{}:c),{include:u,exclude:h,max:d}=e;if(u&&(!l||!Me(u,l))||h&&l&&Me(h,l))return a=s,r;const f=null==s.key?c:s.key,p=i.get(f);return s.el&&(s=Gn(s),128&r.shapeFlag&&(r.ssContent=s)),m=f,p?(s.el=p.el,s.component=p.component,s.transition&&Re(s,s.transition),s.shapeFlag|=512,o.delete(f),o.add(f)):(o.add(f),d&&o.size>parseInt(d,10)&&y(o.values().next().value)),s.shapeFlag|=256,a=s,X(r.type)?r:s}}},Be=xe;function Me(e,t){return(0,s.kJ)(e)?e.some((e=>Me(e,t))):(0,s.HD)(e)?e.split(",").includes(t):!!e.test&&e.test(t)}function Ue(e,t){je(e,"a",t)}function Fe(e,t){je(e,"da",t)}function je(e,t,n=or){const r=e.__wdc||(e.__wdc=()=>{let t=n;while(t){if(t.isDeactivated)return;t=t.parent}return e()});if(Ke(t,r,n),n){let e=n.parent;while(e&&e.parent)Le(e.parent.vnode)&&Ve(r,t,n,e),e=e.parent}}function Ve(e,t,n,r){const i=Ke(t,e,r,!0);Xe((()=>{(0,s.Od)(r[t],i)}),n)}function ze(e){e.shapeFlag&=-257,e.shapeFlag&=-513}function $e(e){return 128&e.shapeFlag?e.ssContent:e}function Ke(e,t,n=or,s=!1){if(n){const i=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...s)=>{if(n.isUnmounted)return;(0,r.Jd)(),cr(n);const i=a(t,n,e,s);return lr(),(0,r.lk)(),i});return s?i.unshift(o):i.push(o),o}}const He=e=>(t,n=or)=>(!fr||"sp"===e)&&Ke(e,((...e)=>t(...e)),n),qe=He("bm"),We=He("m"),Ge=He("bu"),Ye=He("u"),Qe=He("bum"),Xe=He("um"),Je=He("sp"),Ze=He("rtg"),et=He("rtc");function tt(e,t=or){Ke("ec",e,t)}function nt(e,t){const n=M;if(null===n)return e;const r=Er(n)||n.proxy,i=e.dirs||(e.dirs=[]);for(let o=0;o<t.length;o++){let[e,n,a,c=s.kT]=t[o];e&&((0,s.mf)(e)&&(e={mounted:e,updated:e}),e.deep&&be(n),i.push({dir:e,instance:r,value:n,oldValue:void 0,arg:a,modifiers:c}))}return e}function rt(e,t,n,s){const i=e.dirs,o=t&&t.dirs;for(let c=0;c<i.length;c++){const l=i[c];o&&(l.oldValue=o[c].value);let u=l.dir[s];u&&((0,r.Jd)(),a(u,n,8,[e.el,l,e,t]),(0,r.lk)())}}const st="components",it="directives";function ot(e,t){return ut(st,e,!0,t)||e}const at=Symbol();function ct(e){return(0,s.HD)(e)?ut(st,e,!1)||e:e||at}function lt(e){return ut(it,e)}function ut(e,t,n=!0,r=!1){const i=M||or;if(i){const n=i.type;if(e===st){const e=Sr(n,!1);if(e&&(e===t||e===(0,s._A)(t)||e===(0,s.kC)((0,s._A)(t))))return n}const o=ht(i[e]||n[e],t)||ht(i.appContext[e],t);return!o&&r?n:o}}function ht(e,t){return e&&(e[t]||e[(0,s._A)(t)]||e[(0,s.kC)((0,s._A)(t))])}function dt(e,t,n,r){let i;const o=n&&n[r];if((0,s.kJ)(e)||(0,s.HD)(e)){i=new Array(e.length);for(let n=0,r=e.length;n<r;n++)i[n]=t(e[n],n,void 0,o&&o[n])}else if("number"===typeof e){0,i=new Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,o&&o[n])}else if((0,s.Kn)(e))if(e[Symbol.iterator])i=Array.from(e,((e,n)=>t(e,n,void 0,o&&o[n])));else{const n=Object.keys(e);i=new Array(n.length);for(let r=0,s=n.length;r<s;r++){const s=n[r];i[r]=t(e[s],s,r,o&&o[r])}}else i=[];return n&&(n[r]=i),i}function ft(e,t){for(let n=0;n<t.length;n++){const r=t[n];if((0,s.kJ)(r))for(let t=0;t<r.length;t++)e[r[t].name]=r[t].fn;else r&&(e[r.name]=r.key?(...e)=>{const t=r.fn(...e);return t&&(t.key=r.key),t}:r.fn)}return e}function pt(e,t,n={},r,s){if(M.isCE||M.parent&&Ne(M.parent)&&M.parent.isCE)return"default"!==t&&(n.name=t),Hn("slot",n,r&&r());let i=e[t];i&&i._c&&(i._d=!1),Pn();const o=i&&gt(i(n)),a=Mn(kn,{key:n.key||o&&o.key||`_${t}`},o||(r?r():[]),o&&1===e._?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function gt(e){return e.some((e=>!Un(e)||e.type!==An&&!(e.type===kn&&!gt(e.children))))?e:null}function yt(e,t){const n={};for(const r in e)n[t&&/[A-Z]/.test(r)?`on:${r}`:(0,s.hR)(r)]=e[r];return n}const mt=e=>e?ur(e)?Er(e)||e.proxy:mt(e.parent):null,wt=(0,s.l7)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>mt(e.parent),$root:e=>mt(e.root),$emit:e=>e.emit,$options:e=>Tt(e),$forceUpdate:e=>e.f||(e.f=()=>_(e.update)),$nextTick:e=>e.n||(e.n=b.bind(e.proxy)),$watch:e=>me.bind(e)}),bt=(e,t)=>e!==s.kT&&!e.__isScriptSetup&&(0,s.RI)(e,t),vt={get({_:e},t){const{ctx:n,setupState:i,data:o,props:a,accessCache:c,type:l,appContext:u}=e;let h;if("$"!==t[0]){const r=c[t];if(void 0!==r)switch(r){case 1:return i[t];case 2:return o[t];case 4:return n[t];case 3:return a[t]}else{if(bt(i,t))return c[t]=1,i[t];if(o!==s.kT&&(0,s.RI)(o,t))return c[t]=2,o[t];if((h=e.propsOptions[0])&&(0,s.RI)(h,t))return c[t]=3,a[t];if(n!==s.kT&&(0,s.RI)(n,t))return c[t]=4,n[t];Et&&(c[t]=0)}}const d=wt[t];let f,p;return d?("$attrs"===t&&(0,r.j)(e,"get",t),d(e)):(f=l.__cssModules)&&(f=f[t])?f:n!==s.kT&&(0,s.RI)(n,t)?(c[t]=4,n[t]):(p=u.config.globalProperties,(0,s.RI)(p,t)?p[t]:void 0)},set({_:e},t,n){const{data:r,setupState:i,ctx:o}=e;return bt(i,t)?(i[t]=n,!0):r!==s.kT&&(0,s.RI)(r,t)?(r[t]=n,!0):!(0,s.RI)(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(o[t]=n,!0))},has({_:{data:e,setupState:t,accessCache:n,ctx:r,appContext:i,propsOptions:o}},a){let c;return!!n[a]||e!==s.kT&&(0,s.RI)(e,a)||bt(t,a)||(c=o[0])&&(0,s.RI)(c,a)||(0,s.RI)(r,a)||(0,s.RI)(wt,a)||(0,s.RI)(i.config.globalProperties,a)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,s.RI)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};const _t=(0,s.l7)({},vt,{get(e,t){if(t!==Symbol.unscopables)return vt.get(e,t,e)},has(e,t){const n="_"!==t[0]&&!(0,s.e1)(t);return n}});let Et=!0;function St(e){const t=Tt(e),n=e.proxy,i=e.ctx;Et=!1,t.beforeCreate&&It(t.beforeCreate,e,"bc");const{data:o,computed:a,methods:c,watch:l,provide:u,inject:h,created:d,beforeMount:f,mounted:p,beforeUpdate:g,updated:y,activated:m,deactivated:w,beforeDestroy:b,beforeUnmount:v,destroyed:_,unmounted:E,render:S,renderTracked:k,renderTriggered:I,errorCaptured:A,serverPrefetch:T,expose:R,inheritAttrs:C,components:P,directives:N,filters:O}=t,D=null;if(h&&kt(h,i,D,e.appContext.config.unwrapInjectedRef),c)for(const r in c){const e=c[r];(0,s.mf)(e)&&(i[r]=e.bind(n))}if(o){0;const t=o.call(n,n);0,(0,s.Kn)(t)&&(e.data=(0,r.qj)(t))}if(Et=!0,a)for(const r in a){const e=a[r],t=(0,s.mf)(e)?e.bind(n,n):(0,s.mf)(e.get)?e.get.bind(n,n):s.dG;0;const o=!(0,s.mf)(e)&&(0,s.mf)(e.set)?e.set.bind(n):s.dG,c=Ir({get:t,set:o});Object.defineProperty(i,r,{enumerable:!0,configurable:!0,get:()=>c.value,set:e=>c.value=e})}if(l)for(const r in l)At(l[r],i,n,r);if(u){const e=(0,s.mf)(u)?u.call(n):u;Reflect.ownKeys(e).forEach((t=>{le(t,e[t])}))}function L(e,t){(0,s.kJ)(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(d&&It(d,e,"c"),L(qe,f),L(We,p),L(Ge,g),L(Ye,y),L(Ue,m),L(Fe,w),L(tt,A),L(et,k),L(Ze,I),L(Qe,v),L(Xe,E),L(Je,T),(0,s.kJ)(R))if(R.length){const t=e.exposed||(e.exposed={});R.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});S&&e.render===s.dG&&(e.render=S),null!=C&&(e.inheritAttrs=C),P&&(e.components=P),N&&(e.directives=N)}function kt(e,t,n=s.dG,i=!1){(0,s.kJ)(e)&&(e=Ot(e));for(const o in e){const n=e[o];let a;a=(0,s.Kn)(n)?"default"in n?ue(n.from||o,n.default,!0):ue(n.from||o):ue(n),(0,r.dq)(a)&&i?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>a.value,set:e=>a.value=e}):t[o]=a}}function It(e,t,n){a((0,s.kJ)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function At(e,t,n,r){const i=r.includes(".")?we(n,r):()=>n[r];if((0,s.HD)(e)){const n=t[e];(0,s.mf)(n)&&ge(i,n)}else if((0,s.mf)(e))ge(i,e.bind(n));else if((0,s.Kn)(e))if((0,s.kJ)(e))e.forEach((e=>At(e,t,n,r)));else{const r=(0,s.mf)(e.handler)?e.handler.bind(n):t[e.handler];(0,s.mf)(r)&&ge(i,r,e)}else 0}function Tt(e){const t=e.type,{mixins:n,extends:r}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:a}}=e.appContext,c=o.get(t);let l;return c?l=c:i.length||n||r?(l={},i.length&&i.forEach((e=>Rt(l,e,a,!0))),Rt(l,t,a)):l=t,(0,s.Kn)(t)&&o.set(t,l),l}function Rt(e,t,n,r=!1){const{mixins:s,extends:i}=t;i&&Rt(e,i,n,!0),s&&s.forEach((t=>Rt(e,t,n,!0)));for(const o in t)if(r&&"expose"===o);else{const r=Ct[o]||n&&n[o];e[o]=r?r(e[o],t[o]):t[o]}return e}const Ct={data:Pt,props:Lt,emits:Lt,methods:Lt,computed:Lt,beforeCreate:Dt,created:Dt,beforeMount:Dt,mounted:Dt,beforeUpdate:Dt,updated:Dt,beforeDestroy:Dt,beforeUnmount:Dt,destroyed:Dt,unmounted:Dt,activated:Dt,deactivated:Dt,errorCaptured:Dt,serverPrefetch:Dt,components:Lt,directives:Lt,watch:xt,provide:Pt,inject:Nt};function Pt(e,t){return t?e?function(){return(0,s.l7)((0,s.mf)(e)?e.call(this,this):e,(0,s.mf)(t)?t.call(this,this):t)}:t:e}function Nt(e,t){return Lt(Ot(e),Ot(t))}function Ot(e){if((0,s.kJ)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Dt(e,t){return e?[...new Set([].concat(e,t))]:t}function Lt(e,t){return e?(0,s.l7)((0,s.l7)(Object.create(null),e),t):t}function xt(e,t){if(!e)return t;if(!t)return e;const n=(0,s.l7)(Object.create(null),e);for(const r in t)n[r]=Dt(e[r],t[r]);return n}function Bt(e,t,n,i=!1){const o={},a={};(0,s.Nj)(a,Vn,1),e.propsDefaults=Object.create(null),Ut(e,t,o,a);for(const r in e.propsOptions[0])r in o||(o[r]=void 0);n?e.props=i?o:(0,r.Um)(o):e.type.props?e.props=o:e.props=a,e.attrs=a}function Mt(e,t,n,i){const{props:o,attrs:a,vnode:{patchFlag:c}}=e,l=(0,r.IU)(o),[u]=e.propsOptions;let h=!1;if(!(i||c>0)||16&c){let r;Ut(e,t,o,a)&&(h=!0);for(const i in l)t&&((0,s.RI)(t,i)||(r=(0,s.rs)(i))!==i&&(0,s.RI)(t,r))||(u?!n||void 0===n[i]&&void 0===n[r]||(o[i]=Ft(u,l,i,void 0,e,!0)):delete o[i]);if(a!==l)for(const e in a)t&&(0,s.RI)(t,e)||(delete a[e],h=!0)}else if(8&c){const n=e.vnode.dynamicProps;for(let r=0;r<n.length;r++){let i=n[r];if(B(e.emitsOptions,i))continue;const c=t[i];if(u)if((0,s.RI)(a,i))c!==a[i]&&(a[i]=c,h=!0);else{const t=(0,s._A)(i);o[t]=Ft(u,l,t,c,e,!1)}else c!==a[i]&&(a[i]=c,h=!0)}}h&&(0,r.X$)(e,"set","$attrs")}function Ut(e,t,n,i){const[o,a]=e.propsOptions;let c,l=!1;if(t)for(let r in t){if((0,s.Gg)(r))continue;const u=t[r];let h;o&&(0,s.RI)(o,h=(0,s._A)(r))?a&&a.includes(h)?(c||(c={}))[h]=u:n[h]=u:B(e.emitsOptions,r)||r in i&&u===i[r]||(i[r]=u,l=!0)}if(a){const t=(0,r.IU)(n),i=c||s.kT;for(let r=0;r<a.length;r++){const c=a[r];n[c]=Ft(o,t,c,i[c],e,!(0,s.RI)(i,c))}}return l}function Ft(e,t,n,r,i,o){const a=e[n];if(null!=a){const e=(0,s.RI)(a,"default");if(e&&void 0===r){const e=a.default;if(a.type!==Function&&(0,s.mf)(e)){const{propsDefaults:s}=i;n in s?r=s[n]:(cr(i),r=s[n]=e.call(null,t),lr())}else r=e}a[0]&&(o&&!e?r=!1:!a[1]||""!==r&&r!==(0,s.rs)(n)||(r=!0))}return r}function jt(e,t,n=!1){const r=t.propsCache,i=r.get(e);if(i)return i;const o=e.props,a={},c=[];let l=!1;if(!(0,s.mf)(e)){const r=e=>{l=!0;const[n,r]=jt(e,t,!0);(0,s.l7)(a,n),r&&c.push(...r)};!n&&t.mixins.length&&t.mixins.forEach(r),e.extends&&r(e.extends),e.mixins&&e.mixins.forEach(r)}if(!o&&!l)return(0,s.Kn)(e)&&r.set(e,s.Z6),s.Z6;if((0,s.kJ)(o))for(let h=0;h<o.length;h++){0;const e=(0,s._A)(o[h]);Vt(e)&&(a[e]=s.kT)}else if(o){0;for(const e in o){const t=(0,s._A)(e);if(Vt(t)){const n=o[e],r=a[t]=(0,s.kJ)(n)||(0,s.mf)(n)?{type:n}:Object.assign({},n);if(r){const e=Kt(Boolean,r.type),n=Kt(String,r.type);r[0]=e>-1,r[1]=n<0||e<n,(e>-1||(0,s.RI)(r,"default"))&&c.push(t)}}}}const u=[a,c];return(0,s.Kn)(e)&&r.set(e,u),u}function Vt(e){return"$"!==e[0]}function zt(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:null===e?"null":""}function $t(e,t){return zt(e)===zt(t)}function Kt(e,t){return(0,s.kJ)(t)?t.findIndex((t=>$t(t,e))):(0,s.mf)(t)&&$t(t,e)?0:-1}const Ht=e=>"_"===e[0]||"$stable"===e,qt=e=>(0,s.kJ)(e)?e.map(Jn):[Jn(e)],Wt=(e,t,n)=>{if(t._n)return t;const r=$(((...e)=>qt(t(...e))),n);return r._c=!1,r},Gt=(e,t,n)=>{const r=e._ctx;for(const i in e){if(Ht(i))continue;const n=e[i];if((0,s.mf)(n))t[i]=Wt(i,n,r);else if(null!=n){0;const e=qt(n);t[i]=()=>e}}},Yt=(e,t)=>{const n=qt(t);e.slots.default=()=>n},Qt=(e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=(0,r.IU)(t),(0,s.Nj)(t,"_",n)):Gt(t,e.slots={})}else e.slots={},t&&Yt(e,t);(0,s.Nj)(e.slots,Vn,1)},Xt=(e,t,n)=>{const{vnode:r,slots:i}=e;let o=!0,a=s.kT;if(32&r.shapeFlag){const e=t._;e?n&&1===e?o=!1:((0,s.l7)(i,t),n||1!==e||delete i._):(o=!t.$stable,Gt(t,i)),a=t}else t&&(Yt(e,t),a={default:1});if(o)for(const s in i)Ht(s)||s in a||delete i[s]};function Jt(){return{app:null,config:{isNativeTag:s.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Zt=0;function en(e,t){return function(n,r=null){(0,s.mf)(n)||(n=Object.assign({},n)),null==r||(0,s.Kn)(r)||(r=null);const i=Jt(),o=new Set;let a=!1;const c=i.app={_uid:Zt++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:zr,get config(){return i.config},set config(e){0},use(e,...t){return o.has(e)||(e&&(0,s.mf)(e.install)?(o.add(e),e.install(c,...t)):(0,s.mf)(e)&&(o.add(e),e(c,...t))),c},mixin(e){return i.mixins.includes(e)||i.mixins.push(e),c},component(e,t){return t?(i.components[e]=t,c):i.components[e]},directive(e,t){return t?(i.directives[e]=t,c):i.directives[e]},mount(s,o,l){if(!a){0;const u=Hn(n,r);return u.appContext=i,o&&t?t(u,s):e(u,s,l),a=!0,c._container=s,s.__vue_app__=c,Er(u.component)||u.component.proxy}},unmount(){a&&(e(null,c._container),delete c._container.__vue_app__)},provide(e,t){return i.provides[e]=t,c}};return c}}function tn(e,t,n,i,a=!1){if((0,s.kJ)(e))return void e.forEach(((e,r)=>tn(e,t&&((0,s.kJ)(t)?t[r]:t),n,i,a)));if(Ne(i)&&!a)return;const c=4&i.shapeFlag?Er(i.component)||i.component.proxy:i.el,l=a?null:c,{i:u,r:h}=e;const d=t&&t.r,f=u.refs===s.kT?u.refs={}:u.refs,p=u.setupState;if(null!=d&&d!==h&&((0,s.HD)(d)?(f[d]=null,(0,s.RI)(p,d)&&(p[d]=null)):(0,r.dq)(d)&&(d.value=null)),(0,s.mf)(h))o(h,u,12,[l,f]);else{const t=(0,s.HD)(h),i=(0,r.dq)(h);if(t||i){const r=()=>{if(e.f){const n=t?(0,s.RI)(p,h)?p[h]:f[h]:h.value;a?(0,s.kJ)(n)&&(0,s.Od)(n,c):(0,s.kJ)(n)?n.includes(c)||n.push(c):t?(f[h]=[c],(0,s.RI)(p,h)&&(p[h]=f[h])):(h.value=[c],e.k&&(f[e.k]=h.value))}else t?(f[h]=l,(0,s.RI)(p,h)&&(p[h]=l)):i&&(h.value=l,e.k&&(f[e.k]=l))};l?(r.id=-1,cn(r,n)):r()}else 0}}let nn=!1;const rn=e=>/svg/.test(e.namespaceURI)&&"foreignObject"!==e.tagName,sn=e=>8===e.nodeType;function on(e){const{mt:t,p:n,o:{patchProp:r,createText:i,nextSibling:o,parentNode:a,remove:c,insert:l,createComment:u}}=e,h=(e,t)=>{if(!t.hasChildNodes())return n(null,e,t),A(),void(t._vnode=e);nn=!1,d(t.firstChild,e,null,null,null),A(),t._vnode=e,nn&&console.error("Hydration completed but contains mismatches.")},d=(n,r,s,c,u,h=!1)=>{const w=sn(n)&&"["===n.data,b=()=>y(n,r,s,c,u,w),{type:v,ref:_,shapeFlag:E,patchFlag:S}=r;let k=n.nodeType;r.el=n,-2===S&&(h=!1,r.dynamicChildren=null);let I=null;switch(v){case In:3!==k?""===r.children?(l(r.el=i(""),a(n),n),I=n):I=b():(n.data!==r.children&&(nn=!0,n.data=r.children),I=o(n));break;case An:I=8!==k||w?b():o(n);break;case Tn:if(w&&(n=o(n),k=n.nodeType),1===k||3===k){I=n;const e=!r.children.length;for(let t=0;t<r.staticCount;t++)e&&(r.children+=1===I.nodeType?I.outerHTML:I.data),t===r.staticCount-1&&(r.anchor=I),I=o(I);return w?o(I):I}b();break;case kn:I=w?g(n,r,s,c,u,h):b();break;default:if(1&E)I=1!==k||r.type.toLowerCase()!==n.tagName.toLowerCase()?b():f(n,r,s,c,u,h);else if(6&E){r.slotScopeIds=u;const e=a(n);if(t(r,e,null,s,c,rn(e),h),I=w?m(n):o(n),I&&sn(I)&&"teleport end"===I.data&&(I=o(I)),Ne(r)){let t;w?(t=Hn(kn),t.anchor=I?I.previousSibling:e.lastChild):t=3===n.nodeType?Yn(""):Hn("div"),t.el=n,r.component.subTree=t}}else 64&E?I=8!==k?b():r.type.hydrate(n,r,s,c,u,h,e,p):128&E&&(I=r.type.hydrate(n,r,s,c,rn(a(n)),u,h,e,d))}return null!=_&&tn(_,null,c,r),I},f=(e,t,n,i,o,a)=>{a=a||!!t.dynamicChildren;const{type:l,props:u,patchFlag:h,shapeFlag:d,dirs:f}=t,g="input"===l&&f||"option"===l;if(g||-1!==h){if(f&&rt(t,null,n,"created"),u)if(g||!a||48&h)for(const t in u)(g&&t.endsWith("value")||(0,s.F7)(t)&&!(0,s.Gg)(t))&&r(e,t,null,u[t],!1,void 0,n);else u.onClick&&r(e,"onClick",null,u.onClick,!1,void 0,n);let l;if((l=u&&u.onVnodeBeforeMount)&&nr(l,n,t),f&&rt(t,null,n,"beforeMount"),((l=u&&u.onVnodeMounted)||f)&&ae((()=>{l&&nr(l,n,t),f&&rt(t,null,n,"mounted")}),i),16&d&&(!u||!u.innerHTML&&!u.textContent)){let r=p(e.firstChild,t,e,n,i,o,a);while(r){nn=!0;const e=r;r=r.nextSibling,c(e)}}else 8&d&&e.textContent!==t.children&&(nn=!0,e.textContent=t.children)}return e.nextSibling},p=(e,t,r,s,i,o,a)=>{a=a||!!t.dynamicChildren;const c=t.children,l=c.length;for(let u=0;u<l;u++){const t=a?c[u]:c[u]=Jn(c[u]);if(e)e=d(e,t,s,i,o,a);else{if(t.type===In&&!t.children)continue;nn=!0,n(null,t,r,null,s,i,rn(r),o)}}return e},g=(e,t,n,r,s,i)=>{const{slotScopeIds:c}=t;c&&(s=s?s.concat(c):c);const h=a(e),d=p(o(e),t,h,n,r,s,i);return d&&sn(d)&&"]"===d.data?o(t.anchor=d):(nn=!0,l(t.anchor=u("]"),h,d),d)},y=(e,t,r,s,i,l)=>{if(nn=!0,t.el=null,l){const t=m(e);while(1){const n=o(e);if(!n||n===t)break;c(n)}}const u=o(e),h=a(e);return c(e),n(null,t,h,u,r,s,rn(h),i),u},m=e=>{let t=0;while(e)if(e=o(e),e&&sn(e)&&("["===e.data&&t++,"]"===e.data)){if(0===t)return o(e);t--}return e};return[h,d]}function an(){}const cn=ae;function ln(e){return hn(e)}function un(e){return hn(e,on)}function hn(e,t){an();const n=(0,s.E9)();n.__VUE__=!0;const{insert:i,remove:o,patchProp:a,createElement:c,createText:l,createComment:u,setText:h,setElementText:d,parentNode:f,nextSibling:p,setScopeId:g=s.dG,insertStaticContent:y}=e,m=(e,t,n,r=null,s=null,i=null,o=!1,a=null,c=!!t.dynamicChildren)=>{if(e===t)return;e&&!Fn(e,t)&&(r=J(e),H(e,s,i,!0),e=null),-2===t.patchFlag&&(c=!1,t.dynamicChildren=null);const{type:l,ref:u,shapeFlag:h}=t;switch(l){case In:w(e,t,n,r);break;case An:b(e,t,n,r);break;case Tn:null==e&&v(t,n,r,o);break;case kn:L(e,t,n,r,s,i,o,a,c);break;default:1&h?T(e,t,n,r,s,i,o,a,c):6&h?x(e,t,n,r,s,i,o,a,c):(64&h||128&h)&&l.process(e,t,n,r,s,i,o,a,c,ee)}null!=u&&s&&tn(u,e&&e.ref,i,t||e,!t)},w=(e,t,n,r)=>{if(null==e)i(t.el=l(t.children),n,r);else{const n=t.el=e.el;t.children!==e.children&&h(n,t.children)}},b=(e,t,n,r)=>{null==e?i(t.el=u(t.children||""),n,r):t.el=e.el},v=(e,t,n,r)=>{[e.el,e.anchor]=y(e.children,t,n,r,e.el,e.anchor)},E=({el:e,anchor:t},n,r)=>{let s;while(e&&e!==t)s=p(e),i(e,n,r),e=s;i(t,n,r)},k=({el:e,anchor:t})=>{let n;while(e&&e!==t)n=p(e),o(e),e=n;o(t)},T=(e,t,n,r,s,i,o,a,c)=>{o=o||"svg"===t.type,null==e?R(t,n,r,s,i,o,a,c):N(e,t,s,i,o,a,c)},R=(e,t,n,r,o,l,u,h)=>{let f,p;const{type:g,props:y,shapeFlag:m,transition:w,dirs:b}=e;if(f=e.el=c(e.type,l,y&&y.is,y),8&m?d(f,e.children):16&m&&P(e.children,f,null,r,o,l&&"foreignObject"!==g,u,h),b&&rt(e,null,r,"created"),y){for(const t in y)"value"===t||(0,s.Gg)(t)||a(f,t,null,y[t],l,e.children,r,o,X);"value"in y&&a(f,"value",null,y.value),(p=y.onVnodeBeforeMount)&&nr(p,r,e)}C(f,e,e.scopeId,u,r),b&&rt(e,null,r,"beforeMount");const v=(!o||o&&!o.pendingBranch)&&w&&!w.persisted;v&&w.beforeEnter(f),i(f,t,n),((p=y&&y.onVnodeMounted)||v||b)&&cn((()=>{p&&nr(p,r,e),v&&w.enter(f),b&&rt(e,null,r,"mounted")}),o)},C=(e,t,n,r,s)=>{if(n&&g(e,n),r)for(let i=0;i<r.length;i++)g(e,r[i]);if(s){let n=s.subTree;if(t===n){const t=s.vnode;C(e,t,t.scopeId,t.slotScopeIds,s.parent)}}},P=(e,t,n,r,s,i,o,a,c=0)=>{for(let l=c;l<e.length;l++){const c=e[l]=a?Zn(e[l]):Jn(e[l]);m(null,c,t,n,r,s,i,o,a)}},N=(e,t,n,r,i,o,c)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:h,dirs:f}=t;u|=16&e.patchFlag;const p=e.props||s.kT,g=t.props||s.kT;let y;n&&dn(n,!1),(y=g.onVnodeBeforeUpdate)&&nr(y,n,t,e),f&&rt(t,e,n,"beforeUpdate"),n&&dn(n,!0);const m=i&&"foreignObject"!==t.type;if(h?O(e.dynamicChildren,h,l,n,r,m,o):c||j(e,t,l,null,n,r,m,o,!1),u>0){if(16&u)D(l,t,p,g,n,r,i);else if(2&u&&p.class!==g.class&&a(l,"class",null,g.class,i),4&u&&a(l,"style",p.style,g.style,i),8&u){const s=t.dynamicProps;for(let t=0;t<s.length;t++){const o=s[t],c=p[o],u=g[o];u===c&&"value"!==o||a(l,o,c,u,i,e.children,n,r,X)}}1&u&&e.children!==t.children&&d(l,t.children)}else c||null!=h||D(l,t,p,g,n,r,i);((y=g.onVnodeUpdated)||f)&&cn((()=>{y&&nr(y,n,t,e),f&&rt(t,e,n,"updated")}),r)},O=(e,t,n,r,s,i,o)=>{for(let a=0;a<t.length;a++){const c=e[a],l=t[a],u=c.el&&(c.type===kn||!Fn(c,l)||70&c.shapeFlag)?f(c.el):n;m(c,l,u,null,r,s,i,o,!0)}},D=(e,t,n,r,i,o,c)=>{if(n!==r){if(n!==s.kT)for(const l in n)(0,s.Gg)(l)||l in r||a(e,l,n[l],null,c,t.children,i,o,X);for(const l in r){if((0,s.Gg)(l))continue;const u=r[l],h=n[l];u!==h&&"value"!==l&&a(e,l,h,u,c,t.children,i,o,X)}"value"in r&&a(e,"value",n.value,r.value)}},L=(e,t,n,r,s,o,a,c,u)=>{const h=t.el=e?e.el:l(""),d=t.anchor=e?e.anchor:l("");let{patchFlag:f,dynamicChildren:p,slotScopeIds:g}=t;g&&(c=c?c.concat(g):g),null==e?(i(h,n,r),i(d,n,r),P(t.children,n,d,s,o,a,c,u)):f>0&&64&f&&p&&e.dynamicChildren?(O(e.dynamicChildren,p,n,s,o,a,c),(null!=t.key||s&&t===s.subTree)&&fn(e,t,!0)):j(e,t,n,d,s,o,a,c,u)},x=(e,t,n,r,s,i,o,a,c)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?s.ctx.activate(t,n,r,o,c):B(t,n,r,s,i,o,c):M(e,t,c)},B=(e,t,n,r,s,i,o)=>{const a=e.component=ir(e,r,s);if(Le(e)&&(a.ctx.renderer=ee),pr(a),a.asyncDep){if(s&&s.registerDep(a,U),!e.el){const e=a.subTree=Hn(An);b(null,e,t,n)}}else U(a,e,t,n,s,i,o)},M=(e,t,n)=>{const r=t.component=e.component;if(G(e,t,n)){if(r.asyncDep&&!r.asyncResolved)return void F(r,t,n);r.next=t,S(r.update),r.update()}else t.el=e.el,r.vnode=t},U=(e,t,n,i,o,a,c)=>{const l=()=>{if(e.isMounted){let t,{next:n,bu:r,u:i,parent:l,vnode:u}=e,h=n;0,dn(e,!1),n?(n.el=u.el,F(e,n,c)):n=u,r&&(0,s.ir)(r),(t=n.props&&n.props.onVnodeBeforeUpdate)&&nr(t,l,n,u),dn(e,!0);const d=K(e);0;const p=e.subTree;e.subTree=d,m(p,d,f(p.el),J(p),e,o,a),n.el=d.el,null===h&&Q(e,d.el),i&&cn(i,o),(t=n.props&&n.props.onVnodeUpdated)&&cn((()=>nr(t,l,n,u)),o)}else{let r;const{el:c,props:l}=t,{bm:u,m:h,parent:d}=e,f=Ne(t);if(dn(e,!1),u&&(0,s.ir)(u),!f&&(r=l&&l.onVnodeBeforeMount)&&nr(r,d,t),dn(e,!0),c&&ne){const n=()=>{e.subTree=K(e),ne(c,e.subTree,e,o,null)};f?t.type.__asyncLoader().then((()=>!e.isUnmounted&&n())):n()}else{0;const r=e.subTree=K(e);0,m(null,r,n,i,e,o,a),t.el=r.el}if(h&&cn(h,o),!f&&(r=l&&l.onVnodeMounted)){const e=t;cn((()=>nr(r,d,e)),o)}(256&t.shapeFlag||d&&Ne(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&cn(e.a,o),e.isMounted=!0,t=n=i=null}},u=e.effect=new r.qq(l,(()=>_(h)),e.scope),h=e.update=()=>u.run();h.id=e.uid,dn(e,!0),h()},F=(e,t,n)=>{t.component=e;const s=e.vnode.props;e.vnode=t,e.next=null,Mt(e,t.props,s,n),Xt(e,t.children,n),(0,r.Jd)(),I(),(0,r.lk)()},j=(e,t,n,r,s,i,o,a,c=!1)=>{const l=e&&e.children,u=e?e.shapeFlag:0,h=t.children,{patchFlag:f,shapeFlag:p}=t;if(f>0){if(128&f)return void z(l,h,n,r,s,i,o,a,c);if(256&f)return void V(l,h,n,r,s,i,o,a,c)}8&p?(16&u&&X(l,s,i),h!==l&&d(n,h)):16&u?16&p?z(l,h,n,r,s,i,o,a,c):X(l,s,i,!0):(8&u&&d(n,""),16&p&&P(h,n,r,s,i,o,a,c))},V=(e,t,n,r,i,o,a,c,l)=>{e=e||s.Z6,t=t||s.Z6;const u=e.length,h=t.length,d=Math.min(u,h);let f;for(f=0;f<d;f++){const r=t[f]=l?Zn(t[f]):Jn(t[f]);m(e[f],r,n,null,i,o,a,c,l)}u>h?X(e,i,o,!0,!1,d):P(t,n,r,i,o,a,c,l,d)},z=(e,t,n,r,i,o,a,c,l)=>{let u=0;const h=t.length;let d=e.length-1,f=h-1;while(u<=d&&u<=f){const r=e[u],s=t[u]=l?Zn(t[u]):Jn(t[u]);if(!Fn(r,s))break;m(r,s,n,null,i,o,a,c,l),u++}while(u<=d&&u<=f){const r=e[d],s=t[f]=l?Zn(t[f]):Jn(t[f]);if(!Fn(r,s))break;m(r,s,n,null,i,o,a,c,l),d--,f--}if(u>d){if(u<=f){const e=f+1,s=e<h?t[e].el:r;while(u<=f)m(null,t[u]=l?Zn(t[u]):Jn(t[u]),n,s,i,o,a,c,l),u++}}else if(u>f)while(u<=d)H(e[u],i,o,!0),u++;else{const p=u,g=u,y=new Map;for(u=g;u<=f;u++){const e=t[u]=l?Zn(t[u]):Jn(t[u]);null!=e.key&&y.set(e.key,u)}let w,b=0;const v=f-g+1;let _=!1,E=0;const S=new Array(v);for(u=0;u<v;u++)S[u]=0;for(u=p;u<=d;u++){const r=e[u];if(b>=v){H(r,i,o,!0);continue}let s;if(null!=r.key)s=y.get(r.key);else for(w=g;w<=f;w++)if(0===S[w-g]&&Fn(r,t[w])){s=w;break}void 0===s?H(r,i,o,!0):(S[s-g]=u+1,s>=E?E=s:_=!0,m(r,t[s],n,null,i,o,a,c,l),b++)}const k=_?pn(S):s.Z6;for(w=k.length-1,u=v-1;u>=0;u--){const e=g+u,s=t[e],d=e+1<h?t[e+1].el:r;0===S[u]?m(null,s,n,d,i,o,a,c,l):_&&(w<0||u!==k[w]?$(s,n,d,2):w--)}}},$=(e,t,n,r,s=null)=>{const{el:o,type:a,transition:c,children:l,shapeFlag:u}=e;if(6&u)return void $(e.component.subTree,t,n,r);if(128&u)return void e.suspense.move(t,n,r);if(64&u)return void a.move(e,t,n,ee);if(a===kn){i(o,t,n);for(let e=0;e<l.length;e++)$(l[e],t,n,r);return void i(e.anchor,t,n)}if(a===Tn)return void E(e,t,n);const h=2!==r&&1&u&&c;if(h)if(0===r)c.beforeEnter(o),i(o,t,n),cn((()=>c.enter(o)),s);else{const{leave:e,delayLeave:r,afterLeave:s}=c,a=()=>i(o,t,n),l=()=>{e(o,(()=>{a(),s&&s()}))};r?r(o,a,l):l()}else i(o,t,n)},H=(e,t,n,r=!1,s=!1)=>{const{type:i,props:o,ref:a,children:c,dynamicChildren:l,shapeFlag:u,patchFlag:h,dirs:d}=e;if(null!=a&&tn(a,null,n,e,!0),256&u)return void t.ctx.deactivate(e);const f=1&u&&d,p=!Ne(e);let g;if(p&&(g=o&&o.onVnodeBeforeUnmount)&&nr(g,t,e),6&u)Y(e.component,n,r);else{if(128&u)return void e.suspense.unmount(n,r);f&&rt(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,s,ee,r):l&&(i!==kn||h>0&&64&h)?X(l,t,n,!1,!0):(i===kn&&384&h||!s&&16&u)&&X(c,t,n),r&&q(e)}(p&&(g=o&&o.onVnodeUnmounted)||f)&&cn((()=>{g&&nr(g,t,e),f&&rt(e,null,t,"unmounted")}),n)},q=e=>{const{type:t,el:n,anchor:r,transition:s}=e;if(t===kn)return void W(n,r);if(t===Tn)return void k(e);const i=()=>{o(n),s&&!s.persisted&&s.afterLeave&&s.afterLeave()};if(1&e.shapeFlag&&s&&!s.persisted){const{leave:t,delayLeave:r}=s,o=()=>t(n,i);r?r(e.el,i,o):o()}else i()},W=(e,t)=>{let n;while(e!==t)n=p(e),o(e),e=n;o(t)},Y=(e,t,n)=>{const{bum:r,scope:i,update:o,subTree:a,um:c}=e;r&&(0,s.ir)(r),i.stop(),o&&(o.active=!1,H(a,e,t,n)),c&&cn(c,t),cn((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},X=(e,t,n,r=!1,s=!1,i=0)=>{for(let o=i;o<e.length;o++)H(e[o],t,n,r,s)},J=e=>6&e.shapeFlag?J(e.component.subTree):128&e.shapeFlag?e.suspense.next():p(e.anchor||e.el),Z=(e,t,n)=>{null==e?t._vnode&&H(t._vnode,null,null,!0):m(t._vnode||null,e,t,null,null,null,n),I(),A(),t._vnode=e},ee={p:m,um:H,m:$,r:q,mt:B,mc:P,pc:j,pbc:O,n:J,o:e};let te,ne;return t&&([te,ne]=t(ee)),{render:Z,hydrate:te,createApp:en(Z,te)}}function dn({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function fn(e,t,n=!1){const r=e.children,i=t.children;if((0,s.kJ)(r)&&(0,s.kJ)(i))for(let s=0;s<r.length;s++){const e=r[s];let t=i[s];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=i[s]=Zn(i[s]),t.el=e.el),n||fn(e,t)),t.type===In&&(t.el=e.el)}}function pn(e){const t=e.slice(),n=[0];let r,s,i,o,a;const c=e.length;for(r=0;r<c;r++){const c=e[r];if(0!==c){if(s=n[n.length-1],e[s]<c){t[r]=s,n.push(r);continue}i=0,o=n.length-1;while(i<o)a=i+o>>1,e[n[a]]<c?i=a+1:o=a;c<e[n[i]]&&(i>0&&(t[r]=n[i-1]),n[i]=r)}}i=n.length,o=n[i-1];while(i-- >0)n[i]=o,o=t[o];return n}const gn=e=>e.__isTeleport,yn=e=>e&&(e.disabled||""===e.disabled),mn=e=>"undefined"!==typeof SVGElement&&e instanceof SVGElement,wn=(e,t)=>{const n=e&&e.to;if((0,s.HD)(n)){if(t){const e=t(n);return e}return null}return n},bn={__isTeleport:!0,process(e,t,n,r,s,i,o,a,c,l){const{mc:u,pc:h,pbc:d,o:{insert:f,querySelector:p,createText:g,createComment:y}}=l,m=yn(t.props);let{shapeFlag:w,children:b,dynamicChildren:v}=t;if(null==e){const e=t.el=g(""),l=t.anchor=g("");f(e,n,r),f(l,n,r);const h=t.target=wn(t.props,p),d=t.targetAnchor=g("");h&&(f(d,h),o=o||mn(h));const y=(e,t)=>{16&w&&u(b,e,t,s,i,o,a,c)};m?y(n,l):h&&y(h,d)}else{t.el=e.el;const r=t.anchor=e.anchor,u=t.target=e.target,f=t.targetAnchor=e.targetAnchor,g=yn(e.props),y=g?n:u,w=g?r:f;if(o=o||mn(u),v?(d(e.dynamicChildren,v,y,s,i,o,a),fn(e,t,!0)):c||h(e,t,y,w,s,i,o,a,!1),m)g||vn(t,n,r,l,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const e=t.target=wn(t.props,p);e&&vn(t,e,null,l,0)}else g&&vn(t,u,f,l,1)}Sn(t)},remove(e,t,n,r,{um:s,o:{remove:i}},o){const{shapeFlag:a,children:c,anchor:l,targetAnchor:u,target:h,props:d}=e;if(h&&i(u),(o||!yn(d))&&(i(l),16&a))for(let f=0;f<c.length;f++){const e=c[f];s(e,t,n,!0,!!e.dynamicChildren)}},move:vn,hydrate:_n};function vn(e,t,n,{o:{insert:r},m:s},i=2){0===i&&r(e.targetAnchor,t,n);const{el:o,anchor:a,shapeFlag:c,children:l,props:u}=e,h=2===i;if(h&&r(o,t,n),(!h||yn(u))&&16&c)for(let d=0;d<l.length;d++)s(l[d],t,n,2);h&&r(a,t,n)}function _n(e,t,n,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:c}},l){const u=t.target=wn(t.props,c);if(u){const c=u._lpa||u.firstChild;if(16&t.shapeFlag)if(yn(t.props))t.anchor=l(o(e),t,a(e),n,r,s,i),t.targetAnchor=c;else{t.anchor=o(e);let a=c;while(a)if(a=o(a),a&&8===a.nodeType&&"teleport anchor"===a.data){t.targetAnchor=a,u._lpa=t.targetAnchor&&o(t.targetAnchor);break}l(c,t,u,n,r,s,i)}Sn(t)}return t.anchor&&o(t.anchor)}const En=bn;function Sn(e){const t=e.ctx;if(t&&t.ut){let n=e.children[0].el;while(n!==e.targetAnchor)1===n.nodeType&&n.setAttribute("data-v-owner",t.uid),n=n.nextSibling;t.ut()}}const kn=Symbol(void 0),In=Symbol(void 0),An=Symbol(void 0),Tn=Symbol(void 0),Rn=[];let Cn=null;function Pn(e=!1){Rn.push(Cn=e?null:[])}function Nn(){Rn.pop(),Cn=Rn[Rn.length-1]||null}let On,Dn=1;function Ln(e){Dn+=e}function xn(e){return e.dynamicChildren=Dn>0?Cn||s.Z6:null,Nn(),Dn>0&&Cn&&Cn.push(e),e}function Bn(e,t,n,r,s,i){return xn(Kn(e,t,n,r,s,i,!0))}function Mn(e,t,n,r,s){return xn(Hn(e,t,n,r,s,!0))}function Un(e){return!!e&&!0===e.__v_isVNode}function Fn(e,t){return e.type===t.type&&e.key===t.key}function jn(e){On=e}const Vn="__vInternal",zn=({key:e})=>null!=e?e:null,$n=({ref:e,ref_key:t,ref_for:n})=>null!=e?(0,s.HD)(e)||(0,r.dq)(e)||(0,s.mf)(e)?{i:M,r:e,k:t,f:!!n}:e:null;function Kn(e,t=null,n=null,r=0,i=null,o=(e===kn?0:1),a=!1,c=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&zn(t),ref:t&&$n(t),scopeId:U,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:M};return c?(er(l,n),128&o&&e.normalize(l)):n&&(l.shapeFlag|=(0,s.HD)(n)?8:16),Dn>0&&!a&&Cn&&(l.patchFlag>0||6&o)&&32!==l.patchFlag&&Cn.push(l),l}const Hn=qn;function qn(e,t=null,n=null,i=0,o=null,a=!1){if(e&&e!==at||(e=An),Un(e)){const r=Gn(e,t,!0);return n&&er(r,n),Dn>0&&!a&&Cn&&(6&r.shapeFlag?Cn[Cn.indexOf(e)]=r:Cn.push(r)),r.patchFlag|=-2,r}if(kr(e)&&(e=e.__vccOpts),t){t=Wn(t);let{class:e,style:n}=t;e&&!(0,s.HD)(e)&&(t.class=(0,s.C_)(e)),(0,s.Kn)(n)&&((0,r.X3)(n)&&!(0,s.kJ)(n)&&(n=(0,s.l7)({},n)),t.style=(0,s.j5)(n))}const c=(0,s.HD)(e)?1:X(e)?128:gn(e)?64:(0,s.Kn)(e)?4:(0,s.mf)(e)?2:0;return Kn(e,t,n,i,o,c,a,!0)}function Wn(e){return e?(0,r.X3)(e)||Vn in e?(0,s.l7)({},e):e:null}function Gn(e,t,n=!1){const{props:r,ref:i,patchFlag:o,children:a}=e,c=t?tr(r||{},t):r,l={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&zn(c),ref:t&&t.ref?n&&i?(0,s.kJ)(i)?i.concat($n(t)):[i,$n(t)]:$n(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==kn?-1===o?16:16|o:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Gn(e.ssContent),ssFallback:e.ssFallback&&Gn(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx};return l}function Yn(e=" ",t=0){return Hn(In,null,e,t)}function Qn(e,t){const n=Hn(Tn,null,e);return n.staticCount=t,n}function Xn(e="",t=!1){return t?(Pn(),Mn(An,null,e)):Hn(An,null,e)}function Jn(e){return null==e||"boolean"===typeof e?Hn(An):(0,s.kJ)(e)?Hn(kn,null,e.slice()):"object"===typeof e?Zn(e):Hn(In,null,String(e))}function Zn(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:Gn(e)}function er(e,t){let n=0;const{shapeFlag:r}=e;if(null==t)t=null;else if((0,s.kJ)(t))n=16;else if("object"===typeof t){if(65&r){const n=t.default;return void(n&&(n._c&&(n._d=!1),er(e,n()),n._c&&(n._d=!0)))}{n=32;const r=t._;r||Vn in t?3===r&&M&&(1===M.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=M}}else(0,s.mf)(t)?(t={default:t,_ctx:M},n=32):(t=String(t),64&r?(n=16,t=[Yn(t)]):n=8);e.children=t,e.shapeFlag|=n}function tr(...e){const t={};for(let n=0;n<e.length;n++){const r=e[n];for(const e in r)if("class"===e)t.class!==r.class&&(t.class=(0,s.C_)([t.class,r.class]));else if("style"===e)t.style=(0,s.j5)([t.style,r.style]);else if((0,s.F7)(e)){const n=t[e],i=r[e];!i||n===i||(0,s.kJ)(n)&&n.includes(i)||(t[e]=n?[].concat(n,i):i)}else""!==e&&(t[e]=r[e])}return t}function nr(e,t,n,r=null){a(e,t,7,[n,r])}const rr=Jt();let sr=0;function ir(e,t,n){const i=e.type,o=(t?t.appContext:e.appContext)||rr,a={uid:sr++,vnode:e,type:i,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new r.Bj(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:jt(i,o),emitsOptions:x(i,o),emit:null,emitted:null,propsDefaults:s.kT,inheritAttrs:i.inheritAttrs,ctx:s.kT,data:s.kT,props:s.kT,attrs:s.kT,slots:s.kT,refs:s.kT,setupState:s.kT,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=L.bind(null,a),e.ce&&e.ce(a),a}let or=null;const ar=()=>or||M,cr=e=>{or=e,e.scope.on()},lr=()=>{or&&or.scope.off(),or=null};function ur(e){return 4&e.vnode.shapeFlag}let hr,dr,fr=!1;function pr(e,t=!1){fr=t;const{props:n,children:r}=e.vnode,s=ur(e);Bt(e,n,s,t),Qt(e,r);const i=s?gr(e,t):void 0;return fr=!1,i}function gr(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=(0,r.Xl)(new Proxy(e.ctx,vt));const{setup:i}=n;if(i){const n=e.setupContext=i.length>1?_r(e):null;cr(e),(0,r.Jd)();const a=o(i,e,0,[e.props,n]);if((0,r.lk)(),lr(),(0,s.tI)(a)){if(a.then(lr,lr),t)return a.then((n=>{yr(e,n,t)})).catch((t=>{c(t,e,0)}));e.asyncDep=a}else yr(e,a,t)}else br(e,t)}function yr(e,t,n){(0,s.mf)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,s.Kn)(t)&&(e.setupState=(0,r.WL)(t)),br(e,n)}function mr(e){hr=e,dr=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,_t))}}const wr=()=>!hr;function br(e,t,n){const i=e.type;if(!e.render){if(!t&&hr&&!i.render){const t=i.template||Tt(e).template;if(t){0;const{isCustomElement:n,compilerOptions:r}=e.appContext.config,{delimiters:o,compilerOptions:a}=i,c=(0,s.l7)((0,s.l7)({isCustomElement:n,delimiters:o},r),a);i.render=hr(t,c)}}e.render=i.render||s.dG,dr&&dr(e)}cr(e),(0,r.Jd)(),St(e),(0,r.lk)(),lr()}function vr(e){return new Proxy(e.attrs,{get(t,n){return(0,r.j)(e,"get","$attrs"),t[n]}})}function _r(e){const t=t=>{e.exposed=t||{}};let n;return{get attrs(){return n||(n=vr(e))},slots:e.slots,emit:e.emit,expose:t}}function Er(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy((0,r.WL)((0,r.Xl)(e.exposed)),{get(t,n){return n in t?t[n]:n in wt?wt[n](e):void 0},has(e,t){return t in e||t in wt}}))}function Sr(e,t=!0){return(0,s.mf)(e)?e.displayName||e.name:e.name||t&&e.__name}function kr(e){return(0,s.mf)(e)&&"__vccOpts"in e}const Ir=(e,t)=>(0,r.Fl)(e,t,fr);function Ar(){return null}function Tr(){return null}function Rr(e){0}function Cr(e,t){return null}function Pr(){return Or().slots}function Nr(){return Or().attrs}function Or(){const e=ar();return e.setupContext||(e.setupContext=_r(e))}function Dr(e,t){const n=(0,s.kJ)(e)?e.reduce(((e,t)=>(e[t]={},e)),{}):e;for(const r in t){const e=n[r];e?(0,s.kJ)(e)||(0,s.mf)(e)?n[r]={type:e,default:t[r]}:e.default=t[r]:null===e&&(n[r]={default:t[r]})}return n}function Lr(e,t){const n={};for(const r in e)t.includes(r)||Object.defineProperty(n,r,{enumerable:!0,get:()=>e[r]});return n}function xr(e){const t=ar();let n=e();return lr(),(0,s.tI)(n)&&(n=n.catch((e=>{throw cr(t),e}))),[n,()=>cr(t)]}function Br(e,t,n){const r=arguments.length;return 2===r?(0,s.Kn)(t)&&!(0,s.kJ)(t)?Un(t)?Hn(e,null,[t]):Hn(e,t):Hn(e,null,t):(r>3?n=Array.prototype.slice.call(arguments,2):3===r&&Un(n)&&(n=[n]),Hn(e,t,n))}const Mr=Symbol(""),Ur=()=>{{const e=ue(Mr);return e}};function Fr(){return void 0}function jr(e,t,n,r){const s=n[r];if(s&&Vr(s,e))return s;const i=t();return i.memo=e.slice(),n[r]=i}function Vr(e,t){const n=e.memo;if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if((0,s.aU)(n[r],t[r]))return!1;return Dn>0&&Cn&&Cn.push(e),!0}const zr="3.2.45",$r={createComponentInstance:ir,setupComponent:pr,renderComponentRoot:K,setCurrentRenderingInstance:F,isVNode:Un,normalizeVNode:Jn},Kr=$r,Hr=null,qr=null},9242:function(e,t,n){"use strict";n.d(t,{$d:function(){return s.$d},$y:function(){return s.$y},Ah:function(){return L},B:function(){return s.B},BK:function(){return s.BK},Bj:function(){return s.Bj},Bz:function(){return s.Bz},C3:function(){return s.C3},C_:function(){return s.C_},Cn:function(){return s.Cn},D2:function(){return De},EB:function(){return s.EB},Eo:function(){return s.Eo},F4:function(){return s.F4},F8:function(){return Le},FN:function(){return s.FN},Fl:function(){return s.Fl},G:function(){return s.G},G2:function(){return ve},HX:function(){return s.HX},HY:function(){return s.HY},Ho:function(){return s.Ho},IU:function(){return s.IU},JJ:function(){return s.JJ},Jd:function(){return s.Jd},KU:function(){return s.KU},Ko:function(){return s.Ko},LL:function(){return s.LL},MW:function(){return D},MX:function(){return s.MX},Mr:function(){return s.Mr},Nd:function(){return Ge},Nv:function(){return s.Nv},OT:function(){return s.OT},Ob:function(){return s.Ob},P$:function(){return s.P$},PG:function(){return s.PG},Q2:function(){return s.Q2},Q6:function(){return s.Q6},RC:function(){return s.RC},Rh:function(){return s.Rh},Rr:function(){return s.Rr},S3:function(){return s.S3},SK:function(){return s.Ah},SU:function(){return s.SU},U2:function(){return s.U2},Uc:function(){return s.Uc},Uk:function(){return s.Uk},Um:function(){return s.Um},Us:function(){return s.Us},Vh:function(){return s.Vh},W3:function(){return le},WI:function(){return s.WI},WL:function(){return s.WL},WY:function(){return s.WY},Wm:function(){return s.Wm},X3:function(){return s.X3},XI:function(){return s.XI},Xl:function(){return s.Xl},Xn:function(){return s.Xn},Y1:function(){return s.Y1},Y3:function(){return s.Y3},Y8:function(){return s.Y8},YP:function(){return s.YP},YS:function(){return s.YS},YZ:function(){return Ie},Yq:function(){return s.Yq},ZB:function(){return $e},ZK:function(){return s.ZK},ZM:function(){return s.ZM},Zq:function(){return s.Zq},_:function(){return s._},_A:function(){return s._A},a2:function(){return B},aZ:function(){return s.aZ},b9:function(){return s.b9},bM:function(){return _e},bT:function(){return s.bT},bv:function(){return s.bv},cE:function(){return s.cE},d1:function(){return s.d1},dD:function(){return s.dD},dG:function(){return s.dG},dl:function(){return s.dl},dq:function(){return s.dq},e8:function(){return we},ec:function(){return s.ec},eq:function(){return s.eq},f3:function(){return s.f3},fb:function(){return M},h:function(){return s.h},hR:function(){return s.hR},i8:function(){return s.i8},iD:function(){return s.iD},iH:function(){return s.iH},iM:function(){return Ne},ic:function(){return s.ic},j4:function(){return s.j4},j5:function(){return s.j5},kC:function(){return s.kC},kq:function(){return s.kq},l1:function(){return s.l1},lA:function(){return s.lA},lR:function(){return s.lR},m0:function(){return s.m0},mW:function(){return s.mW},mv:function(){return s.mv},mx:function(){return s.mx},n4:function(){return s.n4},nK:function(){return s.nK},nQ:function(){return s.nQ},nZ:function(){return s.nZ},nr:function(){return me},oR:function(){return s.oR},of:function(){return s.of},p1:function(){return s.p1},qG:function(){return s.qG},qZ:function(){return s.qZ},qb:function(){return s.qb},qj:function(){return s.qj},qq:function(){return s.qq},ri:function(){return Ke},ry:function(){return s.ry},sT:function(){return s.sT},sY:function(){return ze},se:function(){return s.se},sj:function(){return U},sv:function(){return s.sv},uE:function(){return s.uE},uT:function(){return $},u_:function(){return s.u_},up:function(){return s.up},vl:function(){return s.vl},vr:function(){return He},vs:function(){return s.vs},w5:function(){return s.w5},wF:function(){return s.wF},wg:function(){return s.wg},wy:function(){return s.wy},xv:function(){return s.xv},yT:function(){return s.yT},yX:function(){return s.yX},yb:function(){return s.MW},zw:function(){return s.zw}});n(7658);var r=n(7139),s=n(3396),i=n(4870);const o="http://www.w3.org/2000/svg",a="undefined"!==typeof document?document:null,c=a&&a.createElement("template"),l={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,r)=>{const s=t?a.createElementNS(o,e):a.createElement(e,n?{is:n}:void 0);return"select"===e&&r&&null!=r.multiple&&s.setAttribute("multiple",r.multiple),s},createText:e=>a.createTextNode(e),createComment:e=>a.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>a.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,r,s,i){const o=n?n.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling)){while(1)if(t.insertBefore(s.cloneNode(!0),n),s===i||!(s=s.nextSibling))break}else{c.innerHTML=r?`<svg>${e}</svg>`:e;const s=c.content;if(r){const e=s.firstChild;while(e.firstChild)s.appendChild(e.firstChild);s.removeChild(e)}t.insertBefore(s,n)}return[o?o.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function u(e,t,n){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function h(e,t,n){const s=e.style,i=(0,r.HD)(n);if(n&&!i){for(const e in n)f(s,e,n[e]);if(t&&!(0,r.HD)(t))for(const e in t)null==n[e]&&f(s,e,"")}else{const r=s.display;i?t!==n&&(s.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(s.display=r)}}const d=/\s*!important$/;function f(e,t,n){if((0,r.kJ)(n))n.forEach((n=>f(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=y(e,t);d.test(n)?e.setProperty((0,r.rs)(s),n.replace(d,""),"important"):e[s]=n}}const p=["Webkit","Moz","ms"],g={};function y(e,t){const n=g[t];if(n)return n;let s=(0,r._A)(t);if("filter"!==s&&s in e)return g[t]=s;s=(0,r.kC)(s);for(let r=0;r<p.length;r++){const n=p[r]+s;if(n in e)return g[t]=n}return t}const m="http://www.w3.org/1999/xlink";function w(e,t,n,s,i){if(s&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(m,t.slice(6,t.length)):e.setAttributeNS(m,t,n);else{const s=(0,r.Pq)(t);null==n||s&&!(0,r.yA)(n)?e.removeAttribute(t):e.setAttribute(t,s?"":n)}}function b(e,t,n,s,i,o,a){if("innerHTML"===t||"textContent"===t)return s&&a(s,i,o),void(e[t]=null==n?"":n);if("value"===t&&"PROGRESS"!==e.tagName&&!e.tagName.includes("-")){e._value=n;const r=null==n?"":n;return e.value===r&&"OPTION"!==e.tagName||(e.value=r),void(null==n&&e.removeAttribute(t))}let c=!1;if(""===n||null==n){const s=typeof e[t];"boolean"===s?n=(0,r.yA)(n):null==n&&"string"===s?(n="",c=!0):"number"===s&&(n=0,c=!0)}try{e[t]=n}catch(l){0}c&&e.removeAttribute(t)}function v(e,t,n,r){e.addEventListener(t,n,r)}function _(e,t,n,r){e.removeEventListener(t,n,r)}function E(e,t,n,r,s=null){const i=e._vei||(e._vei={}),o=i[t];if(r&&o)o.value=r;else{const[n,a]=k(t);if(r){const o=i[t]=R(r,s);v(e,n,o,a)}else o&&(_(e,n,o,a),i[t]=void 0)}}const S=/(?:Once|Passive|Capture)$/;function k(e){let t;if(S.test(e)){let n;t={};while(n=e.match(S))e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):(0,r.rs)(e.slice(2));return[n,t]}let I=0;const A=Promise.resolve(),T=()=>I||(A.then((()=>I=0)),I=Date.now());function R(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();(0,s.$d)(C(e,n.value),t,5,[e])};return n.value=e,n.attached=T(),n}function C(e,t){if((0,r.kJ)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}const P=/^on[a-z]/,N=(e,t,n,s,i=!1,o,a,c,l)=>{"class"===t?u(e,s,i):"style"===t?h(e,n,s):(0,r.F7)(t)?(0,r.tR)(t)||E(e,t,n,s,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):O(e,t,s,i))?b(e,t,s,o,a,c,l):("true-value"===t?e._trueValue=s:"false-value"===t&&(e._falseValue=s),w(e,t,s,i))};function O(e,t,n,s){return s?"innerHTML"===t||"textContent"===t||!!(t in e&&P.test(t)&&(0,r.mf)(n)):"spellcheck"!==t&&"draggable"!==t&&"translate"!==t&&("form"!==t&&(("list"!==t||"INPUT"!==e.tagName)&&(("type"!==t||"TEXTAREA"!==e.tagName)&&((!P.test(t)||!(0,r.HD)(n))&&t in e))))}function D(e,t){const n=(0,s.aZ)(e);class r extends B{constructor(e){super(n,e,t)}}return r.def=n,r}const L=e=>D(e,$e),x="undefined"!==typeof HTMLElement?HTMLElement:class{};class B extends x{constructor(e,t={},n){super(),this._def=e,this._props=t,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&n?n(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,(0,s.Y3)((()=>{this._connected||(ze(null,this.shadowRoot),this._instance=null)}))}_resolveDef(){this._resolved=!0;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);new MutationObserver((e=>{for(const t of e)this._setAttr(t.attributeName)})).observe(this,{attributes:!0});const e=(e,t=!1)=>{const{props:n,styles:s}=e;let i;if(n&&!(0,r.kJ)(n))for(const o in n){const e=n[o];(e===Number||e&&e.type===Number)&&(o in this._props&&(this._props[o]=(0,r.He)(this._props[o])),(i||(i=Object.create(null)))[(0,r._A)(o)]=!0)}this._numberProps=i,t&&this._resolveProps(e),this._applyStyles(s),this._update()},t=this._def.__asyncLoader;t?t().then((t=>e(t,!0))):e(this._def)}_resolveProps(e){const{props:t}=e,n=(0,r.kJ)(t)?t:Object.keys(t||{});for(const r of Object.keys(this))"_"!==r[0]&&n.includes(r)&&this._setProp(r,this[r],!0,!1);for(const s of n.map(r._A))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(e){this._setProp(s,e)}})}_setAttr(e){let t=this.getAttribute(e);const n=(0,r._A)(e);this._numberProps&&this._numberProps[n]&&(t=(0,r.He)(t)),this._setProp(n,t,!1)}_getProp(e){return this._props[e]}_setProp(e,t,n=!0,s=!0){t!==this._props[e]&&(this._props[e]=t,s&&this._instance&&this._update(),n&&(!0===t?this.setAttribute((0,r.rs)(e),""):"string"===typeof t||"number"===typeof t?this.setAttribute((0,r.rs)(e),t+""):t||this.removeAttribute((0,r.rs)(e))))}_update(){ze(this._createVNode(),this.shadowRoot)}_createVNode(){const e=(0,s.Wm)(this._def,(0,r.l7)({},this._props));return this._instance||(e.ce=e=>{this._instance=e,e.isCE=!0;const t=(e,t)=>{this.dispatchEvent(new CustomEvent(e,{detail:t}))};e.emit=(e,...n)=>{t(e,n),(0,r.rs)(e)!==e&&t((0,r.rs)(e),n)};let n=this;while(n=n&&(n.parentNode||n.host))if(n instanceof B){e.parent=n._instance,e.provides=n._instance.provides;break}}),e}_applyStyles(e){e&&e.forEach((e=>{const t=document.createElement("style");t.textContent=e,this.shadowRoot.appendChild(t)}))}}function M(e="$style"){{const t=(0,s.FN)();if(!t)return r.kT;const n=t.type.__cssModules;if(!n)return r.kT;const i=n[e];return i||r.kT}}function U(e){const t=(0,s.FN)();if(!t)return;const n=t.ut=(n=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach((e=>j(e,n)))},r=()=>{const r=e(t.proxy);F(t.subTree,r),n(r)};(0,s.Rh)(r),(0,s.bv)((()=>{const e=new MutationObserver(r);e.observe(t.subTree.el.parentNode,{childList:!0}),(0,s.Ah)((()=>e.disconnect()))}))}function F(e,t){if(128&e.shapeFlag){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push((()=>{F(n.activeBranch,t)}))}while(e.component)e=e.component.subTree;if(1&e.shapeFlag&&e.el)j(e.el,t);else if(e.type===s.HY)e.children.forEach((e=>F(e,t)));else if(e.type===s.qG){let{el:n,anchor:r}=e;while(n){if(j(n,t),n===r)break;n=n.nextSibling}}}function j(e,t){if(1===e.nodeType){const n=e.style;for(const e in t)n.setProperty(`--${e}`,t[e])}}const V="transition",z="animation",$=(e,{slots:t})=>(0,s.h)(s.P$,G(e),t);$.displayName="Transition";const K={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},H=$.props=(0,r.l7)({},s.P$.props,K),q=(e,t=[])=>{(0,r.kJ)(e)?e.forEach((e=>e(...t))):e&&e(...t)},W=e=>!!e&&((0,r.kJ)(e)?e.some((e=>e.length>1)):e.length>1);function G(e){const t={};for(const r in e)r in K||(t[r]=e[r]);if(!1===e.css)return t;const{name:n="v",type:s,duration:i,enterFromClass:o=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:c=`${n}-enter-to`,appearFromClass:l=o,appearActiveClass:u=a,appearToClass:h=c,leaveFromClass:d=`${n}-leave-from`,leaveActiveClass:f=`${n}-leave-active`,leaveToClass:p=`${n}-leave-to`}=e,g=Y(i),y=g&&g[0],m=g&&g[1],{onBeforeEnter:w,onEnter:b,onEnterCancelled:v,onLeave:_,onLeaveCancelled:E,onBeforeAppear:S=w,onAppear:k=b,onAppearCancelled:I=v}=t,A=(e,t,n)=>{J(e,t?h:c),J(e,t?u:a),n&&n()},T=(e,t)=>{e._isLeaving=!1,J(e,d),J(e,p),J(e,f),t&&t()},R=e=>(t,n)=>{const r=e?k:b,i=()=>A(t,e,n);q(r,[t,i]),Z((()=>{J(t,e?l:o),X(t,e?h:c),W(r)||te(t,s,y,i)}))};return(0,r.l7)(t,{onBeforeEnter(e){q(w,[e]),X(e,o),X(e,a)},onBeforeAppear(e){q(S,[e]),X(e,l),X(e,u)},onEnter:R(!1),onAppear:R(!0),onLeave(e,t){e._isLeaving=!0;const n=()=>T(e,t);X(e,d),ie(),X(e,f),Z((()=>{e._isLeaving&&(J(e,d),X(e,p),W(_)||te(e,s,m,n))})),q(_,[e,n])},onEnterCancelled(e){A(e,!1),q(v,[e])},onAppearCancelled(e){A(e,!0),q(I,[e])},onLeaveCancelled(e){T(e),q(E,[e])}})}function Y(e){if(null==e)return null;if((0,r.Kn)(e))return[Q(e.enter),Q(e.leave)];{const t=Q(e);return[t,t]}}function Q(e){const t=(0,r.He)(e);return t}function X(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.add(t))),(e._vtc||(e._vtc=new Set)).add(t)}function J(e,t){t.split(/\s+/).forEach((t=>t&&e.classList.remove(t)));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function Z(e){requestAnimationFrame((()=>{requestAnimationFrame(e)}))}let ee=0;function te(e,t,n,r){const s=e._endId=++ee,i=()=>{s===e._endId&&r()};if(n)return setTimeout(i,n);const{type:o,timeout:a,propCount:c}=ne(e,t);if(!o)return r();const l=o+"end";let u=0;const h=()=>{e.removeEventListener(l,d),i()},d=t=>{t.target===e&&++u>=c&&h()};setTimeout((()=>{u<c&&h()}),a+1),e.addEventListener(l,d)}function ne(e,t){const n=window.getComputedStyle(e),r=e=>(n[e]||"").split(", "),s=r(`${V}Delay`),i=r(`${V}Duration`),o=re(s,i),a=r(`${z}Delay`),c=r(`${z}Duration`),l=re(a,c);let u=null,h=0,d=0;t===V?o>0&&(u=V,h=o,d=i.length):t===z?l>0&&(u=z,h=l,d=c.length):(h=Math.max(o,l),u=h>0?o>l?V:z:null,d=u?u===V?i.length:c.length:0);const f=u===V&&/\b(transform|all)(,|$)/.test(r(`${V}Property`).toString());return{type:u,timeout:h,propCount:d,hasTransform:f}}function re(e,t){while(e.length<t.length)e=e.concat(e);return Math.max(...t.map(((t,n)=>se(t)+se(e[n]))))}function se(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function ie(){return document.body.offsetHeight}const oe=new WeakMap,ae=new WeakMap,ce={name:"TransitionGroup",props:(0,r.l7)({},H,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=(0,s.FN)(),r=(0,s.Y8)();let o,a;return(0,s.ic)((()=>{if(!o.length)return;const t=e.moveClass||`${e.name||"v"}-move`;if(!fe(o[0].el,n.vnode.el,t))return;o.forEach(ue),o.forEach(he);const r=o.filter(de);ie(),r.forEach((e=>{const n=e.el,r=n.style;X(n,t),r.transform=r.webkitTransform=r.transitionDuration="";const s=n._moveCb=e=>{e&&e.target!==n||e&&!/transform$/.test(e.propertyName)||(n.removeEventListener("transitionend",s),n._moveCb=null,J(n,t))};n.addEventListener("transitionend",s)}))})),()=>{const c=(0,i.IU)(e),l=G(c);let u=c.tag||s.HY;o=a,a=t.default?(0,s.Q6)(t.default()):[];for(let e=0;e<a.length;e++){const t=a[e];null!=t.key&&(0,s.nK)(t,(0,s.U2)(t,l,r,n))}if(o)for(let e=0;e<o.length;e++){const t=o[e];(0,s.nK)(t,(0,s.U2)(t,l,r,n)),oe.set(t,t.el.getBoundingClientRect())}return(0,s.Wm)(u,null,a)}}},le=ce;function ue(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function he(e){ae.set(e,e.el.getBoundingClientRect())}function de(e){const t=oe.get(e),n=ae.get(e),r=t.left-n.left,s=t.top-n.top;if(r||s){const t=e.el.style;return t.transform=t.webkitTransform=`translate(${r}px,${s}px)`,t.transitionDuration="0s",e}}function fe(e,t,n){const r=e.cloneNode();e._vtc&&e._vtc.forEach((e=>{e.split(/\s+/).forEach((e=>e&&r.classList.remove(e)))})),n.split(/\s+/).forEach((e=>e&&r.classList.add(e))),r.style.display="none";const s=1===t.nodeType?t:t.parentNode;s.appendChild(r);const{hasTransform:i}=ne(r);return s.removeChild(r),i}const pe=e=>{const t=e.props["onUpdate:modelValue"]||!1;return(0,r.kJ)(t)?e=>(0,r.ir)(t,e):t};function ge(e){e.target.composing=!0}function ye(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const me={created(e,{modifiers:{lazy:t,trim:n,number:s}},i){e._assign=pe(i);const o=s||i.props&&"number"===i.props.type;v(e,t?"change":"input",(t=>{if(t.target.composing)return;let s=e.value;n&&(s=s.trim()),o&&(s=(0,r.He)(s)),e._assign(s)})),n&&v(e,"change",(()=>{e.value=e.value.trim()})),t||(v(e,"compositionstart",ge),v(e,"compositionend",ye),v(e,"change",ye))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:s,number:i}},o){if(e._assign=pe(o),e.composing)return;if(document.activeElement===e&&"range"!==e.type){if(n)return;if(s&&e.value.trim()===t)return;if((i||"number"===e.type)&&(0,r.He)(e.value)===t)return}const a=null==t?"":t;e.value!==a&&(e.value=a)}},we={deep:!0,created(e,t,n){e._assign=pe(n),v(e,"change",(()=>{const t=e._modelValue,n=Se(e),s=e.checked,i=e._assign;if((0,r.kJ)(t)){const e=(0,r.hq)(t,n),o=-1!==e;if(s&&!o)i(t.concat(n));else if(!s&&o){const n=[...t];n.splice(e,1),i(n)}}else if((0,r.DM)(t)){const e=new Set(t);s?e.add(n):e.delete(n),i(e)}else i(ke(e,s))}))},mounted:be,beforeUpdate(e,t,n){e._assign=pe(n),be(e,t,n)}};function be(e,{value:t,oldValue:n},s){e._modelValue=t,(0,r.kJ)(t)?e.checked=(0,r.hq)(t,s.props.value)>-1:(0,r.DM)(t)?e.checked=t.has(s.props.value):t!==n&&(e.checked=(0,r.WV)(t,ke(e,!0)))}const ve={created(e,{value:t},n){e.checked=(0,r.WV)(t,n.props.value),e._assign=pe(n),v(e,"change",(()=>{e._assign(Se(e))}))},beforeUpdate(e,{value:t,oldValue:n},s){e._assign=pe(s),t!==n&&(e.checked=(0,r.WV)(t,s.props.value))}},_e={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const i=(0,r.DM)(t);v(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>n?(0,r.He)(Se(e)):Se(e)));e._assign(e.multiple?i?new Set(t):t:t[0])})),e._assign=pe(s)},mounted(e,{value:t}){Ee(e,t)},beforeUpdate(e,t,n){e._assign=pe(n)},updated(e,{value:t}){Ee(e,t)}};function Ee(e,t){const n=e.multiple;if(!n||(0,r.kJ)(t)||(0,r.DM)(t)){for(let s=0,i=e.options.length;s<i;s++){const i=e.options[s],o=Se(i);if(n)(0,r.kJ)(t)?i.selected=(0,r.hq)(t,o)>-1:i.selected=t.has(o);else if((0,r.WV)(Se(i),t))return void(e.selectedIndex!==s&&(e.selectedIndex=s))}n||-1===e.selectedIndex||(e.selectedIndex=-1)}}function Se(e){return"_value"in e?e._value:e.value}function ke(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const Ie={created(e,t,n){Te(e,t,n,null,"created")},mounted(e,t,n){Te(e,t,n,null,"mounted")},beforeUpdate(e,t,n,r){Te(e,t,n,r,"beforeUpdate")},updated(e,t,n,r){Te(e,t,n,r,"updated")}};function Ae(e,t){switch(e){case"SELECT":return _e;case"TEXTAREA":return me;default:switch(t){case"checkbox":return we;case"radio":return ve;default:return me}}}function Te(e,t,n,r,s){const i=Ae(e.tagName,n.props&&n.props.type),o=i[s];o&&o(e,t,n,r)}function Re(){me.getSSRProps=({value:e})=>({value:e}),ve.getSSRProps=({value:e},t)=>{if(t.props&&(0,r.WV)(t.props.value,e))return{checked:!0}},we.getSSRProps=({value:e},t)=>{if((0,r.kJ)(e)){if(t.props&&(0,r.hq)(e,t.props.value)>-1)return{checked:!0}}else if((0,r.DM)(e)){if(t.props&&e.has(t.props.value))return{checked:!0}}else if(e)return{checked:!0}},Ie.getSSRProps=(e,t)=>{if("string"!==typeof t.type)return;const n=Ae(t.type.toUpperCase(),t.props&&t.props.type);return n.getSSRProps?n.getSSRProps(e,t):void 0}}const Ce=["ctrl","shift","alt","meta"],Pe={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>Ce.some((n=>e[`${n}Key`]&&!t.includes(n)))},Ne=(e,t)=>(n,...r)=>{for(let e=0;e<t.length;e++){const r=Pe[t[e]];if(r&&r(n,t))return}return e(n,...r)},Oe={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},De=(e,t)=>n=>{if(!("key"in n))return;const s=(0,r.rs)(n.key);return t.some((e=>e===s||Oe[e]===s))?e(n):void 0},Le={beforeMount(e,{value:t},{transition:n}){e._vod="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):xe(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:r}){!t!==!n&&(r?t?(r.beforeEnter(e),xe(e,!0),r.enter(e)):r.leave(e,(()=>{xe(e,!1)})):xe(e,t))},beforeUnmount(e,{value:t}){xe(e,t)}};function xe(e,t){e.style.display=t?e._vod:"none"}function Be(){Le.getSSRProps=({value:e})=>{if(!e)return{style:{display:"none"}}}}const Me=(0,r.l7)({patchProp:N},l);let Ue,Fe=!1;function je(){return Ue||(Ue=(0,s.Us)(Me))}function Ve(){return Ue=Fe?Ue:(0,s.Eo)(Me),Fe=!0,Ue}const ze=(...e)=>{je().render(...e)},$e=(...e)=>{Ve().hydrate(...e)},Ke=(...e)=>{const t=je().createApp(...e);const{mount:n}=t;return t.mount=e=>{const s=qe(e);if(!s)return;const i=t._component;(0,r.mf)(i)||i.render||i.template||(i.template=s.innerHTML),s.innerHTML="";const o=n(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t},He=(...e)=>{const t=Ve().createApp(...e);const{mount:n}=t;return t.mount=e=>{const t=qe(e);if(t)return n(t,!0,t instanceof SVGElement)},t};function qe(e){if((0,r.HD)(e)){const t=document.querySelector(e);return t}return e}let We=!1;const Ge=()=>{We||(We=!0,Re(),Be())}},7139:function(e,t,n){"use strict";n.d(t,{C_:function(){return h},DM:function(){return L},E9:function(){return ie},F7:function(){return A},Gg:function(){return q},HD:function(){return M},He:function(){return re},Kn:function(){return F},NO:function(){return k},Nj:function(){return ne},Od:function(){return C},PO:function(){return K},Pq:function(){return p},RI:function(){return N},S0:function(){return H},W7:function(){return $},WV:function(){return m},Z6:function(){return E},_A:function(){return Y},_N:function(){return D},aU:function(){return ee},dG:function(){return S},e1:function(){return i},fY:function(){return r},hR:function(){return Z},hq:function(){return w},ir:function(){return te},j5:function(){return o},kC:function(){return J},kJ:function(){return O},kT:function(){return _},l7:function(){return R},mf:function(){return B},rs:function(){return X},tI:function(){return j},tR:function(){return T},vs:function(){return d},yA:function(){return g},yk:function(){return U},zw:function(){return b}});n(7658);function r(e,t){const n=Object.create(null),r=e.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}const s="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt",i=r(s);function o(e){if(O(e)){const t={};for(let n=0;n<e.length;n++){const r=e[n],s=M(r)?u(r):o(r);if(s)for(const e in s)t[e]=s[e]}return t}return M(e)||F(e)?e:void 0}const a=/;(?![^(]*\))/g,c=/:([^]+)/,l=/\/\*.*?\*\//gs;function u(e){const t={};return e.replace(l,"").split(a).forEach((e=>{if(e){const n=e.split(c);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function h(e){let t="";if(M(e))t=e;else if(O(e))for(let n=0;n<e.length;n++){const r=h(e[n]);r&&(t+=r+" ")}else if(F(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function d(e){if(!e)return null;let{class:t,style:n}=e;return t&&!M(t)&&(e.class=h(t)),n&&(e.style=o(n)),e}const f="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",p=r(f);function g(e){return!!e||""===e}function y(e,t){if(e.length!==t.length)return!1;let n=!0;for(let r=0;n&&r<e.length;r++)n=m(e[r],t[r]);return n}function m(e,t){if(e===t)return!0;let n=x(e),r=x(t);if(n||r)return!(!n||!r)&&e.getTime()===t.getTime();if(n=U(e),r=U(t),n||r)return e===t;if(n=O(e),r=O(t),n||r)return!(!n||!r)&&y(e,t);if(n=F(e),r=F(t),n||r){if(!n||!r)return!1;const s=Object.keys(e).length,i=Object.keys(t).length;if(s!==i)return!1;for(const n in e){const r=e.hasOwnProperty(n),s=t.hasOwnProperty(n);if(r&&!s||!r&&s||!m(e[n],t[n]))return!1}}return String(e)===String(t)}function w(e,t){return e.findIndex((e=>m(e,t)))}const b=e=>M(e)?e:null==e?"":O(e)||F(e)&&(e.toString===V||!B(e.toString))?JSON.stringify(e,v,2):String(e),v=(e,t)=>t&&t.__v_isRef?v(e,t.value):D(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n])=>(e[`${t} =>`]=n,e)),{})}:L(t)?{[`Set(${t.size})`]:[...t.values()]}:!F(t)||O(t)||K(t)?t:String(t),_={},E=[],S=()=>{},k=()=>!1,I=/^on[^a-z]/,A=e=>I.test(e),T=e=>e.startsWith("onUpdate:"),R=Object.assign,C=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},P=Object.prototype.hasOwnProperty,N=(e,t)=>P.call(e,t),O=Array.isArray,D=e=>"[object Map]"===z(e),L=e=>"[object Set]"===z(e),x=e=>"[object Date]"===z(e),B=e=>"function"===typeof e,M=e=>"string"===typeof e,U=e=>"symbol"===typeof e,F=e=>null!==e&&"object"===typeof e,j=e=>F(e)&&B(e.then)&&B(e.catch),V=Object.prototype.toString,z=e=>V.call(e),$=e=>z(e).slice(8,-1),K=e=>"[object Object]"===z(e),H=e=>M(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,q=r(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),W=e=>{const t=Object.create(null);return n=>{const r=t[n];return r||(t[n]=e(n))}},G=/-(\w)/g,Y=W((e=>e.replace(G,((e,t)=>t?t.toUpperCase():"")))),Q=/\B([A-Z])/g,X=W((e=>e.replace(Q,"-$1").toLowerCase())),J=W((e=>e.charAt(0).toUpperCase()+e.slice(1))),Z=W((e=>e?`on${J(e)}`:"")),ee=(e,t)=>!Object.is(e,t),te=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},ne=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},re=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let se;const ie=()=>se||(se="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{})},7081:function(e,t,n){"use strict";n(7658);const{fromCallback:r}=n(8078),s=n(4334),{getCallback:i,getOptions:o}=n(6001),a=Symbol("promise"),c=Symbol("status"),l=Symbol("operations"),u=Symbol("finishClose"),h=Symbol("closeCallbacks");class d{constructor(e){if("object"!==typeof e||null===e){const t=null===e?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[l]=[],this[h]=[],this[c]="open",this[u]=this[u].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[l].length}put(e,t,n){if("open"!==this[c])throw new s("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(e)||this.db._checkValue(t);if(r)throw r;const i=n&&null!=n.sublevel?n.sublevel:this.db,o=n,a=i.keyEncoding(n&&n.keyEncoding),u=i.valueEncoding(n&&n.valueEncoding),h=a.format;n={...n,keyEncoding:h,valueEncoding:u.format},i!==this.db&&(n.sublevel=null);const d=i.prefixKey(a.encode(e),h),f=u.encode(t);return this._put(d,f,n),this[l].push({...o,type:"put",key:e,value:t}),this}_put(e,t,n){}del(e,t){if("open"!==this[c])throw new s("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e);if(n)throw n;const r=t&&null!=t.sublevel?t.sublevel:this.db,i=t,o=r.keyEncoding(t&&t.keyEncoding),a=o.format;return t={...t,keyEncoding:a},r!==this.db&&(t.sublevel=null),this._del(r.prefixKey(o.encode(e),a),t),this[l].push({...i,type:"del",key:e}),this}_del(e,t){}clear(){if("open"!==this[c])throw new s("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[l]=[],this}_clear(){}write(e,t){return t=i(e,t),t=r(t,a),e=o(e),"open"!==this[c]?this.nextTick(t,new s("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(t):(this[c]="writing",this._write(e,(e=>{this[c]="closing",this[h].push((()=>t(e))),e||this.db.emit("batch",this[l]),this._close(this[u])}))),t[a]}_write(e,t){}close(e){return e=r(e,a),"closing"===this[c]?this[h].push(e):"closed"===this[c]?this.nextTick(e):(this[h].push(e),"writing"!==this[c]&&(this[c]="closing",this._close(this[u]))),e[a]}_close(e){this.nextTick(e)}[u](){this[c]="closed",this.db.detachResource(this);const e=this[h];this[h]=[];for(const t of e)t()}}t.AbstractChainedBatch=d},5965:function(e,t,n){"use strict";n(7658);const{fromCallback:r}=n(8078),s=n(4334),{getOptions:i,getCallback:o}=n(6001),a=Symbol("promise"),c=Symbol("callback"),l=Symbol("working"),u=Symbol("handleOne"),h=Symbol("handleMany"),d=Symbol("autoClose"),f=Symbol("finishWork"),p=Symbol("returnMany"),g=Symbol("closing"),y=Symbol("handleClose"),m=Symbol("closed"),w=Symbol("closeCallbacks"),b=Symbol("keyEncoding"),v=Symbol("valueEncoding"),_=Symbol("abortOnClose"),E=Symbol("legacy"),S=Symbol("keys"),k=Symbol("values"),I=Symbol("limit"),A=Symbol("count"),T=Object.freeze({}),R=()=>{};let C=!1;class P{constructor(e,t,n){if("object"!==typeof e||null===e){const t=null===e?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}if("object"!==typeof t||null===t)throw new TypeError("The second argument must be an options object");this[m]=!1,this[w]=[],this[l]=!1,this[g]=!1,this[d]=!1,this[c]=null,this[u]=this[u].bind(this),this[h]=this[h].bind(this),this[y]=this[y].bind(this),this[b]=t[b],this[v]=t[v],this[E]=n,this[I]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[A]=0,this[_]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[A]}get limit(){return this[I]}next(e){let t;if(void 0===e)t=new Promise(((t,n)=>{e=(e,r,s)=>{e?n(e):this[E]?void 0===r&&void 0===s?t():t([r,s]):t(r)}}));else if("function"!==typeof e)throw new TypeError("Callback must be a function");return this[g]?this.nextTick(e,new s("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(e,new s("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[l]=!0,this[c]=e,this[A]>=this[I]?this.nextTick(this[u],null):this._next(this[u])),t}_next(e){this.nextTick(e)}nextv(e,t,n){return n=o(t,n),n=r(n,a),t=i(t,T),Number.isInteger(e)?(this[g]?this.nextTick(n,new s("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(n,new s("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[I]<1/0&&(e=Math.min(e,this[I]-this[A])),this[l]=!0,this[c]=n,e<=0?this.nextTick(this[h],null,[]):this._nextv(e,t,this[h])),n[a]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[a])}_nextv(e,t,n){const r=[],s=(t,i,o)=>t?n(t):(this[E]?void 0===i&&void 0===o:void 0===i)?n(null,r):(r.push(this[E]?[i,o]:i),void(r.length===e?n(null,r):this._next(s)));this._next(s)}all(e,t){return t=o(e,t),t=r(t,a),e=i(e,T),this[g]?this.nextTick(t,new s("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[l]?this.nextTick(t,new s("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[l]=!0,this[c]=t,this[d]=!0,this[A]>=this[I]?this.nextTick(this[h],null,[]):this._all(e,this[h])),t[a]}_all(e,t){let n=this[A];const r=[],s=()=>{const e=this[I]<1/0?Math.min(1e3,this[I]-n):1e3;e<=0?this.nextTick(t,null,r):this._nextv(e,T,i)},i=(e,i)=>{e?t(e):0===i.length?t(null,r):(r.push.apply(r,i),n+=i.length,s())};s()}[f](){const e=this[c];return this[_]&&null===e?R:(this[l]=!1,this[c]=null,this[g]&&this._close(this[y]),e)}[p](e,t,n){this[d]?this.close(e.bind(null,t,n)):e(t,n)}seek(e,t){if(t=i(t,T),this[g]);else{if(this[l])throw new s("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const n=this.db.keyEncoding(t.keyEncoding||this[b]),r=n.format;t.keyEncoding!==r&&(t={...t,keyEncoding:r});const s=this.db.prefixKey(n.encode(e),r);this._seek(s,t)}}}_seek(e,t){throw new s("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){if(e=r(e,a),this[m])this.nextTick(e);else if(this[g])this[w].push(e);else if(this[g]=!0,this[w].push(e),this[l]){if(this[_]){const e=this[f]();e(new s("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[y]);return e[a]}_close(e){this.nextTick(e)}[y](){this[m]=!0,this.db.detachResource(this);const e=this[w];this[w]=[];for(const t of e)t()}async*[Symbol.asyncIterator](){try{let e;while(void 0!==(e=await this.next()))yield e}finally{this[m]||await this.close()}}}class N extends P{constructor(e,t){super(e,t,!0),this[S]=!1!==t.keys,this[k]=!1!==t.values}[u](e,t,n){const r=this[f]();if(e)return r(e);try{t=this[S]&&void 0!==t?this[b].decode(t):void 0,n=this[k]&&void 0!==n?this[v].decode(n):void 0}catch(e){return r(new L("entry",e))}void 0===t&&void 0===n||this[A]++,r(null,t,n)}[h](e,t){const n=this[f]();if(e)return this[p](n,e);try{for(const e of t){const t=e[0],n=e[1];e[0]=this[S]&&void 0!==t?this[b].decode(t):void 0,e[1]=this[k]&&void 0!==n?this[v].decode(n):void 0}}catch(e){return this[p](n,new L("entries",e))}this[A]+=t.length,this[p](n,null,t)}end(e){return C||"undefined"===typeof console||(C=!0,console.warn(new s("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}}class O extends P{constructor(e,t){super(e,t,!1)}[u](e,t){const n=this[f]();if(e)return n(e);try{t=void 0!==t?this[b].decode(t):void 0}catch(e){return n(new L("key",e))}void 0!==t&&this[A]++,n(null,t)}[h](e,t){const n=this[f]();if(e)return this[p](n,e);try{for(let e=0;e<t.length;e++){const n=t[e];t[e]=void 0!==n?this[b].decode(n):void 0}}catch(e){return this[p](n,new L("keys",e))}this[A]+=t.length,this[p](n,null,t)}}class D extends P{constructor(e,t){super(e,t,!1)}[u](e,t){const n=this[f]();if(e)return n(e);try{t=void 0!==t?this[v].decode(t):void 0}catch(e){return n(new L("value",e))}void 0!==t&&this[A]++,n(null,t)}[h](e,t){const n=this[f]();if(e)return this[p](n,e);try{for(let e=0;e<t.length;e++){const n=t[e];t[e]=void 0!==n?this[v].decode(n):void 0}}catch(e){return this[p](n,new L("values",e))}this[A]+=t.length,this[p](n,null,t)}}class L extends s{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}}for(const x of["_ended property","_nexting property","_end method"])Object.defineProperty(N.prototype,x.split(" ")[0],{get(){throw new s(`The ${x} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new s(`The ${x} has been removed`,{code:"LEVEL_LEGACY"})}});N.keyEncoding=b,N.valueEncoding=v,t.AbstractIterator=N,t.AbstractKeyIterator=O,t.AbstractValueIterator=D},2427:function(e,t,n){"use strict";n(7658);const{supports:r}=n(7358),{Transcoder:s}=n(1541),{EventEmitter:i}=n(3793),{fromCallback:o}=n(8078),a=n(4334),{AbstractIterator:c}=n(5965),{DefaultKeyIterator:l,DefaultValueIterator:u}=n(3416),{DeferredIterator:h,DeferredKeyIterator:d,DeferredValueIterator:f}=n(5502),{DefaultChainedBatch:p}=n(7492),{getCallback:g,getOptions:y}=n(6001),m=n(5780),w=Symbol("promise"),b=Symbol("landed"),v=Symbol("resources"),_=Symbol("closeResources"),E=Symbol("operations"),S=Symbol("undefer"),k=Symbol("deferOpen"),I=Symbol("options"),A=Symbol("status"),T=Symbol("defaultOptions"),R=Symbol("transcoder"),C=Symbol("keyEncoding"),P=Symbol("valueEncoding"),N=()=>{};class O extends i{constructor(e,t){if(super(),"object"!==typeof e||null===e)throw new TypeError("The first argument 'manifest' must be an object");t=y(t);const{keyEncoding:n,valueEncoding:i,passive:o,...a}=t;this[v]=new Set,this[E]=[],this[k]=!0,this[I]=a,this[A]="opening",this.supports=r(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==e.snapshots,permanence:!1!==e.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[R]=new s(x(this)),this[C]=this[R].encoding(n||"utf8"),this[P]=this[R].encoding(i||"utf8");for(const r of this[R].encodings())this.supports.encodings[r.commonName]||(this.supports.encodings[r.commonName]=!0);this[T]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[C].commonName,valueEncoding:this[P].commonName}),key:Object.freeze({keyEncoding:this[C].commonName})},this.nextTick((()=>{this[k]&&this.open({passive:!1},N)}))}get status(){return this[A]}keyEncoding(e){return this[R].encoding(null!=e?e:this[C])}valueEncoding(e){return this[R].encoding(null!=e?e:this[P])}open(e,t){t=g(e,t),t=o(t,w),e={...this[I],...y(e)},e.createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists;const n=e=>{"closing"===this[A]||"opening"===this[A]?this.once(b,e?()=>n(e):n):"open"!==this[A]?t(new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:e})):t()};return e.passive?"opening"===this[A]?this.once(b,n):this.nextTick(n):"closed"===this[A]||this[k]?(this[k]=!1,this[A]="opening",this.emit("opening"),this._open(e,(e=>{if(e)return this[A]="closed",this[_]((()=>{this.emit(b),n(e)})),void this[S]();this[A]="open",this[S](),this.emit(b),"open"===this[A]&&this.emit("open"),"open"===this[A]&&this.emit("ready"),n()}))):"open"===this[A]?this.nextTick(n):this.once(b,(()=>this.open(e,t))),t[w]}_open(e,t){this.nextTick(t)}close(e){e=o(e,w);const t=n=>{"opening"===this[A]||"closing"===this[A]?this.once(b,n?t(n):t):"closed"!==this[A]?e(new a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):e()};if("open"===this[A]){this[A]="closing",this.emit("closing");const e=e=>{this[A]="open",this[S](),this.emit(b),t(e)};this[_]((()=>{this._close((n=>{if(n)return e(n);this[A]="closed",this[S](),this.emit(b),"closed"===this[A]&&this.emit("closed"),t()}))}))}else"closed"===this[A]?this.nextTick(t):this.once(b,(()=>this.close(e)));return e[w]}[_](e){if(0===this[v].size)return this.nextTick(e);let t=this[v].size,n=!0;const r=()=>{0===--t&&(n?this.nextTick(e):e())};for(const s of this[v])s.close(r);n=!1,this[v].clear()}_close(e){this.nextTick(e)}get(e,t,n){if(n=g(t,n),n=o(n,w),t=y(t,this[T].entry),"opening"===this[A])return this.defer((()=>this.get(e,t,n))),n[w];if(L(this,n))return n[w];const r=this._checkKey(e);if(r)return this.nextTick(n,r),n[w];const s=this.keyEncoding(t.keyEncoding),i=this.valueEncoding(t.valueEncoding),c=s.format,l=i.format;return t.keyEncoding===c&&t.valueEncoding===l||(t=Object.assign({},t,{keyEncoding:c,valueEncoding:l})),this._get(this.prefixKey(s.encode(e),c),t,((e,t)=>{if(e)return("LEVEL_NOT_FOUND"===e.code||e.notFound||/NotFound/i.test(e))&&(e.code||(e.code="LEVEL_NOT_FOUND"),e.notFound||(e.notFound=!0),e.status||(e.status=404)),n(e);try{t=i.decode(t)}catch(e){return n(new a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:e}))}n(null,t)})),n[w]}_get(e,t,n){this.nextTick(n,new Error("NotFound"))}getMany(e,t,n){if(n=g(t,n),n=o(n,w),t=y(t,this[T].entry),"opening"===this[A])return this.defer((()=>this.getMany(e,t,n))),n[w];if(L(this,n))return n[w];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[w];if(0===e.length)return this.nextTick(n,null,[]),n[w];const r=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),i=r.format,c=s.format;t.keyEncoding===i&&t.valueEncoding===c||(t=Object.assign({},t,{keyEncoding:i,valueEncoding:c}));const l=new Array(e.length);for(let o=0;o<e.length;o++){const t=e[o],s=this._checkKey(t);if(s)return this.nextTick(n,s),n[w];l[o]=this.prefixKey(r.encode(t),i)}return this._getMany(l,t,((e,t)=>{if(e)return n(e);try{for(let e=0;e<t.length;e++)void 0!==t[e]&&(t[e]=s.decode(t[e]))}catch(e){return n(new a(`Could not decode one or more of ${t.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:e}))}n(null,t)})),n[w]}_getMany(e,t,n){this.nextTick(n,null,new Array(e.length).fill(void 0))}put(e,t,n,r){if(r=g(n,r),r=o(r,w),n=y(n,this[T].entry),"opening"===this[A])return this.defer((()=>this.put(e,t,n,r))),r[w];if(L(this,r))return r[w];const s=this._checkKey(e)||this._checkValue(t);if(s)return this.nextTick(r,s),r[w];const i=this.keyEncoding(n.keyEncoding),a=this.valueEncoding(n.valueEncoding),c=i.format,l=a.format;n.keyEncoding===c&&n.valueEncoding===l||(n=Object.assign({},n,{keyEncoding:c,valueEncoding:l}));const u=this.prefixKey(i.encode(e),c),h=a.encode(t);return this._put(u,h,n,(n=>{if(n)return r(n);this.emit("put",e,t),r()})),r[w]}_put(e,t,n,r){this.nextTick(r)}del(e,t,n){if(n=g(t,n),n=o(n,w),t=y(t,this[T].key),"opening"===this[A])return this.defer((()=>this.del(e,t,n))),n[w];if(L(this,n))return n[w];const r=this._checkKey(e);if(r)return this.nextTick(n,r),n[w];const s=this.keyEncoding(t.keyEncoding),i=s.format;return t.keyEncoding!==i&&(t=Object.assign({},t,{keyEncoding:i})),this._del(this.prefixKey(s.encode(e),i),t,(t=>{if(t)return n(t);this.emit("del",e),n()})),n[w]}_del(e,t,n){this.nextTick(n)}batch(e,t,n){if(!arguments.length){if("opening"===this[A])return new p(this);if("open"!==this[A])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(n="function"===typeof e?e:g(t,n),n=o(n,w),t=y(t,this[T].empty),"opening"===this[A])return this.defer((()=>this.batch(e,t,n))),n[w];if(L(this,n))return n[w];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[w];if(0===e.length)return this.nextTick(n),n[w];const r=new Array(e.length),{keyEncoding:s,valueEncoding:i,...c}=t;for(let o=0;o<e.length;o++){if("object"!==typeof e[o]||null===e[o])return this.nextTick(n,new TypeError("A batch operation must be an object")),n[w];const t=Object.assign({},e[o]);if("put"!==t.type&&"del"!==t.type)return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[w];const a=this._checkKey(t.key);if(a)return this.nextTick(n,a),n[w];const c=null!=t.sublevel?t.sublevel:this,l=c.keyEncoding(t.keyEncoding||s),u=l.format;if(t.key=c.prefixKey(l.encode(t.key),u),t.keyEncoding=u,"put"===t.type){const e=this._checkValue(t.value);if(e)return this.nextTick(n,e),n[w];const r=c.valueEncoding(t.valueEncoding||i);t.value=r.encode(t.value),t.valueEncoding=r.format}c!==this&&(t.sublevel=null),r[o]=t}return this._batch(r,c,(t=>{if(t)return n(t);this.emit("batch",e),n()})),n[w]}_batch(e,t,n){this.nextTick(n)}sublevel(e,t){return this._sublevel(e,D.defaults(t))}_sublevel(e,t){return new D(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=g(e,t),t=o(t,w),e=y(e,this[T].empty),"opening"===this[A])return this.defer((()=>this.clear(e,t))),t[w];if(L(this,t))return t[w];const n=e,r=this.keyEncoding(e.keyEncoding);return e=m(e,r),e.keyEncoding=r.format,0===e.limit?this.nextTick(t):this._clear(e,(e=>{if(e)return t(e);this.emit("clear",n),t()})),t[w]}_clear(e,t){this.nextTick(t)}iterator(e){const t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=m(e,t),e.keys=!1!==e.keys,e.values=!1!==e.values,e[c.keyEncoding]=t,e[c.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,"opening"===this[A])return new h(this,e);if("open"!==this[A])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new c(this,e)}keys(e){const t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=m(e,t),e[c.keyEncoding]=t,e[c.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,"opening"===this[A])return new d(this,e);if("open"!==this[A])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new l(this,e)}values(e){const t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=m(e,t),e[c.keyEncoding]=t,e[c.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,"opening"===this[A])return new f(this,e);if("open"!==this[A])throw new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new u(this,e)}defer(e){if("function"!==typeof e)throw new TypeError("The first argument must be a function");this[E].push(e)}[S](){if(0===this[E].length)return;const e=this[E];this[E]=[];for(const t of e)t()}attachResource(e){if("object"!==typeof e||null===e||"function"!==typeof e.close)throw new TypeError("The first argument must be a resource object");this[v].add(e)}detachResource(e){this[v].delete(e)}_chainedBatch(){return new p(this)}_checkKey(e){if(null===e||void 0===e)return new a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(null===e||void 0===e)return new a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}O.prototype.nextTick=n(6565);const{AbstractSublevel:D}=n(2775)({AbstractLevel:O});t.AbstractLevel=O,t.AbstractSublevel=D;const L=function(e,t){return"open"!==e[A]&&(e.nextTick(t,new a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},x=function(e){return Object.keys(e.supports.encodings).filter((t=>!!e.supports.encodings[t]))}},9420:function(e,t,n){"use strict";t.AbstractLevel=n(2427).AbstractLevel,t.AbstractSublevel=n(2427).AbstractSublevel,t.AbstractIterator=n(5965).AbstractIterator,t.AbstractKeyIterator=n(5965).AbstractKeyIterator,t.AbstractValueIterator=n(5965).AbstractValueIterator,t.AbstractChainedBatch=n(7081).AbstractChainedBatch},140:function(e,t,n){"use strict";const{AbstractIterator:r,AbstractKeyIterator:s,AbstractValueIterator:i}=n(5965),o=Symbol("unfix"),a=Symbol("iterator"),c=Symbol("handleOne"),l=Symbol("handleMany"),u=Symbol("callback");class h extends r{constructor(e,t,n,r){super(e,t),this[a]=n,this[o]=r,this[c]=this[c].bind(this),this[l]=this[l].bind(this),this[u]=null}[c](e,t,n){const r=this[u];if(e)return r(e);void 0!==t&&(t=this[o](t)),r(e,t,n)}[l](e,t){const n=this[u];if(e)return n(e);for(const r of t){const e=r[0];void 0!==e&&(r[0]=this[o](e))}n(e,t)}}class d extends s{constructor(e,t,n,r){super(e,t),this[a]=n,this[o]=r,this[c]=this[c].bind(this),this[l]=this[l].bind(this),this[u]=null}[c](e,t){const n=this[u];if(e)return n(e);void 0!==t&&(t=this[o](t)),n(e,t)}[l](e,t){const n=this[u];if(e)return n(e);for(let r=0;r<t.length;r++){const e=t[r];void 0!==e&&(t[r]=this[o](e))}n(e,t)}}class f extends i{constructor(e,t,n){super(e,t),this[a]=n}}for(const p of[h,d])p.prototype._next=function(e){this[u]=e,this[a].next(this[c])},p.prototype._nextv=function(e,t,n){this[u]=n,this[a].nextv(e,t,this[l])},p.prototype._all=function(e,t){this[u]=t,this[a].all(e,this[l])};for(const p of[f])p.prototype._next=function(e){this[a].next(e)},p.prototype._nextv=function(e,t,n){this[a].nextv(e,t,n)},p.prototype._all=function(e,t){this[a].all(e,t)};for(const p of[h,d,f])p.prototype._seek=function(e,t){this[a].seek(e,t)},p.prototype._close=function(e){this[a].close(e)};t.AbstractSublevelIterator=h,t.AbstractSublevelKeyIterator=d,t.AbstractSublevelValueIterator=f},2775:function(e,t,n){"use strict";const r=n(4334),{Buffer:s}=n(6937)||{},{AbstractSublevelIterator:i,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:a}=n(140),c=Symbol("prefix"),l=Symbol("upperBound"),u=Symbol("prefixRange"),h=Symbol("parent"),d=Symbol("unfix"),f=new TextEncoder,p={separator:"!"};e.exports=function({AbstractLevel:e}){class t extends e{static defaults(e){if("string"===typeof e)throw new r("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new r("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?p:e.separator?e:{...e,separator:"!"}}constructor(e,n,s){const{separator:i,manifest:o,...a}=t.defaults(s);n=b(n,i);const u=i.charCodeAt(0)+1,p=e[h]||e;if(!f.encode(n).every((e=>e>u&&e<127)))throw new r(`Prefix must use bytes > ${u} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(g(p,o),a);const y=(e.prefix||"")+i+n+i,v=y.slice(0,-1)+String.fromCharCode(u);this[h]=p,this[c]=new m(y),this[l]=new m(v),this[d]=new w,this.nextTick=p.nextTick}prefixKey(e,t){if("utf8"===t)return this[c].utf8+e;if(0===e.byteLength)return this[c][t];if("view"===t){const t=this[c].view,n=new Uint8Array(t.byteLength+e.byteLength);return n.set(t,0),n.set(e,t.byteLength),n}{const t=this[c].buffer;return s.concat([t,e],t.byteLength+e.byteLength)}}[u](e,t){void 0!==e.gte?e.gte=this.prefixKey(e.gte,t):void 0!==e.gt?e.gt=this.prefixKey(e.gt,t):e.gte=this[c][t],void 0!==e.lte?e.lte=this.prefixKey(e.lte,t):void 0!==e.lt?e.lt=this.prefixKey(e.lt,t):e.lte=this[l][t]}get prefix(){return this[c].utf8}get db(){return this[h]}_open(e,t){this[h].open({passive:!0},t)}_put(e,t,n,r){this[h].put(e,t,n,r)}_get(e,t,n){this[h].get(e,t,n)}_getMany(e,t,n){this[h].getMany(e,t,n)}_del(e,t,n){this[h].del(e,t,n)}_batch(e,t,n){this[h].batch(e,t,n)}_clear(e,t){this[u](e,e.keyEncoding),this[h].clear(e,t)}_iterator(e){this[u](e,e.keyEncoding);const t=this[h].iterator(e),n=this[d].get(this[c].utf8.length,e.keyEncoding);return new i(this,e,t,n)}_keys(e){this[u](e,e.keyEncoding);const t=this[h].keys(e),n=this[d].get(this[c].utf8.length,e.keyEncoding);return new o(this,e,t,n)}_values(e){this[u](e,e.keyEncoding);const t=this[h].values(e);return new a(this,e,t)}}return{AbstractSublevel:t}};const g=function(e,t){return{...e.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...t,encodings:{utf8:y(e,"utf8"),buffer:y(e,"buffer"),view:y(e,"view")}}},y=function(e,t){return!!e.supports.encodings[t]&&e.keyEncoding(t).name===t};class m{constructor(e){this.utf8=e,this.view=f.encode(e),this.buffer=s?s.from(this.view.buffer,0,this.view.byteLength):{}}}class w{constructor(){this.cache=new Map}get(e,t){let n=this.cache.get(t);return void 0===n&&(n="view"===t?function(e,t){return t.subarray(e)}.bind(null,e):function(e,t){return t.slice(e)}.bind(null,e),this.cache.set(t,n)),n}}const b=function(e,t){let n=0,r=e.length;while(n<r&&e[n]===t)n++;while(r>n&&e[r-1]===t)r--;return e.slice(n,r)}},6001:function(e,t){"use strict";t.getCallback=function(e,t){return"function"===typeof e?e:t},t.getOptions=function(e,t){return"object"===typeof e&&null!==e?e:void 0!==t?t:{}}},7492:function(e,t,n){"use strict";n(7658);const{AbstractChainedBatch:r}=n(7081),s=n(4334),i=Symbol("encoded");class o extends r{constructor(e){super(e),this[i]=[]}_put(e,t,n){this[i].push({...n,type:"put",key:e,value:t})}_del(e,t){this[i].push({...t,type:"del",key:e})}_clear(){this[i]=[]}_write(e,t){"opening"===this.db.status?this.db.defer((()=>this._write(e,t))):"open"===this.db.status?0===this[i].length?this.nextTick(t):this.db._batch(this[i],e,t):this.nextTick(t,new s("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}}t.DefaultChainedBatch=o},3416:function(e,t,n){"use strict";const{AbstractKeyIterator:r,AbstractValueIterator:s}=n(5965),i=Symbol("iterator"),o=Symbol("callback"),a=Symbol("handleOne"),c=Symbol("handleMany");class l extends r{constructor(e,t){super(e,t),this[i]=e.iterator({...t,keys:!0,values:!1}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}class u extends s{constructor(e,t){super(e,t),this[i]=e.iterator({...t,keys:!1,values:!0}),this[a]=this[a].bind(this),this[c]=this[c].bind(this)}}for(const h of[l,u]){const e=h===l,t=e?e=>e[0]:e=>e[1];h.prototype._next=function(e){this[o]=e,this[i].next(this[a])},h.prototype[a]=function(t,n,r){const s=this[o];t?s(t):s(null,e?n:r)},h.prototype._nextv=function(e,t,n){this[o]=n,this[i].nextv(e,t,this[c])},h.prototype._all=function(e,t){this[o]=t,this[i].all(e,this[c])},h.prototype[c]=function(e,n){const r=this[o];e?r(e):r(null,n.map(t))},h.prototype._seek=function(e,t){this[i].seek(e,t)},h.prototype._close=function(e){this[i].close(e)}}t.DefaultKeyIterator=l,t.DefaultValueIterator=u},5502:function(e,t,n){"use strict";const{AbstractIterator:r,AbstractKeyIterator:s,AbstractValueIterator:i}=n(5965),o=n(4334),a=Symbol("nut"),c=Symbol("undefer"),l=Symbol("factory");class u extends r{constructor(e,t){super(e,t),this[a]=null,this[l]=()=>e.iterator(t),this.db.defer((()=>this[c]()))}}class h extends s{constructor(e,t){super(e,t),this[a]=null,this[l]=()=>e.keys(t),this.db.defer((()=>this[c]()))}}class d extends i{constructor(e,t){super(e,t),this[a]=null,this[l]=()=>e.values(t),this.db.defer((()=>this[c]()))}}for(const f of[u,h,d])f.prototype[c]=function(){"open"===this.db.status&&(this[a]=this[l]())},f.prototype._next=function(e){null!==this[a]?this[a].next(e):"opening"===this.db.status?this.db.defer((()=>this._next(e))):this.nextTick(e,new o("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},f.prototype._nextv=function(e,t,n){null!==this[a]?this[a].nextv(e,t,n):"opening"===this.db.status?this.db.defer((()=>this._nextv(e,t,n))):this.nextTick(n,new o("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},f.prototype._all=function(e,t){null!==this[a]?this[a].all(t):"opening"===this.db.status?this.db.defer((()=>this._all(e,t))):this.nextTick(t,new o("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},f.prototype._seek=function(e,t){null!==this[a]?this[a]._seek(e,t):"opening"===this.db.status&&this.db.defer((()=>this._seek(e,t)))},f.prototype._close=function(e){null!==this[a]?this[a].close(e):"opening"===this.db.status?this.db.defer((()=>this._close(e))):this.nextTick(e)};t.DeferredIterator=u,t.DeferredKeyIterator=h,t.DeferredValueIterator=d},6565:function(e,t,n){"use strict";const r=n(3802);e.exports=function(e,...t){0===t.length?r(e):r((()=>e(...t)))}},5780:function(e,t,n){"use strict";const r=n(4334),s=Object.prototype.hasOwnProperty,i=new Set(["lt","lte","gt","gte"]);e.exports=function(e,t){const n={};for(const o in e)if(s.call(e,o)&&"keyEncoding"!==o&&"valueEncoding"!==o){if("start"===o||"end"===o)throw new r(`The legacy range option '${o}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===o)throw new r("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});i.has(o)?n[o]=t.encode(e[o]):n[o]=e[o]}return n.reverse=!!n.reverse,n.limit=Number.isInteger(n.limit)&&n.limit>=0?n.limit:-1,n}},6937:function(e,t,n){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */n(7658);const r=n(1271),s=n(7055),i="function"===typeof Symbol&&"function"===typeof Symbol["for"]?Symbol["for"]("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}function c(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return u(e,t,n)}function u(e,t,n){if("string"===typeof e)return p(e,t);if(ArrayBuffer.isView(e))return y(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(oe(e,ArrayBuffer)||e&&oe(e.buffer,ArrayBuffer))return m(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(oe(e,SharedArrayBuffer)||e&&oe(e.buffer,SharedArrayBuffer)))return m(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);const s=w(e);if(s)return s;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e,t,n){return h(e),e<=0?c(e):void 0!==t?"string"===typeof n?c(e).fill(t,n):c(e).fill(t):c(e)}function f(e){return h(e),c(e<0?0:0|b(e))}function p(e,t){if("string"===typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|_(e,t);let r=c(n);const s=r.write(e,t);return s!==n&&(r=r.slice(0,s)),r}function g(e){const t=e.length<0?0:0|b(e.length),n=c(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function y(e){if(oe(e,Uint8Array)){const t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return g(e)}function m(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function w(e){if(l.isBuffer(e)){const t=0|b(e.length),n=c(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!==typeof e.length||ae(e.length)?c(0):g(e):"Buffer"===e.type&&Array.isArray(e.data)?g(e.data):void 0}function b(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),l.alloc(+e)}function _(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||oe(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return te(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return se(e).length;default:if(s)return r?-1:te(e).length;t=(""+t).toLowerCase(),s=!0}}function E(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function S(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function k(e,t,n,r,s){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,ae(n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"===typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:I(e,t,n,r,s);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):I(e,[t],n,r,s);throw new TypeError("val must be string, number or Buffer")}function I(e,t,n,r,s){let i,o=1,a=e.length,c=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let r=-1;for(i=n;i<a;i++)if(l(e,i)===l(t,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===c)return r*o}else-1!==r&&(i-=i-r),r=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){let n=!0;for(let r=0;r<c;r++)if(l(e,i+r)!==l(t,r)){n=!1;break}if(n)return i}return-1}function A(e,t,n,r){n=Number(n)||0;const s=e.length-n;r?(r=Number(r),r>s&&(r=s)):r=s;const i=t.length;let o;for(r>i/2&&(r=i/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(ae(r))return o;e[n+o]=r}return o}function T(e,t,n,r){return ie(te(t,e.length-n),e,n,r)}function R(e,t,n,r){return ie(ne(t),e,n,r)}function C(e,t,n,r){return ie(se(t),e,n,r)}function P(e,t,n,r){return ie(re(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);const r=[];let s=t;while(s<n){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=n){let n,r,a,c;switch(o){case 1:t<128&&(i=t);break;case 2:n=e[s+1],128===(192&n)&&(c=(31&t)<<6|63&n,c>127&&(i=c));break;case 3:n=e[s+1],r=e[s+2],128===(192&n)&&128===(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[s+1],r=e[s+2],a=e[s+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),s+=o}return L(r)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=a(),l.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return d(e,t,n)},l.allocUnsafe=function(e){return f(e)},l.allocUnsafeSlow=function(e){return f(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(oe(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),oe(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let s=0,i=Math.min(n,r);s<i;++s)if(e[s]!==t[s]){n=e[s],r=t[s];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=l.allocUnsafe(t);let s=0;for(n=0;n<e.length;++n){let t=e[n];if(oe(t,Uint8Array))s+t.length>r.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(r,s)):Uint8Array.prototype.set.call(r,t,s);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,s)}s+=t.length}return r},l.byteLength=_,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)S(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?O(this,0,e):E.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,s){if(oe(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||n>e.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&t>=n)return 0;if(r>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,s>>>=0,this===e)return 0;let i=s-r,o=n-t;const a=Math.min(i,o),c=this.slice(r,s),u=e.slice(t,n);for(let l=0;l<a;++l)if(c[l]!==u[l]){i=c[l],o=u[l];break}return i<o?-1:o<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return k(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return k(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const s=this.length-t;if((void 0===n||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return A(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":case"latin1":case"binary":return R(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const D=4096;function L(e){const t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);let n="",r=0;while(r<t)n+=String.fromCharCode.apply(String,e.slice(r,r+=D));return n}function x(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(127&e[s]);return r}function B(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(e[s]);return r}function M(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let s="";for(let i=t;i<n;++i)s+=ce[e[i]];return s}function U(e,t,n){const r=e.slice(t,n);let s="";for(let i=0;i<r.length-1;i+=2)s+=String.fromCharCode(r[i]+256*r[i+1]);return s}function F(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,s,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function V(e,t,n,r,s){Q(t,r,s,e,n,7);let i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function z(e,t,n,r,s){Q(t,r,s,e,n,7);let i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function $(e,t,n,r,s,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function K(e,t,n,r,i){return t=+t,n>>>=0,i||$(e,t,n,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,n,r,23,4),n+4}function H(e,t,n,r,i){return t=+t,n>>>=0,i||$(e,t,n,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=this[e],s=1,i=0;while(++i<t&&(s*=256))r+=this[e+i]*s;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=this[e+--t],s=1;while(t>0&&(s*=256))r+=this[e+--t]*s;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(s)<<BigInt(32))})),l.prototype.readBigUInt64BE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(s)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=this[e],s=1,i=0;while(++i<t&&(s*=256))r+=this[e+i]*s;return s*=128,r>=s&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=t,s=1,i=this[e+--r];while(r>0&&(s*=256))i+=this[e+--r]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),s.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),s.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),s.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),s.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){const r=Math.pow(2,8*n)-1;j(this,e,t,n,r,0)}let s=1,i=0;this[t]=255&e;while(++i<n&&(s*=256))this[t+i]=e/s&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){const r=Math.pow(2,8*n)-1;j(this,e,t,n,r,0)}let s=n-1,i=1;this[t+s]=255&e;while(--s>=0&&(i*=256))this[t+s]=e/i&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=le((function(e,t=0){return V(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=le((function(e,t=0){return z(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}let s=0,i=1,o=0;this[t]=255&e;while(++s<n&&(i*=256))e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}let s=n-1,i=1,o=0;this[t+s]=255&e;while(--s>=0&&(i*=256))e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=le((function(e,t=0){return V(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=le((function(e,t=0){return z(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return K(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return K(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return H(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return H(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const s=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),s},l.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(s=t;s<n;++s)this[s]=e;else{const i=l.isBuffer(e)?e:l.from(e,r),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=i[s%o]}return this};const q={};function W(e,t,n){q[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function G(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function Y(e,t,n){X(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||J(t,e.length-(n+1))}function Q(e,t,n,r,s,i){if(e>n||e<t){const r="bigint"===typeof t?"n":"";let s;throw s=i>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new q.ERR_OUT_OF_RANGE("value",s,e)}Y(r,s,i)}function X(e,t){if("number"!==typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function J(e,t,n){if(Math.floor(e)!==e)throw X(e,n),new q.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}W("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),W("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),W("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,s=n;return Number.isInteger(n)&&Math.abs(n)>2**32?s=G(String(n)):"bigint"===typeof n&&(s=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(s=G(s)),s+="n"),r+=` It must be ${t}. Received ${s}`,r}),RangeError);const Z=/[^+/0-9A-Za-z-_]/g;function ee(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function te(e,t){let n;t=t||1/0;const r=e.length;let s=null;const i=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function ne(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function re(e,t){let n,r,s;const i=[];for(let o=0;o<e.length;++o){if((t-=2)<0)break;n=e.charCodeAt(o),r=n>>8,s=n%256,i.push(s),i.push(r)}return i}function se(e){return r.toByteArray(ee(e))}function ie(e,t,n,r){let s;for(s=0;s<r;++s){if(s+n>=t.length||s>=e.length)break;t[s+n]=e[s]}return s}function oe(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ae(e){return e!==e}const ce=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let s=0;s<16;++s)t[r+s]=e[n]+e[s]}return t}();function le(e){return"undefined"===typeof BigInt?ue:e}function ue(){throw new Error("BigInt not supported")}},7358:function(e,t){"use strict";t.supports=function(...e){const t=e.reduce(((e,t)=>Object.assign(e,t)),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}},4908:function(e){function t(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)t&&t.removeEventListener&&t.removeEventListener("abort",n)}for(const r of e)if(r&&r.addEventListener){if(r.aborted){n();break}r.addEventListener("abort",n)}return t.signal}e.exports=t,e.exports.anySignal=t},1271:function(e,t,n){"use strict";n(7658),t.byteLength=u,t.toByteArray=d,t.fromByteArray=g;for(var r=[],s=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=o.length;a<c;++a)r[a]=o[a],s[o.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function u(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r}function h(e,t,n){return 3*(t+n)/4-n}function d(e){var t,n,r=l(e),o=r[0],a=r[1],c=new i(h(e,o,a)),u=0,d=a>0?o-4:o;for(n=0;n<d;n+=4)t=s[e.charCodeAt(n)]<<18|s[e.charCodeAt(n+1)]<<12|s[e.charCodeAt(n+2)]<<6|s[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===a&&(t=s[e.charCodeAt(n)]<<2|s[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===a&&(t=s[e.charCodeAt(n)]<<10|s[e.charCodeAt(n+1)]<<4|s[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c}function f(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function p(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),s.push(f(r));return s.join("")}function g(e){for(var t,n=e.length,s=n%3,i=[],o=16383,a=0,c=n-s;a<c;a+=o)i.push(p(e,a,a+o>c?c:a+o));return 1===s?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===s&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},2196:function(e,t,n){"use strict";const{AbstractLevel:r}=n(9420),s=n(4334),i=n(9641),{fromCallback:o}=n(8078),{Iterator:a}=n(274),c=n(394),l=n(2181),u=n(3458),h="level-js-",d=Symbol("idb"),f=Symbol("namePrefix"),p=Symbol("location"),g=Symbol("version"),y=Symbol("store"),m=Symbol("onComplete"),w=Symbol("promise");class b extends r{constructor(e,t,n){if("function"===typeof t||"function"===typeof n)throw new s("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:r,version:i,...o}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),"string"!==typeof e)throw new Error("constructor requires a location string argument");this[p]=e,this[f]=null==r?h:r,this[g]=parseInt(i||1,10),this[d]=null}get location(){return this[p]}get namePrefix(){return this[f]}get version(){return this[g]}get db(){return this[d]}get type(){return"browser-level"}_open(e,t){const n=indexedDB.open(this[f]+this[p],this[g]);n.onerror=function(){t(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[d]=n.result,t()},n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this[p])||t.createObjectStore(this[p])}}[y](e){const t=this[d].transaction([this[p]],e);return t.objectStore(this[p])}[m](e,t){const n=e.transaction;n.onabort=function(){t(n.error||new Error("aborted by user"))},n.oncomplete=function(){t(null,e.result)}}_get(e,t,n){const r=this[y]("readonly");let i;try{i=r.get(e)}catch(o){return this.nextTick(n,o)}this[m](i,(function(e,t){return e?n(e):void 0===t?n(new s("Entry not found",{code:"LEVEL_NOT_FOUND"})):void n(null,c(t))}))}_getMany(e,t,n){const r=this[y]("readonly"),s=e.map((e=>t=>{let n;try{n=r.get(e)}catch(s){return t(s)}n.onsuccess=()=>{const e=n.result;t(null,void 0===e?e:c(e))},n.onerror=e=>{e.stopPropagation(),t(n.error)}}));i(s,16,n)}_del(e,t,n){const r=this[y]("readwrite");let s;try{s=r.delete(e)}catch(i){return this.nextTick(n,i)}this[m](s,n)}_put(e,t,n,r){const s=this[y]("readwrite");let i;try{i=s.put(t,e)}catch(o){return this.nextTick(r,o)}this[m](i,r)}_iterator(e){return new a(this,this[p],e)}_batch(e,t,n){const r=this[y]("readwrite"),s=r.transaction;let i,o=0;function a(){const t=e[o++],n=t.key;let c;try{c="del"===t.type?r.delete(n):r.put(t.value,n)}catch(l){return i=l,void s.abort()}o<e.length?c.onsuccess=a:"function"===typeof s.commit&&s.commit()}s.onabort=function(){n(i||s.error||new Error("aborted by user"))},s.oncomplete=function(){n()},a()}_clear(e,t){let n,r;try{n=u(e)}catch(s){return this.nextTick(t)}if(e.limit>=0)return l(this,this[p],n,e,t);try{const e=this[y]("readwrite");r=n?e.delete(n):e.clear()}catch(i){return this.nextTick(t,i)}this[m](r,t)}_close(e){this[d].close(),this.nextTick(e)}}b.destroy=function(e,t,n){"function"===typeof t&&(n=t,t=h),n=o(n,w);const r=indexedDB.deleteDatabase(t+e);return r.onsuccess=function(){n()},r.onerror=function(e){n(e)},n[w]},t.BrowserLevel=b},274:function(e,t,n){"use strict";n(7658);const{AbstractIterator:r}=n(9420),s=n(3458),i=n(394),o=Symbol("cache"),a=Symbol("finished"),c=Symbol("options"),l=Symbol("currentOptions"),u=Symbol("position"),h=Symbol("location"),d=Symbol("first"),f={};class p extends r{constructor(e,t,n){super(e,n),this[o]=[],this[a]=0===this.limit,this[c]=n,this[l]={...n},this[u]=void 0,this[h]=t,this[d]=!0}_nextv(e,t,n){if(this[d]=!1,this[a])return this.nextTick(n,null,[]);if(this[o].length>0)return e=Math.min(e,this[o].length),this.nextTick(n,null,this[o].splice(0,e));let r;void 0!==this[u]&&(this[c].reverse?(this[l].lt=this[u],this[l].lte=void 0):(this[l].gt=this[u],this[l].gte=void 0));try{r=s(this[l])}catch(m){return this[a]=!0,this.nextTick(n,null,[])}const f=this.db.db.transaction([this[h]],"readonly"),p=f.objectStore(this[h]),y=[];if(this[c].reverse){const t=!this[c].values&&p.openKeyCursor?"openKeyCursor":"openCursor";p[t](r,"prev").onsuccess=t=>{const n=t.target.result;if(n){const{key:t,value:r}=n;this[u]=t,y.push([this[c].keys&&void 0!==t?i(t):void 0,this[c].values&&void 0!==r?i(r):void 0]),y.length<e?n.continue():g(f)}else this[a]=!0}}else{let t,n;const s=()=>{if(void 0===t||void 0===n)return;const r=Math.max(t.length,n.length);0===r||e===1/0?this[a]=!0:this[u]=t[r-1],y.length=r;for(let e=0;e<r;e++){const r=t[e],s=n[e];y[e]=[this[c].keys&&void 0!==r?i(r):void 0,this[c].values&&void 0!==s?i(s):void 0]}g(f)};this[c].keys||e<1/0?p.getAllKeys(r,e<1/0?e:void 0).onsuccess=e=>{t=e.target.result,s()}:(t=[],this.nextTick(s)),this[c].values?p.getAll(r,e<1/0?e:void 0).onsuccess=e=>{n=e.target.result,s()}:(n=[],this.nextTick(s))}f.onabort=()=>{n(f.error||new Error("aborted by user")),n=null},f.oncomplete=()=>{n(null,y),n=null}}_next(e){if(this[o].length>0){const[t,n]=this[o].shift();this.nextTick(e,null,t,n)}else if(this[a])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[d]&&(this[d]=!1,t=1),this._nextv(t,f,((t,n)=>{if(t)return e(t);this[o]=n,this._next(e)}))}}_all(e,t){this[d]=!1;const n=this[o].splice(0,this[o].length),r=this.limit-this.count-n.length;if(r<=0)return this.nextTick(t,null,n);this._nextv(r,f,((e,r)=>{if(e)return t(e);n.length>0&&(r=n.concat(r)),t(null,r)}))}_seek(e,t){let n;this[d]=!0,this[o]=[],this[a]=!1,this[u]=void 0,this[l]={...this[c]};try{n=s(this[c])}catch(r){return void(this[a]=!0)}null===n||n.includes(e)?this[c].reverse?this[l].lte=e:this[l].gte=e:this[a]=!0}}function g(e){"function"===typeof e.commit&&e.commit()}t.Iterator=p},2181:function(e){"use strict";e.exports=function(e,t,n,r,s){if(0===r.limit)return e.nextTick(s);const i=e.db.transaction([t],"readwrite"),o=i.objectStore(t);let a=0;i.oncomplete=function(){s()},i.onabort=function(){s(i.error||new Error("aborted by user"))};const c=o.openKeyCursor?"openKeyCursor":"openCursor",l=r.reverse?"prev":"next";o[c](n,l).onsuccess=function(e){const t=e.target.result;t&&(o.delete(t.key).onsuccess=function(){(r.limit<=0||++a<r.limit)&&t.continue()})}}},394:function(e){"use strict";const t=new TextEncoder;e.exports=function(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):t.encode(e)}},3458:function(e){"use strict";e.exports=function(e){const t=void 0!==e.gte?e.gte:void 0!==e.gt?e.gt:void 0,n=void 0!==e.lte?e.lte:void 0!==e.lt?e.lt:void 0,r=void 0===e.gte,s=void 0===e.lte;return void 0!==t&&void 0!==n?IDBKeyRange.bound(t,n,r,s):void 0!==t?IDBKeyRange.lowerBound(t,r):void 0!==n?IDBKeyRange.upperBound(n,s):null}},5361:function(e,t,n){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */n(7658);var r=n(1271),s=n(7055),i="function"===typeof Symbol&&"function"===typeof Symbol["for"]?Symbol["for"]("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;var o=2147483647;function a(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(n){return!1}}function c(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return u(e,t,n)}function u(e,t,n){if("string"===typeof e)return p(e,t);if(ArrayBuffer.isView(e))return y(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return m(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return m(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);var s=w(e);if(s)return s;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e,t,n){return h(e),e<=0?c(e):void 0!==t?"string"===typeof n?c(e).fill(t,n):c(e).fill(t):c(e)}function f(e){return h(e),c(e<0?0:0|b(e))}function p(e,t){if("string"===typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|_(e,t),r=c(n),s=r.write(e,t);return s!==n&&(r=r.slice(0,s)),r}function g(e){for(var t=e.length<0?0:0|b(e.length),n=c(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function y(e){if(X(e,Uint8Array)){var t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return g(e)}function m(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function w(e){if(l.isBuffer(e)){var t=0|b(e.length),n=c(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!==typeof e.length||J(e.length)?c(0):g(e):"Buffer"===e.type&&Array.isArray(e.data)?g(e.data):void 0}function b(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),l.alloc(+e)}function _(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var s=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(s)return r?-1:q(e).length;t=(""+t).toLowerCase(),s=!0}}function E(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function S(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function k(e,t,n,r,s){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,J(n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"===typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:I(e,t,n,r,s);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):I(e,[t],n,r,s);throw new TypeError("val must be string, number or Buffer")}function I(e,t,n,r,s){var i,o=1,a=e.length,c=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){var u=-1;for(i=n;i<a;i++)if(l(e,i)===l(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===c)return u*o}else-1!==u&&(i-=i-u),u=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){for(var h=!0,d=0;d<c;d++)if(l(e,i+d)!==l(t,d)){h=!1;break}if(h)return i}return-1}function A(e,t,n,r){n=Number(n)||0;var s=e.length-n;r?(r=Number(r),r>s&&(r=s)):r=s;var i=t.length;r>i/2&&(r=i/2);for(var o=0;o<r;++o){var a=parseInt(t.substr(2*o,2),16);if(J(a))return o;e[n+o]=a}return o}function T(e,t,n,r){return Q(q(t,e.length-n),e,n,r)}function R(e,t,n,r){return Q(W(t),e,n,r)}function C(e,t,n,r){return Q(Y(t),e,n,r)}function P(e,t,n,r){return Q(G(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);var r=[],s=t;while(s<n){var i,o,a,c,l=e[s],u=null,h=l>239?4:l>223?3:l>191?2:1;if(s+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:i=e[s+1],128===(192&i)&&(c=(31&l)<<6|63&i,c>127&&(u=c));break;case 3:i=e[s+1],o=e[s+2],128===(192&i)&&128===(192&o)&&(c=(15&l)<<12|(63&i)<<6|63&o,c>2047&&(c<55296||c>57343)&&(u=c));break;case 4:i=e[s+1],o=e[s+2],a=e[s+3],128===(192&i)&&128===(192&o)&&128===(192&a)&&(c=(15&l)<<18|(63&i)<<12|(63&o)<<6|63&a,c>65535&&c<1114112&&(u=c))}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),s+=h}return L(r)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=a(),l.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return d(e,t,n)},l.allocUnsafe=function(e){return f(e)},l.allocUnsafeSlow=function(e){return f(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,s=0,i=Math.min(n,r);s<i;++s)if(e[s]!==t[s]){n=e[s],r=t[s];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){var i=e[n];if(X(i,Uint8Array))s+i.length>r.length?l.from(i).copy(r,s):Uint8Array.prototype.set.call(r,i,s);else{if(!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,s)}s+=i.length}return r},l.byteLength=_,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)S(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?O(this,0,e):E.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,s){if(X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||n>e.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&t>=n)return 0;if(r>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,s>>>=0,this===e)return 0;for(var i=s-r,o=n-t,a=Math.min(i,o),c=this.slice(r,s),u=e.slice(t,n),h=0;h<a;++h)if(c[h]!==u[h]){i=c[h],o=u[h];break}return i<o?-1:o<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return k(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return k(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var s=this.length-t;if((void 0===n||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return A(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":case"latin1":case"binary":return R(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function L(e){var t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);var n="",r=0;while(r<t)n+=String.fromCharCode.apply(String,e.slice(r,r+=D));return n}function x(e,t,n){var r="";n=Math.min(e.length,n);for(var s=t;s<n;++s)r+=String.fromCharCode(127&e[s]);return r}function B(e,t,n){var r="";n=Math.min(e.length,n);for(var s=t;s<n;++s)r+=String.fromCharCode(e[s]);return r}function M(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var s="",i=t;i<n;++i)s+=Z[e[i]];return s}function U(e,t,n){for(var r=e.slice(t,n),s="",i=0;i<r.length-1;i+=2)s+=String.fromCharCode(r[i]+256*r[i+1]);return s}function F(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,s,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function V(e,t,n,r,s,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(e,t,n,r,i){return t=+t,n>>>=0,i||V(e,t,n,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,n,r,23,4),n+4}function $(e,t,n,r,i){return t=+t,n>>>=0,i||V(e,t,n,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);var r=this[e],s=1,i=0;while(++i<t&&(s*=256))r+=this[e+i]*s;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);var r=this[e+--t],s=1;while(t>0&&(s*=256))r+=this[e+--t]*s;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);var r=this[e],s=1,i=0;while(++i<t&&(s*=256))r+=this[e+i]*s;return s*=128,r>=s&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);var r=t,s=1,i=this[e+--r];while(r>0&&(s*=256))i+=this[e+--r]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),s.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),s.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),s.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),s.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){var s=Math.pow(2,8*n)-1;j(this,e,t,n,s,0)}var i=1,o=0;this[t]=255&e;while(++o<n&&(i*=256))this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){var s=Math.pow(2,8*n)-1;j(this,e,t,n,s,0)}var i=n-1,o=1;this[t+i]=255&e;while(--i>=0&&(o*=256))this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var s=Math.pow(2,8*n-1);j(this,e,t,n,s-1,-s)}var i=0,o=1,a=0;this[t]=255&e;while(++i<n&&(o*=256))e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var s=Math.pow(2,8*n-1);j(this,e,t,n,s-1,-s)}var i=n-1,o=1,a=0;this[t+i]=255&e;while(--i>=0&&(o*=256))e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,n){return z(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return z(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return $(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return $(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var s=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),s},l.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var s=e.charCodeAt(0);("utf8"===r&&s<128||"latin1"===r)&&(e=s)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=l.isBuffer(e)?e:l.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};var K=/[^+/0-9A-Za-z-_]/g;function H(e){if(e=e.split("=")[0],e=e.trim().replace(K,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function q(e,t){var n;t=t||1/0;for(var r=e.length,s=null,i=[],o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function W(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function G(e,t){for(var n,r,s,i=[],o=0;o<e.length;++o){if((t-=2)<0)break;n=e.charCodeAt(o),r=n>>8,s=n%256,i.push(s),i.push(r)}return i}function Y(e){return r.toByteArray(H(e))}function Q(e,t,n,r){for(var s=0;s<r;++s){if(s+n>=t.length||s>=e.length)break;t[s+n]=e[s]}return s}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!==e}var Z=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,s=0;s<16;++s)t[r+s]=e[n]+e[s];return t}()},8078:function(e,t,n){"use strict";var r=n(1503);t.fromCallback=function(e,t){if(void 0===e){var n=new Promise((function(t,n){e=function(e,r){e?n(e):t(r)}}));e[void 0!==t?t:"promise"]=n}else if("function"!==typeof e)throw new TypeError("Callback must be a function");return e},t.fromPromise=function(e,t){if(void 0===t)return e;e.then((function(e){r((()=>t(null,e)))})).catch((function(e){r((()=>t(e)))}))}},1503:function(e){e.exports="function"===typeof queueMicrotask?queueMicrotask:e=>Promise.resolve().then(e)},5739:function(e,t,n){t.Level=n(2196).BrowserLevel},5652:function(e,t,n){function r(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"===typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function s(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(s=r))})),t.splice(s,0,n)}function i(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}}function o(){let e;try{e=t.storage.getItem("debug")}catch(n){}return!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",BASE_URL:"/ypu/"}.DEBUG),e}function a(){try{return localStorage}catch(e){}}t.formatArgs=s,t.save=i,t.load=o,t.useColors=r,t.storage=a(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(2940)(t);const{formatters:c}=e.exports;c.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},2940:function(e,t,n){function r(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let t,n,i,o=null;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),i=s-(t||s);n.diff=i,n.prev=t,n.curr=s,t=s,e[0]=r.coerce(e[0]),"string"!==typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,s)=>{if("%%"===t)return"%";o++;const i=r.formatters[s];if("function"===typeof i){const r=e[o];t=i.call(n,r),e.splice(o,1),o--}return t})),r.formatArgs.call(n,e);const c=n.log||r.log;c.apply(n,e)}return a.namespace=e,a.useColors=r.useColors(),a.color=r.selectColor(e),a.extend=s,a.destroy=r.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(n!==r.namespaces&&(n=r.namespaces,i=r.enabled(e)),i),set:e=>{o=e}}),"function"===typeof r.init&&r.init(a),a}function s(e,t){const n=r(this.namespace+("undefined"===typeof t?":":t)+e);return n.log=this.log,n}function i(e){let t;r.save(e),r.namespaces=e,r.names=[],r.skips=[];const n=("string"===typeof e?e:"").split(/[\s,]+/),s=n.length;for(t=0;t<s;t++)n[t]&&(e=n[t].replace(/\*/g,".*?"),"-"===e[0]?r.skips.push(new RegExp("^"+e.slice(1)+"$")):r.names.push(new RegExp("^"+e+"$")))}function o(){const e=[...r.names.map(c),...r.skips.map(c).map((e=>"-"+e))].join(",");return r.enable(""),e}function a(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1}function c(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}function l(e){return e instanceof Error?e.stack||e.message:e}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=i,r.enabled=a,r.humanize=n(7901),r.destroy=u,Object.keys(e).forEach((t=>{r[t]=e[t]})),r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}n(541),n(7658),e.exports=r},8592:function(e){"use strict";const t=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),n=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},r=({clearTimeout:e,setTimeout:t,willResolve:r})=>(s,{value:i,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(n());let a,c,l;const u=e||clearTimeout,h=()=>{u(a),l(n())},d=()=>{o&&o.removeEventListener("abort",h)},f=new Promise(((e,n)=>{c=()=>{d(),r?e(i):n(i)},l=n,a=(t||setTimeout)(c,s)}));return o&&o.addEventListener("abort",h,{once:!0}),f.clear=()=>{u(a),a=null,c()},f},s=e=>{const n=r({...e,willResolve:!0});return n.reject=r({...e,willResolve:!1}),n.range=(e,r,s)=>n(t(e,r),s),n},i=s();i.createWithTimers=s,e.exports=i,e.exports["default"]=i},482:function(e,t,n){"use strict";function r(e,t){t=t||{};this._head=0,this._tail=0,this._capacity=t.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(e)&&this._fromArray(e)}n(541),n(7658),r.prototype.peekAt=function(e){var t=e;if(t===(0|t)){var n=this.size();if(!(t>=n||t<-n))return t<0&&(t+=n),t=this._head+t&this._capacityMask,this._list[t]}},r.prototype.get=function(e){return this.peekAt(e)},r.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]},r.prototype.peekFront=function(){return this.peek()},r.prototype.peekBack=function(){return this.peekAt(-1)},Object.defineProperty(r.prototype,"length",{get:function(){return this.size()}}),r.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.unshift=function(e){if(void 0===e)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}},r.prototype.push=function(e){if(void 0===e)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},r.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),n}},r.prototype.removeOne=function(e){var t=e;if(t===(0|t)&&this._head!==this._tail){var n=this.size(),r=this._list.length;if(!(t>=n||t<-n)){t<0&&(t+=n),t=this._head+t&this._capacityMask;var s,i=this._list[t];if(e<n/2){for(s=e;s>0;s--)this._list[t]=this._list[t=t-1+r&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+r&this._capacityMask}else{for(s=n-1-e;s>0;s--)this._list[t]=this._list[t=t+1+r&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+r&this._capacityMask}return i}}},r.prototype.remove=function(e,t){var n,r=e,s=t;if(r===(0|r)&&this._head!==this._tail){var i=this.size(),o=this._list.length;if(!(r>=i||r<-i||t<1)){if(r<0&&(r+=i),1===t||!t)return n=new Array(1),n[0]=this.removeOne(r),n;if(0===r&&r+t>=i)return n=this.toArray(),this.clear(),n;var a;for(r+t>i&&(t=i-r),n=new Array(t),a=0;a<t;a++)n[a]=this._list[this._head+r+a&this._capacityMask];if(r=this._head+r&this._capacityMask,e+t===i){for(this._tail=this._tail-t+o&this._capacityMask,a=t;a>0;a--)this._list[r=r+1+o&this._capacityMask]=void 0;return n}if(0===e){for(this._head=this._head+t+o&this._capacityMask,a=t-1;a>0;a--)this._list[r=r+1+o&this._capacityMask]=void 0;return n}if(r<i/2){for(this._head=this._head+e+t+o&this._capacityMask,a=e;a>0;a--)this.unshift(this._list[r=r-1+o&this._capacityMask]);r=this._head-1+o&this._capacityMask;while(s>0)this._list[r=r-1+o&this._capacityMask]=void 0,s--;e<0&&(this._tail=r)}else{for(this._tail=r,r=r+t+o&this._capacityMask,a=i-(t+e);a>0;a--)this.push(this._list[r++]);r=this._tail;while(s>0)this._list[r=r+1+o&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=o>>>2&&this._shrinkArray(),n}}},r.prototype.splice=function(e,t){var n=e;if(n===(0|n)){var r=this.size();if(n<0&&(n+=r),!(n>r)){if(arguments.length>2){var s,i,o,a=arguments.length,c=this._list.length,l=2;if(!r||n<r/2){for(i=new Array(n),s=0;s<n;s++)i[s]=this._list[this._head+s&this._capacityMask];0===t?(o=[],n>0&&(this._head=this._head+n+c&this._capacityMask)):(o=this.remove(n,t),this._head=this._head+n+c&this._capacityMask);while(a>l)this.unshift(arguments[--a]);for(s=n;s>0;s--)this.unshift(i[s-1])}else{i=new Array(r-(n+t));var u=i.length;for(s=0;s<u;s++)i[s]=this._list[this._head+n+t+s&this._capacityMask];0===t?(o=[],n!=r&&(this._tail=this._head+n+c&this._capacityMask)):(o=this.remove(n,t),this._tail=this._tail-u+c&this._capacityMask);while(l<a)this.push(arguments[l++]);for(s=0;s<u;s++)this.push(i[s])}return o}return this.remove(n,t)}}},r.prototype.clear=function(){this._head=0,this._tail=0},r.prototype.isEmpty=function(){return this._head===this._tail},r.prototype.toArray=function(){return this._copyArray(!1)},r.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])},r.prototype._copyArray=function(e){var t,n=[],r=this._list,s=r.length;if(e||this._head>this._tail){for(t=this._head;t<s;t++)n.push(r[t]);for(t=0;t<this._tail;t++)n.push(r[t])}else for(t=this._head;t<this._tail;t++)n.push(r[t]);return n},r.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},r.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1},e.exports=r},2883:function(e){!function(t,n){e.exports=function(e,t,n,r,s){for(t=t.split?t.split("."):t,r=0;r<t.length;r++)e=e?e[t[r]]:s;return e===s?n:e}}()},9998:function(e){"use strict";function t(e,t){for(const n in t)Object.defineProperty(e,n,{value:t[n],enumerable:!0,configurable:!0});return e}function n(e,n,r){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"===typeof n&&(r=n,n=""),n&&(r.code=n);try{return t(e,r)}catch(s){r.message=e.message,r.stack=e.stack;const n=function(){};n.prototype=Object.create(Object.getPrototypeOf(e));const i=t(new n,r);return i}}e.exports=n},4772:function(e,t,n){"use strict";n(7658);const r=n(6169);function s(e,t,n){return new r.EventIterator((({push:n})=>(this.addEventListener(e,n,t),()=>this.removeEventListener(e,n,t))),n)}t.zN=r.EventIterator,r.EventIterator},6169:function(e,t,n){"use strict";n(7658),Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class s{constructor(e,{highWaterMark:t=100,lowWaterMark:n=1}={}){const s=new r;s.highWaterMark=t,s.lowWaterMark=n,s.removeCallback=e({push:e=>s.push(e),stop:()=>s.stop(),fail:e=>s.fail(e),on:(e,t)=>{s.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>s[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=s,t["default"]=s},6856:function(e,t,n){"use strict";n(7658);var r=Object.prototype.hasOwnProperty,s="~";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function a(e,t,n,r,i){if("function"!==typeof n)throw new TypeError("The listener must be a function");var a=new o(n,r||e,i),c=s?s+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function c(e,t){0===--e._eventsCount?e._events=new i:delete e._events[t]}function l(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(s=!1)),l.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},l.prototype.listeners=function(e){var t=s?s+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,o=new Array(i);r<i;r++)o[r]=n[r].fn;return o},l.prototype.listenerCount=function(e){var t=s?s+e:e,n=this._events[t];return n?n.fn?1:n.length:0},l.prototype.emit=function(e,t,n,r,i,o){var a=s?s+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,r),!0;case 5:return u.fn.call(u.context,t,n,r,i),!0;case 6:return u.fn.call(u.context,t,n,r,i,o),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,r);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},l.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},l.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},l.prototype.removeListener=function(e,t,n,r){var i=s?s+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||c(this,i);else{for(var a=0,l=[],u=o.length;a<u;a++)(o[a].fn!==t||r&&!o[a].once||n&&o[a].context!==n)&&l.push(o[a]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=s,l.EventEmitter=l,e.exports=l},3793:function(e,t,n){"use strict";n(7658),n(541);var r,s="object"===typeof Reflect?Reflect:null,i=s&&"function"===typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function o(e){console&&console.warn&&console.warn(e)}r=s&&"function"===typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!==e};function c(){c.init.call(this)}e.exports=c,e.exports.once=v,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function h(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var s,i,a;if(u(n),i=e._events,void 0===i?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]),void 0===a)a=i[t]=n,++e._eventsCount;else if("function"===typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),s=h(e),s>0&&a.length>s&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,o(c)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=f.bind(r);return s.listener=n,r.wrapFn=s,s}function g(e,t,n){var r=e._events;if(void 0===r)return[];var s=r[t];return void 0===s?[]:"function"===typeof s?n?[s.listener||s]:[s]:n?b(s):m(s,s.length)}function y(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function w(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function b(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function v(e,t){return new Promise((function(n,r){function s(n){e.removeListener(t,i),r(n)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",s),n([].slice.call(arguments))}E(e,t,i,{once:!0}),"error"!==t&&_(e,s,{once:!0})}))}function _(e,t,n){"function"===typeof e.on&&E(e,"error",t,n)}function E(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(i){r.once&&e.removeEventListener(t,s),n(i)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!==typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return h(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"===typeof c)i(c,this,t);else{var l=c.length,u=m(c,l);for(n=0;n<l;++n)i(u[n],this,t)}return!0},c.prototype.addListener=function(e,t){return d(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return d(this,e,t,!0)},c.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,s,i,o;if(u(t),r=this._events,void 0===r)return this;if(n=r[e],void 0===n)return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(s=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){o=n[i].listener,s=i;break}if(s<0)return this;0===s?n.shift():w(n,s),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,i=Object.keys(n);for(r=0;r<i.length;++r)s=i[r],"removeListener"!==s&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],"function"===typeof t)this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return g(this,e,!0)},c.prototype.rawListeners=function(e){return g(this,e,!1)},c.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):y.call(e,t)},c.prototype.listenerCount=y,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},2771:function(e){e.exports=class{constructor(e){if(!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return void 0===this.buffer[this.btm]}}},2819:function(e,t,n){n(7658);const r=n(2771);e.exports=class{constructor(e){this.hwm=e||16,this.head=new r(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){const t=this.head;this.head=t.next=new r(2*this.head.buffer.length),this.head.push(e)}}shift(){const e=this.tail.shift();if(void 0===e&&this.tail.next){const e=this.tail.next;return this.tail.next=null,this.tail=e,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}},1173:function(e,t){"use strict";function n(e,t=n.BASE){const r=e.length;for(let n=0;n<r;n++)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}Object.defineProperty(t,"__esModule",{value:!0}),n.BASE=2166136261,t["default"]=n,e.exports=n},8694:function(e){e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,n=Object.create(null),r=Object.create(null);function s(s,i){n[s]=i,t++,t>=e&&(t=0,r=n,n=Object.create(null))}return{has:function(e){return void 0!==n[e]||void 0!==r[e]},remove:function(e){void 0!==n[e]&&(n[e]=void 0),void 0!==r[e]&&(r[e]=void 0)},get:function(e){var t=n[e];return void 0!==t?t:void 0!==(t=r[e])?(s(e,t),t):void 0},set:function(e,t){void 0!==n[e]?n[e]=t:s(e,t)},clear:function(){n=Object.create(null),r=Object.create(null)}}}},7055:function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,s){var i,o,a=8*s-r-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?s-1:0,d=n?-1:1,f=e[t+h];for(h+=d,i=f&(1<<-u)-1,f>>=-u,u+=a;u>0;i=256*i+e[t+h],h+=d,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=r;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===i)i=1-l;else{if(i===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),i-=l}return(f?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,s,i){var o,a,c,l=8*i-s-1,u=(1<<l)-1,h=u>>1,d=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),t+=o+h>=1?d/c:d*Math.pow(2,1-h),t*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*c-1)*Math.pow(2,s),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;e[n+f]=255&a,f+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;e[n+f]=255&o,f+=p,o/=256,l-=8);e[n+f-p]|=128*g}},9564:function(e,t,n){n(7658),function(t){"use strict";const n="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${n}\\.${n}\\.${n}\\.${n}$`,"i"),threeOctet:new RegExp(`^${n}\\.${n}\\.${n}$`,"i"),twoOctet:new RegExp(`^${n}\\.${n}$`,"i"),longValue:new RegExp(`^${n}$`,"i")},s=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",c={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${n}\\.${n}\\.${n}\\.${n}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${n}\\.${n}\\.${n}\\.${n}(${o})?$`,"i")};function l(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let n,r,s=0,i=-1,o=(e.match(c.zoneIndex)||[])[0];o&&(o=o.substring(1),e=e.replace(/%.+$/,""));while((i=e.indexOf(":",i+1))>=0)s++;if("::"===e.substr(0,2)&&s--,"::"===e.substr(-2,2)&&s--,s>t)return null;r=t-s,n=":";while(r--)n+="0:";return e=e.replace("::",n),":"===e[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),t=function(){const t=e.split(":"),n=[];for(let e=0;e<t.length;e++)n.push(parseInt(t[e],16));return n}(),{parts:t,zoneId:o}}function u(e,t,n,r){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let s,i=0;while(r>0){if(s=n-r,s<0&&(s=0),e[i]>>s!==t[i]>>s)return!1;r-=n,i+=1}return!0}function h(e){if(i.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(s.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function d(e,t){while(e.length<t)e=`0${e}`;return e}const f={};f.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,n;for(t=0;t<e.length;t++)if(n=e[t],!(0<=n&&n<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let n;if(void 0===t&&(n=e,e=n[0],t=n[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const n={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let r,s,i;for(r=3;r>=0;r-=1){if(s=this.octets[r],!(s in n))return null;if(i=n[s],t&&0!==i)return null;8!==i&&(t=!0),e+=i}return 32-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return f.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),f.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[];let i=0;while(i<4)s.push(parseInt(n[i],10)|255^parseInt(r[i],10)),i++;return new this(s)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.isIPv4=function(e){return null!==this.parser(e)},f.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(t){return!1}},f.IPv4.isValidFourPartDecimal=function(e){return!(!f.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},f.IPv4.networkAddressFromCIDR=function(e){let t,n,r,s,i;try{t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[],n=0;while(n<4)s.push(parseInt(r[n],10)&parseInt(i[n],10)),n++;return new this(s)}catch(o){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},f.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const n=[this.parse(t[1]),e];return Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},f.IPv4.parser=function(e){let t,n,s;if(t=e.match(r.fourOctet))return function(){const e=t.slice(1,6),r=[];for(let t=0;t<e.length;t++)n=e[t],r.push(h(n));return r}();if(t=e.match(r.longValue)){if(s=h(t[1]),s>4294967295||s<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(s>>t&255);return e}().reverse()}return(t=e.match(r.twoOctet))?function(){const e=t.slice(1,4),n=[];if(s=h(e[1]),s>16777215||s<0)throw new Error("ipaddr: address outside defined range");return n.push(h(e[0])),n.push(s>>16&255),n.push(s>>8&255),n.push(255&s),n}():(t=e.match(r.threeOctet))?function(){const e=t.slice(1,5),n=[];if(s=h(e[2]),s>65535||s<0)throw new Error("ipaddr: address outside defined range");return n.push(h(e[0])),n.push(h(e[1])),n.push(s>>8&255),n.push(255&s),n}():null},f.IPv4.subnetMaskFromPrefixLength=function(e){if(e=parseInt(e),e<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let n=0;const r=Math.floor(e/8);while(n<r)t[n]=255,n++;return r<4&&(t[r]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.IPv6=function(){function e(e,t){let n,r;if(16===e.length)for(this.parts=[],n=0;n<=14;n+=2)this.parts.push(e[n]<<8|e[n+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(n=0;n<this.parts.length;n++)if(r=this.parts[n],!(0<=r&&r<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let n;if(void 0===t&&(n=e,e=n[0],t=n[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const n={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let r,s;for(let i=7;i>=0;i-=1){if(r=this.parts[i],!(r in n))return null;if(s=n[r],t&&0!==s)return null;16!==s&&(t=!0),e+=s}return 128-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],n=this.parts;for(let r=0;r<n.length;r++)e=n[r],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(d(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],n=e[1];return new f.IPv4([t>>8,255&t,n>>8,255&n])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let n,r=0,s=-1;while(n=e.exec(t))n[0].length>s&&(r=n.index,s=n[0].length);return s<0?t:`${t.substring(0,r)}::${t.substring(r+s)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),f.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),n=t[0].toByteArray(),r=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[];let i=0;while(i<16)s.push(parseInt(n[i],10)|255^parseInt(r[i],10)),i++;return new this(s)}catch(t){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${t})`)}},f.IPv6.isIPv6=function(e){return null!==this.parser(e)},f.IPv6.isValid=function(e){if("string"===typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(t){return!1}},f.IPv6.networkAddressFromCIDR=function(e){let t,n,r,s,i;try{t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),s=[],n=0;while(n<16)s.push(parseInt(r[n],10)&parseInt(i[n],10)),n++;return new this(s)}catch(o){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${o})`)}},f.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},f.IPv6.parseCIDR=function(e){let t,n,r;if((n=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(n[2]),t>=0&&t<=128))return r=[this.parse(n[1]),t],Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},f.IPv6.parser=function(e){let t,n,r,s,i,o;if(r=e.match(c.deprecatedTransitional))return this.parser(`::ffff:${r[1]}`);if(c.native.test(e))return l(e,8);if((r=e.match(c.transitional))&&(o=r[6]||"",t=l(r[1].slice(0,-1)+o,6),t.parts)){for(i=[parseInt(r[2]),parseInt(r[3]),parseInt(r[4]),parseInt(r[5])],n=0;n<i.length;n++)if(s=i[n],!(0<=s&&s<=255))return null;return t.parts.push(i[0]<<8|i[1]),t.parts.push(i[2]<<8|i[3]),{parts:t.parts,zoneId:t.zoneId}}return null},f.IPv6.subnetMaskFromPrefixLength=function(e){if(e=parseInt(e),e<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let n=0;const r=Math.floor(e/8);while(n<r)t[n]=255,n++;return r<16&&(t[r]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.fromByteArray=function(e){const t=e.length;if(4===t)return new f.IPv4(e);if(16===t)return new f.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},f.isValid=function(e){return f.IPv6.isValid(e)||f.IPv4.isValid(e)},f.parse=function(e){if(f.IPv6.isValid(e))return f.IPv6.parse(e);if(f.IPv4.isValid(e))return f.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},f.parseCIDR=function(e){try{return f.IPv6.parseCIDR(e)}catch(t){try{return f.IPv4.parseCIDR(e)}catch(n){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},f.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},f.subnetMatch=function(e,t,n){let r,s,i,o;for(s in void 0!==n&&null!==n||(n="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,s))for(i=t[s],!i[0]||i[0]instanceof Array||(i=[i]),r=0;r<i.length;r++)if(o=i[r],e.kind()===o[0].kind()&&e.match.apply(e,o))return s;return n},e.exports?e.exports=f:t.ipaddr=f}(this)},6827:function(e){"use strict";
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */e.exports=i,e.exports.format=o,e.exports.parse=a;var t=/\B(?=(\d{3})+(?!\d))/g,n=/(?:\.0*|(\.[^0]+)0+)$/,r={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},s=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function i(e,t){return"string"===typeof e?a(e):"number"===typeof e?o(e,t):null}function o(e,s){if(!Number.isFinite(e))return null;var i=Math.abs(e),o=s&&s.thousandsSeparator||"",a=s&&s.unitSeparator||"",c=s&&void 0!==s.decimalPlaces?s.decimalPlaces:2,l=Boolean(s&&s.fixedDecimals),u=s&&s.unit||"";u&&r[u.toLowerCase()]||(u=i>=r.pb?"PB":i>=r.tb?"TB":i>=r.gb?"GB":i>=r.mb?"MB":i>=r.kb?"KB":"B");var h=e/r[u.toLowerCase()],d=h.toFixed(c);return l||(d=d.replace(n,"$1")),o&&(d=d.split(".").map((function(e,n){return 0===n?e.replace(t,o):e})).join(".")),d+a+u}function a(e){if("number"===typeof e&&!isNaN(e))return e;if("string"!==typeof e)return null;var t,n=s.exec(e),i="b";return n?(t=parseFloat(n[1]),i=n[4].toLowerCase()):(t=parseInt(e,10),i="b"),isNaN(t)?null:Math.floor(r[i]*t)}},6008:function(e){"use strict";async function*t(e,t={}){const n=e.getReader();try{while(1){const e=await n.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&n.cancel(),n.releaseLock()}}e.exports=t},9018:function(e,t,n){"use strict";n(7658);const r=async e=>{const t=[];for await(const n of e)t.push(n);return t};e.exports=r},9860:function(e,t,n){"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?e.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:e.exports={default:n(333)["default"],Headers:n(333).Headers,Request:n(333).Request,Response:n(333).Response}},798:function(e,t,n){"use strict";const r=n(4024),s="object"===typeof window&&"object"===typeof document&&9===document.nodeType,i=r(),o=s&&!i,a=i&&!s,c=i&&s,l="undefined"!==typeof process&&"undefined"!==typeof process.release&&"node"===process.release.name&&!i,u="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,h="undefined"!==typeof process&&!1,d="undefined"!==typeof navigator&&"ReactNative"===navigator.product;e.exports={isTest:h,isElectron:i,isElectronMain:a,isElectronRenderer:c,isNode:l,isBrowser:o,isWebWorker:u,isEnvWithDom:s,isReactNative:d}},3223:function(e,t,n){"use strict";e.exports=n(9860)},8624:function(e,t,n){"use strict";const r=n(3436),s=(e,t)=>({path:decodeURIComponent(new URL(e).pathname.split("/").pop()||""),content:i(e,t)});async function*i(e,t){const n=new r,s=await n.get(e,t);yield*s.iterator()}e.exports=s},3436:function(e,t,n){"use strict";const{fetch:r,Request:s,Headers:i}=n(7579),{TimeoutError:o,HTTPError:a}=n(7262),c=n(535).bind({ignoreUndefined:!0}),{URL:l,URLSearchParams:u}=n(9339),h=n(4908),d=n(6008),{isBrowser:f,isWebWorker:p}=n(798),g=n(9018),y=(e,t,n)=>{if(void 0===t)return e;const r=Date.now(),s=()=>{const e=Date.now()-r;return e>=t};return new Promise(((r,i)=>{const a=setTimeout((()=>{s()&&(i(new o),n.abort())}),t),c=e=>{const t=t=>{clearTimeout(a),s()?i(new o):e(t)};return t};e.then(c(r),c(i))}))},m={throwHttpErrors:!0,credentials:"same-origin"};class w{constructor(e={}){this.opts=c(m,e)}async fetch(e,t={}){const n=c(this.opts,t),o=new i(n.headers);if("string"!==typeof e&&!(e instanceof l||e instanceof s))throw new TypeError("`resource` must be a string, URL, or Request");const m=new l(e.toString(),n.base),{searchParams:w,transformSearchParams:_,json:E}=n;w&&(m.search="function"===typeof _?_(new u(n.searchParams)):new u(n.searchParams)),E&&(n.body=JSON.stringify(n.json),o.set("content-type","application/json"));const S=new AbortController,k=h([S.signal,n.signal]);null!=globalThis.ReadableStream&&n.body instanceof globalThis.ReadableStream&&(f||p)&&(n.body=new Blob(await g(d(n.body))));const I=await y(r(m.toString(),{...n,signal:k,timeout:void 0,headers:o,duplex:"half"}),n.timeout,S);if(!I.ok&&n.throwHttpErrors)throw n.handleError&&await n.handleError(I),new a(I);return I.iterator=async function*(){yield*v(I.body)},I.ndjson=async function*(){for await(const e of b(I.iterator()))t.transform?yield t.transform(e):yield e},I}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}}const b=async function*(e){const t=new TextDecoder;let n="";for await(const r of e){n+=t.decode(r,{stream:!0});const e=n.split(/\r?\n/);for(let t=0;t<e.length-1;t++){const n=e[t].trim();n.length>0&&(yield JSON.parse(n))}n=e[e.length-1]}n+=t.decode(),n=n.trim(),0!==n.length&&(yield JSON.parse(n))},v=e=>{if(_(e))return e;if(S(e)){const t=e[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:t.next.bind(t),return(n){return e.destroy(),"function"===typeof t.return?t.return():Promise.resolve({done:!0,value:n})}}}}}if(E(e)){const t=e.getReader();return async function*(){try{while(1){const{done:e,value:n}=await t.read();if(e)return;n&&(yield n)}}finally{t.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},_=e=>"object"===typeof e&&null!==e&&"function"===typeof e[Symbol.asyncIterator],E=e=>e&&"function"===typeof e.getReader,S=e=>Object.prototype.hasOwnProperty.call(e,"readable")&&Object.prototype.hasOwnProperty.call(e,"writable");w.HTTPError=a,w.TimeoutError=o,w.streamToAsyncIterator=v,w.post=(e,t)=>new w(t).post(e,t),w.get=(e,t)=>new w(t).get(e,t),w.put=(e,t)=>new w(t).put(e,t),w.delete=(e,t)=>new w(t).delete(e,t),w.options=(e,t)=>new w(t).options(e,t),e.exports=w},7262:function(e,t){"use strict";class n extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}t.TimeoutError=n;class r extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}t.AbortError=r;class s extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}}t.HTTPError=s},7579:function(e,t,n){"use strict";const{TimeoutError:r,AbortError:s}=n(7262),{Response:i,Request:o,Headers:a,default:c}=n(3223),l=(e,t={})=>{const n=new XMLHttpRequest;n.open(t.method||"GET",e.toString(),!0);const{timeout:o,headers:c}=t;if(o&&o>0&&o<1/0&&(n.timeout=o),null!=t.overrideMimeType&&n.overrideMimeType(t.overrideMimeType),c)for(const[r,s]of new a(c))n.setRequestHeader(r,s);return t.signal&&(t.signal.onabort=()=>n.abort()),t.onUploadProgress&&(n.upload.onprogress=t.onUploadProgress),n.responseType="arraybuffer",new Promise(((e,o)=>{const a=t=>{switch(t.type){case"error":e(i.error());break;case"load":e(new f(n.responseURL,n.response,{status:n.status,statusText:n.statusText,headers:d(n.getAllResponseHeaders())}));break;case"timeout":o(new r);break;case"abort":o(new s);break;default:break}};n.onerror=a,n.onload=a,n.ontimeout=a,n.onabort=a,n.send(t.body)}))},u=c,h=(e,t={})=>null!=t.onUploadProgress?l(e,t):u(e,t),d=e=>{const t=new a;for(const n of e.trim().split(/[\r\n]+/)){const e=n.indexOf(": ");e>0&&t.set(n.slice(0,e),n.slice(e+1))}return t};class f extends i{constructor(e,t,n){super(t,n),Object.defineProperty(this,"url",{value:e})}}e.exports={fetch:h,Request:o,Headers:a}},1050:function(e){"use strict";var t=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;e.exports=function(e,n){if(null==n&&(n=!1),e.length<2)return!1;if(e.length>255)return!1;var r=e[e.length-1];if(n){if("."!==r)return!1}else if("."===r)return!1;return t.test(e)}},4024:function(e){function t(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof process||"object"!==typeof process.versions||!process.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}e.exports=t},3837:function(e){"use strict";e.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488447,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},1809:function(e){"use strict";const t=65536;function n(e){const n=new Uint8Array(e);let r=0;if(e>0)if(e>t)while(r<e)r+t>e?(crypto.getRandomValues(n.subarray(r,r+(e-r))),r+=e-r):(crypto.getRandomValues(n.subarray(r,r+t)),r+=t);else crypto.getRandomValues(n);return n}e.exports=n},9339:function(e,t,n){"use strict";const{URLWithLegacySupport:r,format:s,URLSearchParams:i,defaultBase:o}=n(7141),a=n(7200);e.exports={URL:r,URLSearchParams:i,format:s,relative:a,defaultBase:o}},7200:function(e,t,n){"use strict";const{URLWithLegacySupport:r,format:s}=n(7141);e.exports=(e,t={},n={},i)=>{let o,a=t.protocol?t.protocol.replace(":",""):"http";a=(n[a]||i||a)+":";try{o=new r(e)}catch(l){o={}}const c=Object.assign({},t,{protocol:a||o.protocol,host:t.host||o.host});return new r(e,s(c)).toString()}},7141:function(e){"use strict";const t="undefined"!==typeof navigator&&"ReactNative"===navigator.product;function n(){return t?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const r=self.URL,s=n();class i{constructor(e="",t=s){this.super=new r(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return r.createObjectURL(e)}static revokeObjectURL(e){r.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function o(e){if("string"===typeof e){const t=new r(e);return t.toString()}if(!(e instanceof r)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",n=e.auth?e.auth+"@":"",r=e.port?":"+e.port:"",s=e.protocol?e.protocol+"//":"",i=e.host||"",o=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",l=e.pathname||"",u=e.path||l+a;return`${s}${t||n}${i||o+r}${u}${c}`}}e.exports={URLWithLegacySupport:i,URLSearchParams:self.URLSearchParams,defaultBase:s,format:o}},6657:function(e,t,n){"use strict";n(7658);const r=n(7602),{EventEmitter:s}=n(3793);function i(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;++n)if(e[n]!==t[n])return!1;return!0}function o(){return{contacts:[],dontSplit:!1,left:null,right:null}}function a(e,t){if(!(t instanceof Uint8Array))throw new TypeError(e+" is not a Uint8Array")}class c extends s{constructor(e={}){super(),this.localNodeId=e.localNodeId||r(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||c.distance,this.arbiter=e.arbiter||c.arbiter,this.metadata=Object.assign({},e.metadata),a("option.localNodeId as parameter 1",this.localNodeId),this.root=o()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let n=0,r=0;const s=Math.min(e.length,t.length),i=Math.max(e.length,t.length);for(;r<s;++r)n=256*n+(e[r]^t[r]);for(;r<i;++r)n=256*n+255;return n}add(e){a("contact.id",(e||{}).id);let t=0,n=this.root;while(null===n.contacts)n=this._determineNode(n,e.id,t++);const r=this._indexOf(n,e.id);return r>=0?(this._update(n,r,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.emit("added",e),this):n.dontSplit?(this.emit("ping",n.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(n,t),this.add(e))}closest(e,t=1/0){if(a("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let n=[];for(let r=[this.root],s=0;r.length>0&&n.length<t;){const t=r.pop();if(null===t.contacts){const n=this._determineNode(t,e,s++);r.push(t.left===n?t.right:t.left),r.push(n)}else n=n.concat(t.contacts)}return n.map((t=>[this.distance(t.id,e),t])).sort(((e,t)=>e[0]-t[0])).slice(0,t).map((e=>e[1]))}count(){let e=0;for(const t=[this.root];t.length>0;){const n=t.pop();null===n.contacts?t.push(n.right,n.left):e+=n.contacts.length}return e}_determineNode(e,t,n){const r=n>>3,s=n%8;if(t.length<=r&&0!==s)return e.left;const i=t[r];return i&1<<7-s?e.right:e.left}get(e){a("id",e);let t=0,n=this.root;while(null===n.contacts)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);return r>=0?n.contacts[r]:null}_indexOf(e,t){for(let n=0;n<e.contacts.length;++n)if(i(e.contacts[n].id,t))return n;return-1}remove(e){a("the id as parameter 1",e);let t=0,n=this.root;while(null===n.contacts)n=this._determineNode(n,e,t++);const r=this._indexOf(n,e);if(r>=0){const e=n.contacts.splice(r,1)[0];this.emit("removed",e)}return this}_split(e,t){e.left=o(),e.right=o();for(const s of e.contacts)this._determineNode(e,s.id,t).contacts.push(s);e.contacts=null;const n=this._determineNode(e,this.localNodeId,t),r=e.left===n?e.right:e.left;r.dontSplit=!0}toArray(){let e=[];for(const t=[this.root];t.length>0;){const n=t.pop();null===n.contacts?t.push(n.right,n.left):e=e.concat(n.contacts)}return e}*toIterable(){for(const e=[this.root];e.length>0;){const t=e.pop();null===t.contacts?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,n){if(!i(e.contacts[t].id,n.id))throw new Error("wrong index for _update");const r=e.contacts[t],s=this.arbiter(r,n);s===r&&r!==n||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",r,s))}}e.exports=c},1541:function(e,t,n){"use strict";const r=n(4334),s=n(8681),{Encoding:i}=n(789),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=n(1657),l=Symbol("formats"),u=Symbol("encodings"),h=new Set(["buffer","view","utf8"]);class d{constructor(e){if(!Array.isArray(e))throw new TypeError("The first argument 'formats' must be an array");if(!e.every((e=>h.has(e))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[u]=new Map,this[l]=new Set(e);for(const n in s)try{this.encoding(n)}catch(t){if("LEVEL_ENCODING_NOT_SUPPORTED"!==t.code)throw t}}encodings(){return Array.from(new Set(this[u].values()))}encoding(e){let t=this[u].get(e);if(void 0===t){if("string"===typeof e&&""!==e){if(t=y[e],!t)throw new r(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!==typeof e||null===e)throw new TypeError("First argument 'encoding' must be a string or object");t=f(e)}const{name:n,format:s}=t;if(!this[l].has(s))if(this[l].has("view"))t=t.createViewTranscoder();else if(this[l].has("buffer"))t=t.createBufferTranscoder();else{if(!this[l].has("utf8"))throw new r(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});t=t.createUTF8Transcoder()}for(const r of[e,n,t.name,t.commonName])this[u].set(r,t)}return t}}function f(e){if(e instanceof i)return e;const t="type"in e&&"string"===typeof e.type?e.type:void 0,n=e.name||t||"anonymous-"+m++;switch(p(e)){case"view":return new a({...e,name:n});case"utf8":return new c({...e,name:n});case"buffer":return new o({...e,name:n});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function p(e){return"format"in e&&void 0!==e.format?e.format:"buffer"in e&&"boolean"===typeof e.buffer?e.buffer?"buffer":"utf8":"code"in e&&Number.isInteger(e.code)?"view":"buffer"}t.Transcoder=d;const g={binary:s.buffer,"utf-8":s.utf8},y={...s,...g};let m=0},789:function(e,t,n){"use strict";const r=n(4334),s=new Set(["buffer","view","utf8"]);class i{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,"function"!==typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!==typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!==typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!==typeof this.format||!s.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new r(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new r(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new r(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}}t.Encoding=i},8681:function(e,t,n){"use strict";const{Buffer:r}=n(4308)||{Buffer:{isBuffer:()=>!1}},{textEncoder:s,textDecoder:i}=n(4916)(),{BufferFormat:o,ViewFormat:a,UTF8Format:c}=n(1657),l=e=>e;t.utf8=new c({encode:function(e){return r.isBuffer(e)?e.toString("utf8"):ArrayBuffer.isView(e)?i.decode(e):String(e)},decode:l,name:"utf8",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:s.encode(e)},decode:function(e){return i.decode(e)},name:`${this.name}+view`})},createBufferTranscoder(){return new o({encode:function(e){return r.isBuffer(e)?e:ArrayBuffer.isView(e)?r.from(e.buffer,e.byteOffset,e.byteLength):r.from(String(e),"utf8")},decode:function(e){return e.toString("utf8")},name:`${this.name}+buffer`})}}),t.json=new c({encode:JSON.stringify,decode:JSON.parse,name:"json"}),t.buffer=new o({encode:function(e){return r.isBuffer(e)?e:ArrayBuffer.isView(e)?r.from(e.buffer,e.byteOffset,e.byteLength):r.from(String(e),"utf8")},decode:l,name:"buffer",createViewTranscoder(){return new a({encode:function(e){return ArrayBuffer.isView(e)?e:r.from(String(e),"utf8")},decode:function(e){return r.from(e.buffer,e.byteOffset,e.byteLength)},name:`${this.name}+view`})}}),t.view=new a({encode:function(e){return ArrayBuffer.isView(e)?e:s.encode(e)},decode:l,name:"view",createBufferTranscoder(){return new o({encode:function(e){return r.isBuffer(e)?e:ArrayBuffer.isView(e)?r.from(e.buffer,e.byteOffset,e.byteLength):r.from(String(e),"utf8")},decode:l,name:`${this.name}+buffer`})}}),t.hex=new o({encode:function(e){return r.isBuffer(e)?e:r.from(String(e),"hex")},decode:function(e){return e.toString("hex")},name:"hex"}),t.base64=new o({encode:function(e){return r.isBuffer(e)?e:r.from(String(e),"base64")},decode:function(e){return e.toString("base64")},name:"base64"})},1657:function(e,t,n){"use strict";const{Buffer:r}=n(4308)||{},{Encoding:s}=n(789),i=n(4916);class o extends s{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new a({encode:this.encode,decode:e=>this.decode(r.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class a extends s{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new o({encode:e=>{const t=this.encode(e);return r.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}class c extends s{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new o({encode:e=>r.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:t}=i();return new a({encode:t=>e.encode(this.encode(t)),decode:e=>this.decode(t.decode(e)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}}t.BufferFormat=o,t.ViewFormat=a,t.UTF8Format=c},4916:function(e){"use strict";let t=null;e.exports=function(){return null===t&&(t={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),t}},4308:function(e,t,n){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */n(7658);const r=n(1271),s=n(7055),i="function"===typeof Symbol&&"function"===typeof Symbol["for"]?Symbol["for"]("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}function c(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return u(e,t,n)}function u(e,t,n){if("string"===typeof e)return p(e,t);if(ArrayBuffer.isView(e))return y(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(oe(e,ArrayBuffer)||e&&oe(e.buffer,ArrayBuffer))return m(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(oe(e,SharedArrayBuffer)||e&&oe(e.buffer,SharedArrayBuffer)))return m(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);const s=w(e);if(s)return s;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e,t,n){return h(e),e<=0?c(e):void 0!==t?"string"===typeof n?c(e).fill(t,n):c(e).fill(t):c(e)}function f(e){return h(e),c(e<0?0:0|b(e))}function p(e,t){if("string"===typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|_(e,t);let r=c(n);const s=r.write(e,t);return s!==n&&(r=r.slice(0,s)),r}function g(e){const t=e.length<0?0:0|b(e.length),n=c(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function y(e){if(oe(e,Uint8Array)){const t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return g(e)}function m(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function w(e){if(l.isBuffer(e)){const t=0|b(e.length),n=c(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!==typeof e.length||ae(e.length)?c(0):g(e):"Buffer"===e.type&&Array.isArray(e.data)?g(e.data):void 0}function b(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),l.alloc(+e)}function _(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||oe(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return te(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return se(e).length;default:if(s)return r?-1:te(e).length;t=(""+t).toLowerCase(),s=!0}}function E(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";e||(e="utf8");while(1)switch(e){case"hex":return M(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return N(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function S(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function k(e,t,n,r,s){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,ae(n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"===typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:I(e,t,n,r,s);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):I(e,[t],n,r,s);throw new TypeError("val must be string, number or Buffer")}function I(e,t,n,r,s){let i,o=1,a=e.length,c=t.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let r=-1;for(i=n;i<a;i++)if(l(e,i)===l(t,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===c)return r*o}else-1!==r&&(i-=i-r),r=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){let n=!0;for(let r=0;r<c;r++)if(l(e,i+r)!==l(t,r)){n=!1;break}if(n)return i}return-1}function A(e,t,n,r){n=Number(n)||0;const s=e.length-n;r?(r=Number(r),r>s&&(r=s)):r=s;const i=t.length;let o;for(r>i/2&&(r=i/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(ae(r))return o;e[n+o]=r}return o}function T(e,t,n,r){return ie(te(t,e.length-n),e,n,r)}function R(e,t,n,r){return ie(ne(t),e,n,r)}function C(e,t,n,r){return ie(se(t),e,n,r)}function P(e,t,n,r){return ie(re(t,e.length-n),e,n,r)}function N(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);const r=[];let s=t;while(s<n){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=n){let n,r,a,c;switch(o){case 1:t<128&&(i=t);break;case 2:n=e[s+1],128===(192&n)&&(c=(31&t)<<6|63&n,c>127&&(i=c));break;case 3:n=e[s+1],r=e[s+2],128===(192&n)&&128===(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[s+1],r=e[s+2],a=e[s+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),s+=o}return L(r)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=a(),l.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return d(e,t,n)},l.allocUnsafe=function(e){return f(e)},l.allocUnsafeSlow=function(e){return f(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(oe(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),oe(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let s=0,i=Math.min(n,r);s<i;++s)if(e[s]!==t[s]){n=e[s],r=t[s];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=l.allocUnsafe(t);let s=0;for(n=0;n<e.length;++n){let t=e[n];if(oe(t,Uint8Array))s+t.length>r.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(r,s)):Uint8Array.prototype.set.call(r,t,s);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,s)}s+=t.length}return r},l.byteLength=_,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)S(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?O(this,0,e):E.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,s){if(oe(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),t<0||n>e.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&t>=n)return 0;if(r>=s)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,s>>>=0,this===e)return 0;let i=s-r,o=n-t;const a=Math.min(i,o),c=this.slice(r,s),u=e.slice(t,n);for(let l=0;l<a;++l)if(c[l]!==u[l]){i=c[l],o=u[l];break}return i<o?-1:o<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return k(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return k(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const s=this.length-t;if((void 0===n||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return A(this,e,t,n);case"utf8":case"utf-8":return T(this,e,t,n);case"ascii":case"latin1":case"binary":return R(this,e,t,n);case"base64":return C(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const D=4096;function L(e){const t=e.length;if(t<=D)return String.fromCharCode.apply(String,e);let n="",r=0;while(r<t)n+=String.fromCharCode.apply(String,e.slice(r,r+=D));return n}function x(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(127&e[s]);return r}function B(e,t,n){let r="";n=Math.min(e.length,n);for(let s=t;s<n;++s)r+=String.fromCharCode(e[s]);return r}function M(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let s="";for(let i=t;i<n;++i)s+=ce[e[i]];return s}function U(e,t,n){const r=e.slice(t,n);let s="";for(let i=0;i<r.length-1;i+=2)s+=String.fromCharCode(r[i]+256*r[i+1]);return s}function F(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,s,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function V(e,t,n,r,s){Q(t,r,s,e,n,7);let i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function z(e,t,n,r,s){Q(t,r,s,e,n,7);let i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function $(e,t,n,r,s,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function K(e,t,n,r,i){return t=+t,n>>>=0,i||$(e,t,n,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,n,r,23,4),n+4}function H(e,t,n,r,i){return t=+t,n>>>=0,i||$(e,t,n,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=this[e],s=1,i=0;while(++i<t&&(s*=256))r+=this[e+i]*s;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=this[e+--t],s=1;while(t>0&&(s*=256))r+=this[e+--t]*s;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||F(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(s)<<BigInt(32))})),l.prototype.readBigUInt64BE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(s)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=this[e],s=1,i=0;while(++i<t&&(s*=256))r+=this[e+i]*s;return s*=128,r>=s&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||F(e,t,this.length);let r=t,s=1,i=this[e+--r];while(r>0&&(s*=256))i+=this[e+--r]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return e>>>=0,t||F(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||F(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||F(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||F(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=le((function(e){e>>>=0,X(e,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||F(e,4,this.length),s.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||F(e,4,this.length),s.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||F(e,8,this.length),s.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||F(e,8,this.length),s.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){const r=Math.pow(2,8*n)-1;j(this,e,t,n,r,0)}let s=1,i=0;this[t]=255&e;while(++i<n&&(s*=256))this[t+i]=e/s&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){const r=Math.pow(2,8*n)-1;j(this,e,t,n,r,0)}let s=n-1,i=1;this[t+s]=255&e;while(--s>=0&&(i*=256))this[t+s]=e/i&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=le((function(e,t=0){return V(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=le((function(e,t=0){return z(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}let s=0,i=1,o=0;this[t]=255&e;while(++s<n&&(i*=256))e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}let s=n-1,i=1,o=0;this[t+s]=255&e;while(--s>=0&&(i*=256))e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=le((function(e,t=0){return V(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=le((function(e,t=0){return z(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return K(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return K(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return H(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return H(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const s=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),s},l.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(s=t;s<n;++s)this[s]=e;else{const i=l.isBuffer(e)?e:l.from(e,r),o=i.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-t;++s)this[s+t]=i[s%o]}return this};const q={};function W(e,t,n){q[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function G(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function Y(e,t,n){X(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||J(t,e.length-(n+1))}function Q(e,t,n,r,s,i){if(e>n||e<t){const r="bigint"===typeof t?"n":"";let s;throw s=i>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new q.ERR_OUT_OF_RANGE("value",s,e)}Y(r,s,i)}function X(e,t){if("number"!==typeof e)throw new q.ERR_INVALID_ARG_TYPE(t,"number",e)}function J(e,t,n){if(Math.floor(e)!==e)throw X(e,n),new q.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new q.ERR_BUFFER_OUT_OF_BOUNDS;throw new q.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}W("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),W("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),W("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,s=n;return Number.isInteger(n)&&Math.abs(n)>2**32?s=G(String(n)):"bigint"===typeof n&&(s=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(s=G(s)),s+="n"),r+=` It must be ${t}. Received ${s}`,r}),RangeError);const Z=/[^+/0-9A-Za-z-_]/g;function ee(e){if(e=e.split("=")[0],e=e.trim().replace(Z,""),e.length<2)return"";while(e.length%4!==0)e+="=";return e}function te(e,t){let n;t=t||1/0;const r=e.length;let s=null;const i=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function ne(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function re(e,t){let n,r,s;const i=[];for(let o=0;o<e.length;++o){if((t-=2)<0)break;n=e.charCodeAt(o),r=n>>8,s=n%256,i.push(s),i.push(r)}return i}function se(e){return r.toByteArray(ee(e))}function ie(e,t,n,r){let s;for(s=0;s<r;++s){if(s+n>=t.length||s>=e.length)break;t[s+n]=e[s]}return s}function oe(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ae(e){return e!==e}const ce=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let s=0;s<16;++s)t[r+s]=e[n]+e[s]}return t}();function le(e){return"undefined"===typeof BigInt?ue:e}function ue(){throw new Error("BigInt not supported")}},535:function(e,t,n){"use strict";n(7658);const r=n(1800),{hasOwnProperty:s}=Object.prototype,{propertyIsEnumerable:i}=Object,o=(e,t,n)=>Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0}),a=this,c={concatArrays:!1,ignoreUndefined:!1},l=e=>{const t=[];for(const n in e)s.call(e,n)&&t.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(e);for(const r of n)i.call(e,r)&&t.push(r)}return t};function u(e){return Array.isArray(e)?h(e):r(e)?d(e):e}function h(e){const t=e.slice(0,0);return l(e).forEach((n=>{o(t,n,u(e[n]))})),t}function d(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return l(e).forEach((n=>{o(t,n,u(e[n]))})),t}const f=(e,t,n,r)=>(n.forEach((n=>{"undefined"===typeof t[n]&&r.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?o(e,n,g(e[n],t[n],r)):o(e,n,u(t[n])))})),e),p=(e,t,n)=>{let r=e.slice(0,0),i=0;return[e,t].forEach((t=>{const a=[];for(let n=0;n<t.length;n++)s.call(t,n)&&(a.push(String(n)),o(r,i++,t===e?t[n]:u(t[n])));r=f(r,t,l(t).filter((e=>!a.includes(e))),n)})),r};function g(e,t,n){return n.concatArrays&&Array.isArray(e)&&Array.isArray(t)?p(e,t,n):r(t)&&r(e)?f(e,t,l(t),n):u(t)}e.exports=function(...e){const t=g(u(c),this!==a&&this||{},c);let n={_:{}};for(const s of e)if(void 0!==s){if(!r(s))throw new TypeError("`"+s+"` is not an Option Object");n=g(n,{_:s},t)}return n._}},1800:function(e){"use strict";e.exports=e=>{if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}},4334:function(e){"use strict";e.exports=class extends Error{constructor(e,t){super(e||""),"object"===typeof t&&null!==t&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}},7901:function(e){var t=1e3,n=60*t,r=60*n,s=24*r,i=7*s,o=365.25*s;function a(e){if(e=String(e),!(e.length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var c=parseFloat(a[1]),l=(a[2]||"ms").toLowerCase();switch(l){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*s;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function c(e){var i=Math.abs(e);return i>=s?Math.round(e/s)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}function l(e){var i=Math.abs(e);return i>=s?u(e,i,s,"day"):i>=r?u(e,i,r,"hour"):i>=n?u(e,i,n,"minute"):i>=t?u(e,i,t,"second"):e+" ms"}function u(e,t,n,r){var s=t>=1.5*n;return Math.round(e/n)+" "+r+(s?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return a(e);if("number"===n&&isFinite(e))return t.long?l(e):c(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},716:function(e,t,n){e.exports=n(55)},55:function(e,t){(function(n,r){"use strict";var s={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function a(e,t){return e<<t|e>>>32-t}function c(e){return e^=e>>>16,e=o(e,2246822507),e^=e>>>13,e=o(e,3266489909),e^=e>>>16,e}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function h(e,t){return t%=64,32===t?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function d(e,t){return t%=64,0===t?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=f(e,[0,e[0]>>>1]),e=u(e,[4283543511,3981806797]),e=f(e,[0,e[0]>>>1]),e=u(e,[3301882366,444984403]),e=f(e,[0,e[0]>>>1]),e}s.x86.hash32=function(e,t){if(s.inputValidation&&!i(e))return r;t=t||0;for(var n=e.length%4,l=e.length-n,u=t,h=0,d=3432918353,f=461845907,p=0;p<l;p+=4)h=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,h=o(h,d),h=a(h,15),h=o(h,f),u^=h,u=a(u,13),u=o(u,5)+3864292196;switch(h=0,n){case 3:h^=e[p+2]<<16;case 2:h^=e[p+1]<<8;case 1:h^=e[p],h=o(h,d),h=a(h,15),h=o(h,f),u^=h}return u^=e.length,u=c(u),u>>>0},s.x86.hash128=function(e,t){if(s.inputValidation&&!i(e))return r;t=t||0;for(var n=e.length%16,l=e.length-n,u=t,h=t,d=t,f=t,p=0,g=0,y=0,m=0,w=597399067,b=2869860233,v=951274213,_=2716044179,E=0;E<l;E+=16)p=e[E]|e[E+1]<<8|e[E+2]<<16|e[E+3]<<24,g=e[E+4]|e[E+5]<<8|e[E+6]<<16|e[E+7]<<24,y=e[E+8]|e[E+9]<<8|e[E+10]<<16|e[E+11]<<24,m=e[E+12]|e[E+13]<<8|e[E+14]<<16|e[E+15]<<24,p=o(p,w),p=a(p,15),p=o(p,b),u^=p,u=a(u,19),u+=h,u=o(u,5)+1444728091,g=o(g,b),g=a(g,16),g=o(g,v),h^=g,h=a(h,17),h+=d,h=o(h,5)+197830471,y=o(y,v),y=a(y,17),y=o(y,_),d^=y,d=a(d,15),d+=f,d=o(d,5)+2530024501,m=o(m,_),m=a(m,18),m=o(m,w),f^=m,f=a(f,13),f+=u,f=o(f,5)+850148119;switch(p=0,g=0,y=0,m=0,n){case 15:m^=e[E+14]<<16;case 14:m^=e[E+13]<<8;case 13:m^=e[E+12],m=o(m,_),m=a(m,18),m=o(m,w),f^=m;case 12:y^=e[E+11]<<24;case 11:y^=e[E+10]<<16;case 10:y^=e[E+9]<<8;case 9:y^=e[E+8],y=o(y,v),y=a(y,17),y=o(y,_),d^=y;case 8:g^=e[E+7]<<24;case 7:g^=e[E+6]<<16;case 6:g^=e[E+5]<<8;case 5:g^=e[E+4],g=o(g,b),g=a(g,16),g=o(g,v),h^=g;case 4:p^=e[E+3]<<24;case 3:p^=e[E+2]<<16;case 2:p^=e[E+1]<<8;case 1:p^=e[E],p=o(p,w),p=a(p,15),p=o(p,b),u^=p}return u^=e.length,h^=e.length,d^=e.length,f^=e.length,u+=h,u+=d,u+=f,h+=u,d+=u,f+=u,u=c(u),h=c(h),d=c(d),f=c(f),u+=h,u+=d,u+=f,h+=u,d+=u,f+=u,("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)},s.x64.hash128=function(e,t){if(s.inputValidation&&!i(e))return r;t=t||0;for(var n=e.length%16,o=e.length-n,a=[0,t],c=[0,t],g=[0,0],y=[0,0],m=[2277735313,289559509],w=[1291169091,658871167],b=0;b<o;b+=16)g=[e[b+4]|e[b+5]<<8|e[b+6]<<16|e[b+7]<<24,e[b]|e[b+1]<<8|e[b+2]<<16|e[b+3]<<24],y=[e[b+12]|e[b+13]<<8|e[b+14]<<16|e[b+15]<<24,e[b+8]|e[b+9]<<8|e[b+10]<<16|e[b+11]<<24],g=u(g,m),g=h(g,31),g=u(g,w),a=f(a,g),a=h(a,27),a=l(a,c),a=l(u(a,[0,5]),[0,1390208809]),y=u(y,w),y=h(y,33),y=u(y,m),c=f(c,y),c=h(c,31),c=l(c,a),c=l(u(c,[0,5]),[0,944331445]);switch(g=[0,0],y=[0,0],n){case 15:y=f(y,d([0,e[b+14]],48));case 14:y=f(y,d([0,e[b+13]],40));case 13:y=f(y,d([0,e[b+12]],32));case 12:y=f(y,d([0,e[b+11]],24));case 11:y=f(y,d([0,e[b+10]],16));case 10:y=f(y,d([0,e[b+9]],8));case 9:y=f(y,[0,e[b+8]]),y=u(y,w),y=h(y,33),y=u(y,m),c=f(c,y);case 8:g=f(g,d([0,e[b+7]],56));case 7:g=f(g,d([0,e[b+6]],48));case 6:g=f(g,d([0,e[b+5]],40));case 5:g=f(g,d([0,e[b+4]],32));case 4:g=f(g,d([0,e[b+3]],24));case 3:g=f(g,d([0,e[b+2]],16));case 2:g=f(g,d([0,e[b+1]],8));case 1:g=f(g,[0,e[b]]),g=u(g,m),g=h(g,31),g=u(g,w),a=f(a,g)}return a=f(a,[0,e.length]),c=f(c,[0,e.length]),a=l(a,c),c=l(c,a),a=p(a),c=p(c),a=l(a,c),c=l(c,a),("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)+("00000000"+(c[0]>>>0).toString(16)).slice(-8)+("00000000"+(c[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=s),t.murmurHash3=s})()},98:function(e,t,n){n(7658),function(){var e,n,r,s,i,o,a,c;c=function(e){var t,n,r,s;return t=(e&255<<24)>>>24,n=(e&255<<16)>>>16,r=(65280&e)>>>8,s=255&e,[t,n,r,s].join(".")},a=function(e){var t,r,s,i,o,a;for(t=[],s=i=0;i<=3;s=++i){if(0===e.length)break;if(s>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}a=n(e),o=a[0],r=a[1],e=e.substring(r),t.push(o)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},r=function(e){return e.charCodeAt(0)},s=r("0"),o=r("a"),i=r("A"),n=function(e){var t,n,a,c,l;c=0,t=10,n="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,n="7")),l=a;while(a<e.length){if("0"<=e[a]&&e[a]<=n)c=c*t+(r(e[a])-s)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")c=c*t+(10+r(e[a])-o)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;c=c*t+(10+r(e[a])-i)>>>0}}if(c>4294967295)throw new Error("too large");a++}if(a===l)throw new Error("empty octet");return[c,a]},e=function(){function e(e,t){var n,r,s;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(s=e.split("/",2),e=s[0],t=s[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(i){throw i,new Error("Invalid mask: "+t)}for(n=r=32;r>=0;n=--r)if(this.maskLong===4294967295<<32-n>>>0){this.bitmask=n;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(i){throw i,new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=c(this.netLong),this.mask=c(this.maskLong),this.hostmask=c(~this.maskLong),this.first=this.bitmask<=30?c(this.netLong+1):this.base,this.last=this.bitmask<=30?c(this.netLong+this.size-2):c(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?c(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(c(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,n,r;r=a(this.first),n=a(this.last),t=0;while(r<=n)e(c(r),r,t),t++,r++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=c,t.Netmask=e}.call(this)},333:function(e,t,n){"use strict";var r=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")},s=r();e.exports=t=s.fetch,s.fetch&&(t["default"]=s.fetch.bind(s)),t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response},22:function(e,t,n){n(7658);var r=n(5736);function s(e,t){var n=function(){return new r.aes.Algorithm(e,t)};r.cipher.registerAlgorithm(e,n)}n(298),n(2009),n(4292),e.exports=r.aes=r.aes||{},r.aes.startEncrypting=function(e,t,n,r){var s=g({key:e,output:n,decrypt:!1,mode:r});return s.start(t),s},r.aes.createEncryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!1,mode:t})},r.aes.startDecrypting=function(e,t,n,r){var s=g({key:e,output:n,decrypt:!0,mode:r});return s.start(t),s},r.aes.createDecryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!0,mode:t})},r.aes.Algorithm=function(e,t){u||d();var n=this;n.name=e,n.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return p(n._w,e,t,!1)},decrypt:function(e,t){return p(n._w,e,t,!0)}}}),n._init=!1},r.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,n=e.key;if("string"!==typeof n||16!==n.length&&24!==n.length&&32!==n.length){if(r.util.isArray(n)&&(16===n.length||24===n.length||32===n.length)){t=n,n=r.util.createBuffer();for(var s=0;s<t.length;++s)n.putByte(t[s])}}else n=r.util.createBuffer(n);if(!r.util.isArray(n)){t=n,n=[];var i=t.length();if(16===i||24===i||32===i){i>>>=2;for(s=0;s<i;++s)n.push(t.getInt32())}}if(!r.util.isArray(n)||4!==n.length&&6!==n.length&&8!==n.length)throw new Error("Invalid key parameter.");var o=this.mode.name,a=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=f(n,e.decrypt&&!a),this._init=!0}},r.aes._expandKey=function(e,t){return u||d(),f(e,t)},r.aes._updateBlock=p,s("AES-ECB",r.cipher.modes.ecb),s("AES-CBC",r.cipher.modes.cbc),s("AES-CFB",r.cipher.modes.cfb),s("AES-OFB",r.cipher.modes.ofb),s("AES-CTR",r.cipher.modes.ctr),s("AES-GCM",r.cipher.modes.gcm);var i,o,a,c,l,u=!1,h=4;function d(){u=!0,a=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;i=new Array(256),o=new Array(256),c=new Array(4),l=new Array(4);for(t=0;t<4;++t)c[t]=new Array(256),l[t]=new Array(256);var n,r,s,h,d,f,p,g=0,y=0;for(t=0;t<256;++t){h=y^y<<1^y<<2^y<<3^y<<4,h=h>>8^255&h^99,i[g]=h,o[h]=g,d=e[h],n=e[g],r=e[n],s=e[r],f=d<<24^h<<16^h<<8^h^d,p=(n^r^s)<<24^(g^s)<<16^(g^r^s)<<8^g^n^s;for(var m=0;m<4;++m)c[m][g]=f,l[m][h]=p,f=f<<24|f>>>8,p=p<<24|p>>>8;0===g?g=y=1:(g=n^e[e[e[n^s]]],y^=e[e[y]])}}function f(e,t){for(var n,r=e.slice(0),s=1,o=r.length,c=o+6+1,u=h*c,d=o;d<u;++d)n=r[d-1],d%o===0?(n=i[n>>>16&255]<<24^i[n>>>8&255]<<16^i[255&n]<<8^i[n>>>24]^a[s]<<24,s++):o>6&&d%o===4&&(n=i[n>>>24]<<24^i[n>>>16&255]<<16^i[n>>>8&255]<<8^i[255&n]),r[d]=r[d-o]^n;if(t){var f,p=l[0],g=l[1],y=l[2],m=l[3],w=r.slice(0);u=r.length;d=0;for(var b=u-h;d<u;d+=h,b-=h)if(0===d||d===u-h)w[d]=r[b],w[d+1]=r[b+3],w[d+2]=r[b+2],w[d+3]=r[b+1];else for(var v=0;v<h;++v)f=r[b+v],w[d+(3&-v)]=p[i[f>>>24]]^g[i[f>>>16&255]]^y[i[f>>>8&255]]^m[i[255&f]];r=w}return r}function p(e,t,n,r){var s,a,u,h,d,f,p,g,y,m,w,b,v=e.length/4-1;r?(s=l[0],a=l[1],u=l[2],h=l[3],d=o):(s=c[0],a=c[1],u=c[2],h=c[3],d=i),f=t[0]^e[0],p=t[r?3:1]^e[1],g=t[2]^e[2],y=t[r?1:3]^e[3];for(var _=3,E=1;E<v;++E)m=s[f>>>24]^a[p>>>16&255]^u[g>>>8&255]^h[255&y]^e[++_],w=s[p>>>24]^a[g>>>16&255]^u[y>>>8&255]^h[255&f]^e[++_],b=s[g>>>24]^a[y>>>16&255]^u[f>>>8&255]^h[255&p]^e[++_],y=s[y>>>24]^a[f>>>16&255]^u[p>>>8&255]^h[255&g]^e[++_],f=m,p=w,g=b;n[0]=d[f>>>24]<<24^d[p>>>16&255]<<16^d[g>>>8&255]<<8^d[255&y]^e[++_],n[r?3:1]=d[p>>>24]<<24^d[g>>>16&255]<<16^d[y>>>8&255]<<8^d[255&f]^e[++_],n[2]=d[g>>>24]<<24^d[y>>>16&255]<<16^d[f>>>8&255]<<8^d[255&p]^e[++_],n[r?1:3]=d[y>>>24]<<24^d[f>>>16&255]<<16^d[p>>>8&255]<<8^d[255&g]^e[++_]}function g(e){e=e||{};var t,n=(e.mode||"CBC").toUpperCase(),s="AES-"+n;t=e.decrypt?r.cipher.createDecipher(s,e.key):r.cipher.createCipher(s,e.key);var i=t.start;return t.start=function(e,n){var s=null;n instanceof r.util.ByteBuffer&&(s=n,n={}),n=n||{},n.output=s,n.iv=e,i.call(t,n)},t}},1041:function(e,t,n){n(7658);var r=n(5736);n(4292),n(9002);var s=e.exports=r.asn1=r.asn1||{};function i(e,t,n){if(n>t){var r=new Error("Too few bytes to parse DER.");throw r.available=e.length(),r.remaining=t,r.requested=n,r}}s.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},s.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},s.create=function(e,t,n,i,o){if(r.util.isArray(i)){for(var a=[],c=0;c<i.length;++c)void 0!==i[c]&&a.push(i[c]);i=a}var l={tagClass:e,type:t,constructed:n,composed:n||r.util.isArray(i),value:i};return o&&"bitStringContents"in o&&(l.bitStringContents=o.bitStringContents,l.original=s.copy(l)),l},s.copy=function(e,t){var n;if(r.util.isArray(e)){n=[];for(var i=0;i<e.length;++i)n.push(s.copy(e[i],t));return n}return"string"===typeof e?e:(n={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:s.copy(e.value,t)},t&&!t.excludeBitStringContents&&(n.bitStringContents=e.bitStringContents),n)},s.equals=function(e,t,n){if(r.util.isArray(e)){if(!r.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var i=0;i<e.length;++i)if(!s.equals(e[i],t[i]))return!1;return!0}if(typeof e!==typeof t)return!1;if("string"===typeof e)return e===t;var o=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&s.equals(e.value,t.value);return n&&n.includeBitStringContents&&(o=o&&e.bitStringContents===t.bitStringContents),o},s.getBerValueLength=function(e){var t=e.getByte();if(128!==t){var n,r=128&t;return n=r?e.getInt((127&t)<<3):t,n}};var o=function(e,t){var n=e.getByte();if(t--,128!==n){var r,s=128&n;if(s){var o=127&n;i(e,t,o),r=e.getInt(o<<3)}else r=n;if(r<0)throw new Error("Negative length: "+r);return r}};function a(e,t,n,r){var c;i(e,t,2);var l=e.getByte();t--;var u=192&l,h=31&l;c=e.length();var d,f,p=o(e,t);if(t-=c-e.length(),void 0!==p&&p>t){if(r.strict){var g=new Error("Too few bytes to read ASN.1 value.");throw g.available=e.length(),g.remaining=t,g.requested=p,g}p=t}var y=32===(32&l);if(y)if(d=[],void 0===p)for(;;){if(i(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}c=e.length(),d.push(a(e,t,n+1,r)),t-=c-e.length()}else while(p>0)c=e.length(),d.push(a(e,p,n+1,r)),t-=c-e.length(),p-=c-e.length();if(void 0===d&&u===s.Class.UNIVERSAL&&h===s.Type.BITSTRING&&(f=e.bytes(p)),void 0===d&&r.decodeBitStrings&&u===s.Class.UNIVERSAL&&h===s.Type.BITSTRING&&p>1){var m=e.read,w=t,b=0;if(h===s.Type.BITSTRING&&(i(e,t,1),b=e.getByte(),t--),0===b)try{c=e.length();var v={strict:!0,decodeBitStrings:!0},_=a(e,t,n+1,v),E=c-e.length();t-=E,h==s.Type.BITSTRING&&E++;var S=_.tagClass;E!==p||S!==s.Class.UNIVERSAL&&S!==s.Class.CONTEXT_SPECIFIC||(d=[_])}catch(I){}void 0===d&&(e.read=m,t=w)}if(void 0===d){if(void 0===p){if(r.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");p=t}if(h===s.Type.BMPSTRING)for(d="";p>0;p-=2)i(e,t,2),d+=String.fromCharCode(e.getInt16()),t-=2;else d=e.getBytes(p),t-=p}var k=void 0===f?null:{bitStringContents:f};return s.create(u,h,y,d,k)}s.fromDer=function(e,t){void 0===t&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),"boolean"===typeof t&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"===typeof e&&(e=r.util.createBuffer(e));var n=e.length(),s=a(e,e.length(),0,t);if(t.parseAllBytes&&0!==e.length()){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=n,i.remaining=e.length(),i}return s},s.toDer=function(e){var t=r.util.createBuffer(),n=e.tagClass|e.type,i=r.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=s.equals(e,e.original))),o)i.putBytes(e.bitStringContents);else if(e.composed){e.constructed?n|=32:i.putByte(0);for(var a=0;a<e.value.length;++a)void 0!==e.value[a]&&i.putBuffer(s.toDer(e.value[a]))}else if(e.type===s.Type.BMPSTRING)for(a=0;a<e.value.length;++a)i.putInt16(e.value.charCodeAt(a));else e.type===s.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0===(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128===(128&e.value.charCodeAt(1)))?i.putBytes(e.value.substr(1)):i.putBytes(e.value);if(t.putByte(n),i.length()<=127)t.putByte(127&i.length());else{var c=i.length(),l="";do{l+=String.fromCharCode(255&c),c>>>=8}while(c>0);t.putByte(128|l.length);for(a=l.length-1;a>=0;--a)t.putByte(l.charCodeAt(a))}return t.putBuffer(i),t},s.oidToDer=function(e){var t,n,s,i,o=e.split("."),a=r.util.createBuffer();a.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var c=2;c<o.length;++c){t=!0,n=[],s=parseInt(o[c],10);do{i=127&s,s>>>=7,t||(i|=128),n.push(i),t=!1}while(s>0);for(var l=n.length-1;l>=0;--l)a.putByte(n[l])}return a},s.derToOid=function(e){var t;"string"===typeof e&&(e=r.util.createBuffer(e));var n=e.getByte();t=Math.floor(n/40)+"."+n%40;var s=0;while(e.length()>0)n=e.getByte(),s<<=7,128&n?s+=127&n:(t+="."+(s+n),s=0);return t},s.utcTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,2),10);n=n>=50?1900+n:2e3+n;var r=parseInt(e.substr(2,2),10)-1,s=parseInt(e.substr(4,2),10),i=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),a=0;if(e.length>11){var c=e.charAt(10),l=10;"+"!==c&&"-"!==c&&(a=parseInt(e.substr(10,2),10),l+=2)}if(t.setUTCFullYear(n,r,s),t.setUTCHours(i,o,a,0),l&&(c=e.charAt(l),"+"===c||"-"===c)){var u=parseInt(e.substr(l+1,2),10),h=parseInt(e.substr(l+4,2),10),d=60*u+h;d*=6e4,"+"===c?t.setTime(+t-d):t.setTime(+t+d)}return t},s.generalizedTimeToDate=function(e){var t=new Date,n=parseInt(e.substr(0,4),10),r=parseInt(e.substr(4,2),10)-1,s=parseInt(e.substr(6,2),10),i=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),a=parseInt(e.substr(12,2),10),c=0,l=0,u=!1;"Z"===e.charAt(e.length-1)&&(u=!0);var h=e.length-5,d=e.charAt(h);if("+"===d||"-"===d){var f=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);l=60*f+p,l*=6e4,"+"===d&&(l*=-1),u=!0}return"."===e.charAt(14)&&(c=1e3*parseFloat(e.substr(14),10)),u?(t.setUTCFullYear(n,r,s),t.setUTCHours(i,o,a,c),t.setTime(+t+l)):(t.setFullYear(n,r,s),t.setHours(i,o,a,c)),t},s.dateToUtcTime=function(e){if("string"===typeof e)return e;var t="",n=[];n.push((""+e.getUTCFullYear()).substr(2)),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z",t},s.dateToGeneralizedTime=function(e){if("string"===typeof e)return e;var t="",n=[];n.push(""+e.getUTCFullYear()),n.push(""+(e.getUTCMonth()+1)),n.push(""+e.getUTCDate()),n.push(""+e.getUTCHours()),n.push(""+e.getUTCMinutes()),n.push(""+e.getUTCSeconds());for(var r=0;r<n.length;++r)n[r].length<2&&(t+="0"),t+=n[r];return t+="Z",t},s.integerToDer=function(e){var t=r.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var n=new Error("Integer too large; max is 32-bits.");throw n.integer=e,n},s.derToInteger=function(e){"string"===typeof e&&(e=r.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},s.validate=function(e,t,n,i){var o=!1;if(e.tagClass!==t.tagClass&&"undefined"!==typeof t.tagClass||e.type!==t.type&&"undefined"!==typeof t.type)i&&(e.tagClass!==t.tagClass&&i.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&i.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"===typeof t.constructed){if(o=!0,t.value&&r.util.isArray(t.value))for(var a=0,c=0;o&&c<t.value.length;++c)o=t.value[c].optional||!1,e.value[a]&&(o=s.validate(e.value[a],t.value[c],n,i),o?++a:t.value[c].optional&&(o=!0)),!o&&i&&i.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(o&&n)if(t.capture&&(n[t.capture]=e.value),t.captureAsn1&&(n[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(n[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)n[t.captureBitStringValue]="";else{var l=e.bitStringContents.charCodeAt(0);if(0!==l)throw new Error("captureBitStringValue only supported for zero unused bits");n[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else i&&i.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return o};var c=/[^\\u0000-\\u00ff]/;s.prettyPrint=function(e,t,n){var i="";t=t||0,n=n||2,t>0&&(i+="\n");for(var o="",a=0;a<t*n;++a)o+=" ";switch(i+=o+"Tag: ",e.tagClass){case s.Class.UNIVERSAL:i+="Universal:";break;case s.Class.APPLICATION:i+="Application:";break;case s.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case s.Class.PRIVATE:i+="Private:";break}if(e.tagClass===s.Class.UNIVERSAL)switch(i+=e.type,e.type){case s.Type.NONE:i+=" (None)";break;case s.Type.BOOLEAN:i+=" (Boolean)";break;case s.Type.INTEGER:i+=" (Integer)";break;case s.Type.BITSTRING:i+=" (Bit string)";break;case s.Type.OCTETSTRING:i+=" (Octet string)";break;case s.Type.NULL:i+=" (Null)";break;case s.Type.OID:i+=" (Object Identifier)";break;case s.Type.ODESC:i+=" (Object Descriptor)";break;case s.Type.EXTERNAL:i+=" (External or Instance of)";break;case s.Type.REAL:i+=" (Real)";break;case s.Type.ENUMERATED:i+=" (Enumerated)";break;case s.Type.EMBEDDED:i+=" (Embedded PDV)";break;case s.Type.UTF8:i+=" (UTF8)";break;case s.Type.ROID:i+=" (Relative Object Identifier)";break;case s.Type.SEQUENCE:i+=" (Sequence)";break;case s.Type.SET:i+=" (Set)";break;case s.Type.PRINTABLESTRING:i+=" (Printable String)";break;case s.Type.IA5String:i+=" (IA5String (ASCII))";break;case s.Type.UTCTIME:i+=" (UTC time)";break;case s.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case s.Type.BMPSTRING:i+=" (BMP String)";break}else i+=e.type;if(i+="\n",i+=o+"Constructed: "+e.constructed+"\n",e.composed){var l=0,u="";for(a=0;a<e.value.length;++a)void 0!==e.value[a]&&(l+=1,u+=s.prettyPrint(e.value[a],t+1,n),a+1<e.value.length&&(u+=","));i+=o+"Sub values: "+l+u}else{if(i+=o+"Value: ",e.type===s.Type.OID){var h=s.derToOid(e.value);i+=h,r.pki&&r.pki.oids&&h in r.pki.oids&&(i+=" ("+r.pki.oids[h]+") ")}if(e.type===s.Type.INTEGER)try{i+=s.derToInteger(e.value)}catch(f){i+="0x"+r.util.bytesToHex(e.value)}else if(e.type===s.Type.BITSTRING){if(e.value.length>1?i+="0x"+r.util.bytesToHex(e.value.slice(1)):i+="(none)",e.value.length>0){var d=e.value.charCodeAt(0);1==d?i+=" (1 unused bit shown)":d>1&&(i+=" ("+d+" unused bits shown)")}}else if(e.type===s.Type.OCTETSTRING)c.test(e.value)||(i+="("+e.value+") "),i+="0x"+r.util.bytesToHex(e.value);else if(e.type===s.Type.UTF8)try{i+=r.util.decodeUtf8(e.value)}catch(p){if("URI malformed"!==p.message)throw p;i+="0x"+r.util.bytesToHex(e.value)+" (malformed UTF8)"}else e.type===s.Type.PRINTABLESTRING||e.type===s.Type.IA5String?i+=e.value:c.test(e.value)?i+="0x"+r.util.bytesToHex(e.value):0===e.value.length?i+="[null]":i+=e.value}return i}},3220:function(e,t,n){n(7658);var r={};e.exports=r;var s={};function i(e,t){var n=0,r=t.length,s=t.charAt(0),i=[0];for(n=0;n<e.length();++n){for(var o=0,a=e.at(n);o<i.length;++o)a+=i[o]<<8,i[o]=a%r,a=a/r|0;while(a>0)i.push(a%r),a=a/r|0}var c="";for(n=0;0===e.at(n)&&n<e.length()-1;++n)c+=s;for(n=i.length-1;n>=0;--n)c+=t[i[n]];return c}r.encode=function(e,t,n){if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==n&&"number"!==typeof n)throw new TypeError('"maxline" must be a number.');var r="";if(e instanceof Uint8Array){var s=0,o=t.length,a=t.charAt(0),c=[0];for(s=0;s<e.length;++s){for(var l=0,u=e[s];l<c.length;++l)u+=c[l]<<8,c[l]=u%o,u=u/o|0;while(u>0)c.push(u%o),u=u/o|0}for(s=0;0===e[s]&&s<e.length-1;++s)r+=a;for(s=c.length-1;s>=0;--s)r+=t[c[s]]}else r=i(e,t);if(n){var h=new RegExp(".{1,"+n+"}","g");r=r.match(h).join("\r\n")}return r},r.decode=function(e,t){if("string"!==typeof e)throw new TypeError('"input" must be a string.');if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');var n=s[t];if(!n){n=s[t]=[];for(var r=0;r<t.length;++r)n[t.charCodeAt(r)]=r}e=e.replace(/\s/g,"");var i=t.length,o=t.charAt(0),a=[0];for(r=0;r<e.length;r++){var c=n[e.charCodeAt(r)];if(void 0===c)return;for(var l=0,u=c;l<a.length;++l)u+=a[l]*i,a[l]=255&u,u>>=8;while(u>0)a.push(255&u),u>>=8}for(var h=0;e[h]===o&&h<e.length-1;++h)a.push(0);return"undefined"!==typeof Buffer?Buffer.from(a.reverse()):new Uint8Array(a.reverse())}},298:function(e,t,n){var r=n(5736);n(4292),e.exports=r.cipher=r.cipher||{},r.cipher.algorithms=r.cipher.algorithms||{},r.cipher.createCipher=function(e,t){var n=e;if("string"===typeof n&&(n=r.cipher.getAlgorithm(n),n&&(n=n())),!n)throw new Error("Unsupported algorithm: "+e);return new r.cipher.BlockCipher({algorithm:n,key:t,decrypt:!1})},r.cipher.createDecipher=function(e,t){var n=e;if("string"===typeof n&&(n=r.cipher.getAlgorithm(n),n&&(n=n())),!n)throw new Error("Unsupported algorithm: "+e);return new r.cipher.BlockCipher({algorithm:n,key:t,decrypt:!0})},r.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),r.cipher.algorithms[e]=t},r.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in r.cipher.algorithms?r.cipher.algorithms[e]:null};var s=r.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};s.prototype.start=function(e){e=e||{};var t={};for(var n in e)t[n]=e[n];t.decrypt=this._decrypt,this._finish=!1,this._input=r.util.createBuffer(),this.output=e.output||r.util.createBuffer(),this.mode.start(t)},s.prototype.update=function(e){e&&this._input.putBuffer(e);while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish);this._input.compact()},s.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},2009:function(e,t,n){n(7658);var r=n(5736);n(4292),r.cipher=r.cipher||{};var s=e.exports=r.cipher.modes=r.cipher.modes||{};function i(e,t){if("string"===typeof e&&(e=r.util.createBuffer(e)),r.util.isArray(e)&&e.length>4){var n=e;e=r.util.createBuffer();for(var s=0;s<n.length;++s)e.putByte(n[s])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!r.util.isArray(e)){var i=[],o=t/4;for(s=0;s<o;++s)i.push(e.getInt32());e=i}return e}function o(e){e[e.length-1]=e[e.length-1]+1&4294967295}function a(e){return[e/4294967296|0,4294967295&e]}s.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},s.ecb.prototype.start=function(e){},s.ecb.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])},s.ecb.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._outBlock[r])},s.ecb.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0},s.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return!(r>this.blockSize<<2)&&(e.truncate(r),!0)},s.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},s.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},s.cbc.prototype.encrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=this._prev[r]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._outBlock[r]);this._prev=this._outBlock},s.cbc.prototype.decrypt=function(e,t,n){if(e.length()<this.blockSize&&!(n&&e.length()>0))return!0;for(var r=0;r<this._ints;++r)this._inBlock[r]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(r=0;r<this._ints;++r)t.putInt32(this._prev[r]^this._outBlock[r]);this._prev=this._inBlock.slice(0)},s.cbc.prototype.pad=function(e,t){var n=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(n,n),!0},s.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var n=e.length(),r=e.at(n-1);return!(r>this.blockSize<<2)&&(e.truncate(r),!0)},s.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},s.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.cfb.prototype.encrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32()^this._outBlock[s],t.putInt32(this._inBlock[s]);else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32()^this._outBlock[s],this._partialOutput.putInt32(this._partialBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!n)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},s.cfb.prototype.decrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var s=0;s<this._ints;++s)this._inBlock[s]=e.getInt32(),t.putInt32(this._inBlock[s]^this._outBlock[s]);else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialBlock[s]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[s]^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!n)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},s.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},s.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.ofb.prototype.encrypt=function(e,t,n){var r=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]),this._inBlock[s]=this._outBlock[s];else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0)e.read-=this.blockSize;else for(s=0;s<this._ints;++s)this._inBlock[s]=this._outBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!n)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}},s.ofb.prototype.decrypt=s.ofb.prototype.encrypt,s.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},s.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=i(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},s.ctr.prototype.encrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize)for(var s=0;s<this._ints;++s)t.putInt32(e.getInt32()^this._outBlock[s]);else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!n)return t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}o(this._inBlock)},s.ctr.prototype.decrypt=s.ctr.prototype.encrypt,s.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0,this._R=3774873600},s.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,n=r.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?r.util.createBuffer(e.additionalData):r.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=r.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var s=n.length();if(12===s)this._j0=[n.getInt32(),n.getInt32(),n.getInt32(),1];else{this._j0=[0,0,0,0];while(n.length()>0)this._j0=this.ghash(this._hashSubkey,this._j0,[n.getInt32(),n.getInt32(),n.getInt32(),n.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(a(8*s)))}this._inBlock=this._j0.slice(0),o(this._inBlock),this._partialBytes=0,t=r.util.createBuffer(t),this._aDataLength=a(8*t.length());var i=t.length()%this.blockSize;i&&t.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];while(t.length()>0)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},s.gcm.prototype.encrypt=function(e,t,n){var r=e.length();if(0===r)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&r>=this.blockSize){for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^=e.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-r)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(s=0;s<this._ints;++s)this._partialOutput.putInt32(e.getInt32()^this._outBlock[s]);if(i<=0||n){if(n){var a=r%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!n)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;t.putBytes(this._partialOutput.getBytes(r-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),o(this._inBlock)},s.gcm.prototype.decrypt=function(e,t,n){var r=e.length();if(r<this.blockSize&&!(n&&r>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),o(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)t.putInt32(this._outBlock[s]^this._hashBlock[s]);r<this.blockSize?this._cipherLength+=r%this.blockSize:this._cipherLength+=this.blockSize},s.gcm.prototype.afterFinish=function(e,t){var n=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=r.util.createBuffer();var s=this._aDataLength.concat(a(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,s);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(n=!1),n},s.gcm.prototype.multiply=function(e,t){for(var n=[0,0,0,0],r=t.slice(0),s=0;s<128;++s){var i=e[s/32|0]&1<<31-s%32;i&&(n[0]^=r[0],n[1]^=r[1],n[2]^=r[2],n[3]^=r[3]),this.pow(r,r)}return n},s.gcm.prototype.pow=function(e,t){for(var n=1&e[3],r=3;r>0;--r)t[r]=e[r]>>>1|(1&e[r-1])<<31;t[0]=e[0]>>>1,n&&(t[0]^=this._R)},s.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],n=0;n<32;++n){var r=n/8|0,s=e[r]>>>4*(7-n%8)&15,i=this._m[n][s];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},s.gcm.prototype.ghash=function(e,t,n){return t[0]^=n[0],t[1]^=n[1],t[2]^=n[2],t[3]^=n[3],this.tableMultiply(t)},s.gcm.prototype.generateHashTable=function(e,t){for(var n=8/t,r=4*n,s=16*n,i=new Array(s),o=0;o<s;++o){var a=[0,0,0,0],c=o/r|0,l=(r-1-o%r)*t;a[c]=1<<t-1<<l,i[o]=this.generateSubHashTable(this.multiply(a,e),t)}return i},s.gcm.prototype.generateSubHashTable=function(e,t){var n=1<<t,r=n>>>1,s=new Array(n);s[r]=e.slice(0);var i=r>>>1;while(i>0)this.pow(s[2*i],s[i]=[]),i>>=1;i=2;while(i<r){for(var o=1;o<i;++o){var a=s[i],c=s[o];s[i+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}i*=2}for(s[0]=[0,0,0,0],i=r+1;i<n;++i){var l=s[i^r];s[i]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return s}},8577:function(e,t,n){var r=n(5736);function s(e,t){var n=function(){return new r.des.Algorithm(e,t)};r.cipher.registerAlgorithm(e,n)}n(298),n(2009),n(4292),e.exports=r.des=r.des||{},r.des.startEncrypting=function(e,t,n,r){var s=g({key:e,output:n,decrypt:!1,mode:r||(null===t?"ECB":"CBC")});return s.start(t),s},r.des.createEncryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!1,mode:t})},r.des.startDecrypting=function(e,t,n,r){var s=g({key:e,output:n,decrypt:!0,mode:r||(null===t?"ECB":"CBC")});return s.start(t),s},r.des.createDecryptionCipher=function(e,t){return g({key:e,output:null,decrypt:!0,mode:t})},r.des.Algorithm=function(e,t){var n=this;n.name=e,n.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return p(n._keys,e,t,!1)},decrypt:function(e,t){return p(n._keys,e,t,!0)}}}),n._init=!1},r.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=r.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=f(t),this._init=!0}},s("DES-ECB",r.cipher.modes.ecb),s("DES-CBC",r.cipher.modes.cbc),s("DES-CFB",r.cipher.modes.cfb),s("DES-OFB",r.cipher.modes.ofb),s("DES-CTR",r.cipher.modes.ctr),s("3DES-ECB",r.cipher.modes.ecb),s("3DES-CBC",r.cipher.modes.cbc),s("3DES-CFB",r.cipher.modes.cfb),s("3DES-OFB",r.cipher.modes.ofb),s("3DES-CTR",r.cipher.modes.ctr);var i=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],a=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],c=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],u=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],d=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function f(e){for(var t,n=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],s=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,m=[],w=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,v=0;v<y;v++){var _=e.getInt32(),E=e.getInt32();t=252645135&(_>>>4^E),E^=t,_^=t<<4,t=65535&(E>>>-16^_),_^=t,E^=t<<-16,t=858993459&(_>>>2^E),E^=t,_^=t<<2,t=65535&(E>>>-16^_),_^=t,E^=t<<-16,t=1431655765&(_>>>1^E),E^=t,_^=t<<1,t=16711935&(E>>>8^_),_^=t,E^=t<<8,t=1431655765&(_>>>1^E),E^=t,_^=t<<1,t=_<<8|E>>>20&240,_=E<<24|E<<8&16711680|E>>>8&65280|E>>>24&240,E=t;for(var S=0;S<w.length;++S){w[S]?(_=_<<2|_>>>26,E=E<<2|E>>>26):(_=_<<1|_>>>27,E=E<<1|E>>>27),_&=-15,E&=-15;var k=n[_>>>28]|r[_>>>24&15]|s[_>>>20&15]|i[_>>>16&15]|o[_>>>12&15]|a[_>>>8&15]|c[_>>>4&15],I=l[E>>>28]|u[E>>>24&15]|h[E>>>20&15]|d[E>>>16&15]|f[E>>>12&15]|p[E>>>8&15]|g[E>>>4&15];t=65535&(I>>>16^k),m[b++]=k^t,m[b++]=I^t<<16}}return m}function p(e,t,n,r){var s,f,p=32===e.length?3:9;s=3===p?r?[30,-2,-2]:[0,32,2]:r?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var g=t[0],y=t[1];f=252645135&(g>>>4^y),y^=f,g^=f<<4,f=65535&(g>>>16^y),y^=f,g^=f<<16,f=858993459&(y>>>2^g),g^=f,y^=f<<2,f=16711935&(y>>>8^g),g^=f,y^=f<<8,f=1431655765&(g>>>1^y),y^=f,g^=f<<1,g=g<<1|g>>>31,y=y<<1|y>>>31;for(var m=0;m<p;m+=3){for(var w=s[m+1],b=s[m+2],v=s[m];v!=w;v+=b){var _=y^e[v],E=(y>>>4|y<<28)^e[v+1];f=g,g=y,y=f^(o[_>>>24&63]|c[_>>>16&63]|u[_>>>8&63]|d[63&_]|i[E>>>24&63]|a[E>>>16&63]|l[E>>>8&63]|h[63&E])}f=g,g=y,y=f}g=g>>>1|g<<31,y=y>>>1|y<<31,f=1431655765&(g>>>1^y),y^=f,g^=f<<1,f=16711935&(y>>>8^g),g^=f,y^=f<<8,f=858993459&(y>>>2^g),g^=f,y^=f<<2,f=65535&(g>>>16^y),y^=f,g^=f<<16,f=252645135&(g>>>4^y),y^=f,g^=f<<4,n[0]=g,n[1]=y}function g(e){e=e||{};var t,n=(e.mode||"CBC").toUpperCase(),s="DES-"+n;t=e.decrypt?r.cipher.createDecipher(s,e.key):r.cipher.createCipher(s,e.key);var i=t.start;return t.start=function(e,n){var s=null;n instanceof r.util.ByteBuffer&&(s=n,n={}),n=n||{},n.output=s,n.iv=e,i.call(t,n)},t}},5736:function(e){e.exports={options:{usePureJavaScript:!1}}},4881:function(e,t,n){var r=n(5736);n(4038),n(4292);var s=e.exports=r.hmac=r.hmac||{};s.create=function(){var e=null,t=null,n=null,s=null,i={start:function(i,o){if(null!==i)if("string"===typeof i){if(i=i.toLowerCase(),!(i in r.md.algorithms))throw new Error('Unknown hash algorithm "'+i+'"');t=r.md.algorithms[i].create()}else t=i;if(null===o)o=e;else{if("string"===typeof o)o=r.util.createBuffer(o);else if(r.util.isArray(o)){var a=o;o=r.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var l=o.length();l>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),n=r.util.createBuffer(),s=r.util.createBuffer(),l=o.length();for(c=0;c<l;++c){a=o.at(c);n.putByte(54^a),s.putByte(92^a)}if(l<t.blockLength)for(a=t.blockLength-l,c=0;c<a;++c)n.putByte(54),s.putByte(92);e=o,n=n.bytes(),s=s.bytes()}t.start(),t.update(n)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(s),t.update(e),t.digest()}};return i.digest=i.getMac,i}},5970:function(e,t,n){var r,s=n(5736);e.exports=s.jsbn=s.jsbn||{};var i=0xdeadbeefcafe,o=15715070==(16777215&i);function a(e,t,n){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,n):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function c(){return new a(null)}function l(e,t,n,r,s,i){while(--i>=0){var o=t*this.data[e++]+n.data[r]+s;s=Math.floor(o/67108864),n.data[r++]=67108863&o}return s}function u(e,t,n,r,s,i){var o=32767&t,a=t>>15;while(--i>=0){var c=32767&this.data[e],l=this.data[e++]>>15,u=a*c+l*o;c=o*c+((32767&u)<<15)+n.data[r]+(1073741823&s),s=(c>>>30)+(u>>>15)+a*l+(s>>>30),n.data[r++]=1073741823&c}return s}function h(e,t,n,r,s,i){var o=16383&t,a=t>>14;while(--i>=0){var c=16383&this.data[e],l=this.data[e++]>>14,u=a*c+l*o;c=o*c+((16383&u)<<14)+n.data[r]+s,s=(c>>28)+(u>>14)+a*l,n.data[r++]=268435455&c}return s}s.jsbn.BigInteger=a,"undefined"===typeof navigator?(a.prototype.am=h,r=28):o&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=u,r=30):o&&"Netscape"!=navigator.appName?(a.prototype.am=l,r=26):(a.prototype.am=h,r=28),a.prototype.DB=r,a.prototype.DM=(1<<r)-1,a.prototype.DV=1<<r;var d=52;a.prototype.FV=Math.pow(2,d),a.prototype.F1=d-r,a.prototype.F2=2*r-d;var f,p,g="0123456789abcdefghijklmnopqrstuvwxyz",y=new Array;for(f="0".charCodeAt(0),p=0;p<=9;++p)y[f++]=p;for(f="a".charCodeAt(0),p=10;p<36;++p)y[f++]=p;for(f="A".charCodeAt(0),p=10;p<36;++p)y[f++]=p;function m(e){return g.charAt(e)}function w(e,t){var n=y[e.charCodeAt(t)];return null==n?-1:n}function b(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function v(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function _(e){var t=c();return t.fromInt(e),t}function E(e,t){var n;if(16==t)n=4;else if(8==t)n=3;else if(256==t)n=8;else if(2==t)n=1;else if(32==t)n=5;else{if(4!=t)return void this.fromRadix(e,t);n=2}this.t=0,this.s=0;var r=e.length,s=!1,i=0;while(--r>=0){var o=8==n?255&e[r]:w(e,r);o<0?"-"==e.charAt(r)&&(s=!0):(s=!1,0==i?this.data[this.t++]=o:i+n>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-i)-1)<<i,this.data[this.t++]=o>>this.DB-i):this.data[this.t-1]|=o<<i,i+=n,i>=this.DB&&(i-=this.DB))}8==n&&0!=(128&e[0])&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),s&&a.ZERO.subTo(this,this)}function S(){var e=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==e)--this.t}function k(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var n,r=(1<<t)-1,s=!1,i="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0){a<this.DB&&(n=this.data[o]>>a)>0&&(s=!0,i=m(n));while(o>=0)a<t?(n=(this.data[o]&(1<<a)-1)<<t-a,n|=this.data[--o]>>(a+=this.DB-t)):(n=this.data[o]>>(a-=t)&r,a<=0&&(a+=this.DB,--o)),n>0&&(s=!0),s&&(i+=m(n))}return s?i:"0"}function I(){var e=c();return a.ZERO.subTo(this,e),e}function A(){return this.s<0?this.negate():this}function T(e){var t=this.s-e.s;if(0!=t)return t;var n=this.t;if(t=n-e.t,0!=t)return this.s<0?-t:t;while(--n>=0)if(0!=(t=this.data[n]-e.data[n]))return t;return 0}function R(e){var t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function C(){return this.t<=0?0:this.DB*(this.t-1)+R(this.data[this.t-1]^this.s&this.DM)}function P(e,t){var n;for(n=this.t-1;n>=0;--n)t.data[n+e]=this.data[n];for(n=e-1;n>=0;--n)t.data[n]=0;t.t=this.t+e,t.s=this.s}function N(e,t){for(var n=e;n<this.t;++n)t.data[n-e]=this.data[n];t.t=Math.max(this.t-e,0),t.s=this.s}function O(e,t){var n,r=e%this.DB,s=this.DB-r,i=(1<<s)-1,o=Math.floor(e/this.DB),a=this.s<<r&this.DM;for(n=this.t-1;n>=0;--n)t.data[n+o+1]=this.data[n]>>s|a,a=(this.data[n]&i)<<r;for(n=o-1;n>=0;--n)t.data[n]=0;t.data[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()}function D(e,t){t.s=this.s;var n=Math.floor(e/this.DB);if(n>=this.t)t.t=0;else{var r=e%this.DB,s=this.DB-r,i=(1<<r)-1;t.data[0]=this.data[n]>>r;for(var o=n+1;o<this.t;++o)t.data[o-n-1]|=(this.data[o]&i)<<s,t.data[o-n]=this.data[o]>>r;r>0&&(t.data[this.t-n-1]|=(this.s&i)<<s),t.t=this.t-n,t.clamp()}}function L(e,t){var n=0,r=0,s=Math.min(e.t,this.t);while(n<s)r+=this.data[n]-e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){r-=e.s;while(n<this.t)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{r+=this.s;while(n<e.t)r-=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t.data[n++]=this.DV+r:r>0&&(t.data[n++]=r),t.t=n,t.clamp()}function x(e,t){var n=this.abs(),r=e.abs(),s=n.t;t.t=s+r.t;while(--s>=0)t.data[s]=0;for(s=0;s<r.t;++s)t.data[s+n.t]=n.am(0,r.data[s],t,s,0,n.t);t.s=0,t.clamp(),this.s!=e.s&&a.ZERO.subTo(t,t)}function B(e){var t=this.abs(),n=e.t=2*t.t;while(--n>=0)e.data[n]=0;for(n=0;n<t.t-1;++n){var r=t.am(n,t.data[n],e,2*n,0,1);(e.data[n+t.t]+=t.am(n+1,2*t.data[n],e,2*n+1,r,t.t-n-1))>=t.DV&&(e.data[n+t.t]-=t.DV,e.data[n+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(n,t.data[n],e,2*n,0,1)),e.s=0,e.clamp()}function M(e,t,n){var r=e.abs();if(!(r.t<=0)){var s=this.abs();if(s.t<r.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=c());var i=c(),o=this.s,l=e.s,u=this.DB-R(r.data[r.t-1]);u>0?(r.lShiftTo(u,i),s.lShiftTo(u,n)):(r.copyTo(i),s.copyTo(n));var h=i.t,d=i.data[h-1];if(0!=d){var f=d*(1<<this.F1)+(h>1?i.data[h-2]>>this.F2:0),p=this.FV/f,g=(1<<this.F1)/f,y=1<<this.F2,m=n.t,w=m-h,b=null==t?c():t;i.dlShiftTo(w,b),n.compareTo(b)>=0&&(n.data[n.t++]=1,n.subTo(b,n)),a.ONE.dlShiftTo(h,b),b.subTo(i,i);while(i.t<h)i.data[i.t++]=0;while(--w>=0){var v=n.data[--m]==d?this.DM:Math.floor(n.data[m]*p+(n.data[m-1]+y)*g);if((n.data[m]+=i.am(0,v,n,w,0,h))<v){i.dlShiftTo(w,b),n.subTo(b,n);while(n.data[m]<--v)n.subTo(b,n)}}null!=t&&(n.drShiftTo(h,t),o!=l&&a.ZERO.subTo(t,t)),n.t=h,n.clamp(),u>0&&n.rShiftTo(u,n),o<0&&a.ZERO.subTo(n,n)}}}function U(e){var t=c();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(a.ZERO)>0&&e.subTo(t,t),t}function F(e){this.m=e}function j(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function V(e){return e}function z(e){e.divRemTo(this.m,null,e)}function $(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function K(e,t){e.squareTo(t),this.reduce(t)}function H(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function q(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function W(e){var t=c();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(a.ZERO)>0&&this.m.subTo(t,t),t}function G(e){var t=c();return e.copyTo(t),this.reduce(t),t}function Y(e){while(e.t<=this.mt2)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e.data[t],r=n*this.mpl+((n*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;n=t+this.m.t,e.data[n]+=this.m.am(0,r,e,t,0,this.m.t);while(e.data[n]>=e.DV)e.data[n]-=e.DV,e.data[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Q(e,t){e.squareTo(t),this.reduce(t)}function X(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function J(){return 0==(this.t>0?1&this.data[0]:this.s)}function Z(e,t){if(e>4294967295||e<1)return a.ONE;var n=c(),r=c(),s=t.convert(this),i=R(e)-1;s.copyTo(n);while(--i>=0)if(t.sqrTo(n,r),(e&1<<i)>0)t.mulTo(r,s,n);else{var o=n;n=r,r=o}return t.revert(n)}function ee(e,t){var n;return n=e<256||t.isEven()?new F(t):new q(t),this.exp(e,n)}function te(){var e=c();return this.copyTo(e),e}function ne(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function re(){return 0==this.t?this.s:this.data[0]<<24>>24}function se(){return 0==this.t?this.s:this.data[0]<<16>>16}function ie(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function oe(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1}function ae(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),n=Math.pow(e,t),r=_(n),s=c(),i=c(),o="";this.divRemTo(r,s,i);while(s.signum()>0)o=(n+i.intValue()).toString(e).substr(1)+o,s.divRemTo(r,s,i);return i.intValue().toString(e)+o}function ce(e,t){this.fromInt(0),null==t&&(t=10);for(var n=this.chunkSize(t),r=Math.pow(t,n),s=!1,i=0,o=0,c=0;c<e.length;++c){var l=w(e,c);l<0?"-"==e.charAt(c)&&0==this.signum()&&(s=!0):(o=t*o+l,++i>=n&&(this.dMultiply(r),this.dAddOffset(o,0),i=0,o=0))}i>0&&(this.dMultiply(Math.pow(t,i)),this.dAddOffset(o,0)),s&&a.ZERO.subTo(this,this)}function le(e,t,n){if("number"==typeof t)if(e<2)this.fromInt(1);else{this.fromNumber(e,n),this.testBit(e-1)||this.bitwiseTo(a.ONE.shiftLeft(e-1),me,this),this.isEven()&&this.dAddOffset(1,0);while(!this.isProbablePrime(t))this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(a.ONE.shiftLeft(e-1),this)}else{var r=new Array,s=7&e;r.length=1+(e>>3),t.nextBytes(r),s>0?r[0]&=(1<<s)-1:r[0]=0,this.fromString(r,256)}}function ue(){var e=this.t,t=new Array;t[0]=this.s;var n,r=this.DB-e*this.DB%8,s=0;if(e-- >0){r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[s++]=n|this.s<<this.DB-r);while(e>=0)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),0!=(128&n)&&(n|=-256),0==s&&(128&this.s)!=(128&n)&&++s,(s>0||n!=this.s)&&(t[s++]=n)}return t}function he(e){return 0==this.compareTo(e)}function de(e){return this.compareTo(e)<0?this:e}function fe(e){return this.compareTo(e)>0?this:e}function pe(e,t,n){var r,s,i=Math.min(e.t,this.t);for(r=0;r<i;++r)n.data[r]=t(this.data[r],e.data[r]);if(e.t<this.t){for(s=e.s&this.DM,r=i;r<this.t;++r)n.data[r]=t(this.data[r],s);n.t=this.t}else{for(s=this.s&this.DM,r=i;r<e.t;++r)n.data[r]=t(s,e.data[r]);n.t=e.t}n.s=t(this.s,e.s),n.clamp()}function ge(e,t){return e&t}function ye(e){var t=c();return this.bitwiseTo(e,ge,t),t}function me(e,t){return e|t}function we(e){var t=c();return this.bitwiseTo(e,me,t),t}function be(e,t){return e^t}function ve(e){var t=c();return this.bitwiseTo(e,be,t),t}function _e(e,t){return e&~t}function Ee(e){var t=c();return this.bitwiseTo(e,_e,t),t}function Se(){for(var e=c(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function ke(e){var t=c();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Ie(e){var t=c();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Ae(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function Te(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+Ae(this.data[e]);return this.s<0?this.t*this.DB:-1}function Re(e){var t=0;while(0!=e)e&=e-1,++t;return t}function Ce(){for(var e=0,t=this.s&this.DM,n=0;n<this.t;++n)e+=Re(this.data[n]^t);return e}function Pe(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)}function Ne(e,t){var n=a.ONE.shiftLeft(e);return this.bitwiseTo(n,t,n),n}function Oe(e){return this.changeBit(e,me)}function De(e){return this.changeBit(e,_e)}function Le(e){return this.changeBit(e,be)}function xe(e,t){var n=0,r=0,s=Math.min(e.t,this.t);while(n<s)r+=this.data[n]+e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;if(e.t<this.t){r+=e.s;while(n<this.t)r+=this.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{r+=this.s;while(n<e.t)r+=e.data[n],t.data[n++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t.data[n++]=r:r<-1&&(t.data[n++]=this.DV+r),t.t=n,t.clamp()}function Be(e){var t=c();return this.addTo(e,t),t}function Me(e){var t=c();return this.subTo(e,t),t}function Ue(e){var t=c();return this.multiplyTo(e,t),t}function Fe(e){var t=c();return this.divRemTo(e,t,null),t}function je(e){var t=c();return this.divRemTo(e,null,t),t}function Ve(e){var t=c(),n=c();return this.divRemTo(e,t,n),new Array(t,n)}function ze(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function $e(e,t){if(0!=e){while(this.t<=t)this.data[this.t++]=0;this.data[t]+=e;while(this.data[t]>=this.DV)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Ke(){}function He(e){return e}function qe(e,t,n){e.multiplyTo(t,n)}function We(e,t){e.squareTo(t)}function Ge(e){return this.exp(e,new Ke)}function Ye(e,t,n){var r,s=Math.min(this.t+e.t,t);n.s=0,n.t=s;while(s>0)n.data[--s]=0;for(r=n.t-this.t;s<r;++s)n.data[s+this.t]=this.am(0,e.data[s],n,s,0,this.t);for(r=Math.min(e.t,t);s<r;++s)this.am(0,e.data[s],n,s,0,t-s);n.clamp()}function Qe(e,t,n){--t;var r=n.t=this.t+e.t-t;n.s=0;while(--r>=0)n.data[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)n.data[this.t+r-t]=this.am(t-r,e.data[r],n,0,0,this.t+r-t);n.clamp(),n.drShiftTo(1,n)}function Xe(e){this.r2=c(),this.q3=c(),a.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Je(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=c();return e.copyTo(t),this.reduce(t),t}function Ze(e){return e}function et(e){e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(e.compareTo(this.r2)<0)e.dAddOffset(1,this.m.t+1);e.subTo(this.r2,e);while(e.compareTo(this.m)>=0)e.subTo(this.m,e)}function tt(e,t){e.squareTo(t),this.reduce(t)}function nt(e,t,n){e.multiplyTo(t,n),this.reduce(n)}function rt(e,t){var n,r,s=e.bitLength(),i=_(1);if(s<=0)return i;n=s<18?1:s<48?3:s<144?4:s<768?5:6,r=s<8?new F(t):t.isEven()?new Xe(t):new q(t);var o=new Array,a=3,l=n-1,u=(1<<n)-1;if(o[1]=r.convert(this),n>1){var h=c();r.sqrTo(o[1],h);while(a<=u)o[a]=c(),r.mulTo(h,o[a-2],o[a]),a+=2}var d,f,p=e.t-1,g=!0,y=c();s=R(e.data[p])-1;while(p>=0){s>=l?d=e.data[p]>>s-l&u:(d=(e.data[p]&(1<<s+1)-1)<<l-s,p>0&&(d|=e.data[p-1]>>this.DB+s-l)),a=n;while(0==(1&d))d>>=1,--a;if((s-=a)<0&&(s+=this.DB,--p),g)o[d].copyTo(i),g=!1;else{while(a>1)r.sqrTo(i,y),r.sqrTo(y,i),a-=2;a>0?r.sqrTo(i,y):(f=i,i=y,y=f),r.mulTo(y,o[d],i)}while(p>=0&&0==(e.data[p]&1<<s))r.sqrTo(i,y),f=i,i=y,y=f,--s<0&&(s=this.DB-1,--p)}return r.revert(i)}function st(e){var t=this.s<0?this.negate():this.clone(),n=e.s<0?e.negate():e.clone();if(t.compareTo(n)<0){var r=t;t=n,n=r}var s=t.getLowestSetBit(),i=n.getLowestSetBit();if(i<0)return t;s<i&&(i=s),i>0&&(t.rShiftTo(i,t),n.rShiftTo(i,n));while(t.signum()>0)(s=t.getLowestSetBit())>0&&t.rShiftTo(s,t),(s=n.getLowestSetBit())>0&&n.rShiftTo(s,n),t.compareTo(n)>=0?(t.subTo(n,t),t.rShiftTo(1,t)):(n.subTo(t,n),n.rShiftTo(1,n));return i>0&&n.lShiftTo(i,n),n}function it(e){if(e<=0)return 0;var t=this.DV%e,n=this.s<0?e-1:0;if(this.t>0)if(0==t)n=this.data[0]%e;else for(var r=this.t-1;r>=0;--r)n=(t*n+this.data[r])%e;return n}function ot(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return a.ZERO;var n=e.clone(),r=this.clone(),s=_(1),i=_(0),o=_(0),c=_(1);while(0!=n.signum()){while(n.isEven())n.rShiftTo(1,n),t?(s.isEven()&&i.isEven()||(s.addTo(this,s),i.subTo(e,i)),s.rShiftTo(1,s)):i.isEven()||i.subTo(e,i),i.rShiftTo(1,i);while(r.isEven())r.rShiftTo(1,r),t?(o.isEven()&&c.isEven()||(o.addTo(this,o),c.subTo(e,c)),o.rShiftTo(1,o)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);n.compareTo(r)>=0?(n.subTo(r,n),t&&s.subTo(o,s),i.subTo(c,i)):(r.subTo(n,r),t&&o.subTo(s,o),c.subTo(i,c))}return 0!=r.compareTo(a.ONE)?a.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c}F.prototype.convert=j,F.prototype.revert=V,F.prototype.reduce=z,F.prototype.mulTo=$,F.prototype.sqrTo=K,q.prototype.convert=W,q.prototype.revert=G,q.prototype.reduce=Y,q.prototype.mulTo=X,q.prototype.sqrTo=Q,a.prototype.copyTo=b,a.prototype.fromInt=v,a.prototype.fromString=E,a.prototype.clamp=S,a.prototype.dlShiftTo=P,a.prototype.drShiftTo=N,a.prototype.lShiftTo=O,a.prototype.rShiftTo=D,a.prototype.subTo=L,a.prototype.multiplyTo=x,a.prototype.squareTo=B,a.prototype.divRemTo=M,a.prototype.invDigit=H,a.prototype.isEven=J,a.prototype.exp=Z,a.prototype.toString=k,a.prototype.negate=I,a.prototype.abs=A,a.prototype.compareTo=T,a.prototype.bitLength=C,a.prototype.mod=U,a.prototype.modPowInt=ee,a.ZERO=_(0),a.ONE=_(1),Ke.prototype.convert=He,Ke.prototype.revert=He,Ke.prototype.mulTo=qe,Ke.prototype.sqrTo=We,Xe.prototype.convert=Je,Xe.prototype.revert=Ze,Xe.prototype.reduce=et,Xe.prototype.mulTo=nt,Xe.prototype.sqrTo=tt;var at=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ct=(1<<26)/at[at.length-1];function lt(e){var t,n=this.abs();if(1==n.t&&n.data[0]<=at[at.length-1]){for(t=0;t<at.length;++t)if(n.data[0]==at[t])return!0;return!1}if(n.isEven())return!1;t=1;while(t<at.length){var r=at[t],s=t+1;while(s<at.length&&r<ct)r*=at[s++];r=n.modInt(r);while(t<s)if(r%at[t++]==0)return!1}return n.millerRabin(e)}function ut(e){var t=this.subtract(a.ONE),n=t.getLowestSetBit();if(n<=0)return!1;for(var r,s=t.shiftRight(n),i=ht(),o=0;o<e;++o){do{r=new a(this.bitLength(),i)}while(r.compareTo(a.ONE)<=0||r.compareTo(t)>=0);var c=r.modPow(s,this);if(0!=c.compareTo(a.ONE)&&0!=c.compareTo(t)){var l=1;while(l++<n&&0!=c.compareTo(t))if(c=c.modPowInt(2,this),0==c.compareTo(a.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0}function ht(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}}}a.prototype.chunkSize=ie,a.prototype.toRadix=ae,a.prototype.fromRadix=ce,a.prototype.fromNumber=le,a.prototype.bitwiseTo=pe,a.prototype.changeBit=Ne,a.prototype.addTo=xe,a.prototype.dMultiply=ze,a.prototype.dAddOffset=$e,a.prototype.multiplyLowerTo=Ye,a.prototype.multiplyUpperTo=Qe,a.prototype.modInt=it,a.prototype.millerRabin=ut,a.prototype.clone=te,a.prototype.intValue=ne,a.prototype.byteValue=re,a.prototype.shortValue=se,a.prototype.signum=oe,a.prototype.toByteArray=ue,a.prototype.equals=he,a.prototype.min=de,a.prototype.max=fe,a.prototype.and=ye,a.prototype.or=we,a.prototype.xor=ve,a.prototype.andNot=Ee,a.prototype.not=Se,a.prototype.shiftLeft=ke,a.prototype.shiftRight=Ie,a.prototype.getLowestSetBit=Te,a.prototype.bitCount=Ce,a.prototype.testBit=Pe,a.prototype.setBit=Oe,a.prototype.clearBit=De,a.prototype.flipBit=Le,a.prototype.add=Be,a.prototype.subtract=Me,a.prototype.multiply=Ue,a.prototype.divide=Fe,a.prototype.remainder=je,a.prototype.divideAndRemainder=Ve,a.prototype.modPow=rt,a.prototype.modInverse=ot,a.prototype.pow=Ge,a.prototype.gcd=st,a.prototype.isProbablePrime=lt},4038:function(e,t,n){var r=n(5736);e.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}},235:function(e,t,n){var r=n(5736);n(5219),e.exports=r.mgf=r.mgf||{},r.mgf.mgf1=r.mgf1},5219:function(e,t,n){var r=n(5736);n(4292),r.mgf=r.mgf||{};var s=e.exports=r.mgf.mgf1=r.mgf1=r.mgf1||{};s.create=function(e){var t={generate:function(t,n){for(var s=new r.util.ByteBuffer,i=Math.ceil(n/e.digestLength),o=0;o<i;o++){var a=new r.util.ByteBuffer;a.putInt32(o),e.start(),e.update(t+a.getBytes()),s.putBuffer(e.digest())}return s.truncate(s.length()-n),s.getBytes()}};return t}},9002:function(e,t,n){var r=n(5736);r.pki=r.pki||{};var s=e.exports=r.pki.oids=r.oids=r.oids||{};function i(e,t){s[e]=t,s[t]=e}function o(e,t){s[e]=t}i("1.2.840.113549.1.1.1","rsaEncryption"),i("1.2.840.113549.1.1.4","md5WithRSAEncryption"),i("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),i("1.2.840.113549.1.1.7","RSAES-OAEP"),i("1.2.840.113549.1.1.8","mgf1"),i("1.2.840.113549.1.1.9","pSpecified"),i("1.2.840.113549.1.1.10","RSASSA-PSS"),i("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),i("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),i("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),i("1.3.101.112","EdDSA25519"),i("1.2.840.10040.4.3","dsa-with-sha1"),i("1.3.14.3.2.7","desCBC"),i("1.3.14.3.2.26","sha1"),i("1.3.14.3.2.29","sha1WithRSASignature"),i("2.16.840.1.101.3.4.2.1","sha256"),i("2.16.840.1.101.3.4.2.2","sha384"),i("2.16.840.1.101.3.4.2.3","sha512"),i("2.16.840.1.101.3.4.2.4","sha224"),i("2.16.840.1.101.3.4.2.5","sha512-224"),i("2.16.840.1.101.3.4.2.6","sha512-256"),i("1.2.840.113549.2.2","md2"),i("1.2.840.113549.2.5","md5"),i("1.2.840.113549.1.7.1","data"),i("1.2.840.113549.1.7.2","signedData"),i("1.2.840.113549.1.7.3","envelopedData"),i("1.2.840.113549.1.7.4","signedAndEnvelopedData"),i("1.2.840.113549.1.7.5","digestedData"),i("1.2.840.113549.1.7.6","encryptedData"),i("1.2.840.113549.1.9.1","emailAddress"),i("1.2.840.113549.1.9.2","unstructuredName"),i("1.2.840.113549.1.9.3","contentType"),i("1.2.840.113549.1.9.4","messageDigest"),i("1.2.840.113549.1.9.5","signingTime"),i("1.2.840.113549.1.9.6","counterSignature"),i("1.2.840.113549.1.9.7","challengePassword"),i("1.2.840.113549.1.9.8","unstructuredAddress"),i("1.2.840.113549.1.9.14","extensionRequest"),i("1.2.840.113549.1.9.20","friendlyName"),i("1.2.840.113549.1.9.21","localKeyId"),i("1.2.840.113549.1.9.22.1","x509Certificate"),i("1.2.840.113549.1.12.10.1.1","keyBag"),i("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),i("1.2.840.113549.1.12.10.1.3","certBag"),i("1.2.840.113549.1.12.10.1.4","crlBag"),i("1.2.840.113549.1.12.10.1.5","secretBag"),i("1.2.840.113549.1.12.10.1.6","safeContentsBag"),i("1.2.840.113549.1.5.13","pkcs5PBES2"),i("1.2.840.113549.1.5.12","pkcs5PBKDF2"),i("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),i("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),i("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),i("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),i("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),i("1.2.840.113549.2.7","hmacWithSHA1"),i("1.2.840.113549.2.8","hmacWithSHA224"),i("1.2.840.113549.2.9","hmacWithSHA256"),i("1.2.840.113549.2.10","hmacWithSHA384"),i("1.2.840.113549.2.11","hmacWithSHA512"),i("1.2.840.113549.3.7","des-EDE3-CBC"),i("2.16.840.1.101.3.4.1.2","aes128-CBC"),i("2.16.840.1.101.3.4.1.22","aes192-CBC"),i("2.16.840.1.101.3.4.1.42","aes256-CBC"),i("2.5.4.3","commonName"),i("2.5.4.4","surname"),i("2.5.4.5","serialNumber"),i("2.5.4.6","countryName"),i("2.5.4.7","localityName"),i("2.5.4.8","stateOrProvinceName"),i("2.5.4.9","streetAddress"),i("2.5.4.10","organizationName"),i("2.5.4.11","organizationalUnitName"),i("2.5.4.12","title"),i("2.5.4.13","description"),i("2.5.4.15","businessCategory"),i("2.5.4.17","postalCode"),i("2.5.4.42","givenName"),i("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),i("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),i("2.16.840.1.113730.1.1","nsCertType"),i("2.16.840.1.113730.1.13","nsComment"),o("2.5.29.1","authorityKeyIdentifier"),o("2.5.29.2","keyAttributes"),o("2.5.29.3","certificatePolicies"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.5","policyMapping"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.7","subjectAltName"),o("2.5.29.8","issuerAltName"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.10","basicConstraints"),o("2.5.29.11","nameConstraints"),o("2.5.29.12","policyConstraints"),o("2.5.29.13","basicConstraints"),i("2.5.29.14","subjectKeyIdentifier"),i("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),i("2.5.29.17","subjectAltName"),i("2.5.29.18","issuerAltName"),i("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.25","cRLDistributionPoints"),o("2.5.29.26","issuingDistributionPoint"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),i("2.5.29.31","cRLDistributionPoints"),i("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.34","policyConstraints"),i("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),i("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),i("1.3.6.1.4.1.11129.2.4.2","timestampList"),i("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),i("1.3.6.1.5.5.7.3.1","serverAuth"),i("1.3.6.1.5.5.7.3.2","clientAuth"),i("1.3.6.1.5.5.7.3.3","codeSigning"),i("1.3.6.1.5.5.7.3.4","emailProtection"),i("1.3.6.1.5.5.7.3.8","timeStamping")},1352:function(e,t,n){n(7658);var r=n(5736);if(n(22),n(1041),n(8577),n(4038),n(9002),n(2515),n(7513),n(6412),n(2890),n(5070),n(4292),"undefined"===typeof s)var s=r.jsbn.BigInteger;var i=r.asn1,o=r.pki=r.pki||{};e.exports=o.pbe=r.pbe=r.pbe||{};var a=o.oids,c={name:"EncryptedPrivateKeyInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l={name:"PBES2Algorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},u={name:"pkcs-12PbeParams",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function d(e){var t;if(e){if(t=o.oids[i.derToOid(e)],!t){var n=new Error("Unsupported PRF OID.");throw n.oid=e,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}}else t="hmacWithSHA1";return f(t)}function f(e){var t=r.md;switch(e){case"hmacWithSHA224":t=r.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var n=new Error("Unsupported PRF algorithm.");throw n.algorithm=e,n.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],n}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function p(e,t,n,s){var a=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,e),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,t.getBytes())]);return"hmacWithSHA1"!==s&&a.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,r.util.hexToBytes(n.toString(16))),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.oids[s]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])),a}o.encryptPrivateKeyInfo=function(e,t,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||"aes128",n.prfAlgorithm=n.prfAlgorithm||"sha1";var s,c,l,u=r.random.getBytesSync(n.saltSize),h=n.count,d=i.integerToDer(h);if(0===n.algorithm.indexOf("aes")||"des"===n.algorithm){var g,y,m;switch(n.algorithm){case"aes128":s=16,g=16,y=a["aes128-CBC"],m=r.aes.createEncryptionCipher;break;case"aes192":s=24,g=16,y=a["aes192-CBC"],m=r.aes.createEncryptionCipher;break;case"aes256":s=32,g=16,y=a["aes256-CBC"],m=r.aes.createEncryptionCipher;break;case"des":s=8,g=8,y=a["desCBC"],m=r.des.createEncryptionCipher;break;default:var w=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw w.algorithm=n.algorithm,w}var b="hmacWith"+n.prfAlgorithm.toUpperCase(),v=f(b),_=r.pkcs5.pbkdf2(t,u,h,s,v),E=r.random.getBytesSync(g),S=m(_);S.start(E),S.update(i.toDer(e)),S.finish(),l=S.output.getBytes();var k=p(u,d,s,b);c=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a["pkcs5PBES2"]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a["pkcs5PBKDF2"]).getBytes()),k]),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(y).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,E)])])])}else{if("3des"!==n.algorithm){w=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw w.algorithm=n.algorithm,w}s=24;var I=new r.util.ByteBuffer(u);_=o.pbe.generatePkcs12Key(t,I,1,h,s),E=o.pbe.generatePkcs12Key(t,I,2,h,s),S=r.des.createEncryptionCipher(_);S.start(E),S.update(i.toDer(e)),S.finish(),l=S.output.getBytes(),c=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,u),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,d.getBytes())])])}var A=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[c,i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,l)]);return A},o.decryptPrivateKeyInfo=function(e,t){var n=null,s={},a=[];if(!i.validate(e,c,s,a)){var l=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=a,l}var u=i.derToOid(s.encryptionOid),h=o.pbe.getCipher(u,s.encryptionParams,t),d=r.util.createBuffer(s.encryptedData);return h.update(d),h.finish()&&(n=i.fromDer(h.output)),n},o.encryptedPrivateKeyToPem=function(e,t){var n={type:"ENCRYPTED PRIVATE KEY",body:i.toDer(e).getBytes()};return r.pem.encode(n,{maxline:t})},o.encryptedPrivateKeyFromPem=function(e){var t=r.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var n=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw n.headerType=t.type,n}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return i.fromDer(t.body)},o.encryptRsaPrivateKey=function(e,t,n){if(n=n||{},!n.legacy){var s=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));return s=o.encryptPrivateKeyInfo(s,t,n),o.encryptedPrivateKeyToPem(s)}var a,c,l,u;switch(n.algorithm){case"aes128":a="AES-128-CBC",l=16,c=r.random.getBytesSync(16),u=r.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",l=24,c=r.random.getBytesSync(16),u=r.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",l=32,c=r.random.getBytesSync(16),u=r.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",l=24,c=r.random.getBytesSync(8),u=r.des.createEncryptionCipher;break;case"des":a="DES-CBC",l=8,c=r.random.getBytesSync(8),u=r.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+n.algorithm+'".');throw h.algorithm=n.algorithm,h}var d=r.pbe.opensslDeriveBytes(t,c.substr(0,8),l),f=u(d);f.start(c),f.update(i.toDer(o.privateKeyToAsn1(e))),f.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:r.util.bytesToHex(c).toUpperCase()},body:f.output.getBytes()};return r.pem.encode(p)},o.decryptRsaPrivateKey=function(e,t){var n=null,s=r.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==s.type&&"PRIVATE KEY"!==s.type&&"RSA PRIVATE KEY"!==s.type){var a=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw a.headerType=a,a}if(s.procType&&"ENCRYPTED"===s.procType.type){var c,l;switch(s.dekInfo.algorithm){case"DES-CBC":c=8,l=r.des.createDecryptionCipher;break;case"DES-EDE3-CBC":c=24,l=r.des.createDecryptionCipher;break;case"AES-128-CBC":c=16,l=r.aes.createDecryptionCipher;break;case"AES-192-CBC":c=24,l=r.aes.createDecryptionCipher;break;case"AES-256-CBC":c=32,l=r.aes.createDecryptionCipher;break;case"RC2-40-CBC":c=5,l=function(e){return r.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":c=8,l=function(e){return r.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":c=16,l=function(e){return r.rc2.createDecryptionCipher(e,128)};break;default:a=new Error('Could not decrypt private key; unsupported encryption algorithm "'+s.dekInfo.algorithm+'".');throw a.algorithm=s.dekInfo.algorithm,a}var u=r.util.hexToBytes(s.dekInfo.parameters),h=r.pbe.opensslDeriveBytes(t,u.substr(0,8),c),d=l(h);if(d.start(u),d.update(r.util.createBuffer(s.body)),!d.finish())return n;n=d.output.getBytes()}else n=s.body;return n="ENCRYPTED PRIVATE KEY"===s.type?o.decryptPrivateKeyInfo(i.fromDer(n),t):i.fromDer(n),null!==n&&(n=o.privateKeyFromAsn1(n)),n},o.pbe.generatePkcs12Key=function(e,t,n,s,i,o){var a,c;if("undefined"===typeof o||null===o){if(!("sha1"in r.md))throw new Error('"sha1" hash algorithm unavailable.');o=r.md.sha1.create()}var l=o.digestLength,u=o.blockLength,h=new r.util.ByteBuffer,d=new r.util.ByteBuffer;if(null!==e&&void 0!==e){for(c=0;c<e.length;c++)d.putInt16(e.charCodeAt(c));d.putInt16(0)}var f=d.length(),p=t.length(),g=new r.util.ByteBuffer;g.fillWithByte(n,u);var y=u*Math.ceil(p/u),m=new r.util.ByteBuffer;for(c=0;c<y;c++)m.putByte(t.at(c%p));var w=u*Math.ceil(f/u),b=new r.util.ByteBuffer;for(c=0;c<w;c++)b.putByte(d.at(c%f));var v=m;v.putBuffer(b);for(var _=Math.ceil(i/l),E=1;E<=_;E++){var S=new r.util.ByteBuffer;S.putBytes(g.bytes()),S.putBytes(v.bytes());for(var k=0;k<s;k++)o.start(),o.update(S.getBytes()),S=o.digest();var I=new r.util.ByteBuffer;for(c=0;c<u;c++)I.putByte(S.at(c%l));var A=Math.ceil(p/u)+Math.ceil(f/u),T=new r.util.ByteBuffer;for(a=0;a<A;a++){var R=new r.util.ByteBuffer(v.getBytes(u)),C=511;for(c=I.length()-1;c>=0;c--)C>>=8,C+=I.at(c)+R.at(c),R.setAt(c,255&C);T.putBuffer(R)}v=T,h.putBuffer(S)}return h.truncate(h.length()-i),h},o.pbe.getCipher=function(e,t,n){switch(e){case o.oids["pkcs5PBES2"]:return o.pbe.getCipherForPBES2(e,t,n);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(e,t,n);default:var r=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw r.oid=e,r.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],r}},o.pbe.getCipherForPBES2=function(e,t,n){var s={},a=[];if(!i.validate(t,l,s,a)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=a,c}if(e=i.derToOid(s.kdfOid),e!==o.oids["pkcs5PBKDF2"]){c=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw c.oid=e,c.supportedOids=["pkcs5PBKDF2"],c}if(e=i.derToOid(s.encOid),e!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids["desCBC"]){c=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw c.oid=e,c.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],c}var u,h,f=s.kdfSalt,p=r.util.createBuffer(s.kdfIterationCount);switch(p=p.getInt(p.length()<<3),o.oids[e]){case"aes128-CBC":u=16,h=r.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,h=r.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,h=r.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,h=r.des.createDecryptionCipher;break;case"desCBC":u=8,h=r.des.createDecryptionCipher;break}var g=d(s.prfOid),y=r.pkcs5.pbkdf2(n,f,p,u,g),m=s.encIv,w=h(y);return w.start(m),w},o.pbe.getCipherForPKCS12PBE=function(e,t,n){var s={},a=[];if(!i.validate(t,u,s,a)){var c=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw c.errors=a,c}var l,h,f,p=r.util.createBuffer(s.salt),g=r.util.createBuffer(s.iterations);switch(g=g.getInt(g.length()<<3),e){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,h=8,f=r.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,h=8,f=function(e,t){var n=r.rc2.createDecryptionCipher(e,40);return n.start(t,null),n};break;default:c=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw c.oid=e,c}var y=d(s.prfOid),m=o.pbe.generatePkcs12Key(n,p,1,g,l,y);y.start();var w=o.pbe.generatePkcs12Key(n,p,2,g,h,y);return f(m,w)},o.pbe.opensslDeriveBytes=function(e,t,n,s){if("undefined"===typeof s||null===s){if(!("md5"in r.md))throw new Error('"md5" hash algorithm unavailable.');s=r.md.md5.create()}null===t&&(t="");for(var i=[h(s,e+t)],o=16,a=1;o<n;++a,o+=16)i.push(h(s,i[a-1]+e+t));return i.join("").substr(0,n)}},2515:function(e,t,n){var r=n(5736);n(4881),n(4038),n(4292);var s,i=r.pkcs5=r.pkcs5||{};r.util.isNodejs&&!r.options.usePureJavaScript&&(s=n(5819)),e.exports=r.pbkdf2=i.pbkdf2=function(e,t,n,i,o,a){if("function"===typeof o&&(a=o,o=null),r.util.isNodejs&&!r.options.usePureJavaScript&&s.pbkdf2&&(null===o||"object"!==typeof o)&&(s.pbkdf2Sync.length>4||!o||"sha1"===o))return"string"!==typeof o&&(o="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),a?4===s.pbkdf2Sync.length?s.pbkdf2(e,t,n,i,(function(e,t){if(e)return a(e);a(null,t.toString("binary"))})):s.pbkdf2(e,t,n,i,o,(function(e,t){if(e)return a(e);a(null,t.toString("binary"))})):4===s.pbkdf2Sync.length?s.pbkdf2Sync(e,t,n,i).toString("binary"):s.pbkdf2Sync(e,t,n,i,o).toString("binary");if("undefined"!==typeof o&&null!==o||(o="sha1"),"string"===typeof o){if(!(o in r.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=r.md[o].create()}var c=o.digestLength;if(i>4294967295*c){var l=new Error("Derived key is too long.");if(a)return a(l);throw l}var u=Math.ceil(i/c),h=i-(u-1)*c,d=r.hmac.create();d.start(o,e);var f,p,g,y="";if(!a){for(var m=1;m<=u;++m){d.start(null,null),d.update(t),d.update(r.util.int32ToBytes(m)),f=g=d.digest().getBytes();for(var w=2;w<=n;++w)d.start(null,null),d.update(g),p=d.digest().getBytes(),f=r.util.xorBytes(f,p,c),g=p;y+=m<u?f:f.substr(0,h)}return y}m=1;function b(){if(m>u)return a(null,y);d.start(null,null),d.update(t),d.update(r.util.int32ToBytes(m)),f=g=d.digest().getBytes(),w=2,v()}function v(){if(w<=n)return d.start(null,null),d.update(g),p=d.digest().getBytes(),f=r.util.xorBytes(f,p,c),g=p,++w,r.util.setImmediate(v);y+=m<u?f:f.substr(0,h),++m,b()}b()}},7513:function(e,t,n){n(7658);var r=n(5736);n(4292);var s=e.exports=r.pem=r.pem||{};function i(e){for(var t=e.name+": ",n=[],r=function(e,t){return" "+t},s=0;s<e.values.length;++s)n.push(e.values[s].replace(/^(\S+\r\n)/,r));t+=n.join(",")+"\r\n";var i=0,o=-1;for(s=0;s<t.length;++s,++i)if(i>65&&-1!==o){var a=t[o];","===a?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+a+t.substr(o+1),i=s-o-1,o=-1,++s}else" "!==t[s]&&"\t"!==t[s]&&","!==t[s]||(o=s);return t}function o(e){return e.replace(/^\s+/,"")}s.encode=function(e,t){t=t||{};var n,s="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},s+=i(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},s+=i(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),s+=i(n)),e.headers)for(var o=0;o<e.headers.length;++o)s+=i(e.headers[o]);return e.procType&&(s+="\r\n"),s+=r.util.encode64(e.body,t.maxline||64)+"\r\n",s+="-----END "+e.type+"-----\r\n",s},s.decode=function(e){var t,n=[],s=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/;while(1){if(t=s.exec(e),!t)break;var c=t[1];"NEW CERTIFICATE REQUEST"===c&&(c="CERTIFICATE REQUEST");var l={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:r.util.decode64(t[3])};if(n.push(l),t[2]){var u=t[2].split(a),h=0;while(t&&h<u.length){for(var d=u[h].replace(/\s+$/,""),f=h+1;f<u.length;++f){var p=u[f];if(!/\s/.test(p[0]))break;d+=p,h=f}if(t=d.match(i),t){for(var g={name:t[1],values:[]},y=t[2].split(","),m=0;m<y.length;++m)g.values.push(o(y[m]));if(l.procType)if(l.contentDomain||"Content-Domain"!==g.name)if(l.dekInfo||"DEK-Info"!==g.name)l.headers.push(g);else{if(0===g.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');l.dekInfo={algorithm:y[0],parameters:y[1]||null}}else l.contentDomain=y[0]||"";else{if("Proc-Type"!==g.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==g.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');l.procType={version:y[0],type:y[1]}}}++h}if("ENCRYPTED"===l.procType&&!l.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===n.length)throw new Error("Invalid PEM formatted message.");return n}},902:function(e,t,n){var r=n(5736);n(4292),n(6412),n(989);var s=e.exports=r.pkcs1=r.pkcs1||{};function i(e,t,n){n||(n=r.md.sha1.create());for(var s="",i=Math.ceil(t/n.digestLength),o=0;o<i;++o){var a=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);n.start(),n.update(e+a),s+=n.digest().getBytes()}return s.substring(0,t)}s.encode_rsa_oaep=function(e,t,n){var s,o,a,c;"string"===typeof n?(s=n,o=arguments[3]||void 0,a=arguments[4]||void 0):n&&(s=n.label||void 0,o=n.seed||void 0,a=n.md||void 0,n.mgf1&&n.mgf1.md&&(c=n.mgf1.md)),a?a.start():a=r.md.sha1.create(),c||(c=a);var l=Math.ceil(e.n.bitLength()/8),u=l-2*a.digestLength-2;if(t.length>u){var h=new Error("RSAES-OAEP input message length is too long.");throw h.length=t.length,h.maxLength=u,h}s||(s=""),a.update(s,"raw");for(var d=a.digest(),f="",p=u-t.length,g=0;g<p;g++)f+="\0";var y=d.getBytes()+f+""+t;if(o){if(o.length!==a.digestLength){h=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw h.seedLength=o.length,h.digestLength=a.digestLength,h}}else o=r.random.getBytes(a.digestLength);var m=i(o,l-a.digestLength-1,c),w=r.util.xorBytes(y,m,y.length),b=i(w,a.digestLength,c),v=r.util.xorBytes(o,b,o.length);return"\0"+v+w},s.decode_rsa_oaep=function(e,t,n){var s,o,a;"string"===typeof n?(s=n,o=arguments[3]||void 0):n&&(s=n.label||void 0,o=n.md||void 0,n.mgf1&&n.mgf1.md&&(a=n.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c){var l=new Error("RSAES-OAEP encoded message length is invalid.");throw l.length=t.length,l.expectedLength=c,l}if(void 0===o?o=r.md.sha1.create():o.start(),a||(a=o),c<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");s||(s=""),o.update(s,"raw");for(var u=o.digest().getBytes(),h=t.charAt(0),d=t.substring(1,o.digestLength+1),f=t.substring(1+o.digestLength),p=i(f,o.digestLength,a),g=r.util.xorBytes(d,p,d.length),y=i(g,c-o.digestLength-1,a),m=r.util.xorBytes(f,y,f.length),w=m.substring(0,o.digestLength),b=(l="\0"!==h,0);b<o.digestLength;++b)l|=u.charAt(b)!==w.charAt(b);for(var v=1,_=o.digestLength,E=o.digestLength;E<m.length;E++){var S=m.charCodeAt(E),k=1&S^1,I=v?65534:0;l|=S&I,v&=k,_+=v}if(l||1!==m.charCodeAt(_))throw new Error("Invalid RSAES-OAEP padding.");return m.substring(_+1)}},7323:function(e,t,n){n(7658);var r=n(5736);n(22),n(1041),n(8577),n(9002),n(7513),n(2193),n(6412),n(4292),n(8410);var s=r.asn1,i=e.exports=r.pkcs7=r.pkcs7||{};function o(e){var t={},n=[];if(!s.validate(e,i.asn1.recipientInfoValidator,t,n)){var o=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw o.errors=n,o}return{version:t.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(t.issuer),serialNumber:r.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:s.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function a(e){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:e.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,r.util.hexToBytes(e.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.encryptedContent.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function c(e){for(var t=[],n=0;n<e.length;++n)t.push(o(e[n]));return t}function l(e){for(var t=[],n=0;n<e.length;++n)t.push(a(e[n]));return t}function u(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:e.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,r.util.hexToBytes(e.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.digestAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var n=s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<e.unauthenticatedAttributes.length;++i){var o=e.unauthenticatedAttributes[i];n.values.push(d(o))}t.value.push(n)}return t}function h(e){for(var t=[],n=0;n<e.length;++n)t.push(u(e[n]));return t}function d(e){var t;if(e.type===r.pki.oids.contentType)t=s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.value).getBytes());else if(e.type===r.pki.oids.messageDigest)t=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===r.pki.oids.signingTime){var n=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),o=e.value;if("string"===typeof o){var a=Date.parse(o);o=isNaN(a)?13===o.length?s.utcTimeToDate(o):s.generalizedTimeToDate(o):new Date(a)}t=o>=n&&o<i?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(o)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(o))}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[t])])}function f(e){return[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(r.pki.oids.data).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.algorithm).getBytes()),e.parameter?s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.content.getBytes())])]}function p(e,t,n){var i={},o=[];if(!s.validate(t,n,i,o)){var a=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw a.errors=a,a}var c=s.derToOid(i.contentType);if(c!==r.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var l="";if(r.util.isArray(i.encryptedContent))for(var u=0;u<i.encryptedContent.length;++u){if(i.encryptedContent[u].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");l+=i.encryptedContent[u].value}else l=i.encryptedContent;e.encryptedContent={algorithm:s.derToOid(i.encAlgorithm),parameter:r.util.createBuffer(i.encParameter.value),content:r.util.createBuffer(l)}}if(i.content){l="";if(r.util.isArray(i.content))for(u=0;u<i.content.length;++u){if(i.content[u].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");l+=i.content[u].value}else l=i.content;e.content=r.util.createBuffer(l)}return e.version=i.version.charCodeAt(0),e.rawCapture=i,i}function g(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case r.pki.oids["aes128-CBC"]:case r.pki.oids["aes192-CBC"]:case r.pki.oids["aes256-CBC"]:t=r.aes.createDecryptionCipher(e.encryptedContent.key);break;case r.pki.oids["desCBC"]:case r.pki.oids["des-EDE3-CBC"]:t=r.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}i.messageFromPem=function(e){var t=r.pem.decode(e)[0];if("PKCS7"!==t.type){var n=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw n.headerType=t.type,n}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var o=s.fromDer(t.body);return i.messageFromAsn1(o)},i.messageToPem=function(e,t){var n={type:"PKCS7",body:s.toDer(e.toAsn1()).getBytes()};return r.pem.encode(n,{maxline:t})},i.messageFromAsn1=function(e){var t={},n=[];if(!s.validate(e,i.asn1.contentInfoValidator,t,n)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw o.errors=n,o}var a,c=s.derToOid(t.contentType);switch(c){case r.pki.oids.envelopedData:a=i.createEnvelopedData();break;case r.pki.oids.encryptedData:a=i.createEncryptedData();break;case r.pki.oids.signedData:a=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return a.fromAsn1(t.content.value[0]),a},i.createSignedData=function(){var e=null;return e={type:r.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(p(e,t,i.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var n=e.rawCapture.certificates.value,s=0;s<n.length;++s)e.certificates.push(r.pki.certificateFromAsn1(n[s]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],n=0;n<e.certificates.length;++n)t.push(r.pki.certificateToAsn1(e.certificates[n]));var i=[],o=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&o.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,t)),i.length>0&&o.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,i)),o.value[0].value.push(s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.signerInfos)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),o])},addSigner:function(t){var n=t.issuer,s=t.serialNumber;if(t.certificate){var i=t.certificate;"string"===typeof i&&(i=r.pki.certificateFromPem(i)),n=i.issuer.attributes,s=i.serialNumber}var o=t.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"===typeof o&&(o=r.pki.privateKeyFromPem(o));var a=t.digestAlgorithm||r.pki.oids.sha1;switch(a){case r.pki.oids.sha1:case r.pki.oids.sha256:case r.pki.oids.sha384:case r.pki.oids.sha512:case r.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+a)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var l=!1,u=!1,h=0;h<c.length;++h){var d=c[h];if(l||d.type!==r.pki.oids.contentType){if(u||d.type!==r.pki.oids.messageDigest);else if(u=!0,l)break}else if(l=!0,u)break}if(!l||!u)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:n,serialNumber:s,digestAlgorithm:a,signatureAlgorithm:r.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(i){var o;(i=i||{},"object"!==typeof e.content||null===e.contentInfo)&&(e.contentInfo=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(r.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof r.util.ByteBuffer?o=e.content.bytes():"string"===typeof e.content&&(o=r.util.encodeUtf8(e.content)),i.detached?e.detachedContent=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,o):e.contentInfo.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,o)]))));if(0!==e.signers.length){var a=t();n(a)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"===typeof t&&(t=r.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var t={},n=0;n<e.signers.length;++n){var i=e.signers[n],o=i.digestAlgorithm;o in t||(t[o]=r.md[r.pki.oids[o]].create()),0===i.authenticatedAttributes.length?i.md=t[o]:i.md=r.md[r.pki.oids[o]].create()}for(var o in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]));return t}function n(t){var n;if(e.detachedContent?n=e.detachedContent:(n=e.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var i=s.derToOid(e.contentInfo.value[0].value),o=s.toDer(n);for(var a in o.getByte(),s.getBerValueLength(o),o=o.getBytes(),t)t[a].start().update(o);for(var c=new Date,l=0;l<e.signers.length;++l){var u=e.signers[l];if(0===u.authenticatedAttributes.length){if(i!==r.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{u.authenticatedAttributesAsn1=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[]),p=0;p<u.authenticatedAttributes.length;++p){var g=u.authenticatedAttributes[p];g.type===r.pki.oids.messageDigest?g.value=t[u.digestAlgorithm].digest():g.type===r.pki.oids.signingTime&&(g.value||(g.value=c)),f.value.push(d(g)),u.authenticatedAttributesAsn1.value.push(d(g))}o=s.toDer(f).getBytes(),u.md.start().update(o)}u.signature=u.key.sign(u.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=h(e.signers)}},i.createEncryptedData=function(){var e=null;return e={type:r.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(t){p(e,t,i.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),g(e)}},e},i.createEnvelopedData=function(){var e=null;return e={type:r.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(t){var n=p(e,t,i.asn1.envelopedDataValidator);e.recipients=c(n.recipientInfos.value)},toAsn1:function(){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,l(e.recipients)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,f(e.encryptedContent))])])])},findRecipient:function(t){for(var n=t.issuer.attributes,r=0;r<e.recipients.length;++r){var s=e.recipients[r],i=s.issuer;if(s.serialNumber===t.serialNumber&&i.length===n.length){for(var o=!0,a=0;a<n.length;++a)if(i[a].type!==n[a].type||i[a].value!==n[a].value){o=!1;break}if(o)return s}}return null},decrypt:function(t,n){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==n)switch(t.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:case r.pki.oids.desCBC:var s=n.decrypt(t.encryptedContent.content);e.encryptedContent.key=r.util.createBuffer(s);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}g(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:r.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,n){if(void 0===e.encryptedContent.content){var s,i,o;switch(n=n||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,n){case r.pki.oids["aes128-CBC"]:s=16,i=16,o=r.aes.createEncryptionCipher;break;case r.pki.oids["aes192-CBC"]:s=24,i=16,o=r.aes.createEncryptionCipher;break;case r.pki.oids["aes256-CBC"]:s=32,i=16,o=r.aes.createEncryptionCipher;break;case r.pki.oids["des-EDE3-CBC"]:s=24,i=8,o=r.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+n)}if(void 0===t)t=r.util.createBuffer(r.random.getBytes(s));else if(t.length()!=s)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+s+".");e.encryptedContent.algorithm=n,e.encryptedContent.key=t,e.encryptedContent.parameter=r.util.createBuffer(r.random.getBytes(i));var a=o(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var c=0;c<e.recipients.length;++c){var l=e.recipients[c];if(void 0===l.encryptedContent.content)switch(l.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},e}},2193:function(e,t,n){var r=n(5736);n(1041),n(4292);var s=r.asn1,i=e.exports=r.pkcs7asn1=r.pkcs7asn1||{};r.pkcs7=r.pkcs7||{},r.pkcs7.asn1=i;var o={name:"ContentInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};i.contentInfoValidator=o;var a={name:"EncryptedContentInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};i.envelopedDataValidator={name:"EnvelopedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(a)},i.encryptedDataValidator={name:"EncryptedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"}].concat(a)};var c={name:"SignerInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};i.signedDataValidator={name:"SignedData",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},i.recipientInfoValidator={name:"RecipientInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:s.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:s.Class.UNIVERSAL,type:s.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},3686:function(e,t,n){var r=n(5736);n(4292),n(5970),n(6412),function(){if(r.prime)e.exports=r.prime;else{var t=e.exports=r.prime=r.prime||{},n=r.jsbn.BigInteger,s=[6,4,2,4,2,4,6,2],i=new n(null);i.fromInt(30);var o=function(e,t){return e|t};t.generateProbablePrime=function(e,t,n){"function"===typeof t&&(n=t,t={}),t=t||{};var s=t.algorithm||"PRIMEINC";"string"===typeof s&&(s={name:s}),s.options=s.options||{};var i=t.prng||r.random,o={nextBytes:function(e){for(var t=i.getBytesSync(e.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}};if("PRIMEINC"===s.name)return a(e,o,s.options,n);throw new Error("Invalid prime generation algorithm: "+s.name)}}function a(e,t,n,r){return"workers"in n?u(e,t,n,r):c(e,t,n,r)}function c(e,t,n,r){var s=h(e,t),i=0,o=d(s.bitLength());"millerRabinTests"in n&&(o=n.millerRabinTests);var a=10;"maxBlockTime"in n&&(a=n.maxBlockTime),l(s,e,t,i,o,a,r)}function l(e,t,n,i,o,a,c){var u=+new Date;do{if(e.bitLength()>t&&(e=h(t,n)),e.isProbablePrime(o))return c(null,e);e.dAddOffset(s[i++%8],0)}while(a<0||+new Date-u<a);r.util.setImmediate((function(){l(e,t,n,i,o,a,c)}))}function u(e,t,s,i){if("undefined"===typeof Worker)return c(e,t,s,i);var o=h(e,t),a=s.workers,l=s.workLoad||100,u=30*l/8,d=s.workerScript||"forge/prime.worker.js";if(-1===a)return r.util.estimateCores((function(e,t){e&&(t=2),a=t-1,f()}));function f(){a=Math.max(1,a);for(var r=[],s=0;s<a;++s)r[s]=new Worker(d);for(s=0;s<a;++s)r[s].addEventListener("message",f);var c=!1;function f(s){if(!c){0;var a=s.data;if(a.found){for(var d=0;d<r.length;++d)r[d].terminate();return c=!0,i(null,new n(a.prime,16))}o.bitLength()>e&&(o=h(e,t));var f=o.toString(16);s.target.postMessage({hex:f,workLoad:l}),o.dAddOffset(u,0)}}}f()}function h(e,t){var r=new n(e,t),s=e-1;return r.testBit(s)||r.bitwiseTo(n.ONE.shiftLeft(s),o,r),r.dAddOffset(31-r.mod(i).byteValue(),0),r}function d(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}}()},649:function(e,t,n){var r=n(5736);n(4292);var s=null;!r.util.isNodejs||r.options.usePureJavaScript||process.versions["node-webkit"]||(s=n(5819));var i=e.exports=r.prng=r.prng||{};i.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},n=e.md,i=new Array(32),o=0;o<32;++o)i[o]=n.create();function a(e){if(t.pools[0].messageLength>=32)return l(),e();var n=32-t.pools[0].messageLength<<5;t.seedFile(n,(function(n,r){if(n)return e(n);t.collect(r),l(),e()}))}function c(){if(t.pools[0].messageLength>=32)return l();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),l()}function l(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var n=1,r=0;r<32;++r)t.reseeds%n===0&&(e.update(t.pools[r].digest().getBytes()),t.pools[r].start()),n<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var s=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(s),t.generated=0}function u(e){var t=null,n=r.util.globalScope,s=n.crypto||n.msCrypto;s&&s.getRandomValues&&(t=function(e){return s.getRandomValues(e)});var i=r.util.createBuffer();if(t)while(i.length()<e){var o=Math.max(1,Math.min(e-i.length(),65536)/4),a=new Uint32Array(Math.floor(o));try{t(a);for(var c=0;c<a.length;++c)i.putInt32(a[c])}catch(f){if(!("undefined"!==typeof QuotaExceededError&&f instanceof QuotaExceededError))throw f}}if(i.length()<e){var l,u,h,d=Math.floor(65536*Math.random());while(i.length()<e){u=16807*(65535&d),l=16807*(d>>16),u+=(32767&l)<<16,u+=l>>15,u=(2147483647&u)+(u>>31),d=4294967295&u;for(c=0;c<3;++c)h=d>>>(c<<3),h^=Math.floor(256*Math.random()),i.putByte(255&h)}}return i.getBytes(e)}return t.pools=i,t.pool=0,t.generate=function(e,n){if(!n)return t.generateSync(e);var s=t.plugin.cipher,i=t.plugin.increment,o=t.plugin.formatKey,c=t.plugin.formatSeed,l=r.util.createBuffer();function u(h){if(h)return n(h);if(l.length()>=e)return n(null,l.getBytes(e));if(t.generated>1048575&&(t.key=null),null===t.key)return r.util.nextTick((function(){a(u)}));var d=s(t.key,t.seed);t.generated+=d.length,l.putBytes(d),t.key=o(s(t.key,i(t.seed))),t.seed=c(s(t.key,t.seed)),r.util.setImmediate(u)}t.key=null,u()},t.generateSync=function(e){var n=t.plugin.cipher,s=t.plugin.increment,i=t.plugin.formatKey,o=t.plugin.formatSeed;t.key=null;var a=r.util.createBuffer();while(a.length()<e){t.generated>1048575&&(t.key=null),null===t.key&&c();var l=n(t.key,t.seed);t.generated+=l.length,a.putBytes(l),t.key=i(n(t.key,s(t.seed))),t.seed=o(n(t.key,t.seed))}return a.getBytes(e)},s?(t.seedFile=function(e,t){s.randomBytes(e,(function(e,n){if(e)return t(e);t(null,n.toString())}))},t.seedFileSync=function(e){return s.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,u(e))}catch(n){t(n)}},t.seedFileSync=u),t.collect=function(e){for(var n=e.length,r=0;r<n;++r)t.pools[t.pool].update(e.substr(r,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,n){for(var r="",s=0;s<n;s+=8)r+=String.fromCharCode(e>>s&255);t.collect(r)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){function n(e){var r=e.data;r.forge&&r.forge.prng&&(self.removeEventListener("message",n),t(r.forge.prng.err,r.forge.prng.bytes))}self.addEventListener("message",n),self.postMessage({forge:{prng:{needed:e}}})};else{var n=function(n){var r=n.data;r.forge&&r.forge.prng&&t.seedFile(r.forge.prng.needed,(function(t,n){e.postMessage({forge:{prng:{err:t,bytes:n}}})}))};e.addEventListener("message",n)}},t}},5451:function(e,t,n){var r=n(5736);n(6412),n(4292);var s=e.exports=r.pss=r.pss||{};s.create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,n=e.md,s=e.mgf,i=n.digestLength,o=e.salt||null;if("string"===typeof o&&(o=r.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||r.random,c={encode:function(e,c){var l,u,h=c-1,d=Math.ceil(h/8),f=e.digest().getBytes();if(d<i+t+2)throw new Error("Message is too long to encrypt.");u=null===o?a.getBytesSync(t):o.bytes();var p=new r.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(f),p.putBytes(u),n.start(),n.update(p.getBytes());var g=n.digest().getBytes(),y=new r.util.ByteBuffer;y.fillWithByte(0,d-t-i-2),y.putByte(1),y.putBytes(u);var m=y.getBytes(),w=d-i-1,b=s.generate(g,w),v="";for(l=0;l<w;l++)v+=String.fromCharCode(m.charCodeAt(l)^b.charCodeAt(l));var _=65280>>8*d-h&255;return v=String.fromCharCode(v.charCodeAt(0)&~_)+v.substr(1),v+g+String.fromCharCode(188)},verify:function(e,o,a){var c,l=a-1,u=Math.ceil(l/8);if(o=o.substr(-u),u<i+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(u-1))throw new Error("Encoded message does not end in 0xBC.");var h=u-i-1,d=o.substr(0,h),f=o.substr(h,i),p=65280>>8*u-l&255;if(0!==(d.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var g=s.generate(f,h),y="";for(c=0;c<h;c++)y+=String.fromCharCode(d.charCodeAt(c)^g.charCodeAt(c));y=String.fromCharCode(y.charCodeAt(0)&~p)+y.substr(1);var m=u-i-t-2;for(c=0;c<m;c++)if(0!==y.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==y.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var w=y.substr(-t),b=new r.util.ByteBuffer;b.fillWithByte(0,8),b.putBytes(e),b.putBytes(w),n.start(),n.update(b.getBytes());var v=n.digest().getBytes();return f===v}};return c}},6412:function(e,t,n){var r=n(5736);n(22),n(5898),n(649),n(4292),function(){r.random&&r.random.getBytes?e.exports=r.random:function(t){var n={},s=new Array(4),i=r.util.createBuffer();function o(){var e=r.prng.create(n);return e.getBytes=function(t,n){return e.generate(t,n)},e.getBytesSync=function(t){return e.generate(t)},e}n.formatKey=function(e){var t=r.util.createBuffer(e);return e=new Array(4),e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),r.aes._expandKey(e,!1)},n.formatSeed=function(e){var t=r.util.createBuffer(e);return e=new Array(4),e[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},n.cipher=function(e,t){return r.aes._updateBlock(e,t,s,!1),i.putInt32(s[0]),i.putInt32(s[1]),i.putInt32(s[2]),i.putInt32(s[3]),i.getBytes()},n.increment=function(e){return++e[3],e},n.md=r.md.sha256;var a=o(),c=null,l=r.util.globalScope,u=l.crypto||l.msCrypto;if(u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)}),r.options.usePureJavaScript||!r.util.isNodejs&&!c){if("undefined"===typeof window||window.document,a.collectInt(+new Date,32),"undefined"!==typeof navigator){var h="";for(var d in navigator)try{"string"==typeof navigator[d]&&(h+=navigator[d])}catch(f){}a.collect(h),h=null}t&&(t().mousemove((function(e){a.collectInt(e.clientX,16),a.collectInt(e.clientY,16)})),t().keypress((function(e){a.collectInt(e.charCode,8)})))}if(r.random)for(var d in a)r.random[d]=a[d];else r.random=a;r.random.createInstance=o,e.exports=r.random}("undefined"!==typeof jQuery?jQuery:null)}()},2890:function(e,t,n){n(7658);var r=n(5736);n(4292);var s=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],i=[1,2,3,5],o=function(e,t){return e<<t&65535|(65535&e)>>16-t},a=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=r.rc2=r.rc2||{},r.rc2.expandKey=function(e,t){"string"===typeof e&&(e=r.util.createBuffer(e)),t=t||128;var n,i=e,o=e.length(),a=t,c=Math.ceil(a/8),l=255>>(7&a);for(n=o;n<128;n++)i.putByte(s[i.at(n-1)+i.at(n-o)&255]);for(i.setAt(128-c,s[i.at(128-c)&l]),n=127-c;n>=0;n--)i.setAt(n,s[i.at(n+1)^i.at(n+c)]);return i};var c=function(e,t,n){var s,c,l,u,h=!1,d=null,f=null,p=null,g=[];for(e=r.rc2.expandKey(e,t),l=0;l<64;l++)g.push(e.getInt16Le());n?(s=function(e){for(l=0;l<4;l++)e[l]+=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),e[l]=o(e[l],i[l]),u++},c=function(e){for(l=0;l<4;l++)e[l]+=g[63&e[(l+3)%4]]}):(s=function(e){for(l=3;l>=0;l--)e[l]=a(e[l],i[l]),e[l]-=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),u--},c=function(e){for(l=3;l>=0;l--)e[l]-=g[63&e[(l+3)%4]]});var y=function(e){var t=[];for(l=0;l<4;l++){var r=d.getInt16Le();null!==p&&(n?r^=p.getInt16Le():p.putInt16Le(r)),t.push(65535&r)}u=n?0:63;for(var s=0;s<e.length;s++)for(var i=0;i<e[s][0];i++)e[s][1](t);for(l=0;l<4;l++)null!==p&&(n?p.putInt16Le(t[l]):t[l]^=p.getInt16Le()),f.putInt16Le(t[l])},m=null;return m={start:function(e,t){e&&"string"===typeof e&&(e=r.util.createBuffer(e)),h=!1,d=r.util.createBuffer(),f=t||new r.util.createBuffer,p=e,m.output=f},update:function(e){h||d.putBuffer(e);while(d.length()>=8)y([[5,s],[1,c],[6,s],[1,c],[5,s]])},finish:function(e){var t=!0;if(n)if(e)t=e(8,d,!n);else{var r=8===d.length()?8:8-d.length();d.fillWithByte(r,r)}if(t&&(h=!0,m.update()),!n&&(t=0===d.length(),t))if(e)t=e(8,f,!n);else{var s=f.length(),i=f.at(s-1);i>s?t=!1:f.truncate(i)}return t}},m};r.rc2.startEncrypting=function(e,t,n){var s=r.rc2.createEncryptionCipher(e,128);return s.start(t,n),s},r.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},r.rc2.startDecrypting=function(e,t,n){var s=r.rc2.createDecryptionCipher(e,128);return s.start(t,n),s},r.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},5070:function(e,t,n){n(7658);var r=n(5736);if(n(1041),n(5970),n(9002),n(902),n(3686),n(6412),n(4292),"undefined"===typeof s)var s=r.jsbn.BigInteger;var i=r.util.isNodejs?n(5819):null,o=r.asn1,a=r.util;r.pki=r.pki||{},e.exports=r.pki.rsa=r.rsa=r.rsa||{};var c=r.pki,l=[6,4,2,4,2,4,6,2],u={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},d={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},f=r.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p={name:"DigestInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:o.Class.UNIVERSAL,type:o.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},g=function(e){var t;if(!(e.algorithm in c.oids)){var n=new Error("Unknown message digest algorithm.");throw n.algorithm=e.algorithm,n}t=c.oids[e.algorithm];var r=o.oidToDer(t).getBytes(),s=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);i.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,r)),i.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var a=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return s.value.push(i),s.value.push(a),o.toDer(s).getBytes()},y=function(e,t,n){if(n)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var i;t.dP||(t.dP=t.d.mod(t.p.subtract(s.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(s.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{i=new s(r.util.bytesToHex(r.random.getBytes(t.n.bitLength()/8)),16)}while(i.compareTo(t.n)>=0||!i.gcd(t.n).equals(s.ONE));e=e.multiply(i.modPow(t.e,t.n)).mod(t.n);var o=e.mod(t.p).modPow(t.dP,t.p),a=e.mod(t.q).modPow(t.dQ,t.q);while(o.compareTo(a)<0)o=o.add(t.p);var c=o.subtract(a).multiply(t.qInv).mod(t.p).multiply(t.q).add(a);return c=c.multiply(i.modInverse(t.n)).mod(t.n),c};function m(e,t,n){var s=r.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=i-11,o}s.putByte(0),s.putByte(n);var a,c=i-3-e.length;if(0===n||1===n){a=0===n?0:255;for(var l=0;l<c;++l)s.putByte(a)}else while(c>0){var u=0,h=r.random.getBytes(c);for(l=0;l<c;++l)a=h.charCodeAt(l),0===a?++u:s.putByte(a);c=u}return s.putByte(0),s.putBytes(e),s}function w(e,t,n,s){var i=Math.ceil(t.n.bitLength()/8),o=r.util.createBuffer(e),a=o.getByte(),c=o.getByte();if(0!==a||n&&0!==c&&1!==c||!n&&2!=c||n&&0===c&&"undefined"===typeof s)throw new Error("Encryption block is invalid.");var l=0;if(0===c){l=i-3-s;for(var u=0;u<l;++u)if(0!==o.getByte())throw new Error("Encryption block is invalid.")}else if(1===c){l=0;while(o.length()>1){if(255!==o.getByte()){--o.read;break}++l}}else if(2===c){l=0;while(o.length()>1){if(0===o.getByte()){--o.read;break}++l}}var h=o.getByte();if(0!==h||l!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function b(e,t,n){"function"===typeof t&&(n=t,t={}),t=t||{};var i={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function o(){a(e.pBits,(function(t,r){return t?n(t):(e.p=r,null!==e.q?l(t,e.q):void a(e.qBits,l))}))}function a(e,t){r.prime.generateProbablePrime(e,i,t)}function l(t,r){if(t)return n(t);if(e.q=r,e.p.compareTo(e.q)<0){var i=e.p;e.p=e.q,e.q=i}if(0!==e.p.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.p=null,void o();if(0!==e.q.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.q=null,void a(e.qBits,l);if(e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(s.ONE))return e.p=e.q=null,void o();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void a(e.qBits,l);var u=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)},n(null,e.keys)}"prng"in t&&(i.prng=t.prng),o()}function v(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var n=r.util.hexToBytes(t);return n.length>1&&(0===n.charCodeAt(0)&&0===(128&n.charCodeAt(1))||255===n.charCodeAt(0)&&128===(128&n.charCodeAt(1)))?n.substr(1):n}function _(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function E(e){return r.util.isNodejs&&"function"===typeof i[e]}function S(e){return"undefined"!==typeof a.globalScope&&"object"===typeof a.globalScope.crypto&&"object"===typeof a.globalScope.crypto.subtle&&"function"===typeof a.globalScope.crypto.subtle[e]}function k(e){return"undefined"!==typeof a.globalScope&&"object"===typeof a.globalScope.msCrypto&&"object"===typeof a.globalScope.msCrypto.subtle&&"function"===typeof a.globalScope.msCrypto.subtle[e]}function I(e){for(var t=r.util.hexToBytes(e.toString(16)),n=new Uint8Array(t.length),s=0;s<t.length;++s)n[s]=t.charCodeAt(s);return n}c.rsa.encrypt=function(e,t,n){var i,o=n,a=Math.ceil(t.n.bitLength()/8);!1!==n&&!0!==n?(o=2===n,i=m(e,t,n)):(i=r.util.createBuffer(),i.putBytes(e));var c=new s(i.toHex(),16),l=y(c,t,o),u=l.toString(16),h=r.util.createBuffer(),d=a-Math.ceil(u.length/2);while(d>0)h.putByte(0),--d;return h.putBytes(r.util.hexToBytes(u)),h.getBytes()},c.rsa.decrypt=function(e,t,n,i){var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var a=new Error("Encrypted message length is invalid.");throw a.length=e.length,a.expected=o,a}var c=new s(r.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");var l=y(c,t,n),u=l.toString(16),h=r.util.createBuffer(),d=o-Math.ceil(u.length/2);while(d>0)h.putByte(0),--d;return h.putBytes(r.util.hexToBytes(u)),!1!==i?w(h.getBytes(),t,n):h.getBytes()},c.rsa.createKeyPairGenerationState=function(e,t,n){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048,n=n||{};var i,o=n.prng||r.random,a={nextBytes:function(e){for(var t=o.getBytesSync(e.length),n=0;n<e.length;++n)e[n]=t.charCodeAt(n)}},c=n.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return i={algorithm:c,state:0,bits:e,rng:a,eInt:t||65537,e:new s(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},i.e.fromInt(i.eInt),i},c.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var n=new s(null);n.fromInt(30);var r,i=0,o=function(e,t){return e|t},a=+new Date,u=0;while(null===e.keys&&(t<=0||u<t)){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,d=h-1;0===e.pqState?(e.num=new s(h,e.rng),e.num.testBit(d)||e.num.bitwiseTo(s.ONE.shiftLeft(d),o,e.num),e.num.dAddOffset(31-e.num.mod(n).byteValue(),0),i=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(_(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(l[i++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(s.ONE).gcd(e.e).compareTo(s.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(s.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:c.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:c.rsa.setPublicKey(e.n,e.e)}}r=+new Date,u+=r-a,a=r}return null!==e.keys},c.rsa.generateKeyPair=function(e,t,n,s){if(1===arguments.length?"object"===typeof e?(n=e,e=void 0):"function"===typeof e&&(s=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(s=t,t=void 0):"number"!==typeof t&&(n=t,t=void 0):(n=e,s=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof n&&(s=n,n=void 0):(s=n,n=t,t=void 0)),n=n||{},void 0===e&&(e=n.bits||2048),void 0===t&&(t=n.e||65537),!r.options.usePureJavaScript&&!n.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(s){if(E("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,n){if(e)return s(e);s(null,{privateKey:c.privateKeyFromPem(n),publicKey:c.publicKeyFromPem(t)})}));if(S("generateKey")&&S("exportKey"))return a.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:I(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return a.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){s(e)})).then((function(e){if(e){var t=c.privateKeyFromAsn1(o.fromDer(r.util.createBuffer(e)));s(null,{privateKey:t,publicKey:c.setRsaPublicKey(t.n,t.e)})}}));if(k("generateKey")&&k("exportKey")){var l=a.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:I(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return l.oncomplete=function(e){var t=e.target.result,n=a.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);n.oncomplete=function(e){var t=e.target.result,n=c.privateKeyFromAsn1(o.fromDer(r.util.createBuffer(t)));s(null,{privateKey:n,publicKey:c.setRsaPublicKey(n.n,n.e)})},n.onerror=function(e){s(e)}},void(l.onerror=function(e){s(e)})}}else if(E("generateKeyPairSync")){var u=i.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:c.privateKeyFromPem(u.privateKey),publicKey:c.publicKeyFromPem(u.publicKey)}}var h=c.rsa.createKeyPairGenerationState(e,t,n);if(!s)return c.rsa.stepKeyPairGenerationState(h,0),h.keys;b(h,n,s)},c.setRsaPublicKey=c.rsa.setPublicKey=function(e,t){var n={n:e,e:t,encrypt:function(e,t,s){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,n){return m(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return r.pkcs1.encode_rsa_oaep(t,e,s)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var i=t.encode(e,n,!0);return c.rsa.encrypt(i,n,!0)},verify:function(e,t,s,i){"string"===typeof s?s=s.toUpperCase():void 0===s&&(s="RSASSA-PKCS1-V1_5"),void 0===i&&(i={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in i||(i._parseAllDigestBytes=!0),"RSASSA-PKCS1-V1_5"===s?s={verify:function(e,t){t=w(t,n,!0);var s=o.fromDer(t,{parseAllBytes:i._parseAllDigestBytes}),a={},c=[];if(!o.validate(s,p,a,c)){var l=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw l.errors=c,l}var u=o.derToOid(a.algorithmIdentifier);if(u!==r.oids.md2&&u!==r.oids.md5&&u!==r.oids.sha1&&u!==r.oids.sha224&&u!==r.oids.sha256&&u!==r.oids.sha384&&u!==r.oids.sha512&&u!==r.oids["sha512-224"]&&u!==r.oids["sha512-256"]){l=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw l.oid=u,l}if((u===r.oids.md2||u===r.oids.md5)&&!("parameters"in a))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return e===a.digest}}:"NONE"!==s&&"NULL"!==s&&null!==s||(s={verify:function(e,t){return t=w(t,n,!0),e===t}});var a=c.rsa.decrypt(t,n,!0,!1);return s.verify(e,a,n.n.bitLength())}};return n},c.setRsaPrivateKey=c.rsa.setPrivateKey=function(e,t,n,s,i,o,a,l){var u={n:e,e:t,d:n,p:s,q:i,dP:o,dQ:a,qInv:l,decrypt:function(e,t,n){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var s=c.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:w};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return r.pkcs1.decode_rsa_oaep(t,e,n)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(s,u,!1)},sign:function(e,t){var n=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:g},n=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},n=1);var r=t.encode(e,u.n.bitLength());return c.rsa.encrypt(r,u,n)}};return u},c.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},c.privateKeyFromAsn1=function(e){var t,n,i,a,l,d,f,p,g={},y=[];if(o.validate(e,u,g,y)&&(e=o.fromDer(r.util.createBuffer(g.privateKey))),g={},y=[],!o.validate(e,h,g,y)){var m=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw m.errors=y,m}return t=r.util.createBuffer(g.privateKeyModulus).toHex(),n=r.util.createBuffer(g.privateKeyPublicExponent).toHex(),i=r.util.createBuffer(g.privateKeyPrivateExponent).toHex(),a=r.util.createBuffer(g.privateKeyPrime1).toHex(),l=r.util.createBuffer(g.privateKeyPrime2).toHex(),d=r.util.createBuffer(g.privateKeyExponent1).toHex(),f=r.util.createBuffer(g.privateKeyExponent2).toHex(),p=r.util.createBuffer(g.privateKeyCoefficient).toHex(),c.setRsaPrivateKey(new s(t,16),new s(n,16),new s(i,16),new s(a,16),new s(l,16),new s(d,16),new s(f,16),new s(p,16))},c.privateKeyToAsn1=c.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.qInv))])},c.publicKeyFromAsn1=function(e){var t={},n=[];if(o.validate(e,f,t,n)){var i=o.derToOid(t.publicKeyOid);if(i!==c.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=i,a}e=t.rsaPublicKey}if(n=[],!o.validate(e,d,t,n)){a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=n,a}var l=r.util.createBuffer(t.publicKeyModulus).toHex(),u=r.util.createBuffer(t.publicKeyExponent).toHex();return c.setRsaPublicKey(new s(l,16),new s(u,16))},c.publicKeyToAsn1=c.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(c.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[c.publicKeyToRSAPublicKey(e)])])},c.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,v(e.e))])}},989:function(e,t,n){n(7658);var r=n(5736);n(4038),n(4292);var s=e.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=s,s.create=function(){o||a();var e=null,t=r.util.createBuffer(),n=new Array(80),s={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var n=s.messageLengthSize/4,i=0;i<n;++i)s.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},s}};return s.start(),s.update=function(i,o){"utf8"===o&&(i=r.util.encodeUtf8(i));var a=i.length;s.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var l=s.fullMessageLength.length-1;l>=0;--l)s.fullMessageLength[l]+=a[1],a[1]=a[0]+(s.fullMessageLength[l]/4294967296>>>0),s.fullMessageLength[l]=s.fullMessageLength[l]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),c(e,n,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var o=r.util.createBuffer();o.putBytes(t.bytes());var a,l,u=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize,h=u&s.blockLength-1;o.putBytes(i.substr(0,s.blockLength-h));for(var d=8*s.fullMessageLength[0],f=0;f<s.fullMessageLength.length-1;++f)a=8*s.fullMessageLength[f+1],l=a/4294967296>>>0,d+=l,o.putInt32(d>>>0),d=a>>>0;o.putInt32(d);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};c(p,n,o);var g=r.util.createBuffer();return g.putInt32(p.h0),g.putInt32(p.h1),g.putInt32(p.h2),g.putInt32(p.h3),g.putInt32(p.h4),g},s};var i=null,o=!1;function a(){i=String.fromCharCode(128),i+=r.util.fillString(String.fromCharCode(0),64),o=!0}function c(e,t,n){var r,s,i,o,a,c,l,u,h=n.length();while(h>=64){for(s=e.h0,i=e.h1,o=e.h2,a=e.h3,c=e.h4,u=0;u<16;++u)r=n.getInt32(),t[u]=r,l=a^i&(o^a),r=(s<<5|s>>>27)+l+c+1518500249+r,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=r;for(;u<20;++u)r=t[u-3]^t[u-8]^t[u-14]^t[u-16],r=r<<1|r>>>31,t[u]=r,l=a^i&(o^a),r=(s<<5|s>>>27)+l+c+1518500249+r,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=r;for(;u<32;++u)r=t[u-3]^t[u-8]^t[u-14]^t[u-16],r=r<<1|r>>>31,t[u]=r,l=i^o^a,r=(s<<5|s>>>27)+l+c+1859775393+r,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=r;for(;u<40;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,l=i^o^a,r=(s<<5|s>>>27)+l+c+1859775393+r,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=r;for(;u<60;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,l=i&o|a&(i^o),r=(s<<5|s>>>27)+l+c+2400959708+r,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=r;for(;u<80;++u)r=t[u-6]^t[u-16]^t[u-28]^t[u-32],r=r<<2|r>>>30,t[u]=r,l=i^o^a,r=(s<<5|s>>>27)+l+c+3395469782+r,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=r;e.h0=e.h0+s|0,e.h1=e.h1+i|0,e.h2=e.h2+o|0,e.h3=e.h3+a|0,e.h4=e.h4+c|0,h-=64}}},5898:function(e,t,n){n(7658);var r=n(5736);n(4038),n(4292);var s=e.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=s,s.create=function(){o||c();var e=null,t=r.util.createBuffer(),n=new Array(64),s={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){s.messageLength=0,s.fullMessageLength=s.messageLength64=[];for(var n=s.messageLengthSize/4,i=0;i<n;++i)s.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},s}};return s.start(),s.update=function(i,o){"utf8"===o&&(i=r.util.encodeUtf8(i));var a=i.length;s.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=s.fullMessageLength.length-1;c>=0;--c)s.fullMessageLength[c]+=a[1],a[1]=a[0]+(s.fullMessageLength[c]/4294967296>>>0),s.fullMessageLength[c]=s.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),l(e,n,t),(t.read>2048||0===t.length())&&t.compact(),s},s.digest=function(){var o=r.util.createBuffer();o.putBytes(t.bytes());var a,c,u=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize,h=u&s.blockLength-1;o.putBytes(i.substr(0,s.blockLength-h));for(var d=8*s.fullMessageLength[0],f=0;f<s.fullMessageLength.length-1;++f)a=8*s.fullMessageLength[f+1],c=a/4294967296>>>0,d+=c,o.putInt32(d>>>0),d=a>>>0;o.putInt32(d);var p={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};l(p,n,o);var g=r.util.createBuffer();return g.putInt32(p.h0),g.putInt32(p.h1),g.putInt32(p.h2),g.putInt32(p.h3),g.putInt32(p.h4),g.putInt32(p.h5),g.putInt32(p.h6),g.putInt32(p.h7),g},s};var i=null,o=!1,a=null;function c(){i=String.fromCharCode(128),i+=r.util.fillString(String.fromCharCode(0),64),a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0}function l(e,t,n){var r,s,i,o,c,l,u,h,d,f,p,g,y,m,w,b=n.length();while(b>=64){for(u=0;u<16;++u)t[u]=n.getInt32();for(;u<64;++u)r=t[u-2],r=(r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,s=t[u-15],s=(s>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,t[u]=r+t[u-7]+s+t[u-16]|0;for(h=e.h0,d=e.h1,f=e.h2,p=e.h3,g=e.h4,y=e.h5,m=e.h6,w=e.h7,u=0;u<64;++u)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),c=m^g&(y^m),i=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),l=h&d|f&(h^d),r=w+o+c+a[u]+t[u],s=i+l,w=m,m=y,y=g,g=p+r>>>0,p=f,f=d,d=h,h=r+s>>>0;e.h0=e.h0+h|0,e.h1=e.h1+d|0,e.h2=e.h2+f|0,e.h3=e.h3+p|0,e.h4=e.h4+g|0,e.h5=e.h5+y|0,e.h6=e.h6+m|0,e.h7=e.h7+w|0,b-=64}}},2328:function(e,t,n){n(7658);var r=n(5736);n(4038),n(4292);var s=e.exports=r.sha512=r.sha512||{};r.md.sha512=r.md.algorithms.sha512=s;var i=r.sha384=r.sha512.sha384=r.sha512.sha384||{};i.create=function(){return s.create("SHA-384")},r.md.sha384=r.md.algorithms.sha384=i,r.sha512.sha256=r.sha512.sha256||{create:function(){return s.create("SHA-512/256")}},r.md["sha512/256"]=r.md.algorithms["sha512/256"]=r.sha512.sha256,r.sha512.sha224=r.sha512.sha224||{create:function(){return s.create("SHA-512/224")}},r.md["sha512/224"]=r.md.algorithms["sha512/224"]=r.sha512.sha224,s.create=function(e){if(a||u(),"undefined"===typeof e&&(e="SHA-512"),!(e in l))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=l[e],n=null,s=r.util.createBuffer(),i=new Array(80),c=0;c<80;++c)i[c]=new Array(2);var d=64;switch(e){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28;break}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,i=0;i<e;++i)f.fullMessageLength.push(0);s=r.util.createBuffer(),n=new Array(t.length);for(i=0;i<t.length;++i)n[i]=t[i].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=r.util.encodeUtf8(e));var o=e.length;f.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=f.fullMessageLength.length-1;a>=0;--a)f.fullMessageLength[a]+=o[1],o[1]=o[0]+(f.fullMessageLength[a]/4294967296>>>0),f.fullMessageLength[a]=f.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return s.putBytes(e),h(n,i,s),(s.read>2048||0===s.length())&&s.compact(),f},f.digest=function(){var t=r.util.createBuffer();t.putBytes(s.bytes());var a,c,l=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,u=l&f.blockLength-1;t.putBytes(o.substr(0,f.blockLength-u));for(var d=8*f.fullMessageLength[0],p=0;p<f.fullMessageLength.length-1;++p)a=8*f.fullMessageLength[p+1],c=a/4294967296>>>0,d+=c,t.putInt32(d>>>0),d=a>>>0;t.putInt32(d);var g=new Array(n.length);for(p=0;p<n.length;++p)g[p]=n[p].slice(0);h(g,i,t);var y,m=r.util.createBuffer();y="SHA-512"===e?g.length:"SHA-384"===e?g.length-2:g.length-4;for(p=0;p<y;++p)m.putInt32(g[p][0]),p===y-1&&"SHA-512/224"===e||m.putInt32(g[p][1]);return m},f};var o=null,a=!1,c=null,l=null;function u(){o=String.fromCharCode(128),o+=r.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],l={},l["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],a=!0}function h(e,t,n){var r,s,i,o,a,l,u,h,d,f,p,g,y,m,w,b,v,_,E,S,k,I,A,T,R,C,P,N,O,D,L,x,B,M,U,F=n.length();while(F>=128){for(O=0;O<16;++O)t[O][0]=n.getInt32()>>>0,t[O][1]=n.getInt32()>>>0;for(;O<80;++O)x=t[O-2],D=x[0],L=x[1],r=((D>>>19|L<<13)^(L>>>29|D<<3)^D>>>6)>>>0,s=((D<<13|L>>>19)^(L<<3|D>>>29)^(D<<26|L>>>6))>>>0,M=t[O-15],D=M[0],L=M[1],i=((D>>>1|L<<31)^(D>>>8|L<<24)^D>>>7)>>>0,o=((D<<31|L>>>1)^(D<<24|L>>>8)^(D<<25|L>>>7))>>>0,B=t[O-7],U=t[O-16],L=s+B[1]+o+U[1],t[O][0]=r+B[0]+i+U[0]+(L/4294967296>>>0)>>>0,t[O][1]=L>>>0;for(y=e[0][0],m=e[0][1],w=e[1][0],b=e[1][1],v=e[2][0],_=e[2][1],E=e[3][0],S=e[3][1],k=e[4][0],I=e[4][1],A=e[5][0],T=e[5][1],R=e[6][0],C=e[6][1],P=e[7][0],N=e[7][1],O=0;O<80;++O)u=((k>>>14|I<<18)^(k>>>18|I<<14)^(I>>>9|k<<23))>>>0,h=((k<<18|I>>>14)^(k<<14|I>>>18)^(I<<23|k>>>9))>>>0,d=(R^k&(A^R))>>>0,f=(C^I&(T^C))>>>0,a=((y>>>28|m<<4)^(m>>>2|y<<30)^(m>>>7|y<<25))>>>0,l=((y<<4|m>>>28)^(m<<30|y>>>2)^(m<<25|y>>>7))>>>0,p=(y&w|v&(y^w))>>>0,g=(m&b|_&(m^b))>>>0,L=N+h+f+c[O][1]+t[O][1],r=P+u+d+c[O][0]+t[O][0]+(L/4294967296>>>0)>>>0,s=L>>>0,L=l+g,i=a+p+(L/4294967296>>>0)>>>0,o=L>>>0,P=R,N=C,R=A,C=T,A=k,T=I,L=S+s,k=E+r+(L/4294967296>>>0)>>>0,I=L>>>0,E=v,S=_,v=w,_=b,w=y,b=m,L=s+o,y=r+i+(L/4294967296>>>0)>>>0,m=L>>>0;L=e[0][1]+m,e[0][0]=e[0][0]+y+(L/4294967296>>>0)>>>0,e[0][1]=L>>>0,L=e[1][1]+b,e[1][0]=e[1][0]+w+(L/4294967296>>>0)>>>0,e[1][1]=L>>>0,L=e[2][1]+_,e[2][0]=e[2][0]+v+(L/4294967296>>>0)>>>0,e[2][1]=L>>>0,L=e[3][1]+S,e[3][0]=e[3][0]+E+(L/4294967296>>>0)>>>0,e[3][1]=L>>>0,L=e[4][1]+I,e[4][0]=e[4][0]+k+(L/4294967296>>>0)>>>0,e[4][1]=L>>>0,L=e[5][1]+T,e[5][0]=e[5][0]+A+(L/4294967296>>>0)>>>0,e[5][1]=L>>>0,L=e[6][1]+C,e[6][0]=e[6][0]+R+(L/4294967296>>>0)>>>0,e[6][1]=L>>>0,L=e[7][1]+N,e[7][0]=e[7][0]+P+(L/4294967296>>>0)>>>0,e[7][1]=L>>>0,F-=128}}},4292:function(e,t,n){n(4633),n(7658),n(541);var r=n(5736),s=n(3220),i=e.exports=r.util=r.util||{};function o(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function a(e){if(this.data="",this.read=0,"string"===typeof e)this.data=e;else if(i.isArrayBuffer(e)||i.isArrayBufferView(e))if("undefined"!==typeof Buffer&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(r){for(var n=0;n<t.length;++n)this.putByte(t[n])}}else(e instanceof a||"object"===typeof e&&"string"===typeof e.data&&"number"===typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}(function(){if("undefined"!==typeof process&&process.nextTick&&!process.browser)return i.nextTick=process.nextTick,void("function"===typeof setImmediate?i.setImmediate=setImmediate:i.setImmediate=i.nextTick);if("function"===typeof setImmediate)return i.setImmediate=function(){return setImmediate.apply(void 0,arguments)},void(i.nextTick=function(e){return setImmediate(e)});if(i.setImmediate=function(e){setTimeout(e,0)},"undefined"!==typeof window&&"function"===typeof window.postMessage){var e="forge.setImmediate",t=[];function n(n){if(n.source===window&&n.data===e){n.stopPropagation();var r=t.slice();t.length=0,r.forEach((function(e){e()}))}}i.setImmediate=function(n){t.push(n),1===t.length&&window.postMessage(e,"*")},window.addEventListener("message",n,!0)}if("undefined"!==typeof MutationObserver){var r=Date.now(),s=!0,o=document.createElement("div");t=[];new MutationObserver((function(){var e=t.slice();t.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var a=i.setImmediate;i.setImmediate=function(e){Date.now()-r>15?(r=Date.now(),a(e)):(t.push(e),1===t.length&&o.setAttribute("a",s=!s))}}i.nextTick=i.setImmediate})(),i.isNodejs="undefined"!==typeof process&&process.versions&&process.versions.node,i.globalScope=function(){return i.isNodejs?n.g:"undefined"===typeof self?window:self}(),i.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},i.isArrayBuffer=function(e){return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer},i.isArrayBufferView=function(e){return e&&i.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},i.ByteBuffer=a,i.ByteStringBuffer=a;var c=4096;function l(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var n=i.isArrayBuffer(e),r=i.isArrayBufferView(e);if(n||r)return this.data=n?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}i.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>c&&(this.data.substr(0,1),this._constructedStringLength=0)},i.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},i.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},i.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},i.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);var n=this.data;while(t>0)1&t&&(n+=e),t>>>=1,t>0&&(e+=e);return this.data=n,this._optimizeConstructedString(t),this},i.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},i.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(i.encodeUtf8(e))},i.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},i.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},i.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},i.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},i.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},i.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},i.ByteStringBuffer.prototype.putInt=function(e,t){o(t);var n="";do{t-=8,n+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(n)},i.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},i.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},i.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},i.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},i.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},i.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},i.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},i.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},i.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},i.ByteStringBuffer.prototype.getInt=function(e){o(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},i.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},i.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},i.ByteStringBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},i.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},i.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},i.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},i.ByteStringBuffer.prototype.copy=function(){var e=i.createBuffer(this.data);return e.read=this.read,e},i.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},i.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},i.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},i.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e},i.ByteStringBuffer.prototype.toString=function(){return i.decodeUtf8(this.bytes())},i.DataBuffer=l,i.DataBuffer.prototype.length=function(){return this.write-this.read},i.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},i.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(n),this.data=new DataView(r.buffer),this},i.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},i.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var n=0;n<t;++n)this.data.setUint8(e);return this},i.DataBuffer.prototype.putBytes=function(e,t){if(i.isArrayBufferView(e)){var n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),r=n.byteLength-n.byteOffset;this.accommodate(r);var s=new Uint8Array(this.data.buffer,this.write);return s.set(n),this.write+=r,this}if(i.isArrayBuffer(e)){n=new Uint8Array(e);this.accommodate(n.byteLength);s=new Uint8Array(this.data.buffer);return s.set(n,this.write),this.write+=n.byteLength,this}if(e instanceof i.DataBuffer||"object"===typeof e&&"number"===typeof e.read&&"number"===typeof e.write&&i.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(n.byteLength);s=new Uint8Array(e.data.byteLength,this.write);return s.set(n),this.write+=n.byteLength,this}if(e instanceof i.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"===typeof e){var o;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.hex.decode(e,o,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),o=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.base64.decode(e,o,this.write),this;if("utf8"===t&&(e=i.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=i.binary.raw.decode(o),this;if("utf16"===t)return this.accommodate(2*e.length),o=new Uint16Array(this.data.buffer,this.write),this.write+=i.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},i.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},i.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},i.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},i.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},i.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},i.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},i.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},i.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},i.DataBuffer.prototype.putInt=function(e,t){o(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},i.DataBuffer.prototype.putSignedInt=function(e,t){return o(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},i.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},i.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},i.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},i.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},i.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},i.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},i.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},i.DataBuffer.prototype.getInt=function(e){o(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},i.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},i.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},i.DataBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},i.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},i.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},i.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},i.DataBuffer.prototype.copy=function(){return new i.DataBuffer(this)},i.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},i.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},i.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},i.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var n=this.data.getUint8(t);n<16&&(e+="0"),e+=n.toString(16)}return e},i.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8","binary"===e||"raw"===e)return i.binary.raw.encode(t);if("hex"===e)return i.binary.hex.encode(t);if("base64"===e)return i.binary.base64.encode(t);if("utf8"===e)return i.text.utf8.decode(t);if("utf16"===e)return i.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},i.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=i.encodeUtf8(e)),new i.ByteBuffer(e)},i.fillString=function(e,t){var n="";while(t>0)1&t&&(n+=e),t>>>=1,t>0&&(e+=e);return n},i.xorBytes=function(e,t,n){for(var r="",s="",i="",o=0,a=0;n>0;--n,++o)s=e.charCodeAt(o)^t.charCodeAt(o),a>=10&&(r+=i,i="",a=0),i+=String.fromCharCode(s),++a;return r+=i,r},i.hexToBytes=function(e){var t="",n=0;for(!0&e.length&&(n=1,t+=String.fromCharCode(parseInt(e[0],16)));n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t},i.bytesToHex=function(e){return i.createBuffer(e).toHex()},i.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";i.encode64=function(e,t){var n,r,s,i="",o="",a=0;while(a<e.length)n=e.charCodeAt(a++),r=e.charCodeAt(a++),s=e.charCodeAt(a++),i+=u.charAt(n>>2),i+=u.charAt((3&n)<<4|r>>4),isNaN(r)?i+="==":(i+=u.charAt((15&r)<<2|s>>6),i+=isNaN(s)?"=":u.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i,o},i.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var t,n,r,s,i="",o=0;while(o<e.length)t=h[e.charCodeAt(o++)-43],n=h[e.charCodeAt(o++)-43],r=h[e.charCodeAt(o++)-43],s=h[e.charCodeAt(o++)-43],i+=String.fromCharCode(t<<2|n>>4),64!==r&&(i+=String.fromCharCode((15&n)<<4|r>>2),64!==s&&(i+=String.fromCharCode((3&r)<<6|s)));return i},i.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},i.decodeUtf8=function(e){return decodeURIComponent(escape(e))},i.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:s.encode,decode:s.decode}},i.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},i.binary.raw.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length)),n=n||0;for(var s=n,i=0;i<e.length;++i)r[s++]=e.charCodeAt(i);return t?s-n:r},i.binary.hex.encode=i.bytesToHex,i.binary.hex.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2))),n=n||0;var s=0,i=n;for(1&e.length&&(s=1,r[i++]=parseInt(e[0],16));s<e.length;s+=2)r[i++]=parseInt(e.substr(s,2),16);return t?i-n:r},i.binary.base64.encode=function(e,t){var n,r,s,i="",o="",a=0;while(a<e.byteLength)n=e[a++],r=e[a++],s=e[a++],i+=u.charAt(n>>2),i+=u.charAt((3&n)<<4|r>>4),isNaN(r)?i+="==":(i+=u.charAt((15&r)<<2|s>>6),i+=isNaN(s)?"=":u.charAt(63&s)),t&&i.length>t&&(o+=i.substr(0,t)+"\r\n",i=i.substr(t));return o+=i,o},i.binary.base64.decode=function(e,t,n){var r,s,i,o,a=t;a||(a=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),n=n||0;var c=0,l=n;while(c<e.length)r=h[e.charCodeAt(c++)-43],s=h[e.charCodeAt(c++)-43],i=h[e.charCodeAt(c++)-43],o=h[e.charCodeAt(c++)-43],a[l++]=r<<2|s>>4,64!==i&&(a[l++]=(15&s)<<4|i>>2,64!==o&&(a[l++]=(3&i)<<6|o));return t?l-n:a.subarray(0,l)},i.binary.base58.encode=function(e,t){return i.binary.baseN.encode(e,d,t)},i.binary.base58.decode=function(e,t){return i.binary.baseN.decode(e,d,t)},i.text={utf8:{},utf16:{}},i.text.utf8.encode=function(e,t,n){e=i.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length)),n=n||0;for(var s=n,o=0;o<e.length;++o)r[s++]=e.charCodeAt(o);return t?s-n:r},i.text.utf8.decode=function(e){return i.decodeUtf8(String.fromCharCode.apply(null,e))},i.text.utf16.encode=function(e,t,n){var r=t;r||(r=new Uint8Array(2*e.length));var s=new Uint16Array(r.buffer);n=n||0;for(var i=n,o=n,a=0;a<e.length;++a)s[o++]=e.charCodeAt(a),i+=2;return t?i-n:r},i.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},i.deflate=function(e,t,n){if(t=i.decode64(e.deflate(i.encode64(t)).rval),n){var r=2,s=t.charCodeAt(1);32&s&&(r=6),t=t.substring(r,t.length-4)}return t},i.inflate=function(e,t,n){var r=e.inflate(i.encode64(t)).rval;return null===r?null:i.decode64(r)};var f=function(e,t,n){if(!e)throw new Error("WebStorage not available.");var r;if(null===n?r=e.removeItem(t):(n=i.encode64(JSON.stringify(n)),r=e.setItem(t,n)),"undefined"!==typeof r&&!0!==r.rval){var s=new Error(r.error.message);throw s.id=r.error.id,s.name=r.error.name,s}},p=function(e,t){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(t);if(e.init)if(null===n.rval){if(n.error){var r=new Error(n.error.message);throw r.id=n.error.id,r.name=n.error.name,r}n=null}else n=n.rval;return null!==n&&(n=JSON.parse(i.decode64(n))),n},g=function(e,t,n,r){var s=p(e,t);null===s&&(s={}),s[n]=r,f(e,t,s)},y=function(e,t,n){var r=p(e,t);return null!==r&&(r=n in r?r[n]:null),r},m=function(e,t,n){var r=p(e,t);if(null!==r&&n in r){delete r[n];var s=!0;for(var i in r){s=!1;break}s&&(r=null),f(e,t,r)}},w=function(e,t){f(e,t,null)},b=function(e,t,n){var r,s=null;"undefined"===typeof n&&(n=["web","flash"]);var i=!1,o=null;for(var a in n){r=n[a];try{if("flash"===r||"both"===r){if(null===t[0])throw new Error("Flash local storage not available.");s=e.apply(this,t),i="flash"===r}"web"!==r&&"both"!==r||(t[0]=localStorage,s=e.apply(this,t),i=!0)}catch(c){o=c}if(i)break}if(!i)throw o;return s};i.setItem=function(e,t,n,r,s){b(g,arguments,s)},i.getItem=function(e,t,n,r){return b(y,arguments,r)},i.removeItem=function(e,t,n,r){b(m,arguments,r)},i.clearItems=function(e,t,n){b(w,arguments,n)},i.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},i.format=function(e){var t,n,r=/%./g,s=0,i=[],o=0;while(t=r.exec(e)){n=e.substring(o,r.lastIndex-2),n.length>0&&i.push(n),o=r.lastIndex;var a=t[0][1];switch(a){case"s":case"o":s<arguments.length?i.push(arguments[1+s++]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+a+"?>")}}return i.push(e.substring(o)),i.join("")},i.formatNumber=function(e,t,n,r){var s=e,i=isNaN(t=Math.abs(t))?2:t,o=void 0===n?",":n,a=void 0===r?".":r,c=s<0?"-":"",l=parseInt(s=Math.abs(+s||0).toFixed(i),10)+"",u=l.length>3?l.length%3:0;return c+(u?l.substr(0,u)+a:"")+l.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(i?o+Math.abs(s-l).toFixed(i).slice(2):"")},i.formatSize=function(e){return e=e>=1073741824?i.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?i.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?i.formatNumber(e/1024,0)+" KiB":i.formatNumber(e,0)+" bytes",e},i.bytesFromIP=function(e){return-1!==e.indexOf(".")?i.bytesFromIPv4(e):-1!==e.indexOf(":")?i.bytesFromIPv6(e):null},i.bytesFromIPv4=function(e){if(e=e.split("."),4!==e.length)return null;for(var t=i.createBuffer(),n=0;n<e.length;++n){var r=parseInt(e[n],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()},i.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}));for(var n=2*(8-e.length+t),r=i.createBuffer(),s=0;s<8;++s)if(e[s]&&0!==e[s].length){var o=i.hexToBytes(e[s]);o.length<2&&r.putByte(0),r.putBytes(o)}else r.fillWithByte(0,n),n=0;return r.getBytes()},i.bytesToIP=function(e){return 4===e.length?i.bytesToIPv4(e):16===e.length?i.bytesToIPv6(e):null},i.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t.join(".")},i.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],n=[],r=0,s=0;s<e.length;s+=2){var o=i.bytesToHex(e[s]+e[s+1]);while("0"===o[0]&&"0"!==o)o=o.substr(1);if("0"===o){var a=n[n.length-1],c=t.length;a&&c===a.end+1?(a.end=c,a.end-a.start>n[r].end-n[r].start&&(r=n.length-1)):n.push({start:c,end:c})}t.push(o)}if(n.length>0){var l=n[r];l.end-l.start>0&&(t.splice(l.start,l.end-l.start+1,""),0===l.start&&t.unshift(""),7===l.end&&t.push(""))}return t.join(":")},i.estimateCores=function(e,t){if("function"===typeof e&&(t=e,e={}),e=e||{},"cores"in i&&!e.update)return t(null,i.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return i.cores=navigator.hardwareConcurrency,t(null,i.cores);if("undefined"===typeof Worker)return i.cores=1,t(null,i.cores);if("undefined"===typeof Blob)return i.cores=2,t(null,i.cores);var n=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){var t=Date.now(),n=t+4;while(Date.now()<n);self.postMessage({st:t,et:n})}))}.toString(),")()"],{type:"application/javascript"}));function r(e,a,c){if(0===a){var l=Math.floor(e.reduce((function(e,t){return e+t}),0)/e.length);return i.cores=Math.max(1,l),URL.revokeObjectURL(n),t(null,i.cores)}s(c,(function(t,n){e.push(o(c,n)),r(e,a-1,c)}))}function s(e,t){for(var r=[],s=[],i=0;i<e;++i){var o=new Worker(n);o.addEventListener("message",(function(n){if(s.push(n.data),s.length===e){for(var i=0;i<e;++i)r[i].terminate();t(null,s)}})),r.push(o)}for(i=0;i<e;++i)r[i].postMessage(i)}function o(e,t){for(var n=[],r=0;r<e;++r)for(var s=t[r],i=n[r]=[],o=0;o<e;++o)if(r!==o){var a=t[o];(s.st>a.st&&s.st<a.et||a.st>s.st&&a.st<s.et)&&i.push(o)}return n.reduce((function(e,t){return Math.max(e,t.length)}),0)}r([],5,16)}},8410:function(e,t,n){n(7658);var r=n(5736);n(22),n(1041),n(8577),n(4038),n(235),n(9002),n(7513),n(5451),n(5070),n(4292);var s=r.asn1,i=e.exports=r.pki=r.pki||{},o=i.oids,a={};a["CN"]=o["commonName"],a["commonName"]="CN",a["C"]=o["countryName"],a["countryName"]="C",a["L"]=o["localityName"],a["localityName"]="L",a["ST"]=o["stateOrProvinceName"],a["stateOrProvinceName"]="ST",a["O"]=o["organizationName"],a["organizationName"]="O",a["OU"]=o["organizationalUnitName"],a["organizationalUnitName"]="OU",a["E"]=o["emailAddress"],a["emailAddress"]="E";var c=r.pki.rsa.publicKeyValidator,l={name:"Certificate",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:s.Class.UNIVERSAL,type:s.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:s.Class.UNIVERSAL,type:s.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:s.Class.UNIVERSAL,type:s.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:s.Class.UNIVERSAL,type:s.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},c,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:s.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:s.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},u={name:"rsapss",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:s.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:s.Class.UNIVERSAL,type:s.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:s.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:s.Class.UNIVERSAL,type:s.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:s.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:s.Class.UNIVERSAL,type:s.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:s.Class.UNIVERSAL,type:s.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},c,{name:"CertificationRequestInfo.attributes",tagClass:s.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:s.Class.UNIVERSAL,type:s.Type.SET,constructed:!0}]}]}]},d={name:"CertificationRequest",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:s.Class.UNIVERSAL,type:s.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:s.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:s.Class.UNIVERSAL,type:s.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function f(e,t){"string"===typeof t&&(t={shortName:t});for(var n,r=null,s=0;null===r&&s<e.attributes.length;++s)n=e.attributes[s],(t.type&&t.type===n.type||t.name&&t.name===n.name||t.shortName&&t.shortName===n.shortName)&&(r=n);return r}i.RDNAttributesAsArray=function(e,t){for(var n,r,i,c=[],l=0;l<e.value.length;++l){n=e.value[l];for(var u=0;u<n.value.length;++u)i={},r=n.value[u],i.type=s.derToOid(r.value[0].value),i.value=r.value[1].value,i.valueTagClass=r.value[1].type,i.type in o&&(i.name=o[i.type],i.name in a&&(i.shortName=a[i.name])),t&&(t.update(i.type),t.update(i.value)),c.push(i)}return c},i.CRIAttributesAsArray=function(e){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],c=s.derToOid(r.value[0].value),l=r.value[1].value,u=0;u<l.length;++u){var h={};if(h.type=c,h.value=l[u].value,h.valueTagClass=l[u].type,h.type in o&&(h.name=o[h.type],h.name in a&&(h.shortName=a[h.name])),h.type===o.extensionRequest){h.extensions=[];for(var d=0;d<h.value.length;++d)h.extensions.push(i.certificateExtensionFromAsn1(h.value[d]))}t.push(h)}return t};var p=function(e,t,n){var r={};if(e!==o["RSASSA-PSS"])return r;n&&(r={hash:{algorithmOid:o["sha1"]},mgf:{algorithmOid:o["mgf1"],hash:{algorithmOid:o["sha1"]}},saltLength:20});var i={},a=[];if(!s.validate(t,u,i,a)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=a,c}return void 0!==i.hashOid&&(r.hash=r.hash||{},r.hash.algorithmOid=s.derToOid(i.hashOid)),void 0!==i.maskGenOid&&(r.mgf=r.mgf||{},r.mgf.algorithmOid=s.derToOid(i.maskGenOid),r.mgf.hash=r.mgf.hash||{},r.mgf.hash.algorithmOid=s.derToOid(i.maskGenHashOid)),void 0!==i.saltLength&&(r.saltLength=i.saltLength.charCodeAt(0)),r},g=function(e){switch(o[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return r.md.sha1.create();case"md5WithRSAEncryption":return r.md.md5.create();case"sha256WithRSAEncryption":return r.md.sha256.create();case"sha384WithRSAEncryption":return r.md.sha384.create();case"sha512WithRSAEncryption":return r.md.sha512.create();case"RSASSA-PSS":return r.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},y=function(e){var t,n=e.certificate;switch(n.signatureOid){case o.sha1WithRSAEncryption:case o.sha1WithRSASignature:break;case o["RSASSA-PSS"]:var s,i;if(s=o[n.signatureParameters.mgf.hash.algorithmOid],void 0===s||void 0===r.md[s]){var a=new Error("Unsupported MGF hash function.");throw a.oid=n.signatureParameters.mgf.hash.algorithmOid,a.name=s,a}if(i=o[n.signatureParameters.mgf.algorithmOid],void 0===i||void 0===r.mgf[i]){a=new Error("Unsupported MGF function.");throw a.oid=n.signatureParameters.mgf.algorithmOid,a.name=i,a}if(i=r.mgf[i].create(r.md[s].create()),s=o[n.signatureParameters.hash.algorithmOid],void 0===s||void 0===r.md[s]){a=new Error("Unsupported RSASSA-PSS hash function.");throw a.oid=n.signatureParameters.hash.algorithmOid,a.name=s,a}t=r.pss.create(r.md[s].create(),i,n.signatureParameters.saltLength);break}return n.publicKey.verify(e.md.digest().getBytes(),e.signature,t)};function m(e){for(var t,n,i=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),o=e.attributes,a=0;a<o.length;++a){t=o[a];var c=t.value,l=s.Type.PRINTABLESTRING;"valueTagClass"in t&&(l=t.valueTagClass,l===s.Type.UTF8&&(c=r.util.encodeUtf8(c))),n=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.type).getBytes()),s.create(s.Class.UNIVERSAL,l,!1,c)])]),i.value.push(n)}return i}function w(e){for(var t,n=0;n<e.length;++n){if(t=e[n],"undefined"===typeof t.name&&(t.type&&t.type in i.oids?t.name=i.oids[t.type]:t.shortName&&t.shortName in a&&(t.name=i.oids[a[t.shortName]])),"undefined"===typeof t.type){if(!t.name||!(t.name in i.oids)){var r=new Error("Attribute type not specified.");throw r.attribute=t,r}t.type=i.oids[t.name]}if("undefined"===typeof t.shortName&&t.name&&t.name in a&&(t.shortName=a[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=s.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var c=0;c<t.extensions.length;++c)t.value.push(i.certificateExtensionToAsn1(b(t.extensions[c])))}if("undefined"===typeof t.value){r=new Error("Attribute value not specified.");throw r.attribute=t,r}}}function b(e,t){if(t=t||{},"undefined"===typeof e.name&&e.id&&e.id in i.oids&&(e.name=i.oids[e.id]),"undefined"===typeof e.id){if(!e.name||!(e.name in i.oids)){var n=new Error("Extension ID not specified.");throw n.extension=e,n}e.id=i.oids[e.name]}if("undefined"!==typeof e.value)return e;if("keyUsage"===e.name){var a=0,c=0,l=0;e.digitalSignature&&(c|=128,a=7),e.nonRepudiation&&(c|=64,a=6),e.keyEncipherment&&(c|=32,a=5),e.dataEncipherment&&(c|=16,a=4),e.keyAgreement&&(c|=8,a=3),e.keyCertSign&&(c|=4,a=2),e.cRLSign&&(c|=2,a=1),e.encipherOnly&&(c|=1,a=0),e.decipherOnly&&(l|=128,a=7);var u=String.fromCharCode(a);0!==l?u+=String.fromCharCode(c)+String.fromCharCode(l):0!==c&&(u+=String.fromCharCode(c)),e.value=s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,u)}else if("basicConstraints"===e.name)e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(s.create(s.Class.UNIVERSAL,s.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);var h=e.value.value;for(var d in e)!0===e[d]&&(d in o?h.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o[d]).getBytes())):-1!==d.indexOf(".")&&h.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(d).getBytes())))}else if("nsCertType"===e.name){a=0,c=0;e.client&&(c|=128,a=7),e.server&&(c|=64,a=6),e.email&&(c|=32,a=5),e.objsign&&(c|=16,a=4),e.reserved&&(c|=8,a=3),e.sslCA&&(c|=4,a=2),e.emailCA&&(c|=2,a=1),e.objCA&&(c|=1,a=0);u=String.fromCharCode(a);0!==c&&(u+=String.fromCharCode(c)),e.value=s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,u)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);for(var f=0;f<e.altNames.length;++f){b=e.altNames[f];u=b.value;if(7===b.type&&b.ip){if(u=r.util.bytesFromIP(b.ip),null===u){n=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw n.extension=e,n}}else 8===b.type&&(u=b.oid?s.oidToDer(s.oidToDer(b.oid)):s.oidToDer(u));e.value.value.push(s.create(s.Class.CONTEXT_SPECIFIC,b.type,!1,u))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=s.create(s.Class.UNIVERSAL,s.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var p=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=p.toHex(),e.value=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,p.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);h=e.value.value;if(e.keyIdentifier){var g=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;h.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!1,g))}if(e.authorityCertIssuer){var y=[s.create(s.Class.CONTEXT_SPECIFIC,4,!0,[m(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];h.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,y))}if(e.serialNumber){var w=r.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);h.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!1,w))}}else if("cRLDistributionPoints"===e.name){e.value=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);h=e.value.value;var b,v=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]),_=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(f=0;f<e.altNames.length;++f){b=e.altNames[f];u=b.value;if(7===b.type&&b.ip){if(u=r.util.bytesFromIP(b.ip),null===u){n=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw n.extension=e,n}}else 8===b.type&&(u=b.oid?s.oidToDer(s.oidToDer(b.oid)):s.oidToDer(u));_.value.push(s.create(s.Class.CONTEXT_SPECIFIC,b.type,!1,u))}v.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[_])),h.push(v)}if("undefined"===typeof e.value){n=new Error("Extension value not specified.");throw n.extension=e,n}return e}function v(e,t){switch(e){case o["RSASSA-PSS"]:var n=[];return void 0!==t.hash.algorithmOid&&n.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.hash.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&n.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.mgf.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.mgf.hash.algorithmOid).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&n.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.saltLength).getBytes())])),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,n);default:return s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")}}function _(e){var t=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var n=e.attributes,i=0;i<n.length;++i){var o=n[i],a=o.value,c=s.Type.UTF8;"valueTagClass"in o&&(c=o.valueTagClass),c===s.Type.UTF8&&(a=r.util.encodeUtf8(a));var l=!1;"valueConstructed"in o&&(l=o.valueConstructed);var u=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(o.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[s.create(s.Class.UNIVERSAL,c,l,a)])]);t.value.push(u)}return t}i.certificateFromPem=function(e,t,n){var o=r.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var c=s.fromDer(o.body,n);return i.certificateFromAsn1(c,t)},i.certificateToPem=function(e,t){var n={type:"CERTIFICATE",body:s.toDer(i.certificateToAsn1(e)).getBytes()};return r.pem.encode(n,{maxline:t})},i.publicKeyFromPem=function(e){var t=r.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var n=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw n.headerType=t.type,n}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=s.fromDer(t.body);return i.publicKeyFromAsn1(o)},i.publicKeyToPem=function(e,t){var n={type:"PUBLIC KEY",body:s.toDer(i.publicKeyToAsn1(e)).getBytes()};return r.pem.encode(n,{maxline:t})},i.publicKeyToRSAPublicKeyPem=function(e,t){var n={type:"RSA PUBLIC KEY",body:s.toDer(i.publicKeyToRSAPublicKey(e)).getBytes()};return r.pem.encode(n,{maxline:t})},i.getPublicKeyFingerprint=function(e,t){t=t||{};var n,o=t.md||r.md.sha1.create(),a=t.type||"RSAPublicKey";switch(a){case"RSAPublicKey":n=s.toDer(i.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":n=s.toDer(i.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(n);var c=o.digest();if("hex"===t.encoding){var l=c.toHex();return t.delimiter?l.match(/.{2}/g).join(t.delimiter):l}if("binary"===t.encoding)return c.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return c},i.certificationRequestFromPem=function(e,t,n){var o=r.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=o.type,a}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var c=s.fromDer(o.body,n);return i.certificationRequestFromAsn1(c,t)},i.certificationRequestToPem=function(e,t){var n={type:"CERTIFICATE REQUEST",body:s.toDer(i.certificationRequestToAsn1(e)).getBytes()};return r.pem.encode(n,{maxline:t})},i.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return f(e.issuer,t)},e.issuer.addField=function(t){w([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,n){w(t),e.subject.attributes=t,delete e.subject.uniqueId,n&&(e.subject.uniqueId=n),e.subject.hash=null},e.setIssuer=function(t,n){w(t),e.issuer.attributes=t,delete e.issuer.uniqueId,n&&(e.issuer.uniqueId=n),e.issuer.hash=null},e.setExtensions=function(t){for(var n=0;n<t.length;++n)b(t[n],{cert:e});e.extensions=t},e.getExtension=function(t){"string"===typeof t&&(t={name:t});for(var n,r=null,s=0;null===r&&s<e.extensions.length;++s)n=e.extensions[s],(t.id&&n.id===t.id||t.name&&n.name===t.name)&&(r=n);return r},e.sign=function(t,n){e.md=n||r.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.tbsCertificate=i.getTBSCertificate(e);var l=s.toDer(e.tbsCertificate);e.md.update(l.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var n=!1;if(!e.issued(t)){var r=t.issuer,o=e.subject,a=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw a.expectedIssuer=o.attributes,a.actualIssuer=r.attributes,a}var c=t.md;if(null===c){c=g({signatureOid:t.signatureOid,type:"certificate"});var l=t.tbsCertificate||i.getTBSCertificate(t),u=s.toDer(l);c.update(u.getBytes())}return null!==c&&(n=y({certificate:e,md:c,signature:t.signature})),n},e.isIssuer=function(t){var n=!1,r=e.issuer,s=t.subject;if(r.hash&&s.hash)n=r.hash===s.hash;else if(r.attributes.length===s.attributes.length){var i,o;n=!0;for(var a=0;n&&a<r.attributes.length;++a)i=r.attributes[a],o=s.attributes[a],i.type===o.type&&i.value===o.value||(n=!1)}return n},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return i.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o["subjectKeyIdentifier"],n=0;n<e.extensions.length;++n){var s=e.extensions[n];if(s.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return r.util.hexToBytes(s.subjectKeyIdentifier)===i}}return!1},e},i.certificateFromAsn1=function(e,t){var n={},o=[];if(!s.validate(e,l,n,o)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=o,a}var c=s.derToOid(n.publicKeyOid);if(c!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var u=i.createCertificate();u.version=n.certVersion?n.certVersion.charCodeAt(0):0;var h=r.util.createBuffer(n.certSerialNumber);u.serialNumber=h.toHex(),u.signatureOid=r.asn1.derToOid(n.certSignatureOid),u.signatureParameters=p(u.signatureOid,n.certSignatureParams,!0),u.siginfo.algorithmOid=r.asn1.derToOid(n.certinfoSignatureOid),u.siginfo.parameters=p(u.siginfo.algorithmOid,n.certinfoSignatureParams,!1),u.signature=n.certSignature;var d=[];if(void 0!==n.certValidity1UTCTime&&d.push(s.utcTimeToDate(n.certValidity1UTCTime)),void 0!==n.certValidity2GeneralizedTime&&d.push(s.generalizedTimeToDate(n.certValidity2GeneralizedTime)),void 0!==n.certValidity3UTCTime&&d.push(s.utcTimeToDate(n.certValidity3UTCTime)),void 0!==n.certValidity4GeneralizedTime&&d.push(s.generalizedTimeToDate(n.certValidity4GeneralizedTime)),d.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(d.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(u.validity.notBefore=d[0],u.validity.notAfter=d[1],u.tbsCertificate=n.tbsCertificate,t){u.md=g({signatureOid:u.signatureOid,type:"certificate"});var y=s.toDer(u.tbsCertificate);u.md.update(y.getBytes())}var m=r.md.sha1.create(),b=s.toDer(n.certIssuer);m.update(b.getBytes()),u.issuer.getField=function(e){return f(u.issuer,e)},u.issuer.addField=function(e){w([e]),u.issuer.attributes.push(e)},u.issuer.attributes=i.RDNAttributesAsArray(n.certIssuer),n.certIssuerUniqueId&&(u.issuer.uniqueId=n.certIssuerUniqueId),u.issuer.hash=m.digest().toHex();var v=r.md.sha1.create(),_=s.toDer(n.certSubject);return v.update(_.getBytes()),u.subject.getField=function(e){return f(u.subject,e)},u.subject.addField=function(e){w([e]),u.subject.attributes.push(e)},u.subject.attributes=i.RDNAttributesAsArray(n.certSubject),n.certSubjectUniqueId&&(u.subject.uniqueId=n.certSubjectUniqueId),u.subject.hash=v.digest().toHex(),n.certExtensions?u.extensions=i.certificateExtensionsFromAsn1(n.certExtensions):u.extensions=[],u.publicKey=i.publicKeyFromAsn1(n.subjectPublicKeyInfo),u},i.certificateExtensionsFromAsn1=function(e){for(var t=[],n=0;n<e.value.length;++n)for(var r=e.value[n],s=0;s<r.value.length;++s)t.push(i.certificateExtensionFromAsn1(r.value[s]));return t},i.certificateExtensionFromAsn1=function(e){var t={};if(t.id=s.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===s.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var n=s.fromDer(t.value),i=0,a=0;n.value.length>1&&(i=n.value.charCodeAt(1),a=n.value.length>2?n.value.charCodeAt(2):0),t.digitalSignature=128===(128&i),t.nonRepudiation=64===(64&i),t.keyEncipherment=32===(32&i),t.dataEncipherment=16===(16&i),t.keyAgreement=8===(8&i),t.keyCertSign=4===(4&i),t.cRLSign=2===(2&i),t.encipherOnly=1===(1&i),t.decipherOnly=128===(128&a)}else if("basicConstraints"===t.name){n=s.fromDer(t.value);n.value.length>0&&n.value[0].type===s.Type.BOOLEAN?t.cA=0!==n.value[0].value.charCodeAt(0):t.cA=!1;var c=null;n.value.length>0&&n.value[0].type===s.Type.INTEGER?c=n.value[0].value:n.value.length>1&&(c=n.value[1].value),null!==c&&(t.pathLenConstraint=s.derToInteger(c))}else if("extKeyUsage"===t.name){n=s.fromDer(t.value);for(var l=0;l<n.value.length;++l){var u=s.derToOid(n.value[l].value);u in o?t[o[u]]=!0:t[u]=!0}}else if("nsCertType"===t.name){n=s.fromDer(t.value),i=0;n.value.length>1&&(i=n.value.charCodeAt(1)),t.client=128===(128&i),t.server=64===(64&i),t.email=32===(32&i),t.objsign=16===(16&i),t.reserved=8===(8&i),t.sslCA=4===(4&i),t.emailCA=2===(2&i),t.objCA=1===(1&i)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[];n=s.fromDer(t.value);for(var d=0;d<n.value.length;++d){h=n.value[d];var f={type:h.type,value:h.value};switch(t.altNames.push(f),h.type){case 1:case 2:case 6:break;case 7:f.ip=r.util.bytesToIP(h.value);break;case 8:f.oid=s.derToOid(h.value);break;default:}}}else if("subjectKeyIdentifier"===t.name){n=s.fromDer(t.value);t.subjectKeyIdentifier=r.util.bytesToHex(n.value)}return t},i.certificationRequestFromAsn1=function(e,t){var n={},o=[];if(!s.validate(e,d,n,o)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=o,a}var c=s.derToOid(n.publicKeyOid);if(c!==i.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var l=i.createCertificationRequest();if(l.version=n.csrVersion?n.csrVersion.charCodeAt(0):0,l.signatureOid=r.asn1.derToOid(n.csrSignatureOid),l.signatureParameters=p(l.signatureOid,n.csrSignatureParams,!0),l.siginfo.algorithmOid=r.asn1.derToOid(n.csrSignatureOid),l.siginfo.parameters=p(l.siginfo.algorithmOid,n.csrSignatureParams,!1),l.signature=n.csrSignature,l.certificationRequestInfo=n.certificationRequestInfo,t){l.md=g({signatureOid:l.signatureOid,type:"certification request"});var u=s.toDer(l.certificationRequestInfo);l.md.update(u.getBytes())}var h=r.md.sha1.create();return l.subject.getField=function(e){return f(l.subject,e)},l.subject.addField=function(e){w([e]),l.subject.attributes.push(e)},l.subject.attributes=i.RDNAttributesAsArray(n.certificationRequestInfoSubject,h),l.subject.hash=h.digest().toHex(),l.publicKey=i.publicKeyFromAsn1(n.subjectPublicKeyInfo),l.getAttribute=function(e){return f(l,e)},l.addAttribute=function(e){w([e]),l.attributes.push(e)},l.attributes=i.CRIAttributesAsArray(n.certificationRequestInfoAttributes||[]),l},i.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return f(e.subject,t)},e.subject.addField=function(t){w([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return f(e,t)},e.addAttribute=function(t){w([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){w(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){w(t),e.attributes=t},e.sign=function(t,n){e.md=n||r.md.sha1.create();var a=o[e.md.algorithm+"WithRSAEncryption"];if(!a){var c=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw c.algorithm=e.md.algorithm,c}e.signatureOid=e.siginfo.algorithmOid=a,e.certificationRequestInfo=i.getCertificationRequestInfo(e);var l=s.toDer(e.certificationRequestInfo);e.md.update(l.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,n=e.md;if(null===n){n=g({signatureOid:e.signatureOid,type:"certification request"});var r=e.certificationRequestInfo||i.getCertificationRequestInfo(e),o=s.toDer(r);n.update(o.getBytes())}return null!==n&&(t=y({certificate:e,md:n,signature:e.signature})),t},e};var E=new Date("1950-01-01T00:00:00Z"),S=new Date("2050-01-01T00:00:00Z");function k(e){return e>=E&&e<S?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(e)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(e))}i.getTBSCertificate=function(e){var t=k(e.validity.notBefore),n=k(e.validity.notAfter),o=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes())]),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,r.util.hexToBytes(e.serialNumber)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.siginfo.algorithmOid).getBytes()),v(e.siginfo.algorithmOid,e.siginfo.parameters)]),m(e.issuer),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,n]),m(e.subject),i.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(s.create(s.Class.CONTEXT_SPECIFIC,2,!0,[s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(i.certificateExtensionsToAsn1(e.extensions)),o},i.getCertificationRequestInfo=function(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),m(e.subject),i.publicKeyToAsn1(e.publicKey),_(e)]);return t},i.distinguishedNameToAsn1=function(e){return m(e)},i.certificateToAsn1=function(e){var t=e.tbsCertificate||i.getTBSCertificate(e);return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.certificateExtensionsToAsn1=function(e){var t=s.create(s.Class.CONTEXT_SPECIFIC,3,!0,[]),n=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);t.value.push(n);for(var r=0;r<e.length;++r)n.value.push(i.certificateExtensionToAsn1(e[r]));return t},i.certificateExtensionToAsn1=function(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[]);t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.id).getBytes())),e.critical&&t.value.push(s.create(s.Class.UNIVERSAL,s.Type.BOOLEAN,!1,String.fromCharCode(255)));var n=e.value;return"string"!==typeof e.value&&(n=s.toDer(n).getBytes()),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,n)),t},i.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||i.getCertificationRequestInfo(e);return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[t,s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureOid).getBytes()),v(e.signatureOid,e.signatureParameters)]),s.create(s.Class.UNIVERSAL,s.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},i.createCaStore=function(e){var t={certs:{}};function n(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=r.md.sha1.create();e.attributes=i.RDNAttributesAsArray(m(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){var t=n(e.issuer);return t},t.addCertificate=function(e){if("string"===typeof e&&(e=r.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var n=t.certs[e.subject.hash];r.util.isArray(n)||(n=[n]),n.push(e),t.certs[e.subject.hash]=n}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"===typeof e&&(e=r.pki.certificateFromPem(e));var t=n(e.subject);if(!t)return!1;r.util.isArray(t)||(t=[t]);for(var o=s.toDer(i.certificateToAsn1(e)).getBytes(),a=0;a<t.length;++a){var c=s.toDer(i.certificateToAsn1(t[a])).getBytes();if(o===c)return!0}return!1},t.listAllCertificates=function(){var e=[];for(var n in t.certs)if(t.certs.hasOwnProperty(n)){var s=t.certs[n];if(r.util.isArray(s))for(var i=0;i<s.length;++i)e.push(s[i]);else e.push(s)}return e},t.removeCertificate=function(e){var a;if("string"===typeof e&&(e=r.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var c=n(e.subject);if(!r.util.isArray(c))return a=t.certs[e.subject.hash],delete t.certs[e.subject.hash],a;for(var l=s.toDer(i.certificateToAsn1(e)).getBytes(),u=0;u<c.length;++u){var h=s.toDer(i.certificateToAsn1(c[u])).getBytes();l===h&&(a=c[u],c.splice(u,1))}return 0===c.length&&delete t.certs[e.subject.hash],a},e)for(var a=0;a<e.length;++a){var c=e[a];t.addCertificate(c)}return t},i.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},i.verifyCertificateChain=function(e,t,n){"function"===typeof n&&(n={verify:n}),n=n||{},t=t.slice(0);var s=t.slice(0),o=n.validityCheckDate;"undefined"===typeof o&&(o=new Date);var a=!0,c=null,l=0;do{var u=t.shift(),h=null,d=!1;if(o&&(o<u.validity.notBefore||o>u.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:i.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:o}),null===c){if(h=t[0]||e.getIssuer(u),null===h&&u.isIssuer(u)&&(d=!0,h=u),h){var f=h;r.util.isArray(f)||(f=[f]);var p=!1;while(!p&&f.length>0){h=f.shift();try{p=h.verify(u)}catch(S){}}p||(c={message:"Certificate signature is invalid.",error:i.certificateError.bad_certificate})}null!==c||h&&!d||e.hasCertificate(u)||(c={message:"Certificate is not trusted.",error:i.certificateError.unknown_ca})}if(null===c&&h&&!u.isIssuer(h)&&(c={message:"Certificate issuer is invalid.",error:i.certificateError.bad_certificate}),null===c)for(var g={keyUsage:!0,basicConstraints:!0},y=0;null===c&&y<u.extensions.length;++y){var m=u.extensions[y];m.critical&&!(m.name in g)&&(c={message:"Certificate has an unsupported critical extension.",error:i.certificateError.unsupported_certificate})}if(null===c&&(!a||0===t.length&&(!h||d))){var w=u.getExtension("basicConstraints"),b=u.getExtension("keyUsage");if(null!==b&&(b.keyCertSign&&null!==w||(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:i.certificateError.bad_certificate})),null!==c||null===w||w.cA||(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:i.certificateError.bad_certificate}),null===c&&null!==b&&"pathLenConstraint"in w){var v=l-1;v>w.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:i.certificateError.bad_certificate})}}var _=null===c||c.error,E=n.verify?n.verify(_,l,s):_;if(!0!==E)throw!0===_&&(c={message:"The application rejected the certificate.",error:i.certificateError.bad_certificate}),(E||0===E)&&("object"!==typeof E||r.util.isArray(E)?"string"===typeof E&&(c.error=E):(E.message&&(c.message=E.message),E.error&&(c.error=E.error))),c;c=null,a=!1,++l}while(t.length>0);return!0}},1838:function(e,t,n){n(7658);const r=n(2819),s=n(9044);e.exports=class{constructor(){this._buffer=new r,this._waitingConsumers=new r}push(e){const{promise:t,resolve:n}=s();return this._buffer.push({chunk:e,resolve:n}),this._consume(),t}_consume(){while(!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty()){const e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){const{promise:e,resolve:t}=s();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}},9044:function(e){"use strict";const t=()=>{const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e};e.exports=t},6425:function(e,t,n){"use strict";e.exports=n(9507)},9507:function(e,t,n){"use strict";var r=t;function s(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(7156),r.BufferWriter=n(8252),r.Reader=n(9799),r.BufferReader=n(8894),r.util=n(7102),r.rpc=n(7753),r.roots=n(358),r.configure=s,s()},9799:function(e,t,n){"use strict";e.exports=c;var r,s=n(7102),i=s.LongBits,o=s.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return s.Buffer?function(e){return(c.create=function(e){return s.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function h(){var e=new i(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw a(this,8);return new i(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|d(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:while(4!==(e=7&this.uint32()))this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=u(),r._configure();var t=s.Long?"toLong":"toNumber";s.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},8894:function(e,t,n){"use strict";e.exports=i;var r=n(9799);(i.prototype=Object.create(r.prototype)).constructor=i;var s=n(7102);function i(e){r.call(this,e)}i._configure=function(){s.Buffer&&(i.prototype._slice=s.Buffer.prototype.slice)},i.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},i._configure()},358:function(e){"use strict";e.exports={}},7753:function(e,t,n){"use strict";var r=t;r.Service=n(964)},964:function(e,t,n){"use strict";e.exports=s;var r=n(7102);function s(e,t,n){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(s.prototype=Object.create(r.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,n,s,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return r.asPromise(e,a,t,n,s,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof s))try{n=s[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){o(c)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},6350:function(e,t,n){"use strict";e.exports=s;var r=n(7102);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var i=s.zero=new s(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return i;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new s(n,r)},s.from=function(e){if("number"===typeof e)return s.fromNumber(e);if(r.isString(e)){if(!r.Long)return s.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):i},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?i:new s((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},7102:function(e,t,n){"use strict";var r=t;function s(e,t,n){for(var r=Object.keys(t),s=0;s<r.length;++s)void 0!==e[r[s]]&&n||(e[r[s]]=t[r[s]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&s(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=n(5186),r.base64=n(8673),r.EventEmitter=n(8825),r.float=n(2913),r.inquire=n(6332),r.utf8=n(9561),r.pool=n(1168),r.LongBits=n(6350),r.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"===typeof e||e instanceof String},r.isObject=function(e){return e&&"object"===typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"===typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=s,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},7156:function(e,t,n){"use strict";e.exports=h;var r,s=n(7102),i=s.LongBits,o=s.base64,a=s.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}var d=function(){return s.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function f(e,t,n){t[n]=255&e}function p(e,t,n){while(e>127)t[n++]=127&e|128,e>>>=7;t[n]=e}function g(e,t){this.len=e,this.next=void 0,this.val=t}function y(e,t,n){while(e.hi)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;while(e.lo>127)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function m(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=d(),h.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(h.alloc=s.pool(h.alloc,s.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},g.prototype=Object.create(c.prototype),g.prototype.fn=p,h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new g((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(y,10,i.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=i.from(e);return this._push(y,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=i.from(e).zzEncode();return this._push(y,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(m,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=i.from(e);return this._push(m,4,t.lo)._push(m,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var w=s.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(s.isString(e)){var n=h.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(w,t,e)},h.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){var e=this.head.next,t=this.constructor.alloc(this.len),n=0;while(e)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=d(),r._configure()}},8252:function(e,t,n){"use strict";e.exports=i;var r=n(7156);(i.prototype=Object.create(r.prototype)).constructor=i;var s=n(7102);function i(){r.call(this)}function o(e,t,n){e.length<40?s.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}i._configure=function(){i.alloc=s._Buffer_allocUnsafe,i.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},i.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(i.writeBytesBuffer,t,e),this},i.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},i._configure()},3802:function(e,t,n){
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
let r;e.exports="function"===typeof queueMicrotask?queueMicrotask.bind("undefined"!==typeof window?window:n.g):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},3864:function(e,t,n){const{instantiate:r}=n(5713);function s(e={}){if(!s.supported)return null;var t=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return r(new Response(new Blob([t],{type:"application/wasm"})),e)}s.supported="undefined"!==typeof WebAssembly,e.exports=s},7393:function(e,t,n){const r=n(2282),s=n(3864),i=async(e,t,n,i,o)=>{const a=await s();return new r(a,e,t,n,i,o)};e.exports={Rabin:r,create:i}},2282:function(e){class t{constructor(e,t=12,n=8192,r=32768,s=64,i){this.bits=t,this.min=n,this.max=r,this.asModule=e,this.rabin=new e.Rabin(t,n,r,s,i),this.polynomial=i}fingerprint(e){const{__retain:t,__release:n,__allocArray:r,__getInt32Array:s,Int32Array_ID:i,Uint8Array_ID:o}=this.asModule,a=new Int32Array(Math.ceil(e.length/this.min)),c=t(r(i,a)),l=t(r(o,e)),u=this.rabin.fingerprint(l,c),h=s(u);n(l),n(c);const d=h.indexOf(0);return d>=0?h.subarray(0,d):h}}e.exports=t},7602:function(e,t,n){"use strict";var r=65536,s=4294967295;function i(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var o=n(6779).Buffer,a=n.g.crypto||n.g.msCrypto;function c(e,t){if(e>s)throw new RangeError("requested too many random bytes");var n=o.allocUnsafe(e);if(e>0)if(e>r)for(var i=0;i<e;i+=r)a.getRandomValues(n.slice(i,i+r));else a.getRandomValues(n);return"function"===typeof t?process.nextTick((function(){t(null,n)})):n}a&&a.getRandomValues?e.exports=c:e.exports=i},5024:function(e,t,n){const r=n(8459),s=n(278),i=n(690),o=n(6308),{RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l}=n(7305),u=n(5281),h=n(8038),d=n(4972),f=n(4564),p=n(6486),g=n(555),y=n(1196);e.exports={RateLimiterRedis:r,RateLimiterMongo:s,RateLimiterMySQL:i,RateLimiterPostgres:o,RateLimiterMemory:u,RateLimiterMemcache:h,RateLimiterClusterMaster:a,RateLimiterClusterMasterPM2:c,RateLimiterCluster:l,RLWrapperBlackAndWhite:d,RateLimiterUnion:f,RateLimiterQueue:p,BurstyRateLimiter:g,RateLimiterRes:y}},555:function(e,t,n){const r=n(1196);e.exports=class{constructor(e,t){this._rateLimiter=e,this._burstLimiter=t}_combineRes(e,t){return new r(e.remainingPoints,Math.min(e.msBeforeNext,t.msBeforeNext),e.consumedPoints,e.isFirstInDuration)}consume(e,t=1,n={}){return this._rateLimiter.consume(e,t,n).catch((s=>s instanceof r?this._burstLimiter.consume(e,t,n).then((e=>Promise.resolve(this._combineRes(s,e)))).catch((e=>e instanceof r?Promise.reject(this._combineRes(s,e)):Promise.reject(e))):Promise.reject(s)))}get(e){return Promise.all([this._rateLimiter.get(e),this._burstLimiter.get(e)]).then((([e,t])=>this._combineRes(e,t)))}get points(){return this._rateLimiter.points}}},4972:function(e,t,n){const r=n(1196);e.exports=class{constructor(e={}){this.limiter=e.limiter,this.blackList=e.blackList,this.whiteList=e.whiteList,this.isBlackListed=e.isBlackListed,this.isWhiteListed=e.isWhiteListed,this.runActionAnyway=e.runActionAnyway}get limiter(){return this._limiter}set limiter(e){if("undefined"===typeof e)throw new Error("limiter is not set");this._limiter=e}get runActionAnyway(){return this._runActionAnyway}set runActionAnyway(e){this._runActionAnyway="undefined"!==typeof e&&e}get blackList(){return this._blackList}set blackList(e){this._blackList=Array.isArray(e)?e:[]}get isBlackListed(){return this._isBlackListed}set isBlackListed(e){if("undefined"===typeof e&&(e=()=>!1),"function"!==typeof e)throw new Error("isBlackListed must be function");this._isBlackListed=e}get whiteList(){return this._whiteList}set whiteList(e){this._whiteList=Array.isArray(e)?e:[]}get isWhiteListed(){return this._isWhiteListed}set isWhiteListed(e){if("undefined"===typeof e&&(e=()=>!1),"function"!==typeof e)throw new Error("isWhiteListed must be function");this._isWhiteListed=e}isBlackListedSomewhere(e){return this.blackList.indexOf(e)>=0||this.isBlackListed(e)}isWhiteListedSomewhere(e){return this.whiteList.indexOf(e)>=0||this.isWhiteListed(e)}getBlackRes(){return new r(0,Number.MAX_SAFE_INTEGER,0,!1)}getWhiteRes(){return new r(Number.MAX_SAFE_INTEGER,0,0,!1)}rejectBlack(){return Promise.reject(this.getBlackRes())}resolveBlack(){return Promise.resolve(this.getBlackRes())}resolveWhite(){return Promise.resolve(this.getWhiteRes())}consume(e,t=1){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.rejectBlack()),"undefined"===typeof n?this.limiter.consume(e,t):(this.runActionAnyway&&this.limiter.consume(e,t).catch((()=>{})),n)}block(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),"undefined"===typeof n?this.limiter.block(e,t):(this.runActionAnyway&&this.limiter.block(e,t).catch((()=>{})),n)}penalty(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),"undefined"===typeof n?this.limiter.penalty(e,t):(this.runActionAnyway&&this.limiter.penalty(e,t).catch((()=>{})),n)}reward(e,t){let n;return this.isWhiteListedSomewhere(e)?n=this.resolveWhite():this.isBlackListedSomewhere(e)&&(n=this.resolveBlack()),"undefined"===typeof n?this.limiter.reward(e,t):(this.runActionAnyway&&this.limiter.reward(e,t).catch((()=>{})),n)}get(e){let t;return this.isWhiteListedSomewhere(e)?t=this.resolveWhite():this.isBlackListedSomewhere(e)&&(t=this.resolveBlack()),"undefined"===typeof t||this.runActionAnyway?this.limiter.get(e):t}delete(e){return this.limiter.delete(e)}}},438:function(e){e.exports=class{constructor(e={}){this.points=e.points,this.duration=e.duration,this.blockDuration=e.blockDuration,this.execEvenly=e.execEvenly,this.execEvenlyMinDelayMs=e.execEvenlyMinDelayMs,this.keyPrefix=e.keyPrefix}get points(){return this._points}set points(e){this._points=e>=0?e:4}get duration(){return this._duration}set duration(e){this._duration="undefined"===typeof e?1:e}get msDuration(){return 1e3*this.duration}get blockDuration(){return this._blockDuration}set blockDuration(e){this._blockDuration="undefined"===typeof e?0:e}get msBlockDuration(){return 1e3*this.blockDuration}get execEvenly(){return this._execEvenly}set execEvenly(e){this._execEvenly="undefined"!==typeof e&&Boolean(e)}get execEvenlyMinDelayMs(){return this._execEvenlyMinDelayMs}set execEvenlyMinDelayMs(e){this._execEvenlyMinDelayMs="undefined"===typeof e?Math.ceil(this.msDuration/this.points):e}get keyPrefix(){return this._keyPrefix}set keyPrefix(e){if("undefined"===typeof e&&(e="rlflx"),"string"!==typeof e)throw new Error("keyPrefix must be string");this._keyPrefix=e}_getKeySecDuration(e={}){return e&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?`${this.keyPrefix}:${e}`:e}parseKey(e){return e.substring(this.keyPrefix.length)}consume(){throw new Error("You have to implement the method 'consume'!")}penalty(){throw new Error("You have to implement the method 'penalty'!")}reward(){throw new Error("You have to implement the method 'reward'!")}get(){throw new Error("You have to implement the method 'get'!")}set(){throw new Error("You have to implement the method 'set'!")}block(){throw new Error("You have to implement the method 'block'!")}delete(){throw new Error("You have to implement the method 'delete'!")}}},7305:function(e,t,n){const r=n(1265),s=n(5539),i=n(438),o=n(5281),a=n(1196),c="rate_limiter_flexible";let l=null;const u=function(e,t,n,r){let s;s=null===r||!0===r||!1===r?r:{remainingPoints:r.remainingPoints,msBeforeNext:r.msBeforeNext,consumedPoints:r.consumedPoints,isFirstInDuration:r.isFirstInDuration},e.send({channel:c,keyPrefix:t.keyPrefix,promiseId:t.promiseId,type:n,data:s})},h=function(e){setTimeout((()=>{this._initiated?process.send(e):"undefined"!==typeof this._promises[e.promiseId]&&h.call(this,e)}),30)},d=function(e,t,n,r,s){const i={channel:c,keyPrefix:this.keyPrefix,func:e,promiseId:t,data:{key:n,arg:r,opts:s}};this._initiated?process.send(i):h.call(this,i)},f=function(e,t){if(!t||t.channel!==c||"undefined"===typeof this._rateLimiters[t.keyPrefix])return!1;let n;switch(t.func){case"consume":n=this._rateLimiters[t.keyPrefix].consume(t.data.key,t.data.arg,t.data.opts);break;case"penalty":n=this._rateLimiters[t.keyPrefix].penalty(t.data.key,t.data.arg,t.data.opts);break;case"reward":n=this._rateLimiters[t.keyPrefix].reward(t.data.key,t.data.arg,t.data.opts);break;case"block":n=this._rateLimiters[t.keyPrefix].block(t.data.key,t.data.arg,t.data.opts);break;case"get":n=this._rateLimiters[t.keyPrefix].get(t.data.key,t.data.opts);break;case"delete":n=this._rateLimiters[t.keyPrefix].delete(t.data.key,t.data.opts);break;default:return!1}n&&n.then((n=>{u(e,t,"resolve",n)})).catch((n=>{u(e,t,"reject",n)}))},p=function(e){if(!e||e.channel!==c||e.keyPrefix!==this.keyPrefix)return!1;if(this._promises[e.promiseId]){let t;switch(clearTimeout(this._promises[e.promiseId].timeoutId),t=null===e.data||!0===e.data||!1===e.data?e.data:new a(e.data.remainingPoints,e.data.msBeforeNext,e.data.consumedPoints,e.data.isFirstInDuration),e.type){case"resolve":this._promises[e.promiseId].resolve(t);break;case"reject":this._promises[e.promiseId].reject(t);break;default:throw new Error(`RateLimiterCluster: no such message type '${e.type}'`)}delete this._promises[e.promiseId]}},g=function(){return{points:this.points,duration:this.duration,blockDuration:this.blockDuration,execEvenly:this.execEvenly,execEvenlyMinDelayMs:this.execEvenlyMinDelayMs,keyPrefix:this.keyPrefix}},y=function(e,t){const n=process.hrtime();let r=n[0].toString()+n[1].toString();return"undefined"!==typeof this._promises[r]&&(r+=s.randomBytes(12).toString("base64")),this._promises[r]={resolve:e,reject:t,timeoutId:setTimeout((()=>{delete this._promises[r],t(new Error("RateLimiterCluster timeout: no answer from master in time"))}),this.timeoutMs)},r};class m{constructor(){if(l)return l;this._rateLimiters={},r.setMaxListeners(0),r.on("message",((e,t)=>{t&&t.channel===c&&"init"===t.type?("undefined"===typeof this._rateLimiters[t.opts.keyPrefix]&&(this._rateLimiters[t.opts.keyPrefix]=new o(t.opts)),e.send({channel:c,type:"init",keyPrefix:t.opts.keyPrefix})):f.call(this,e,t)})),l=this}}class w{constructor(e){if(l)return l;this._rateLimiters={},e.launchBus(((t,n)=>{n.on("process:msg",(t=>{const n=t.raw;if(n&&n.channel===c&&"init"===n.type)"undefined"===typeof this._rateLimiters[n.opts.keyPrefix]&&(this._rateLimiters[n.opts.keyPrefix]=new o(n.opts)),e.sendDataToProcessId(t.process.pm_id,{data:{},topic:c,channel:c,type:"init",keyPrefix:n.opts.keyPrefix},((e,t)=>{e&&console.log(e,t)}));else{const r={send:n=>{const r=n;r.topic=c,"undefined"===typeof r.data&&(r.data={}),e.sendDataToProcessId(t.process.pm_id,r,((e,t)=>{e&&console.log(e,t)}))}};f.call(this,r,n)}}))})),l=this}}class b extends i{get timeoutMs(){return this._timeoutMs}set timeoutMs(e){this._timeoutMs="undefined"===typeof e?5e3:Math.abs(parseInt(e))}constructor(e={}){super(e),process.setMaxListeners(0),this.timeoutMs=e.timeoutMs,this._initiated=!1,process.on("message",(e=>{e&&e.channel===c&&"init"===e.type&&e.keyPrefix===this.keyPrefix?this._initiated=!0:p.call(this,e)})),process.send({channel:c,type:"init",opts:g.call(this)}),this._promises={}}consume(e,t=1,n={}){return new Promise(((r,s)=>{const i=y.call(this,r,s);d.call(this,"consume",i,e,t,n)}))}penalty(e,t=1,n={}){return new Promise(((r,s)=>{const i=y.call(this,r,s);d.call(this,"penalty",i,e,t,n)}))}reward(e,t=1,n={}){return new Promise(((r,s)=>{const i=y.call(this,r,s);d.call(this,"reward",i,e,t,n)}))}block(e,t,n={}){return new Promise(((r,s)=>{const i=y.call(this,r,s);d.call(this,"block",i,e,t,n)}))}get(e,t={}){return new Promise(((n,r)=>{const s=y.call(this,n,r);d.call(this,"get",s,e,t)}))}delete(e,t={}){return new Promise(((n,r)=>{const s=y.call(this,n,r);d.call(this,"delete",s,e,t)}))}}e.exports={RateLimiterClusterMaster:m,RateLimiterClusterMasterPM2:w,RateLimiterCluster:b}},8038:function(e,t,n){const r=n(8627),s=n(1196);class i extends r{constructor(e){super(e),this.client=e.storeClient}_getRateLimiterRes(e,t,n){const r=new s;return r.consumedPoints=parseInt(n.consumedPoints),r.isFirstInDuration=n.consumedPoints===t,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=n.msBeforeNext,r}_upsert(e,t,n,r=!1,s={}){return new Promise(((i,o)=>{const a=Date.now(),c=Math.floor(n/1e3);r?this.client.set(e,t,c,(n=>{n?o(n):this.client.set(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{const e={consumedPoints:t,msBeforeNext:c>0?1e3*c:-1};i(e)}))})):this.client.incr(e,t,((l,u)=>{l||!1===u?this.client.add(e,t,c,((l,u)=>{if(l||!u)if("undefined"===typeof s.attemptNumber||s.attemptNumber<3){const a=Object.assign({},s);a.attemptNumber=a.attemptNumber?a.attemptNumber+1:1,this._upsert(e,t,n,r,a).then((e=>i(e))).catch((e=>o(e)))}else o(new Error("Can not add key"));else this.client.add(`${e}_expire`,c>0?a+1e3*c:-1,c,(()=>{const e={consumedPoints:t,msBeforeNext:c>0?1e3*c:-1};i(e)}))})):this.client.get(`${e}_expire`,((e,t)=>{if(e)o(e);else{const e=!1===t?0:t,n={consumedPoints:u,msBeforeNext:e>=0?Math.max(e-a,0):-1};i(n)}}))}))}))}_get(e){return new Promise(((t,n)=>{const r=Date.now();this.client.get(e,((s,i)=>{i?this.client.get(`${e}_expire`,((e,s)=>{if(e)n(e);else{const e=!1===s?0:s,n={consumedPoints:i,msBeforeNext:e>=0?Math.max(e-r,0):-1};t(n)}})):t(null)}))}))}_delete(e){return new Promise(((t,n)=>{this.client.del(e,((r,s)=>{r?n(r):!1===s?t(s):this.client.del(`${e}_expire`,(e=>{e?n(e):t(s)}))}))}))}}e.exports=i},5281:function(e,t,n){const r=n(438),s=n(6163),i=n(1196);class o extends r{constructor(e={}){super(e),this._memoryStorage=new s}consume(e,t=1,n={}){return new Promise(((r,s)=>{const i=this.getKey(e),o=this._getKeySecDuration(n);let a=this._memoryStorage.incrby(i,t,o);if(a.remainingPoints=Math.max(this.points-a.consumedPoints,0),a.consumedPoints>this.points)this.blockDuration>0&&a.consumedPoints<=this.points+t&&(a=this._memoryStorage.set(i,a.consumedPoints,this.blockDuration)),s(a);else if(this.execEvenly&&a.msBeforeNext>0&&!a.isFirstInDuration){let e=Math.ceil(a.msBeforeNext/(a.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=a.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(r,e,a)}else r(a)}))}penalty(e,t=1,n={}){const r=this.getKey(e);return new Promise((e=>{const s=this._getKeySecDuration(n),i=this._memoryStorage.incrby(r,t,s);i.remainingPoints=Math.max(this.points-i.consumedPoints,0),e(i)}))}reward(e,t=1,n={}){const r=this.getKey(e);return new Promise((e=>{const s=this._getKeySecDuration(n),i=this._memoryStorage.incrby(r,-t,s);i.remainingPoints=Math.max(this.points-i.consumedPoints,0),e(i)}))}block(e,t){const n=1e3*t,r=this.points+1;return this._memoryStorage.set(this.getKey(e),r,t),Promise.resolve(new i(0,0===n?-1:n,r))}set(e,t,n){const r=1e3*(n>=0?n:this.duration);return this._memoryStorage.set(this.getKey(e),t,n),Promise.resolve(new i(0,0===r?-1:r,t))}get(e){const t=this._memoryStorage.get(this.getKey(e));return null!==t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),Promise.resolve(t)}delete(e){return Promise.resolve(this._memoryStorage.delete(this.getKey(e)))}}e.exports=o},278:function(e,t,n){const r=n(8627),s=n(1196);function i(e){try{const t=e.client?e.client:e,{version:n}=t.topology.s.options.metadata.driver,r=n.split(".").map((e=>parseInt(e)));return{major:r[0],feature:r[1],patch:r[2]}}catch(t){return{major:0,feature:0,patch:0}}}class o extends r{constructor(e){super(e),this.dbName=e.dbName,this.tableName=e.tableName,this.indexKeyPrefix=e.indexKeyPrefix,e.mongo?this.client=e.mongo:this.client=e.storeClient,"function"===typeof this.client.then?this.client.then((e=>{this.client=e,this._initCollection(),this._driverVersion=i(this.client)})):(this._initCollection(),this._driverVersion=i(this.client))}get dbName(){return this._dbName}set dbName(e){this._dbName="undefined"===typeof e?o.getDbName():e}static getDbName(){return"node-rate-limiter-flexible"}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get client(){return this._client}set client(e){if("undefined"===typeof e)throw new Error("mongo is not set");this._client=e}get indexKeyPrefix(){return this._indexKeyPrefix}set indexKeyPrefix(e){this._indexKeyPrefix=e||{}}_initCollection(){const e="function"===typeof this.client.db?this.client.db(this.dbName):this.client,t=e.collection(this.tableName);t.createIndex({expire:-1},{expireAfterSeconds:0}),t.createIndex(Object.assign({},this.indexKeyPrefix,{key:1}),{unique:!0}),this._collection=t}_getRateLimiterRes(e,t,n){const r=new s;let i;return i="undefined"===typeof n.value?n:n.value,r.isFirstInDuration=i.points===t,r.consumedPoints=i.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=null!==i.expire?Math.max(new Date(i.expire).getTime()-Date.now(),0):-1,r}_upsert(e,t,n,r=!1,s={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const i=s.attrs||{};let o,a;r?(o={key:e},o=Object.assign(o,i),a={$set:{key:e,points:t,expire:n>0?new Date(Date.now()+n):null}},a.$set=Object.assign(a.$set,i)):(o={$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}],key:e},o=Object.assign(o,i),a={$setOnInsert:{key:e,expire:n>0?new Date(Date.now()+n):null},$inc:{points:t}},a.$setOnInsert=Object.assign(a.$setOnInsert,i));const c={upsert:!0};return this._driverVersion.major>=4||3===this._driverVersion.major&&this._driverVersion.feature>=7||this._driverVersion.feature>=6&&this._driverVersion.patch>=7?c.returnDocument="after":c.returnOriginal=!1,new Promise(((s,l)=>{this._collection.findOneAndUpdate(o,a,c).then((e=>{s(e)})).catch((o=>{if(o&&11e3===o.code){const o=Object.assign({$or:[{expire:{$lte:new Date}},{expire:{$eq:null}}],key:e},i),a={$set:Object.assign({key:e,points:t,expire:n>0?new Date(Date.now()+n):null},i)};this._collection.findOneAndUpdate(o,a,c).then((e=>{s(e)})).catch((i=>{i&&11e3===i.code?this._upsert(e,t,n,r).then((e=>s(e))).catch((e=>l(e))):l(i)}))}else l(o)}))}))}_get(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const n=t.attrs||{},r=Object.assign({key:e,$or:[{expire:{$gt:new Date}},{expire:{$eq:null}}]},n);return this._collection.findOne(r)}_delete(e,t={}){if(!this._collection)return Promise.reject(Error("Mongo connection is not established"));const n=t.attrs||{},r=Object.assign({key:e},n);return this._collection.deleteOne(r).then((e=>e.deletedCount>0))}}e.exports=o},690:function(e,t,n){const r=n(8627),s=n(1196);class i extends r{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.dbName=e.dbName,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?(this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()):this._createDbAndTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()})).catch((e=>{if("function"!==typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{this._getConnection().then((n=>{n.query("DELETE FROM ??.?? WHERE expire < ?",[this.dbName,this.tableName,e],(()=>{this._releaseConnection(n),t()}))})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return new Promise(((e,t)=>{this.client.getConnection(((n,r)=>{if(n)return t(n);e(r)}))}));case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return e.release();case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);default:return!0}}_createDbAndTable(){return new Promise(((e,t)=>{this._getConnection().then((n=>{n.query(`CREATE DATABASE IF NOT EXISTS \`${this.dbName}\`;`,(r=>{if(r)return this._releaseConnection(n),t(r);n.query(this._getCreateTableStmt(),(r=>{if(r)return this._releaseConnection(n),t(r);this._releaseConnection(n),e()}))}))})).catch((e=>{t(e)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS \`${this.dbName}\`.\`${this.tableName}\` (\`key\` VARCHAR(255) CHARACTER SET utf8 NOT NULL,\`points\` INT(9) NOT NULL default 0,\`expire\` BIGINT UNSIGNED,PRIMARY KEY (\`key\`)) ENGINE = INNODB;`}get clientType(){return this._clientType}set clientType(e){if("undefined"===typeof e)if("Connection"===this.client.constructor.name)e="connection";else if("Pool"===this.client.constructor.name)e="pool";else{if("Sequelize"!==this.client.constructor.name)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get dbName(){return this._dbName}set dbName(e){this._dbName="undefined"===typeof e?"rtlmtrflx":e}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated="undefined"!==typeof e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}_getRateLimiterRes(e,t,n){const r=new s,[i]=n;return r.isFirstInDuration=t===i.points,r.consumedPoints=r.isFirstInDuration?t:i.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,r}_upsertTransaction(e,t,n,r,s){return new Promise(((i,o)=>{e.query("BEGIN",(a=>{if(a)return e.rollback(),o(a);const c=Date.now(),l=r>0?c+r:null;let u,h;s?(u="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = ?, \n            expire = ?;",h=[this.dbName,this.tableName,t,n,l,n,l]):(u="INSERT INTO ??.?? VALUES (?, ?, ?)\n          ON DUPLICATE KEY UPDATE \n            points = IF(expire <= ?, ?, points + (?)), \n            expire = IF(expire <= ?, ?, expire);",h=[this.dbName,this.tableName,t,n,l,c,n,n,c,l]),e.query(u,h,(n=>{if(n)return e.rollback(),o(n);e.query("SELECT points, expire FROM ??.?? WHERE `key` = ?;",[this.dbName,this.tableName,t],((t,n)=>{if(t)return e.rollback(),o(t);e.query("COMMIT",(t=>{if(t)return e.rollback(),o(t);i(n)}))}))}))}))}))}_upsert(e,t,n,r=!1){return this.tableCreated?new Promise(((s,i)=>{this._getConnection().then((o=>{this._upsertTransaction(o,e,t,n,r).then((e=>{s(e),this._releaseConnection(o)})).catch((e=>{i(e),this._releaseConnection(o)}))})).catch((e=>{i(e)}))})):Promise.reject(Error("Table is not created yet"))}_get(e){return this.tableCreated?new Promise(((t,n)=>{this._getConnection().then((r=>{r.query("SELECT points, expire FROM ??.?? WHERE `key` = ? AND (`expire` > ? OR `expire` IS NULL)",[this.dbName,this.tableName,e,Date.now()],((e,s)=>{e?n(e):0===s.length?t(null):t(s),this._releaseConnection(r)}))})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?new Promise(((t,n)=>{this._getConnection().then((r=>{r.query("DELETE FROM ??.?? WHERE `key` = ?",[this.dbName,this.tableName,e],((e,s)=>{e?n(e):t(s.affectedRows>0),this._releaseConnection(r)}))})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}}e.exports=i},6308:function(e,t,n){const r=n(8627),s=n(1196);class i extends r{constructor(e,t=null){super(e),this.client=e.storeClient,this.clientType=e.storeType,this.tableName=e.tableName,this.clearExpiredByTimeout=e.clearExpiredByTimeout,this.tableCreated=e.tableCreated,this.tableCreated?"function"===typeof t&&t():this._createTable().then((()=>{this.tableCreated=!0,this.clearExpiredByTimeout&&this._clearExpiredHourAgo(),"function"===typeof t&&t()})).catch((e=>{if("function"!==typeof t)throw e;t(e)}))}clearExpired(e){return new Promise((t=>{const n={name:"rlflx-clear-expired",text:`DELETE FROM ${this.tableName} WHERE expire < $1`,values:[e]};this._query(n).then((()=>{t()})).catch((()=>{t()}))}))}_clearExpiredHourAgo(){this._clearExpiredTimeoutId&&clearTimeout(this._clearExpiredTimeoutId),this._clearExpiredTimeoutId=setTimeout((()=>{this.clearExpired(Date.now()-36e5).then((()=>{this._clearExpiredHourAgo()}))}),3e5),this._clearExpiredTimeoutId.unref()}_getConnection(){switch(this.clientType){case"pool":return Promise.resolve(this.client);case"sequelize":return this.client.connectionManager.getConnection();case"knex":return this.client.client.acquireConnection();case"typeorm":return Promise.resolve(this.client.driver.master);default:return Promise.resolve(this.client)}}_releaseConnection(e){switch(this.clientType){case"pool":return!0;case"sequelize":return this.client.connectionManager.releaseConnection(e);case"knex":return this.client.client.releaseConnection(e);case"typeorm":return!0;default:return!0}}_createTable(){return new Promise(((e,t)=>{this._query({text:this._getCreateTableStmt()}).then((()=>{e()})).catch((n=>{"23505"===n.code?e():t(n)}))}))}_getCreateTableStmt(){return`CREATE TABLE IF NOT EXISTS ${this.tableName} ( \n      key varchar(255) PRIMARY KEY,\n      points integer NOT NULL DEFAULT 0,\n      expire bigint\n    );`}get clientType(){return this._clientType}set clientType(e){const t=this.client.constructor.name;if("undefined"===typeof e)if("Client"===t)e="client";else if("Pool"===t||"BoundPool"===t)e="pool";else{if("Sequelize"!==t)throw new Error("storeType is not defined");e="sequelize"}this._clientType=e.toLowerCase()}get tableName(){return this._tableName}set tableName(e){this._tableName="undefined"===typeof e?this.keyPrefix:e}get tableCreated(){return this._tableCreated}set tableCreated(e){this._tableCreated="undefined"!==typeof e&&!!e}get clearExpiredByTimeout(){return this._clearExpiredByTimeout}set clearExpiredByTimeout(e){this._clearExpiredByTimeout="undefined"===typeof e||Boolean(e)}_getRateLimiterRes(e,t,n){const r=new s,i=n.rows[0];return r.isFirstInDuration=t===i.points,r.consumedPoints=r.isFirstInDuration?t:i.points,r.remainingPoints=Math.max(this.points-r.consumedPoints,0),r.msBeforeNext=i.expire?Math.max(i.expire-Date.now(),0):-1,r}_query(e){const t=this.tableName.toLowerCase(),n={name:`${t}:${e.name}`,text:e.text,values:e.values};return new Promise(((e,t)=>{this._getConnection().then((r=>{r.query(n).then((t=>{e(t),this._releaseConnection(r)})).catch((e=>{t(e),this._releaseConnection(r)}))})).catch((e=>{t(e)}))}))}_upsert(e,t,n,r=!1){if(!this.tableCreated)return Promise.reject(Error("Table is not created yet"));const s=n>0?Date.now()+n:null,i=r?" $3 ":` CASE\n             WHEN ${this.tableName}.expire <= $4 THEN $3\n             ELSE ${this.tableName}.expire\n            END `;return this._query({name:r?"rlflx-upsert-force":"rlflx-upsert",text:`\n            INSERT INTO ${this.tableName} VALUES ($1, $2, $3)\n              ON CONFLICT(key) DO UPDATE SET\n                points = CASE\n                          WHEN (${this.tableName}.expire <= $4 OR 1=${r?1:0}) THEN $2\n                          ELSE ${this.tableName}.points + ($2)\n                         END,\n                expire = ${i}\n            RETURNING points, expire;`,values:[e,t,s,Date.now()]})}_get(e){return this.tableCreated?new Promise(((t,n)=>{this._query({name:"rlflx-get",text:`\n            SELECT points, expire FROM ${this.tableName} WHERE key = $1 AND (expire > $2 OR expire IS NULL);`,values:[e,Date.now()]}).then((e=>{0===e.rowCount&&(e=null),t(e)})).catch((e=>{n(e)}))})):Promise.reject(Error("Table is not created yet"))}_delete(e){return this.tableCreated?this._query({name:"rlflx-delete",text:`DELETE FROM ${this.tableName} WHERE key = $1`,values:[e]}).then((e=>e.rowCount>0)):Promise.reject(Error("Table is not created yet"))}}e.exports=i},6486:function(e,t,n){n(7658),n(541);const r=n(5375),s=4294967295,i="limiter";e.exports=class{constructor(e,t={maxQueueSize:s}){this._queueLimiters={KEY_DEFAULT:new o(e,t)},this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(e=i){return this._queueLimiters[e]?this._queueLimiters[e].getTokensRemaining():Promise.resolve(this._limiterFlexible.points)}removeTokens(e,t=i){return this._queueLimiters[t]||(this._queueLimiters[t]=new o(this._limiterFlexible,{key:t,maxQueueSize:this._maxQueueSize})),this._queueLimiters[t].removeTokens(e)}};class o{constructor(e,t={maxQueueSize:s,key:i}){this._key=t.key,this._waitTimeout=null,this._queue=[],this._limiterFlexible=e,this._maxQueueSize=t.maxQueueSize}getTokensRemaining(){return this._limiterFlexible.get(this._key).then((e=>null!==e?e.remainingPoints:this._limiterFlexible.points))}removeTokens(e){const t=this;return new Promise(((n,s)=>{e>t._limiterFlexible.points?s(new r(`Requested tokens ${e} exceeds maximum ${t._limiterFlexible.points} tokens per interval`)):t._queue.length>0?t._queueRequest.call(t,n,s,e):t._limiterFlexible.consume(t._key,e).then((e=>{n(e.remainingPoints)})).catch((r=>{r instanceof Error?s(r):(t._queueRequest.call(t,n,s,e),null===t._waitTimeout&&(t._waitTimeout=setTimeout(t._processFIFO.bind(t),r.msBeforeNext)))}))}))}_queueRequest(e,t,n){const s=this;s._queue.length<s._maxQueueSize?s._queue.push({resolve:e,reject:t,tokens:n}):t(new r(`Number of requests reached it's maximum ${s._maxQueueSize}`))}_processFIFO(){const e=this;if(null!==e._waitTimeout&&(clearTimeout(e._waitTimeout),e._waitTimeout=null),0===e._queue.length)return;const t=e._queue.shift();e._limiterFlexible.consume(e._key,t.tokens).then((n=>{t.resolve(n.remainingPoints),e._processFIFO.call(e)})).catch((n=>{n instanceof Error?(t.reject(n),e._processFIFO.call(e)):(e._queue.unshift(t),null===e._waitTimeout&&(e._waitTimeout=setTimeout(e._processFIFO.bind(e),n.msBeforeNext)))}))}}},8459:function(e,t,n){const r=n(8627),s=n(1196),i="redis.call('set', KEYS[1], 0, 'EX', ARGV[2], 'NX') local consumed = redis.call('incrby', KEYS[1], ARGV[1]) local ttl = redis.call('pttl', KEYS[1]) if ttl == -1 then   redis.call('expire', KEYS[1], ARGV[2])   ttl = 1000 * ARGV[2] end return {consumed, ttl} ";class o extends r{constructor(e){super(e),e.redis?this.client=e.redis:this.client=e.storeClient,this._rejectIfRedisNotReady=!!e.rejectIfRedisNotReady,"function"===typeof this.client.defineCommand&&this.client.defineCommand("rlflxIncr",{numberOfKeys:1,lua:i})}_isRedisReady(){return!this._rejectIfRedisNotReady||(!this.client.status||"ready"===this.client.status)&&!("function"===typeof this.client.isReady&&!this.client.isReady())}_getRateLimiterRes(e,t,n){let[r,i]=n;Array.isArray(r)&&([,r]=r,[,i]=i);const o=new s;return o.consumedPoints=parseInt(r),o.isFirstInDuration=o.consumedPoints===t,o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.msBeforeNext=i,o}_upsert(e,t,n,r=!1){return new Promise(((s,o)=>{if(!this._isRedisReady())return o(new Error("Redis connection is not ready"));const a=Math.floor(n/1e3),c=this.client.multi();if(r)a>0?c.set(e,t,"EX",a):c.set(e,t),c.pttl(e).exec(((e,t)=>e?o(e):s(t)));else if(a>0){const n=function(e,t){return e?o(e):s(t)};"function"===typeof this.client.rlflxIncr?this.client.rlflxIncr(e,t,a,n):this.client.eval(i,1,e,t,a,n)}else c.incrby(e,t).pttl(e).exec(((e,t)=>e?o(e):s(t)))}))}_get(e){return new Promise(((t,n)=>{if(!this._isRedisReady())return n(new Error("Redis connection is not ready"));this.client.multi().get(e).pttl(e).exec(((e,r)=>{if(e)n(e);else{const[e]=r;if(null===e)return t(null);t(r)}}))}))}_delete(e){return new Promise(((t,n)=>{this.client.del(e,((e,r)=>{e?n(e):t(r>0)}))}))}}e.exports=o},1196:function(e){e.exports=class{constructor(e,t,n,r){this.remainingPoints="undefined"===typeof e?0:e,this.msBeforeNext="undefined"===typeof t?0:t,this.consumedPoints="undefined"===typeof n?0:n,this.isFirstInDuration="undefined"!==typeof r&&r}get msBeforeNext(){return this._msBeforeNext}set msBeforeNext(e){return this._msBeforeNext=e,this}get remainingPoints(){return this._remainingPoints}set remainingPoints(e){return this._remainingPoints=e,this}get consumedPoints(){return this._consumedPoints}set consumedPoints(e){return this._consumedPoints=e,this}get isFirstInDuration(){return this._isFirstInDuration}set isFirstInDuration(e){this._isFirstInDuration=Boolean(e)}_getDecoratedProperties(){return{remainingPoints:this.remainingPoints,msBeforeNext:this.msBeforeNext,consumedPoints:this.consumedPoints,isFirstInDuration:this.isFirstInDuration}}[Symbol.for("nodejs.util.inspect.custom")](){return this._getDecoratedProperties()}toString(){return JSON.stringify(this._getDecoratedProperties())}toJSON(){return this._getDecoratedProperties()}}},8627:function(e,t,n){const r=n(438),s=n(399),i=n(1196);e.exports=class extends r{constructor(e={}){super(e),this.inMemoryBlockOnConsumed=e.inMemoryBlockOnConsumed||e.inmemoryBlockOnConsumed,this.inMemoryBlockDuration=e.inMemoryBlockDuration||e.inmemoryBlockDuration,this.insuranceLimiter=e.insuranceLimiter,this._inMemoryBlockedKeys=new s}get client(){return this._client}set client(e){if("undefined"===typeof e)throw new Error("storeClient is not set");this._client=e}_afterConsume(e,t,n,r,s,i={}){const o=this._getRateLimiterRes(n,r,s);if(this.inMemoryBlockOnConsumed>0&&!(this.inMemoryBlockDuration>0)&&o.consumedPoints>=this.inMemoryBlockOnConsumed)return this._inMemoryBlockedKeys.addMs(n,o.msBeforeNext),o.consumedPoints>this.points?t(o):e(o);if(o.consumedPoints>this.points){let e=Promise.resolve();this.blockDuration>0&&o.consumedPoints<=this.points+r&&(o.msBeforeNext=this.msBlockDuration,e=this._block(n,o.consumedPoints,this.msBlockDuration,i)),this.inMemoryBlockOnConsumed>0&&o.consumedPoints>=this.inMemoryBlockOnConsumed&&(this._inMemoryBlockedKeys.add(n,this.inMemoryBlockDuration),o.msBeforeNext=this.msInMemoryBlockDuration),e.then((()=>{t(o)})).catch((e=>{t(e)}))}else if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let t=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));t<this.execEvenlyMinDelayMs&&(t=o.consumedPoints*this.execEvenlyMinDelayMs),setTimeout(e,t,o)}else e(o)}_handleError(e,t,n,s,i,o=!1,a={}){this.insuranceLimiter instanceof r?this.insuranceLimiter[t](i,o,a).then((e=>{n(e)})).catch((e=>{s(e)})):s(e)}get _inmemoryBlockedKeys(){return this._inMemoryBlockedKeys}getInmemoryBlockMsBeforeExpire(e){return this.getInMemoryBlockMsBeforeExpire(e)}get inmemoryBlockOnConsumed(){return this.inMemoryBlockOnConsumed}set inmemoryBlockOnConsumed(e){this.inMemoryBlockOnConsumed=e}get inmemoryBlockDuration(){return this.inMemoryBlockDuration}set inmemoryBlockDuration(e){this.inMemoryBlockDuration=e}get msInmemoryBlockDuration(){return 1e3*this.inMemoryBlockDuration}getInMemoryBlockMsBeforeExpire(e){return this.inMemoryBlockOnConsumed>0?this._inMemoryBlockedKeys.msBeforeExpire(e):0}get inMemoryBlockOnConsumed(){return this._inMemoryBlockOnConsumed}set inMemoryBlockOnConsumed(e){if(this._inMemoryBlockOnConsumed=e?parseInt(e):0,this.inMemoryBlockOnConsumed>0&&this.points>this.inMemoryBlockOnConsumed)throw new Error('inMemoryBlockOnConsumed option must be greater or equal "points" option')}get inMemoryBlockDuration(){return this._inMemoryBlockDuration}set inMemoryBlockDuration(e){if(this._inMemoryBlockDuration=e?parseInt(e):0,this.inMemoryBlockDuration>0&&0===this.inMemoryBlockOnConsumed)throw new Error("inMemoryBlockOnConsumed option must be set up")}get msInMemoryBlockDuration(){return 1e3*this._inMemoryBlockDuration}get insuranceLimiter(){return this._insuranceLimiter}set insuranceLimiter(e){if("undefined"!==typeof e&&!(e instanceof r))throw new Error("insuranceLimiter must be instance of RateLimiterAbstract");this._insuranceLimiter=e,this._insuranceLimiter&&(this._insuranceLimiter.blockDuration=this.blockDuration,this._insuranceLimiter.execEvenly=this.execEvenly)}block(e,t,n={}){const r=1e3*t;return this._block(this.getKey(e),this.points+1,r,n)}set(e,t,n,r={}){const s=1e3*(n>=0?n:this.duration);return this._block(this.getKey(e),t,s,r)}consume(e,t=1,n={}){return new Promise(((r,s)=>{const o=this.getKey(e),a=this.getInMemoryBlockMsBeforeExpire(o);if(a>0)return s(new i(0,a));this._upsert(o,t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{this._afterConsume(r,s,o,t,e)})).catch((i=>{this._handleError(i,"consume",r,s,e,t,n)}))}))}penalty(e,t=1,n={}){const r=this.getKey(e);return new Promise(((s,i)=>{this._upsert(r,t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{s(this._getRateLimiterRes(r,t,e))})).catch((r=>{this._handleError(r,"penalty",s,i,e,t,n)}))}))}reward(e,t=1,n={}){const r=this.getKey(e);return new Promise(((s,i)=>{this._upsert(r,-t,1e3*this._getKeySecDuration(n),!1,n).then((e=>{s(this._getRateLimiterRes(r,-t,e))})).catch((r=>{this._handleError(r,"reward",s,i,e,t,n)}))}))}get(e,t={}){const n=this.getKey(e);return new Promise(((r,s)=>{this._get(n,t).then((e=>{r(null===e||"undefined"===typeof e?null:this._getRateLimiterRes(n,0,e))})).catch((n=>{this._handleError(n,"get",r,s,e,t)}))}))}delete(e,t={}){const n=this.getKey(e);return new Promise(((r,s)=>{this._delete(n,t).then((e=>{this._inMemoryBlockedKeys.delete(n),r(e)})).catch((n=>{this._handleError(n,"delete",r,s,e,t)}))}))}deleteInMemoryBlockedAll(){this._inMemoryBlockedKeys.delete()}_getRateLimiterRes(e,t,n){throw new Error("You have to implement the method '_getRateLimiterRes'!")}_block(e,t,n,r={}){return new Promise(((s,o)=>{this._upsert(e,t,n,!0,r).then((()=>{s(new i(0,n>0?n:-1,t))})).catch((t=>{this._handleError(t,"block",s,o,this.parseKey(e),n/1e3,r)}))}))}_get(e,t={}){throw new Error("You have to implement the method '_get'!")}_delete(e,t={}){throw new Error("You have to implement the method '_delete'!")}_upsert(e,t,n,r=!1,s={}){throw new Error("You have to implement the method '_upsert'!")}}},4564:function(e,t,n){n(7658);const r=n(438);e.exports=class{constructor(...e){if(e.length<1)throw new Error("RateLimiterUnion: at least one limiter have to be passed");e.forEach((e=>{if(!(e instanceof r))throw new Error("RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract")})),this._limiters=e}consume(e,t=1){return new Promise(((n,r)=>{const s=[];this._limiters.forEach((n=>{s.push(n.consume(e,t).catch((e=>({rejected:!0,rej:e}))))})),Promise.all(s).then((e=>{const t={};let s=!1;e.forEach((e=>{!0===e.rejected&&(s=!0)}));for(let n=0;n<e.length;n++)s&&!0===e[n].rejected?t[this._limiters[n].keyPrefix]=e[n].rej:s||(t[this._limiters[n].keyPrefix]=e[n]);s?r(t):n(t)}))}))}}},7725:function(e){e.exports=class{constructor(){this._keys={},this._addedKeysAmount=0}collectExpired(){const e=Date.now();Object.keys(this._keys).forEach((t=>{this._keys[t]<=e&&delete this._keys[t]})),this._addedKeysAmount=Object.keys(this._keys).length}add(e,t){this.addMs(e,1e3*t)}addMs(e,t){this._keys[e]=Date.now()+t,this._addedKeysAmount++,this._addedKeysAmount>999&&this.collectExpired()}msBeforeExpire(e){const t=this._keys[e];if(t&&t>=Date.now()){this.collectExpired();const e=Date.now();return t>=e?t-e:0}return 0}delete(e){e?delete this._keys[e]:Object.keys(this._keys).forEach((e=>{delete this._keys[e]}))}}},399:function(e,t,n){const r=n(7725);e.exports=r},6163:function(e,t,n){const r=n(7404),s=n(1196);e.exports=class{constructor(){this._storage={}}incrby(e,t,n){if(this._storage[e]){const r=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return 0!==r?(this._storage[e].value=this._storage[e].value+t,new s(0,r,this._storage[e].value,!1)):this.set(e,t,n)}return this.set(e,t,n)}set(e,t,n){const i=1e3*n;return this._storage[e]&&this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),this._storage[e]=new r(t,i>0?new Date(Date.now()+i):null),i>0&&(this._storage[e].timeoutId=setTimeout((()=>{delete this._storage[e]}),i),this._storage[e].timeoutId.unref&&this._storage[e].timeoutId.unref()),new s(0,0===i?-1:i,this._storage[e].value,!0)}get(e){if(this._storage[e]){const t=this._storage[e].expiresAt?this._storage[e].expiresAt.getTime()-(new Date).getTime():-1;return new s(0,t,this._storage[e].value,!1)}return null}delete(e){return!!this._storage[e]&&(this._storage[e].timeoutId&&clearTimeout(this._storage[e].timeoutId),delete this._storage[e],!0)}}},7404:function(e){e.exports=class{constructor(e,t,n=null){this.value=e,this.expiresAt=t,this.timeoutId=n}get value(){return this._value}set value(e){this._value=parseInt(e)}get expiresAt(){return this._expiresAt}set expiresAt(e){e instanceof Date||!Number.isInteger(e)||(e=new Date(e)),this._expiresAt=e}get timeoutId(){return this._timeoutId}set timeoutId(e){this._timeoutId=e}}},5375:function(e){e.exports=class extends Error{constructor(e,t){super(),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="CustomError",this.message=e,t&&(this.extra=t)}}},3061:function(e,t,n){"use strict";n(7658),e.exports=a;var r=n(7901),s=a.prototype,i=new Date%1e9;function o(){return(1e9*Math.random()>>>0)+i++}function a(e){e=e||{},this.id=e.id||o(),this.max=e.max||1/0,this.items=e.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(e.lastModified||new Date);for(var t,n,r=this.items.length;r--;)t=this.items[r],n=new Date(t.expires)-new Date,this._lookup[t.key]=t,n>0?this.expire(t.key,n):n<=0&&this.delete(t.key)}s.has=function(e){return e in this._lookup},s.get=function(e){if(!this.has(e))return null;var t=this._lookup[e];return t.refresh&&this.expire(e,t.refresh),this.items.splice(this.items.indexOf(t),1),this.items.push(t),t.value},s.meta=function(e){if(!this.has(e))return null;var t=this._lookup[e];return"meta"in t?t.meta:null},s.set=function(e,t,n){var r=this._lookup[e],s=this._lookup[e]={key:e,value:t};return this.lastModified=new Date,r?(clearTimeout(r.timeout),this.items.splice(this.items.indexOf(r),1,s)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(s),this.size++),n&&("ttl"in n&&this.expire(e,n.ttl),"meta"in n&&(s.meta=n.meta),n.refresh&&(s.refresh=n.ttl)),this},s.delete=function(e){var t=this._lookup[e];return!!t&&(this.lastModified=new Date,this.items.splice(this.items.indexOf(t),1),clearTimeout(t.timeout),delete this._lookup[e],this.size--,this)},s.expire=function(e,t){var n=t||0,s=this._lookup[e];if(!s)return this;if("string"===typeof n&&(n=r(t)),"number"!==typeof n)throw new TypeError("Expiration time must be a string or number.");return clearTimeout(s.timeout),s.timeout=setTimeout(this.delete.bind(this,s.key),n),s.expires=Number(new Date)+n,this},s.clear=function(){for(var e=this.items.length;e--;)this.delete(this.items[e].key);return this},s.toJSON=function(){for(var e,t=new Array(this.items.length),n=t.length;n--;)e=this.items[n],t[n]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}},5431:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var r,s=function(){return Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))};function i(e,t){void 0===t&&(t={});var n=t.registrationOptions;void 0===n&&(n={}),delete t.registrationOptions;var i=function(e){var n=[],r=arguments.length-1;while(r-- >0)n[r]=arguments[r+1];t&&t[e]&&t[e].apply(t,n)};"serviceWorker"in navigator&&r.then((function(){s()?(c(e,i,n),navigator.serviceWorker.ready.then((function(e){i("ready",e)})).catch((function(e){return o(i,e)}))):(a(e,i,n),navigator.serviceWorker.ready.then((function(e){i("ready",e)})).catch((function(e){return o(i,e)})))}))}function o(e,t){navigator.onLine||e("offline"),e("error",t)}function a(e,t,n){navigator.serviceWorker.register(e,n).then((function(e){t("registered",e),e.waiting?t("updated",e):e.onupdatefound=function(){t("updatefound",e);var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?t("updated",e):t("cached",e))}}})).catch((function(e){return o(t,e)}))}function c(e,t,n){fetch(e).then((function(r){404===r.status?(t("error",new Error("Service worker not found at "+e)),l()):-1===r.headers.get("content-type").indexOf("javascript")?(t("error",new Error("Expected "+e+" to have javascript content-type, but received "+r.headers.get("content-type"))),l()):a(e,t,n)})).catch((function(e){return o(t,e)}))}function l(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){return o(emit,e)}))}"undefined"!==typeof window&&(r="undefined"!==typeof Promise?new Promise((function(e){return window.addEventListener("load",e)})):{then:function(e){return window.addEventListener("load",e)}})},3057:function(e,t,n){"use strict";const r=n(9723);class s{constructor(e,t,n){const s=this;this._started=r(),this._rescheduled=0,this._scheduled=t,this._args=n,this._triggered=!1,this._timerWrapper=()=>{s._rescheduled>0?(s._scheduled=s._rescheduled-(r()-s._started),s._schedule(s._scheduled)):(s._triggered=!0,e.apply(null,s._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);const t=r();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=r(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}}function i(){if("function"!==typeof arguments[0])throw new Error("callback needed");if("number"!==typeof arguments[1])throw new Error("timeout needed");let e;if(arguments.length>0){e=new Array(arguments.length-2);for(var t=0;t<e.length;t++)e[t]=arguments[t+2]}return new s(arguments[0],arguments[1],e)}e.exports=i},9723:function(e){"use strict";e.exports=function(){return Date.now()}},9641:function(e,t,n){
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.exports=s;const r=n(3802);function s(e,t,n){if("number"!==typeof t)throw new Error("second argument must be a Number");let s,i,o,a,c,l,u=!0;function h(e){function t(){n&&n(e,s),n=null}u?r(t):t()}function d(t,n,r){if(s[t]=r,n&&(c=!0),0===--o||n)h(n);else if(!c&&l<i){let t;a?(t=a[l],l+=1,e[t]((function(e,n){d(t,e,n)}))):(t=l,l+=1,e[t]((function(e,n){d(t,e,n)})))}}Array.isArray(e)?(s=[],o=i=e.length):(a=Object.keys(e),s={},o=i=a.length),l=t,o?a?a.some((function(n,r){return e[n]((function(e,t){d(n,e,t)})),r===t-1})):e.some((function(e,n){return e((function(e,t){d(n,e,t)})),n===t-1})):h(null),u=!1}},6779:function(e,t,n){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var r=n(5361),s=r.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return s(e,t,n)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=o),o.prototype=Object.create(s.prototype),i(s,o),o.from=function(e,t,n){if("number"===typeof e)throw new TypeError("Argument must not be a number");return s(e,t,n)},o.alloc=function(e,t,n){if("number"!==typeof e)throw new TypeError("Argument must be a number");var r=s(e);return void 0!==t?"string"===typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return s(e)},o.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},4840:function(e,t,n){"use strict";var r=n(7339),s=/[\/\?<>\\:\*\|"]/g,i=/[\x00-\x1f\x80-\x9f]/g,o=/^\.+$/,a=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,c=/[\. ]+$/;function l(e,t){if("string"!==typeof e)throw new Error("Input must be string");var n=e.replace(s,t).replace(i,t).replace(o,t).replace(a,t).replace(c,t);return r(n,255)}e.exports=function(e,t){var n=t&&t.replacement||"",r=l(e,n);return""===n?r:l(r,"")}},2407:function(e){"use strict";const t=new Map,n=()=>`${Date.now()}:${Math.floor(1e6*Math.random())}`;async function r(e,n,r){while(t.get(r)){try{await e()}catch(s){setTimeout((()=>{throw s}),1);break}if(!t.get(r))break;await new Promise((e=>{const s=setTimeout(e,n);t.set(r,s)}))}}function s(e,s,i){i=i||s;const o=n(),a=setTimeout((()=>{r(e,s,o)}),i);return t.set(o,a),o}function i(e){const n=t.get(e);n&&(clearTimeout(n),t.delete(e))}e.exports={setDelayedInterval:s,clearDelayedInterval:i}},1946:function(e,t,n){"use strict";n(7658),n(541);const r=7;function s(e,t){return e+i(t)}function i(e){let t=e;return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),16843009*(t+(t>>4)&252645135)>>24}function o(e,t){return e[0]-t[0]}function a(e){return e[1]}e.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let n=this._internalPositionFor(e,!1);if(void 0===t)-1!==n&&(this._unsetInternalPos(n),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let r=!1;-1===n?(n=this._data.length,this._setBit(e),this._changedData=!0):r=!0,this._setInternalPos(n,e,t,r),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();const t=this._internalPositionFor(e,!0);if(-1!==t)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){const e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;while(t<this.length)e(this.get(t),t,this),t++}map(e){let t=0,n=new Array(this.length);while(t<this.length)n[t]=e(this.get(t),t,this),t++;return n}reduce(e,t){let n=0,r=t;while(n<this.length){const t=this.get(n);r=e(r,t,n),n++}return r}find(e){let t,n,r=0;while(r<this.length&&!t)n=this.get(r),t=e(n),r++;return t?n:void 0}_internalPositionFor(e,t){const n=this._bytePosFor(e,t);if(n>=this._bitArrays.length)return-1;const o=this._bitArrays[n],a=e-n*r,c=(o&1<<a)>0;if(!c)return-1;const l=this._bitArrays.slice(0,n).reduce(s,0),u=~(4294967295<<a+1),h=i(o&u),d=l+h-1;return d}_bytePosFor(e,t){const n=Math.floor(e/r),s=n+1;while(!t&&this._bitArrays.length<s)this._bitArrays.push(0);return n}_setBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*r}_unsetBit(e){const t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*r)}_setInternalPos(e,t,n,r){const s=this._data,i=[t,n];if(r)this._sortData(),s[e]=i;else{if(s.length)if(s[s.length-1][0]>=t)s.push(i);else if(s[0][0]<=t)s.unshift(i);else{const e=Math.round(s.length/2);this._data=s.slice(0,e).concat(i).concat(s.slice(e))}else this._data.push(i);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(o),this._changedData=!1}bitField(){const e=[];let t,n=8,r=0,s=0;const i=this._bitArrays.slice();while(i.length||r){0===r&&(t=i.shift(),r=7);const o=Math.min(r,n),a=~(255<<o),c=t&a;s|=c<<8-n,t>>>=o,r-=o,n-=o,n&&(r||i.length)||(e.push(s),s=0,n=8)}for(var o=e.length-1;o>0;o--){const t=e[o];if(0!==t)break;e.pop()}return e}compactArray(){return this._sortData(),this._data.map(a)}}},7966:function(e){e.exports=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{while(1){const{done:e,value:n}=await t.read();if(e)return;yield n}}finally{t.releaseLock()}}();throw new Error("unknown stream")}},2856:function(e,t,n){"use strict";const{AbortController:r}=globalThis,s=n(3057);class i extends r{constructor(e){super(),this._ms=e,this._timer=s((()=>this.abort()),e),Object.setPrototypeOf(this,i.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=s((()=>this.abort()),this._ms)}}e.exports={TimeoutController:i}},7339:function(e,t,n){"use strict";var r=n(432),s=n(1725);e.exports=r.bind(null,s)},432:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e,r,s){if("string"!==typeof r)throw new Error("Input must be string");for(var i,o,a=r.length,c=0,l=0;l<a;l+=1){if(i=r.charCodeAt(l),o=r[l],t(i)&&n(r.charCodeAt(l+1))&&(l+=1,o+=r[l]),c+=e(o),c===s)return r.slice(0,l+1);if(c>s)return r.slice(0,l-o.length+1)}return r}},1725:function(e){"use strict";function t(e){return e>=55296&&e<=56319}function n(e){return e>=56320&&e<=57343}e.exports=function(e){if("string"!==typeof e)throw new Error("Input must be string");for(var r=e.length,s=0,i=null,o=null,a=0;a<r;a++)i=e.charCodeAt(a),n(i)?null!=o&&t(o)?s+=1:s+=3:i<=127?s+=1:i>=128&&i<=2047?s+=2:i>=2048&&i<=65535&&(s+=3),o=i;return s}},536:function(e,t,n){"use strict";var r;n.d(t,{Z:function(){return p}});var s=new Uint8Array(16);function i(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(s)}n(7658);var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function a(e){return"string"===typeof e&&o.test(e)}for(var c=a,l=[],u=0;u<256;++u)l.push((u+256).toString(16).substr(1));function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]).toLowerCase();if(!c(n))throw TypeError("Stringified UUID is invalid");return n}var d=h;function f(e,t,n){e=e||{};var r=e.random||(e.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var s=0;s<16;++s)t[n+s]=r[s];return t}return d(r)}var p=f},4402:function(e){e.exports=r;var t=128,n=127;function r(e,s){var i,o=0,a=(s=s||0,0),c=s,l=e.length;do{if(c>=l)throw r.bytes=0,new RangeError("Could not decode varint");i=e[c++],o+=a<28?(i&n)<<a:(i&n)*Math.pow(2,a),a+=7}while(i>=t);return r.bytes=c-s,o}},4146:function(e){e.exports=i;var t=128,n=127,r=~n,s=Math.pow(2,31);function i(e,n,o){n=n||[],o=o||0;var a=o;while(e>=s)n[o++]=255&e|t,e/=128;while(e&r)n[o++]=255&e|t,e>>>=7;return n[o]=0|e,i.bytes=o-a+1,n}},2847:function(e,t,n){e.exports={encode:n(4146),decode:n(4402),encodingLength:n(54)}},54:function(e){var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<s?4:e<i?5:e<o?6:e<a?7:e<c?8:e<l?9:10}},7691:function(e,t,n){"use strict";n(7658);const r=n(2847);e.exports=e=>{if(!(e instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const t=[];while(e.length>0){const n=r.decode(e);t.push(n),e=e.slice(r.decode.bytes)}return t}},2706:function(e){e.exports=r;var t=128,n=127;function r(e,s){var i,o=0,a=(s=s||0,0),c=s,l=e.length;do{if(c>=l||a>49)throw r.bytes=0,new RangeError("Could not decode varint");i=e[c++],o+=a<28?(i&n)<<a:(i&n)*Math.pow(2,a),a+=7}while(i>=t);return r.bytes=c-s,o}},799:function(e){e.exports=i;var t=128,n=127,r=~n,s=Math.pow(2,31);function i(e,n,o){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw i.bytes=0,new RangeError("Could not encode varint");n=n||[],o=o||0;var a=o;while(e>=s)n[o++]=255&e|t,e/=128;while(e&r)n[o++]=255&e|t,e>>>=7;return n[o]=0|e,i.bytes=o-a+1,n}},2611:function(e,t,n){e.exports={encode:n(799),decode:n(2706),encodingLength:n(3303)}},3303:function(e){var t=Math.pow(2,7),n=Math.pow(2,14),r=Math.pow(2,21),s=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),a=Math.pow(2,49),c=Math.pow(2,56),l=Math.pow(2,63);e.exports=function(e){return e<t?1:e<n?2:e<r?3:e<s?4:e<i?5:e<o?6:e<a?7:e<c?8:e<l?9:10}},5658:function(e,t,n){"use strict";n.d(t,{o:function(){return kn}});n(7658);
/*!
  * shared v9.2.2
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */
const r="undefined"!==typeof window;const s="function"===typeof Symbol&&"symbol"===typeof Symbol.toStringTag,i=e=>s?Symbol(e):e,o=(e,t,n)=>a({l:e,k:t,s:n}),a=e=>JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),c=e=>"number"===typeof e&&isFinite(e),l=e=>"[object Date]"===I(e),u=e=>"[object RegExp]"===I(e),h=e=>A(e)&&0===Object.keys(e).length;function d(e,t){"undefined"!==typeof console&&(console.warn("[intlify] "+e),t&&console.warn(t.stack))}const f=Object.assign;let p;const g=()=>p||(p="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{});function y(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const m=Object.prototype.hasOwnProperty;function w(e,t){return m.call(e,t)}const b=Array.isArray,v=e=>"function"===typeof e,_=e=>"string"===typeof e,E=e=>"boolean"===typeof e,S=e=>null!==e&&"object"===typeof e,k=Object.prototype.toString,I=e=>k.call(e),A=e=>"[object Object]"===I(e),T=e=>null==e?"":b(e)||A(e)&&e.toString===k?JSON.stringify(e,null,2):String(e);
/*!
  * message-compiler v9.2.2
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */
const R={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14,__EXTEND_POINT__:15};R.EXPECTED_TOKEN,R.INVALID_TOKEN_IN_PLACEHOLDER,R.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,R.UNKNOWN_ESCAPE_SEQUENCE,R.INVALID_UNICODE_ESCAPE_SEQUENCE,R.UNBALANCED_CLOSING_BRACE,R.UNTERMINATED_CLOSING_BRACE,R.EMPTY_PLACEHOLDER,R.NOT_ALLOW_NEST_PLACEHOLDER,R.INVALID_LINKED_FORMAT,R.MUST_HAVE_MESSAGES_IN_PLURAL,R.UNEXPECTED_EMPTY_LINKED_MODIFIER,R.UNEXPECTED_EMPTY_LINKED_KEY,R.UNEXPECTED_LEXICAL_ANALYSIS;function C(e,t,n={}){const{domain:r,messages:s,args:i}=n,o=e,a=new SyntaxError(String(o));return a.code=e,t&&(a.location=t),a.domain=r,a}function P(e){throw e}function N(e,t,n){return{line:e,column:t,offset:n}}function O(e,t,n){const r={start:e,end:t};return null!=n&&(r.source=n),r}const D=" ",L="\r",x="\n",B=String.fromCharCode(8232),M=String.fromCharCode(8233);function U(e){const t=e;let n=0,r=1,s=1,i=0;const o=e=>t[e]===L&&t[e+1]===x,a=e=>t[e]===x,c=e=>t[e]===M,l=e=>t[e]===B,u=e=>o(e)||a(e)||c(e)||l(e),h=()=>n,d=()=>r,f=()=>s,p=()=>i,g=e=>o(e)||c(e)||l(e)?x:t[e],y=()=>g(n),m=()=>g(n+i);function w(){return i=0,u(n)&&(r++,s=0),o(n)&&n++,n++,s++,t[n]}function b(){return o(n+i)&&i++,i++,t[n+i]}function v(){n=0,r=1,s=1,i=0}function _(e=0){i=e}function E(){const e=n+i;while(e!==n)w();i=0}return{index:h,line:d,column:f,peekOffset:p,charAt:g,currentChar:y,currentPeek:m,next:w,peek:b,reset:v,resetPeek:_,skipToPeek:E}}const F=void 0,j="'",V="tokenizer";function z(e,t={}){const n=!1!==t.location,r=U(e),s=()=>r.index(),i=()=>N(r.line(),r.column(),r.index()),o=i(),a=s(),c={currentType:14,offset:a,startLoc:o,endLoc:o,lastType:14,lastOffset:a,lastStartLoc:o,lastEndLoc:o,braceNest:0,inLinked:!1,text:""},l=()=>c,{onError:u}=t;function h(e,t,n,...r){const s=l();if(t.column+=n,t.offset+=n,u){const n=O(s.startLoc,t),i=C(e,n,{domain:V,args:r});u(i)}}function d(e,t,r){e.endLoc=i(),e.currentType=t;const s={type:t};return n&&(s.loc=O(e.startLoc,e.endLoc)),null!=r&&(s.value=r),s}const f=e=>d(e,14);function p(e,t){return e.currentChar()===t?(e.next(),t):(h(R.EXPECTED_TOKEN,i(),0,t),"")}function g(e){let t="";while(e.currentPeek()===D||e.currentPeek()===x)t+=e.currentPeek(),e.peek();return t}function y(e){const t=g(e);return e.skipToPeek(),t}function m(e){if(e===F)return!1;const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||95===t}function w(e){if(e===F)return!1;const t=e.charCodeAt(0);return t>=48&&t<=57}function b(e,t){const{currentType:n}=t;if(2!==n)return!1;g(e);const r=m(e.currentPeek());return e.resetPeek(),r}function v(e,t){const{currentType:n}=t;if(2!==n)return!1;g(e);const r="-"===e.currentPeek()?e.peek():e.currentPeek(),s=w(r);return e.resetPeek(),s}function _(e,t){const{currentType:n}=t;if(2!==n)return!1;g(e);const r=e.currentPeek()===j;return e.resetPeek(),r}function E(e,t){const{currentType:n}=t;if(8!==n)return!1;g(e);const r="."===e.currentPeek();return e.resetPeek(),r}function S(e,t){const{currentType:n}=t;if(9!==n)return!1;g(e);const r=m(e.currentPeek());return e.resetPeek(),r}function k(e,t){const{currentType:n}=t;if(8!==n&&12!==n)return!1;g(e);const r=":"===e.currentPeek();return e.resetPeek(),r}function I(e,t){const{currentType:n}=t;if(10!==n)return!1;const r=()=>{const t=e.currentPeek();return"{"===t?m(e.peek()):!("@"===t||"%"===t||"|"===t||":"===t||"."===t||t===D||!t)&&(t===x?(e.peek(),r()):m(t))},s=r();return e.resetPeek(),s}function A(e){g(e);const t="|"===e.currentPeek();return e.resetPeek(),t}function T(e){const t=g(e),n="%"===e.currentPeek()&&"{"===e.peek();return e.resetPeek(),{isModulo:n,hasSpace:t.length>0}}function P(e,t=!0){const n=(t=!1,r="",s=!1)=>{const i=e.currentPeek();return"{"===i?"%"!==r&&t:"@"!==i&&i?"%"===i?(e.peek(),n(t,"%",!0)):"|"===i?!("%"!==r&&!s)||!(r===D||r===x):i===D?(e.peek(),n(!0,D,s)):i!==x||(e.peek(),n(!0,x,s)):"%"===r||t},r=n();return t&&e.resetPeek(),r}function L(e,t){const n=e.currentChar();return n===F?F:t(n)?(e.next(),n):null}function B(e){const t=e=>{const t=e.charCodeAt(0);return t>=97&&t<=122||t>=65&&t<=90||t>=48&&t<=57||95===t||36===t};return L(e,t)}function M(e){const t=e=>{const t=e.charCodeAt(0);return t>=48&&t<=57};return L(e,t)}function z(e){const t=e=>{const t=e.charCodeAt(0);return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102};return L(e,t)}function $(e){let t="",n="";while(t=M(e))n+=t;return n}function K(e){y(e);const t=e.currentChar();return"%"!==t&&h(R.EXPECTED_TOKEN,i(),0,t),e.next(),"%"}function H(e){let t="";while(1){const n=e.currentChar();if("{"===n||"}"===n||"@"===n||"|"===n||!n)break;if("%"===n){if(!P(e))break;t+=n,e.next()}else if(n===D||n===x)if(P(e))t+=n,e.next();else{if(A(e))break;t+=n,e.next()}else t+=n,e.next()}return t}function q(e){y(e);let t="",n="";while(t=B(e))n+=t;return e.currentChar()===F&&h(R.UNTERMINATED_CLOSING_BRACE,i(),0),n}function W(e){y(e);let t="";return"-"===e.currentChar()?(e.next(),t+=`-${$(e)}`):t+=$(e),e.currentChar()===F&&h(R.UNTERMINATED_CLOSING_BRACE,i(),0),t}function G(e){y(e),p(e,"'");let t="",n="";const r=e=>e!==j&&e!==x;while(t=L(e,r))n+="\\"===t?Y(e):t;const s=e.currentChar();return s===x||s===F?(h(R.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,i(),0),s===x&&(e.next(),p(e,"'")),n):(p(e,"'"),n)}function Y(e){const t=e.currentChar();switch(t){case"\\":case"'":return e.next(),`\\${t}`;case"u":return Q(e,t,4);case"U":return Q(e,t,6);default:return h(R.UNKNOWN_ESCAPE_SEQUENCE,i(),0,t),""}}function Q(e,t,n){p(e,t);let r="";for(let s=0;s<n;s++){const n=z(e);if(!n){h(R.INVALID_UNICODE_ESCAPE_SEQUENCE,i(),0,`\\${t}${r}${e.currentChar()}`);break}r+=n}return`\\${t}${r}`}function X(e){y(e);let t="",n="";const r=e=>"{"!==e&&"}"!==e&&e!==D&&e!==x;while(t=L(e,r))n+=t;return n}function J(e){let t="",n="";while(t=B(e))n+=t;return n}function Z(e){const t=(n=!1,r)=>{const s=e.currentChar();return"{"!==s&&"%"!==s&&"@"!==s&&"|"!==s&&s?s===D?r:s===x?(r+=s,e.next(),t(n,r)):(r+=s,e.next(),t(!0,r)):r};return t(!1,"")}function ee(e){y(e);const t=p(e,"|");return y(e),t}function te(e,t){let n=null;const r=e.currentChar();switch(r){case"{":return t.braceNest>=1&&h(R.NOT_ALLOW_NEST_PLACEHOLDER,i(),0),e.next(),n=d(t,2,"{"),y(e),t.braceNest++,n;case"}":return t.braceNest>0&&2===t.currentType&&h(R.EMPTY_PLACEHOLDER,i(),0),e.next(),n=d(t,3,"}"),t.braceNest--,t.braceNest>0&&y(e),t.inLinked&&0===t.braceNest&&(t.inLinked=!1),n;case"@":return t.braceNest>0&&h(R.UNTERMINATED_CLOSING_BRACE,i(),0),n=ne(e,t)||f(t),t.braceNest=0,n;default:let r=!0,s=!0,o=!0;if(A(e))return t.braceNest>0&&h(R.UNTERMINATED_CLOSING_BRACE,i(),0),n=d(t,1,ee(e)),t.braceNest=0,t.inLinked=!1,n;if(t.braceNest>0&&(5===t.currentType||6===t.currentType||7===t.currentType))return h(R.UNTERMINATED_CLOSING_BRACE,i(),0),t.braceNest=0,re(e,t);if(r=b(e,t))return n=d(t,5,q(e)),y(e),n;if(s=v(e,t))return n=d(t,6,W(e)),y(e),n;if(o=_(e,t))return n=d(t,7,G(e)),y(e),n;if(!r&&!s&&!o)return n=d(t,13,X(e)),h(R.INVALID_TOKEN_IN_PLACEHOLDER,i(),0,n.value),y(e),n;break}return n}function ne(e,t){const{currentType:n}=t;let r=null;const s=e.currentChar();switch(8!==n&&9!==n&&12!==n&&10!==n||s!==x&&s!==D||h(R.INVALID_LINKED_FORMAT,i(),0),s){case"@":return e.next(),r=d(t,8,"@"),t.inLinked=!0,r;case".":return y(e),e.next(),d(t,9,".");case":":return y(e),e.next(),d(t,10,":");default:return A(e)?(r=d(t,1,ee(e)),t.braceNest=0,t.inLinked=!1,r):E(e,t)||k(e,t)?(y(e),ne(e,t)):S(e,t)?(y(e),d(t,12,J(e))):I(e,t)?(y(e),"{"===s?te(e,t)||r:d(t,11,Z(e))):(8===n&&h(R.INVALID_LINKED_FORMAT,i(),0),t.braceNest=0,t.inLinked=!1,re(e,t))}}function re(e,t){let n={type:14};if(t.braceNest>0)return te(e,t)||f(t);if(t.inLinked)return ne(e,t)||f(t);const r=e.currentChar();switch(r){case"{":return te(e,t)||f(t);case"}":return h(R.UNBALANCED_CLOSING_BRACE,i(),0),e.next(),d(t,3,"}");case"@":return ne(e,t)||f(t);default:if(A(e))return n=d(t,1,ee(e)),t.braceNest=0,t.inLinked=!1,n;const{isModulo:r,hasSpace:s}=T(e);if(r)return s?d(t,0,H(e)):d(t,4,K(e));if(P(e))return d(t,0,H(e));break}return n}function se(){const{currentType:e,offset:t,startLoc:n,endLoc:o}=c;return c.lastType=e,c.lastOffset=t,c.lastStartLoc=n,c.lastEndLoc=o,c.offset=s(),c.startLoc=i(),r.currentChar()===F?d(c,14):re(r,c)}return{nextToken:se,currentOffset:s,currentPosition:i,context:l}}const $="parser",K=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function H(e,t,n){switch(e){case"\\\\":return"\\";case"\\'":return"'";default:{const e=parseInt(t||n,16);return e<=55295||e>=57344?String.fromCodePoint(e):"�"}}}function q(e={}){const t=!1!==e.location,{onError:n}=e;function r(e,t,r,s,...i){const o=e.currentPosition();if(o.offset+=s,o.column+=s,n){const e=O(r,o),s=C(t,e,{domain:$,args:i});n(s)}}function s(e,n,r){const s={type:e,start:n,end:n};return t&&(s.loc={start:r,end:r}),s}function i(e,n,r,s){e.end=n,s&&(e.type=s),t&&e.loc&&(e.loc.end=r)}function o(e,t){const n=e.context(),r=s(3,n.offset,n.startLoc);return r.value=t,i(r,e.currentOffset(),e.currentPosition()),r}function a(e,t){const n=e.context(),{lastOffset:r,lastStartLoc:o}=n,a=s(5,r,o);return a.index=parseInt(t,10),e.nextToken(),i(a,e.currentOffset(),e.currentPosition()),a}function c(e,t){const n=e.context(),{lastOffset:r,lastStartLoc:o}=n,a=s(4,r,o);return a.key=t,e.nextToken(),i(a,e.currentOffset(),e.currentPosition()),a}function l(e,t){const n=e.context(),{lastOffset:r,lastStartLoc:o}=n,a=s(9,r,o);return a.value=t.replace(K,H),e.nextToken(),i(a,e.currentOffset(),e.currentPosition()),a}function u(e){const t=e.nextToken(),n=e.context(),{lastOffset:o,lastStartLoc:a}=n,c=s(8,o,a);return 12!==t.type?(r(e,R.UNEXPECTED_EMPTY_LINKED_MODIFIER,n.lastStartLoc,0),c.value="",i(c,o,a),{nextConsumeToken:t,node:c}):(null==t.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,n.lastStartLoc,0,W(t)),c.value=t.value||"",i(c,e.currentOffset(),e.currentPosition()),{node:c})}function h(e,t){const n=e.context(),r=s(7,n.offset,n.startLoc);return r.value=t,i(r,e.currentOffset(),e.currentPosition()),r}function d(e){const t=e.context(),n=s(6,t.offset,t.startLoc);let o=e.nextToken();if(9===o.type){const t=u(e);n.modifier=t.node,o=t.nextConsumeToken||e.nextToken()}switch(10!==o.type&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(o)),o=e.nextToken(),2===o.type&&(o=e.nextToken()),o.type){case 11:null==o.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(o)),n.key=h(e,o.value||"");break;case 5:null==o.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(o)),n.key=c(e,o.value||"");break;case 6:null==o.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(o)),n.key=a(e,o.value||"");break;case 7:null==o.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(o)),n.key=l(e,o.value||"");break;default:r(e,R.UNEXPECTED_EMPTY_LINKED_KEY,t.lastStartLoc,0);const u=e.context(),d=s(7,u.offset,u.startLoc);return d.value="",i(d,u.offset,u.startLoc),n.key=d,i(n,u.offset,u.startLoc),{nextConsumeToken:o,node:n}}return i(n,e.currentOffset(),e.currentPosition()),{node:n}}function p(e){const t=e.context(),n=1===t.currentType?e.currentOffset():t.offset,u=1===t.currentType?t.endLoc:t.startLoc,h=s(2,n,u);h.items=[];let f=null;do{const n=f||e.nextToken();switch(f=null,n.type){case 0:null==n.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(n)),h.items.push(o(e,n.value||""));break;case 6:null==n.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(n)),h.items.push(a(e,n.value||""));break;case 5:null==n.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(n)),h.items.push(c(e,n.value||""));break;case 7:null==n.value&&r(e,R.UNEXPECTED_LEXICAL_ANALYSIS,t.lastStartLoc,0,W(n)),h.items.push(l(e,n.value||""));break;case 8:const s=d(e);h.items.push(s.node),f=s.nextConsumeToken||null;break}}while(14!==t.currentType&&1!==t.currentType);const p=1===t.currentType?t.lastOffset:e.currentOffset(),g=1===t.currentType?t.lastEndLoc:e.currentPosition();return i(h,p,g),h}function g(e,t,n,o){const a=e.context();let c=0===o.items.length;const l=s(1,t,n);l.cases=[],l.cases.push(o);do{const t=p(e);c||(c=0===t.items.length),l.cases.push(t)}while(14!==a.currentType);return c&&r(e,R.MUST_HAVE_MESSAGES_IN_PLURAL,n,0),i(l,e.currentOffset(),e.currentPosition()),l}function y(e){const t=e.context(),{offset:n,startLoc:r}=t,s=p(e);return 14===t.currentType?s:g(e,n,r,s)}function m(n){const o=z(n,f({},e)),a=o.context(),c=s(0,a.offset,a.startLoc);return t&&c.loc&&(c.loc.source=n),c.body=y(o),14!==a.currentType&&r(o,R.UNEXPECTED_LEXICAL_ANALYSIS,a.lastStartLoc,0,n[a.offset]||""),i(c,o.currentOffset(),o.currentPosition()),c}return{parse:m}}function W(e){if(14===e.type)return"EOF";const t=(e.value||"").replace(/\r?\n/gu,"\\n");return t.length>10?t.slice(0,9)+"…":t}function G(e,t={}){const n={ast:e,helpers:new Set},r=()=>n,s=e=>(n.helpers.add(e),e);return{context:r,helper:s}}function Y(e,t){for(let n=0;n<e.length;n++)Q(e[n],t)}function Q(e,t){switch(e.type){case 1:Y(e.cases,t),t.helper("plural");break;case 2:Y(e.items,t);break;case 6:const n=e;Q(n.key,t),t.helper("linked"),t.helper("type");break;case 5:t.helper("interpolate"),t.helper("list");break;case 4:t.helper("interpolate"),t.helper("named");break}}function X(e,t={}){const n=G(e);n.helper("normalize"),e.body&&Q(e.body,n);const r=n.context();e.helpers=Array.from(r.helpers)}function J(e,t){const{sourceMap:n,filename:r,breakLineCode:s,needIndent:i}=t,o={source:e.loc.source,filename:r,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:s,needIndent:i,indentLevel:0},a=()=>o;function c(e,t){o.code+=e}function l(e,t=!0){const n=t?s:"";c(i?n+"  ".repeat(e):n)}function u(e=!0){const t=++o.indentLevel;e&&l(t)}function h(e=!0){const t=--o.indentLevel;e&&l(t)}function d(){l(o.indentLevel)}const f=e=>`_${e}`,p=()=>o.needIndent;return{context:a,push:c,indent:u,deindent:h,newline:d,helper:f,needIndent:p}}function Z(e,t){const{helper:n}=e;e.push(`${n("linked")}(`),re(e,t.key),t.modifier?(e.push(", "),re(e,t.modifier),e.push(", _type")):e.push(", undefined, _type"),e.push(")")}function ee(e,t){const{helper:n,needIndent:r}=e;e.push(`${n("normalize")}([`),e.indent(r());const s=t.items.length;for(let i=0;i<s;i++){if(re(e,t.items[i]),i===s-1)break;e.push(", ")}e.deindent(r()),e.push("])")}function te(e,t){const{helper:n,needIndent:r}=e;if(t.cases.length>1){e.push(`${n("plural")}([`),e.indent(r());const s=t.cases.length;for(let n=0;n<s;n++){if(re(e,t.cases[n]),n===s-1)break;e.push(", ")}e.deindent(r()),e.push("])")}}function ne(e,t){t.body?re(e,t.body):e.push("null")}function re(e,t){const{helper:n}=e;switch(t.type){case 0:ne(e,t);break;case 1:te(e,t);break;case 2:ee(e,t);break;case 6:Z(e,t);break;case 8:e.push(JSON.stringify(t.value),t);break;case 7:e.push(JSON.stringify(t.value),t);break;case 5:e.push(`${n("interpolate")}(${n("list")}(${t.index}))`,t);break;case 4:e.push(`${n("interpolate")}(${n("named")}(${JSON.stringify(t.key)}))`,t);break;case 9:e.push(JSON.stringify(t.value),t);break;case 3:e.push(JSON.stringify(t.value),t);break;default:0}}const se=(e,t={})=>{const n=_(t.mode)?t.mode:"normal",r=_(t.filename)?t.filename:"message.intl",s=!!t.sourceMap,i=null!=t.breakLineCode?t.breakLineCode:"arrow"===n?";":"\n",o=t.needIndent?t.needIndent:"arrow"!==n,a=e.helpers||[],c=J(e,{mode:n,filename:r,sourceMap:s,breakLineCode:i,needIndent:o});c.push("normal"===n?"function __msg__ (ctx) {":"(ctx) => {"),c.indent(o),a.length>0&&(c.push(`const { ${a.map((e=>`${e}: _${e}`)).join(", ")} } = ctx`),c.newline()),c.push("return "),re(c,e),c.deindent(o),c.push("}");const{code:l,map:u}=c.context();return{ast:e,code:l,map:u?u.toJSON():void 0}};function ie(e,t={}){const n=f({},t),r=q(n),s=r.parse(e);return X(s,n),se(s,n)}
/*!
  * devtools-if v9.2.2
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */
const oe={I18nInit:"i18n:init",FunctionTranslate:"function:translate"},ae=[];ae[0]={["w"]:[0],["i"]:[3,0],["["]:[4],["o"]:[7]},ae[1]={["w"]:[1],["."]:[2],["["]:[4],["o"]:[7]},ae[2]={["w"]:[2],["i"]:[3,0],["0"]:[3,0]},ae[3]={["i"]:[3,0],["0"]:[3,0],["w"]:[1,1],["."]:[2,1],["["]:[4,1],["o"]:[7,1]},ae[4]={["'"]:[5,0],['"']:[6,0],["["]:[4,2],["]"]:[1,3],["o"]:8,["l"]:[4,0]},ae[5]={["'"]:[4,0],["o"]:8,["l"]:[5,0]},ae[6]={['"']:[4,0],["o"]:8,["l"]:[6,0]};const ce=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function le(e){return ce.test(e)}function ue(e){const t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t!==n||34!==t&&39!==t?e:e.slice(1,-1)}function he(e){if(void 0===e||null===e)return"o";const t=e.charCodeAt(0);switch(t){case 91:case 93:case 46:case 34:case 39:return e;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function de(e){const t=e.trim();return("0"!==e.charAt(0)||!isNaN(parseInt(e)))&&(le(t)?ue(t):"*"+t)}function fe(e){const t=[];let n,r,s,i,o,a,c,l=-1,u=0,h=0;const d=[];function f(){const t=e[l+1];if(5===u&&"'"===t||6===u&&'"'===t)return l++,s="\\"+t,d[0](),!0}d[0]=()=>{void 0===r?r=s:r+=s},d[1]=()=>{void 0!==r&&(t.push(r),r=void 0)},d[2]=()=>{d[0](),h++},d[3]=()=>{if(h>0)h--,u=4,d[0]();else{if(h=0,void 0===r)return!1;if(r=de(r),!1===r)return!1;d[1]()}};while(null!==u)if(l++,n=e[l],"\\"!==n||!f()){if(i=he(n),c=ae[u],o=c[i]||c["l"]||8,8===o)return;if(u=o[0],void 0!==o[1]&&(a=d[o[1]],a&&(s=n,!1===a())))return;if(7===u)return t}}const pe=new Map;function ge(e,t){return S(e)?e[t]:null}function ye(e,t){if(!S(e))return null;let n=pe.get(t);if(n||(n=fe(t),n&&pe.set(t,n)),!n)return null;const r=n.length;let s=e,i=0;while(i<r){const e=s[n[i]];if(void 0===e)return null;s=e,i++}return s}const me=e=>e,we=e=>"",be="text",ve=e=>0===e.length?"":e.join(""),_e=T;function Ee(e,t){return e=Math.abs(e),2===t?e?e>1?1:0:1:e?Math.min(e,2):0}function Se(e){const t=c(e.pluralIndex)?e.pluralIndex:-1;return e.named&&(c(e.named.count)||c(e.named.n))?c(e.named.count)?e.named.count:c(e.named.n)?e.named.n:t:t}function ke(e,t){t.count||(t.count=e),t.n||(t.n=e)}function Ie(e={}){const t=e.locale,n=Se(e),r=S(e.pluralRules)&&_(t)&&v(e.pluralRules[t])?e.pluralRules[t]:Ee,s=S(e.pluralRules)&&_(t)&&v(e.pluralRules[t])?Ee:void 0,i=e=>e[r(n,e.length,s)],o=e.list||[],a=e=>o[e],l=e.named||{};c(e.pluralIndex)&&ke(n,l);const u=e=>l[e];function h(t){const n=v(e.messages)?e.messages(t):!!S(e.messages)&&e.messages[t];return n||(e.parent?e.parent.message(t):we)}const d=t=>e.modifiers?e.modifiers[t]:me,f=A(e.processor)&&v(e.processor.normalize)?e.processor.normalize:ve,p=A(e.processor)&&v(e.processor.interpolate)?e.processor.interpolate:_e,g=A(e.processor)&&_(e.processor.type)?e.processor.type:be,y=(e,...t)=>{const[n,r]=t;let s="text",i="";1===t.length?S(n)?(i=n.modifier||i,s=n.type||s):_(n)&&(i=n||i):2===t.length&&(_(n)&&(i=n||i),_(r)&&(s=r||s));let o=h(e)(m);return"vnode"===s&&b(o)&&i&&(o=o[0]),i?d(i)(o,s):o},m={["list"]:a,["named"]:u,["plural"]:i,["linked"]:y,["message"]:h,["type"]:g,["interpolate"]:p,["normalize"]:f};return m}let Ae=null;function Te(e){Ae=e}function Re(e,t,n){Ae&&Ae.emit(oe.I18nInit,{timestamp:Date.now(),i18n:e,version:t,meta:n})}const Ce=Pe(oe.FunctionTranslate);function Pe(e){return t=>Ae&&Ae.emit(e,t)}const Ne={NOT_FOUND_KEY:1,FALLBACK_TO_TRANSLATE:2,CANNOT_FORMAT_NUMBER:3,FALLBACK_TO_NUMBER_FORMAT:4,CANNOT_FORMAT_DATE:5,FALLBACK_TO_DATE_FORMAT:6,__EXTEND_POINT__:7};Ne.NOT_FOUND_KEY,Ne.FALLBACK_TO_TRANSLATE,Ne.CANNOT_FORMAT_NUMBER,Ne.FALLBACK_TO_NUMBER_FORMAT,Ne.CANNOT_FORMAT_DATE,Ne.FALLBACK_TO_DATE_FORMAT;function Oe(e,t,n){return[...new Set([n,...b(t)?t:S(t)?Object.keys(t):_(t)?[t]:[n]])]}function De(e,t,n){const r=_(n)?n:Fe,s=e;s.__localeChainCache||(s.__localeChainCache=new Map);let i=s.__localeChainCache.get(r);if(!i){i=[];let e=[n];while(b(e))e=Le(i,e,t);const o=b(t)||!A(t)?t:t["default"]?t["default"]:null;e=_(o)?[o]:o,b(e)&&Le(i,e,!1),s.__localeChainCache.set(r,i)}return i}function Le(e,t,n){let r=!0;for(let s=0;s<t.length&&E(r);s++){const i=t[s];_(i)&&(r=xe(e,t[s],n))}return r}function xe(e,t,n){let r;const s=t.split("-");do{const t=s.join("-");r=Be(e,t,n),s.splice(-1,1)}while(s.length&&!0===r);return r}function Be(e,t,n){let r=!1;if(!e.includes(t)&&(r=!0,t)){r="!"!==t[t.length-1];const s=t.replace(/!/g,"");e.push(s),(b(n)||A(n))&&n[s]&&(r=n[s])}return r}const Me="9.2.2",Ue=-1,Fe="en-US",je="",Ve=e=>`${e.charAt(0).toLocaleUpperCase()}${e.substr(1)}`;function ze(){return{upper:(e,t)=>"text"===t&&_(e)?e.toUpperCase():"vnode"===t&&S(e)&&"__v_isVNode"in e?e.children.toUpperCase():e,lower:(e,t)=>"text"===t&&_(e)?e.toLowerCase():"vnode"===t&&S(e)&&"__v_isVNode"in e?e.children.toLowerCase():e,capitalize:(e,t)=>"text"===t&&_(e)?Ve(e):"vnode"===t&&S(e)&&"__v_isVNode"in e?Ve(e.children):e}}let $e,Ke,He;function qe(e){$e=e}function We(e){Ke=e}function Ge(e){He=e}let Ye=null;const Qe=e=>{Ye=e},Xe=()=>Ye;let Je=null;const Ze=e=>{Je=e},et=()=>Je;let tt=0;function nt(e={}){const t=_(e.version)?e.version:Me,n=_(e.locale)?e.locale:Fe,r=b(e.fallbackLocale)||A(e.fallbackLocale)||_(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:n,s=A(e.messages)?e.messages:{[n]:{}},i=A(e.datetimeFormats)?e.datetimeFormats:{[n]:{}},o=A(e.numberFormats)?e.numberFormats:{[n]:{}},a=f({},e.modifiers||{},ze()),c=e.pluralRules||{},l=v(e.missing)?e.missing:null,h=!E(e.missingWarn)&&!u(e.missingWarn)||e.missingWarn,p=!E(e.fallbackWarn)&&!u(e.fallbackWarn)||e.fallbackWarn,g=!!e.fallbackFormat,y=!!e.unresolving,m=v(e.postTranslation)?e.postTranslation:null,w=A(e.processor)?e.processor:null,k=!E(e.warnHtmlMessage)||e.warnHtmlMessage,I=!!e.escapeParameter,T=v(e.messageCompiler)?e.messageCompiler:$e,R=v(e.messageResolver)?e.messageResolver:Ke||ge,C=v(e.localeFallbacker)?e.localeFallbacker:He||Oe,P=S(e.fallbackContext)?e.fallbackContext:void 0,N=v(e.onWarn)?e.onWarn:d,O=e,D=S(O.__datetimeFormatters)?O.__datetimeFormatters:new Map,L=S(O.__numberFormatters)?O.__numberFormatters:new Map,x=S(O.__meta)?O.__meta:{};tt++;const B={version:t,cid:tt,locale:n,fallbackLocale:r,messages:s,modifiers:a,pluralRules:c,missing:l,missingWarn:h,fallbackWarn:p,fallbackFormat:g,unresolving:y,postTranslation:m,processor:w,warnHtmlMessage:k,escapeParameter:I,messageCompiler:T,messageResolver:R,localeFallbacker:C,fallbackContext:P,onWarn:N,__meta:x};return B.datetimeFormats=i,B.numberFormats=o,B.__datetimeFormatters=D,B.__numberFormatters=L,__INTLIFY_PROD_DEVTOOLS__&&Re(B,t,x),B}function rt(e,t,n,r,s){const{missing:i,onWarn:o}=e;if(null!==i){const r=i(e,n,t,s);return _(r)?r:t}return t}function st(e,t,n){const r=e;r.__localeChainCache=new Map,e.localeFallbacker(e,n,t)}const it=e=>e;let ot=Object.create(null);function at(e,t={}){{const n=t.onCacheKey||it,r=n(e),s=ot[r];if(s)return s;let i=!1;const o=t.onError||P;t.onError=e=>{i=!0,o(e)};const{code:a}=ie(e,t),c=new Function(`return ${a}`)();return i?c:ot[r]=c}}let ct=R.__EXTEND_POINT__;const lt=()=>++ct,ut={INVALID_ARGUMENT:ct,INVALID_DATE_ARGUMENT:lt(),INVALID_ISO_DATE_ARGUMENT:lt(),__EXTEND_POINT__:lt()};function ht(e){return C(e,null,void 0)}ut.INVALID_ARGUMENT,ut.INVALID_DATE_ARGUMENT,ut.INVALID_ISO_DATE_ARGUMENT;const dt=()=>"",ft=e=>v(e);function pt(e,...t){const{fallbackFormat:n,postTranslation:r,unresolving:s,messageCompiler:i,fallbackLocale:o,messages:a}=e,[c,l]=bt(...t),u=E(l.missingWarn)?l.missingWarn:e.missingWarn,h=E(l.fallbackWarn)?l.fallbackWarn:e.fallbackWarn,d=E(l.escapeParameter)?l.escapeParameter:e.escapeParameter,p=!!l.resolvedMessage,g=_(l.default)||E(l.default)?E(l.default)?i?c:()=>c:l.default:n?i?c:()=>c:"",y=n||""!==g,m=_(l.locale)?l.locale:e.locale;d&&gt(l);let[w,b,v]=p?[c,m,a[m]||{}]:yt(e,c,m,o,h,u),S=w,k=c;if(p||_(S)||ft(S)||y&&(S=g,k=S),!p&&(!_(S)&&!ft(S)||!_(b)))return s?Ue:c;let I=!1;const A=()=>{I=!0},T=ft(S)?S:mt(e,c,b,S,k,A);if(I)return S;const R=_t(e,b,v,l),C=Ie(R),P=wt(e,T,C),N=r?r(P,c):P;if(__INTLIFY_PROD_DEVTOOLS__){const t={timestamp:Date.now(),key:_(c)?c:ft(S)?S.key:"",locale:b||(ft(S)?S.locale:""),format:_(S)?S:ft(S)?S.source:"",message:N};t.meta=f({},e.__meta,Xe()||{}),Ce(t)}return N}function gt(e){b(e.list)?e.list=e.list.map((e=>_(e)?y(e):e)):S(e.named)&&Object.keys(e.named).forEach((t=>{_(e.named[t])&&(e.named[t]=y(e.named[t]))}))}function yt(e,t,n,r,s,i){const{messages:o,onWarn:a,messageResolver:c,localeFallbacker:l}=e,u=l(e,r,n);let h,d={},f=null,p=n,g=null;const y="translate";for(let m=0;m<u.length;m++){h=g=u[m],d=o[h]||{};if(null===(f=c(d,t))&&(f=d[t]),_(f)||v(f))break;const n=rt(e,t,h,i,y);n!==t&&(f=n),p=g}return[f,h,d]}function mt(e,t,n,r,s,i){const{messageCompiler:o,warnHtmlMessage:a}=e;if(ft(r)){const e=r;return e.locale=e.locale||n,e.key=e.key||t,e}if(null==o){const e=()=>r;return e.locale=n,e.key=t,e}const c=o(r,vt(e,n,s,r,a,i));return c.locale=n,c.key=t,c.source=r,c}function wt(e,t,n){const r=t(n);return r}function bt(...e){const[t,n,r]=e,s={};if(!_(t)&&!c(t)&&!ft(t))throw ht(ut.INVALID_ARGUMENT);const i=c(t)?String(t):(ft(t),t);return c(n)?s.plural=n:_(n)?s.default=n:A(n)&&!h(n)?s.named=n:b(n)&&(s.list=n),c(r)?s.plural=r:_(r)?s.default=r:A(r)&&f(s,r),[i,s]}function vt(e,t,n,r,s,i){return{warnHtmlMessage:s,onError:e=>{throw i&&i(e),e},onCacheKey:e=>o(t,n,e)}}function _t(e,t,n,r){const{modifiers:s,pluralRules:i,messageResolver:o,fallbackLocale:a,fallbackWarn:l,missingWarn:u,fallbackContext:h}=e,d=r=>{let s=o(n,r);if(null==s&&h){const[,,e]=yt(h,r,t,a,l,u);s=o(e,r)}if(_(s)){let n=!1;const i=()=>{n=!0},o=mt(e,r,t,s,r,i);return n?dt:o}return ft(s)?s:dt},f={locale:t,modifiers:s,pluralRules:i,messages:d};return e.processor&&(f.processor=e.processor),r.list&&(f.list=r.list),r.named&&(f.named=r.named),c(r.plural)&&(f.pluralIndex=r.plural),f}const Et="undefined"!==typeof Intl;Et&&Intl.DateTimeFormat,Et&&Intl.NumberFormat;function St(e,...t){const{datetimeFormats:n,unresolving:r,fallbackLocale:s,onWarn:i,localeFallbacker:o}=e,{__datetimeFormatters:a}=e;const[c,l,u,d]=It(...t),p=E(u.missingWarn)?u.missingWarn:e.missingWarn,g=(E(u.fallbackWarn)?u.fallbackWarn:e.fallbackWarn,!!u.part),y=_(u.locale)?u.locale:e.locale,m=o(e,s,y);if(!_(c)||""===c)return new Intl.DateTimeFormat(y,d).format(l);let w,b={},v=null,S=y,k=null;const I="datetime format";for(let h=0;h<m.length;h++){if(w=k=m[h],b=n[w]||{},v=b[c],A(v))break;rt(e,c,w,p,I),S=k}if(!A(v)||!_(w))return r?Ue:c;let T=`${w}__${c}`;h(d)||(T=`${T}__${JSON.stringify(d)}`);let R=a.get(T);return R||(R=new Intl.DateTimeFormat(w,f({},v,d)),a.set(T,R)),g?R.formatToParts(l):R.format(l)}const kt=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function It(...e){const[t,n,r,s]=e,i={};let o,a={};if(_(t)){const e=t.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!e)throw ht(ut.INVALID_ISO_DATE_ARGUMENT);const n=e[3]?e[3].trim().startsWith("T")?`${e[1].trim()}${e[3].trim()}`:`${e[1].trim()}T${e[3].trim()}`:e[1].trim();o=new Date(n);try{o.toISOString()}catch(u){throw ht(ut.INVALID_ISO_DATE_ARGUMENT)}}else if(l(t)){if(isNaN(t.getTime()))throw ht(ut.INVALID_DATE_ARGUMENT);o=t}else{if(!c(t))throw ht(ut.INVALID_ARGUMENT);o=t}return _(n)?i.key=n:A(n)&&Object.keys(n).forEach((e=>{kt.includes(e)?a[e]=n[e]:i[e]=n[e]})),_(r)?i.locale=r:A(r)&&(a=r),A(s)&&(a=s),[i.key||"",o,i,a]}function At(e,t,n){const r=e;for(const s in n){const e=`${t}__${s}`;r.__datetimeFormatters.has(e)&&r.__datetimeFormatters.delete(e)}}function Tt(e,...t){const{numberFormats:n,unresolving:r,fallbackLocale:s,onWarn:i,localeFallbacker:o}=e,{__numberFormatters:a}=e;const[c,l,u,d]=Ct(...t),p=E(u.missingWarn)?u.missingWarn:e.missingWarn,g=(E(u.fallbackWarn)?u.fallbackWarn:e.fallbackWarn,!!u.part),y=_(u.locale)?u.locale:e.locale,m=o(e,s,y);if(!_(c)||""===c)return new Intl.NumberFormat(y,d).format(l);let w,b={},v=null,S=y,k=null;const I="number format";for(let h=0;h<m.length;h++){if(w=k=m[h],b=n[w]||{},v=b[c],A(v))break;rt(e,c,w,p,I),S=k}if(!A(v)||!_(w))return r?Ue:c;let T=`${w}__${c}`;h(d)||(T=`${T}__${JSON.stringify(d)}`);let R=a.get(T);return R||(R=new Intl.NumberFormat(w,f({},v,d)),a.set(T,R)),g?R.formatToParts(l):R.format(l)}const Rt=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function Ct(...e){const[t,n,r,s]=e,i={};let o={};if(!c(t))throw ht(ut.INVALID_ARGUMENT);const a=t;return _(n)?i.key=n:A(n)&&Object.keys(n).forEach((e=>{Rt.includes(e)?o[e]=n[e]:i[e]=n[e]})),_(r)?i.locale=r:A(r)&&(o=r),A(s)&&(o=s),[i.key||"",a,i,o]}function Pt(e,t,n){const r=e;for(const s in n){const e=`${t}__${s}`;r.__numberFormatters.has(e)&&r.__numberFormatters.delete(e)}}"boolean"!==typeof __INTLIFY_PROD_DEVTOOLS__&&(g().__INTLIFY_PROD_DEVTOOLS__=!1);var Nt=n(3396),Ot=n(4870);
/*!
  * vue-i18n v9.2.2
  * (c) 2022 kazuya kawaguchi
  * Released under the MIT License.
  */
const Dt="9.2.2";function Lt(){let e=!1;"boolean"!==typeof __VUE_I18N_FULL_INSTALL__&&(e=!0,g().__VUE_I18N_FULL_INSTALL__=!0),"boolean"!==typeof __VUE_I18N_LEGACY_API__&&(e=!0,g().__VUE_I18N_LEGACY_API__=!0),"boolean"!==typeof __INTLIFY_PROD_DEVTOOLS__&&(g().__INTLIFY_PROD_DEVTOOLS__=!1)}let xt=Ne.__EXTEND_POINT__;const Bt=()=>++xt,Mt={FALLBACK_TO_ROOT:xt,NOT_SUPPORTED_PRESERVE:Bt(),NOT_SUPPORTED_FORMATTER:Bt(),NOT_SUPPORTED_PRESERVE_DIRECTIVE:Bt(),NOT_SUPPORTED_GET_CHOICE_INDEX:Bt(),COMPONENT_NAME_LEGACY_COMPATIBLE:Bt(),NOT_FOUND_PARENT_SCOPE:Bt()};Mt.FALLBACK_TO_ROOT,Mt.NOT_SUPPORTED_PRESERVE,Mt.NOT_SUPPORTED_FORMATTER,Mt.NOT_SUPPORTED_PRESERVE_DIRECTIVE,Mt.NOT_SUPPORTED_GET_CHOICE_INDEX,Mt.COMPONENT_NAME_LEGACY_COMPATIBLE,Mt.NOT_FOUND_PARENT_SCOPE;let Ut=R.__EXTEND_POINT__;const Ft=()=>++Ut,jt={UNEXPECTED_RETURN_TYPE:Ut,INVALID_ARGUMENT:Ft(),MUST_BE_CALL_SETUP_TOP:Ft(),NOT_INSLALLED:Ft(),NOT_AVAILABLE_IN_LEGACY_MODE:Ft(),REQUIRED_VALUE:Ft(),INVALID_VALUE:Ft(),CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN:Ft(),NOT_INSLALLED_WITH_PROVIDE:Ft(),UNEXPECTED_ERROR:Ft(),NOT_COMPATIBLE_LEGACY_VUE_I18N:Ft(),BRIDGE_SUPPORT_VUE_2_ONLY:Ft(),MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION:Ft(),NOT_AVAILABLE_COMPOSITION_IN_LEGACY:Ft(),__EXTEND_POINT__:Ft()};function Vt(e,...t){return C(e,null,void 0)}jt.UNEXPECTED_RETURN_TYPE,jt.INVALID_ARGUMENT,jt.MUST_BE_CALL_SETUP_TOP,jt.NOT_INSLALLED,jt.UNEXPECTED_ERROR,jt.NOT_AVAILABLE_IN_LEGACY_MODE,jt.REQUIRED_VALUE,jt.INVALID_VALUE,jt.CANNOT_SETUP_VUE_DEVTOOLS_PLUGIN,jt.NOT_INSLALLED_WITH_PROVIDE,jt.NOT_COMPATIBLE_LEGACY_VUE_I18N,jt.BRIDGE_SUPPORT_VUE_2_ONLY,jt.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION,jt.NOT_AVAILABLE_COMPOSITION_IN_LEGACY;const zt=i("__transrateVNode"),$t=i("__datetimeParts"),Kt=i("__numberParts"),Ht=i("__setPluralRules");i("__intlifyMeta");const qt=i("__injectWithOption");function Wt(e){if(!S(e))return e;for(const t in e)if(w(e,t))if(t.includes(".")){const n=t.split("."),r=n.length-1;let s=e;for(let e=0;e<r;e++)n[e]in s||(s[n[e]]={}),s=s[n[e]];s[n[r]]=e[t],delete e[t],S(s[n[r]])&&Wt(s[n[r]])}else S(e[t])&&Wt(e[t]);return e}function Gt(e,t){const{messages:n,__i18n:r,messageResolver:s,flatJson:i}=t,o=A(n)?n:b(r)?{}:{[e]:{}};if(b(r)&&r.forEach((e=>{if("locale"in e&&"resource"in e){const{locale:t,resource:n}=e;t?(o[t]=o[t]||{},Qt(n,o[t])):Qt(n,o)}else _(e)&&Qt(JSON.parse(e),o)})),null==s&&i)for(const a in o)w(o,a)&&Wt(o[a]);return o}const Yt=e=>!S(e)||b(e);function Qt(e,t){if(Yt(e)||Yt(t))throw Vt(jt.INVALID_VALUE);for(const n in e)w(e,n)&&(Yt(e[n])||Yt(t[n])?t[n]=e[n]:Qt(e[n],t[n]))}function Xt(e){return e.type}function Jt(e,t,n){let r=S(t.messages)?t.messages:{};"__i18nGlobal"in n&&(r=Gt(e.locale.value,{messages:r,__i18n:n.__i18nGlobal}));const s=Object.keys(r);if(s.length&&s.forEach((t=>{e.mergeLocaleMessage(t,r[t])})),S(t.datetimeFormats)){const n=Object.keys(t.datetimeFormats);n.length&&n.forEach((n=>{e.mergeDateTimeFormat(n,t.datetimeFormats[n])}))}if(S(t.numberFormats)){const n=Object.keys(t.numberFormats);n.length&&n.forEach((n=>{e.mergeNumberFormat(n,t.numberFormats[n])}))}}function Zt(e){return(0,Nt.Wm)(Nt.xv,null,e,0)}const en="__INTLIFY_META__";let tn=0;function nn(e){return(t,n,r,s)=>e(n,r,(0,Nt.FN)()||void 0,s)}const rn=()=>{const e=(0,Nt.FN)();let t=null;return e&&(t=Xt(e)[en])?{[en]:t}:null};function sn(e={},t){const{__root:n}=e,s=void 0===n;let i=!E(e.inheritLocale)||e.inheritLocale;const o=(0,Ot.iH)(n&&i?n.locale.value:_(e.locale)?e.locale:Fe),a=(0,Ot.iH)(n&&i?n.fallbackLocale.value:_(e.fallbackLocale)||b(e.fallbackLocale)||A(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:o.value),l=(0,Ot.iH)(Gt(o.value,e)),h=(0,Ot.iH)(A(e.datetimeFormats)?e.datetimeFormats:{[o.value]:{}}),d=(0,Ot.iH)(A(e.numberFormats)?e.numberFormats:{[o.value]:{}});let p=n?n.missingWarn:!E(e.missingWarn)&&!u(e.missingWarn)||e.missingWarn,g=n?n.fallbackWarn:!E(e.fallbackWarn)&&!u(e.fallbackWarn)||e.fallbackWarn,y=n?n.fallbackRoot:!E(e.fallbackRoot)||e.fallbackRoot,m=!!e.fallbackFormat,w=v(e.missing)?e.missing:null,k=v(e.missing)?nn(e.missing):null,I=v(e.postTranslation)?e.postTranslation:null,T=n?n.warnHtmlMessage:!E(e.warnHtmlMessage)||e.warnHtmlMessage,R=!!e.escapeParameter;const C=n?n.modifiers:A(e.modifiers)?e.modifiers:{};let P,N=e.pluralRules||n&&n.pluralRules;const O=()=>{s&&Ze(null);const t={version:Dt,locale:o.value,fallbackLocale:a.value,messages:l.value,modifiers:C,pluralRules:N,missing:null===k?void 0:k,missingWarn:p,fallbackWarn:g,fallbackFormat:m,unresolving:!0,postTranslation:null===I?void 0:I,warnHtmlMessage:T,escapeParameter:R,messageResolver:e.messageResolver,__meta:{framework:"vue"}};t.datetimeFormats=h.value,t.numberFormats=d.value,t.__datetimeFormatters=A(P)?P.__datetimeFormatters:void 0,t.__numberFormatters=A(P)?P.__numberFormatters:void 0;const n=nt(t);return s&&Ze(n),n};function D(){return[o.value,a.value,l.value,h.value,d.value]}P=O(),st(P,o.value,a.value);const L=(0,Nt.Fl)({get:()=>o.value,set:e=>{o.value=e,P.locale=o.value}}),x=(0,Nt.Fl)({get:()=>a.value,set:e=>{a.value=e,P.fallbackLocale=a.value,st(P,o.value,e)}}),B=(0,Nt.Fl)((()=>l.value)),M=(0,Nt.Fl)((()=>h.value)),U=(0,Nt.Fl)((()=>d.value));function F(){return v(I)?I:null}function j(e){I=e,P.postTranslation=e}function V(){return w}function z(e){null!==e&&(k=nn(e)),w=e,P.missing=k}const $=(e,t,r,i,o,a)=>{let l;if(D(),__INTLIFY_PROD_DEVTOOLS__)try{Qe(rn()),s||(P.fallbackContext=n?et():void 0),l=e(P)}finally{Qe(null),s||(P.fallbackContext=void 0)}else l=e(P);if(c(l)&&l===Ue){const[e,r]=t();return n&&y?i(n):o(e)}if(a(l))return l;throw Vt(jt.UNEXPECTED_RETURN_TYPE)};function K(...e){return $((t=>Reflect.apply(pt,null,[t,...e])),(()=>bt(...e)),"translate",(t=>Reflect.apply(t.t,t,[...e])),(e=>e),(e=>_(e)))}function H(...e){const[t,n,r]=e;if(r&&!S(r))throw Vt(jt.INVALID_ARGUMENT);return K(t,n,f({resolvedMessage:!0},r||{}))}function q(...e){return $((t=>Reflect.apply(St,null,[t,...e])),(()=>It(...e)),"datetime format",(t=>Reflect.apply(t.d,t,[...e])),(()=>je),(e=>_(e)))}function W(...e){return $((t=>Reflect.apply(Tt,null,[t,...e])),(()=>Ct(...e)),"number format",(t=>Reflect.apply(t.n,t,[...e])),(()=>je),(e=>_(e)))}function G(e){return e.map((e=>_(e)||c(e)||E(e)?Zt(String(e)):e))}const Y=e=>e,Q={normalize:G,interpolate:Y,type:"vnode"};function X(...e){return $((t=>{let n;const r=t;try{r.processor=Q,n=Reflect.apply(pt,null,[r,...e])}finally{r.processor=null}return n}),(()=>bt(...e)),"translate",(t=>t[zt](...e)),(e=>[Zt(e)]),(e=>b(e)))}function J(...e){return $((t=>Reflect.apply(Tt,null,[t,...e])),(()=>Ct(...e)),"number format",(t=>t[Kt](...e)),(()=>[]),(e=>_(e)||b(e)))}function Z(...e){return $((t=>Reflect.apply(St,null,[t,...e])),(()=>It(...e)),"datetime format",(t=>t[$t](...e)),(()=>[]),(e=>_(e)||b(e)))}function ee(e){N=e,P.pluralRules=N}function te(e,t){const n=_(t)?t:o.value,r=se(n);return null!==P.messageResolver(r,e)}function ne(e){let t=null;const n=De(P,a.value,o.value);for(let r=0;r<n.length;r++){const s=l.value[n[r]]||{},i=P.messageResolver(s,e);if(null!=i){t=i;break}}return t}function re(e){const t=ne(e);return null!=t?t:n&&n.tm(e)||{}}function se(e){return l.value[e]||{}}function ie(e,t){l.value[e]=t,P.messages=l.value}function oe(e,t){l.value[e]=l.value[e]||{},Qt(t,l.value[e]),P.messages=l.value}function ae(e){return h.value[e]||{}}function ce(e,t){h.value[e]=t,P.datetimeFormats=h.value,At(P,e,t)}function le(e,t){h.value[e]=f(h.value[e]||{},t),P.datetimeFormats=h.value,At(P,e,t)}function ue(e){return d.value[e]||{}}function he(e,t){d.value[e]=t,P.numberFormats=d.value,Pt(P,e,t)}function de(e,t){d.value[e]=f(d.value[e]||{},t),P.numberFormats=d.value,Pt(P,e,t)}tn++,n&&r&&((0,Nt.YP)(n.locale,(e=>{i&&(o.value=e,P.locale=e,st(P,o.value,a.value))})),(0,Nt.YP)(n.fallbackLocale,(e=>{i&&(a.value=e,P.fallbackLocale=e,st(P,o.value,a.value))})));const fe={id:tn,locale:L,fallbackLocale:x,get inheritLocale(){return i},set inheritLocale(e){i=e,e&&n&&(o.value=n.locale.value,a.value=n.fallbackLocale.value,st(P,o.value,a.value))},get availableLocales(){return Object.keys(l.value).sort()},messages:B,get modifiers(){return C},get pluralRules(){return N||{}},get isGlobal(){return s},get missingWarn(){return p},set missingWarn(e){p=e,P.missingWarn=p},get fallbackWarn(){return g},set fallbackWarn(e){g=e,P.fallbackWarn=g},get fallbackRoot(){return y},set fallbackRoot(e){y=e},get fallbackFormat(){return m},set fallbackFormat(e){m=e,P.fallbackFormat=m},get warnHtmlMessage(){return T},set warnHtmlMessage(e){T=e,P.warnHtmlMessage=e},get escapeParameter(){return R},set escapeParameter(e){R=e,P.escapeParameter=e},t:K,getLocaleMessage:se,setLocaleMessage:ie,mergeLocaleMessage:oe,getPostTranslationHandler:F,setPostTranslationHandler:j,getMissingHandler:V,setMissingHandler:z,[Ht]:ee};return fe.datetimeFormats=M,fe.numberFormats=U,fe.rt=H,fe.te=te,fe.tm=re,fe.d=q,fe.n=W,fe.getDateTimeFormat=ae,fe.setDateTimeFormat=ce,fe.mergeDateTimeFormat=le,fe.getNumberFormat=ue,fe.setNumberFormat=he,fe.mergeNumberFormat=de,fe[qt]=e.__injectWithOption,fe[zt]=X,fe[$t]=Z,fe[Kt]=J,fe}function on(e){const t=_(e.locale)?e.locale:Fe,n=_(e.fallbackLocale)||b(e.fallbackLocale)||A(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:t,r=v(e.missing)?e.missing:void 0,s=!E(e.silentTranslationWarn)&&!u(e.silentTranslationWarn)||!e.silentTranslationWarn,i=!E(e.silentFallbackWarn)&&!u(e.silentFallbackWarn)||!e.silentFallbackWarn,o=!E(e.fallbackRoot)||e.fallbackRoot,a=!!e.formatFallbackMessages,c=A(e.modifiers)?e.modifiers:{},l=e.pluralizationRules,h=v(e.postTranslation)?e.postTranslation:void 0,d=!_(e.warnHtmlInMessage)||"off"!==e.warnHtmlInMessage,p=!!e.escapeParameterHtml,g=!E(e.sync)||e.sync;let y=e.messages;if(A(e.sharedMessages)){const t=e.sharedMessages,n=Object.keys(t);y=n.reduce(((e,n)=>{const r=e[n]||(e[n]={});return f(r,t[n]),e}),y||{})}const{__i18n:m,__root:w,__injectWithOption:S}=e,k=e.datetimeFormats,I=e.numberFormats,T=e.flatJson;return{locale:t,fallbackLocale:n,messages:y,flatJson:T,datetimeFormats:k,numberFormats:I,missing:r,missingWarn:s,fallbackWarn:i,fallbackRoot:o,fallbackFormat:a,modifiers:c,pluralRules:l,postTranslation:h,warnHtmlMessage:d,escapeParameter:p,messageResolver:e.messageResolver,inheritLocale:g,__i18n:m,__root:w,__injectWithOption:S}}function an(e={},t){{const t=sn(on(e)),n={id:t.id,get locale(){return t.locale.value},set locale(e){t.locale.value=e},get fallbackLocale(){return t.fallbackLocale.value},set fallbackLocale(e){t.fallbackLocale.value=e},get messages(){return t.messages.value},get datetimeFormats(){return t.datetimeFormats.value},get numberFormats(){return t.numberFormats.value},get availableLocales(){return t.availableLocales},get formatter(){return{interpolate(){return[]}}},set formatter(e){},get missing(){return t.getMissingHandler()},set missing(e){t.setMissingHandler(e)},get silentTranslationWarn(){return E(t.missingWarn)?!t.missingWarn:t.missingWarn},set silentTranslationWarn(e){t.missingWarn=E(e)?!e:e},get silentFallbackWarn(){return E(t.fallbackWarn)?!t.fallbackWarn:t.fallbackWarn},set silentFallbackWarn(e){t.fallbackWarn=E(e)?!e:e},get modifiers(){return t.modifiers},get formatFallbackMessages(){return t.fallbackFormat},set formatFallbackMessages(e){t.fallbackFormat=e},get postTranslation(){return t.getPostTranslationHandler()},set postTranslation(e){t.setPostTranslationHandler(e)},get sync(){return t.inheritLocale},set sync(e){t.inheritLocale=e},get warnHtmlInMessage(){return t.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(e){t.warnHtmlMessage="off"!==e},get escapeParameterHtml(){return t.escapeParameter},set escapeParameterHtml(e){t.escapeParameter=e},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(e){},get pluralizationRules(){return t.pluralRules||{}},__composer:t,t(...e){const[n,r,s]=e,i={};let o=null,a=null;if(!_(n))throw Vt(jt.INVALID_ARGUMENT);const c=n;return _(r)?i.locale=r:b(r)?o=r:A(r)&&(a=r),b(s)?o=s:A(s)&&(a=s),Reflect.apply(t.t,t,[c,o||a||{},i])},rt(...e){return Reflect.apply(t.rt,t,[...e])},tc(...e){const[n,r,s]=e,i={plural:1};let o=null,a=null;if(!_(n))throw Vt(jt.INVALID_ARGUMENT);const l=n;return _(r)?i.locale=r:c(r)?i.plural=r:b(r)?o=r:A(r)&&(a=r),_(s)?i.locale=s:b(s)?o=s:A(s)&&(a=s),Reflect.apply(t.t,t,[l,o||a||{},i])},te(e,n){return t.te(e,n)},tm(e){return t.tm(e)},getLocaleMessage(e){return t.getLocaleMessage(e)},setLocaleMessage(e,n){t.setLocaleMessage(e,n)},mergeLocaleMessage(e,n){t.mergeLocaleMessage(e,n)},d(...e){return Reflect.apply(t.d,t,[...e])},getDateTimeFormat(e){return t.getDateTimeFormat(e)},setDateTimeFormat(e,n){t.setDateTimeFormat(e,n)},mergeDateTimeFormat(e,n){t.mergeDateTimeFormat(e,n)},n(...e){return Reflect.apply(t.n,t,[...e])},getNumberFormat(e){return t.getNumberFormat(e)},setNumberFormat(e,n){t.setNumberFormat(e,n)},mergeNumberFormat(e,n){t.mergeNumberFormat(e,n)},getChoiceIndex(e,t){return-1},__onComponentInstanceCreated(t){const{componentInstanceCreatedListener:r}=e;r&&r(t,n)}};return n}}const cn={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:e=>"parent"===e||"global"===e,default:"parent"},i18n:{type:Object}};function ln({slots:e},t){if(1===t.length&&"default"===t[0]){const t=e.default?e.default():[];return t.reduce(((e,t)=>[...e,...b(t.children)?t.children:[t]]),[])}return t.reduce(((t,n)=>{const r=e[n];return r&&(t[n]=r()),t}),{})}function un(e){return Nt.HY}const hn={name:"i18n-t",props:f({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:e=>c(e)||!isNaN(e)}},cn),setup(e,t){const{slots:n,attrs:r}=t,s=e.i18n||In({useScope:e.scope,__useComponent:!0});return()=>{const i=Object.keys(n).filter((e=>"_"!==e)),o={};e.locale&&(o.locale=e.locale),void 0!==e.plural&&(o.plural=_(e.plural)?+e.plural:e.plural);const a=ln(t,i),c=s[zt](e.keypath,a,o),l=f({},r),u=_(e.tag)||S(e.tag)?e.tag:un();return(0,Nt.h)(u,l,c)}}};function dn(e){return b(e)&&!_(e[0])}function fn(e,t,n,r){const{slots:s,attrs:i}=t;return()=>{const t={part:!0};let o={};e.locale&&(t.locale=e.locale),_(e.format)?t.key=e.format:S(e.format)&&(_(e.format.key)&&(t.key=e.format.key),o=Object.keys(e.format).reduce(((t,r)=>n.includes(r)?f({},t,{[r]:e.format[r]}):t),{}));const a=r(e.value,t,o);let c=[t.key];b(a)?c=a.map(((e,t)=>{const n=s[e.type],r=n?n({[e.type]:e.value,index:t,parts:a}):[e.value];return dn(r)&&(r[0].key=`${e.type}-${t}`),r})):_(a)&&(c=[a]);const l=f({},i),u=_(e.tag)||S(e.tag)?e.tag:un();return(0,Nt.h)(u,l,c)}}const pn={name:"i18n-n",props:f({value:{type:Number,required:!0},format:{type:[String,Object]}},cn),setup(e,t){const n=e.i18n||In({useScope:"parent",__useComponent:!0});return fn(e,t,Rt,((...e)=>n[Kt](...e)))}},gn={name:"i18n-d",props:f({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},cn),setup(e,t){const n=e.i18n||In({useScope:"parent",__useComponent:!0});return fn(e,t,kt,((...e)=>n[$t](...e)))}};function yn(e,t){const n=e;if("composition"===e.mode)return n.__getInstance(t)||e.global;{const r=n.__getInstance(t);return null!=r?r.__composer:e.global.__composer}}function mn(e){const t=t=>{const{instance:n,modifiers:r,value:s}=t;if(!n||!n.$)throw Vt(jt.UNEXPECTED_ERROR);const i=yn(e,n.$);const o=wn(s);return[Reflect.apply(i.t,i,[...bn(o)]),i]},n=(n,s)=>{const[i,o]=t(s);r&&e.global===o&&(n.__i18nWatcher=(0,Nt.YP)(o.locale,(()=>{s.instance&&s.instance.$forceUpdate()}))),n.__composer=o,n.textContent=i},s=e=>{r&&e.__i18nWatcher&&(e.__i18nWatcher(),e.__i18nWatcher=void 0,delete e.__i18nWatcher),e.__composer&&(e.__composer=void 0,delete e.__composer)},i=(e,{value:t})=>{if(e.__composer){const n=e.__composer,r=wn(t);e.textContent=Reflect.apply(n.t,n,[...bn(r)])}},o=e=>{const[n]=t(e);return{textContent:n}};return{created:n,unmounted:s,beforeUpdate:i,getSSRProps:o}}function wn(e){if(_(e))return{path:e};if(A(e)){if(!("path"in e))throw Vt(jt.REQUIRED_VALUE,"path");return e}throw Vt(jt.INVALID_VALUE)}function bn(e){const{path:t,locale:n,args:r,choice:s,plural:i}=e,o={},a=r||{};return _(n)&&(o.locale=n),c(s)&&(o.plural=s),c(i)&&(o.plural=i),[t,a,o]}function vn(e,t,...n){const r=A(n[0])?n[0]:{},s=!!r.useI18nComponentName,i=!E(r.globalInstall)||r.globalInstall;i&&(e.component(s?"i18n":hn.name,hn),e.component(pn.name,pn),e.component(gn.name,gn)),e.directive("t",mn(t))}function _n(e,t,n){return{beforeCreate(){const r=(0,Nt.FN)();if(!r)throw Vt(jt.UNEXPECTED_ERROR);const s=this.$options;if(s.i18n){const n=s.i18n;s.__i18n&&(n.__i18n=s.__i18n),n.__root=t,this===this.$root?this.$i18n=En(e,n):(n.__injectWithOption=!0,this.$i18n=an(n))}else s.__i18n?this===this.$root?this.$i18n=En(e,s):this.$i18n=an({__i18n:s.__i18n,__injectWithOption:!0,__root:t}):this.$i18n=e;s.__i18nGlobal&&Jt(t,s,s),e.__onComponentInstanceCreated(this.$i18n),n.__setInstance(r,this.$i18n),this.$t=(...e)=>this.$i18n.t(...e),this.$rt=(...e)=>this.$i18n.rt(...e),this.$tc=(...e)=>this.$i18n.tc(...e),this.$te=(e,t)=>this.$i18n.te(e,t),this.$d=(...e)=>this.$i18n.d(...e),this.$n=(...e)=>this.$i18n.n(...e),this.$tm=e=>this.$i18n.tm(e)},mounted(){0},unmounted(){const e=(0,Nt.FN)();if(!e)throw Vt(jt.UNEXPECTED_ERROR);delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,n.__deleteInstance(e),delete this.$i18n}}}function En(e,t){e.locale=t.locale||e.locale,e.fallbackLocale=t.fallbackLocale||e.fallbackLocale,e.missing=t.missing||e.missing,e.silentTranslationWarn=t.silentTranslationWarn||e.silentFallbackWarn,e.silentFallbackWarn=t.silentFallbackWarn||e.silentFallbackWarn,e.formatFallbackMessages=t.formatFallbackMessages||e.formatFallbackMessages,e.postTranslation=t.postTranslation||e.postTranslation,e.warnHtmlInMessage=t.warnHtmlInMessage||e.warnHtmlInMessage,e.escapeParameterHtml=t.escapeParameterHtml||e.escapeParameterHtml,e.sync=t.sync||e.sync,e.__composer[Ht](t.pluralizationRules||e.pluralizationRules);const n=Gt(e.locale,{messages:t.messages,__i18n:t.__i18n});return Object.keys(n).forEach((t=>e.mergeLocaleMessage(t,n[t]))),t.datetimeFormats&&Object.keys(t.datetimeFormats).forEach((n=>e.mergeDateTimeFormat(n,t.datetimeFormats[n]))),t.numberFormats&&Object.keys(t.numberFormats).forEach((n=>e.mergeNumberFormat(n,t.numberFormats[n]))),e}const Sn=i("global-vue-i18n");function kn(e={},t){const n=__VUE_I18N_LEGACY_API__&&E(e.legacy)?e.legacy:__VUE_I18N_LEGACY_API__,r=!E(e.globalInjection)||e.globalInjection,s=!__VUE_I18N_LEGACY_API__||!n||!!e.allowComposition,o=new Map,[a,c]=An(e,n),l=i("");function u(e){return o.get(e)||null}function h(e,t){o.set(e,t)}function d(e){o.delete(e)}{const e={get mode(){return __VUE_I18N_LEGACY_API__&&n?"legacy":"composition"},get allowComposition(){return s},async install(t,...s){t.__VUE_I18N_SYMBOL__=l,t.provide(t.__VUE_I18N_SYMBOL__,e),!n&&r&&xn(t,e.global),__VUE_I18N_FULL_INSTALL__&&vn(t,e,...s),__VUE_I18N_LEGACY_API__&&n&&t.mixin(_n(c,c.__composer,e));const i=t.unmount;t.unmount=()=>{e.dispose(),i()}},get global(){return c},dispose(){a.stop()},__instances:o,__getInstance:u,__setInstance:h,__deleteInstance:d};return e}}function In(e={}){const t=(0,Nt.FN)();if(null==t)throw Vt(jt.MUST_BE_CALL_SETUP_TOP);if(!t.isCE&&null!=t.appContext.app&&!t.appContext.app.__VUE_I18N_SYMBOL__)throw Vt(jt.NOT_INSLALLED);const n=Tn(t),r=Cn(n),s=Xt(t),i=Rn(e,s);if(__VUE_I18N_LEGACY_API__&&"legacy"===n.mode&&!e.__useComponent){if(!n.allowComposition)throw Vt(jt.NOT_AVAILABLE_IN_LEGACY_MODE);return On(t,i,r,e)}if("global"===i)return Jt(r,e,s),r;if("parent"===i){let s=Pn(n,t,e.__useComponent);return null==s&&(s=r),s}const o=n;let a=o.__getInstance(t);if(null==a){const n=f({},e);"__i18n"in s&&(n.__i18n=s.__i18n),r&&(n.__root=r),a=sn(n),Nn(o,t,a),o.__setInstance(t,a)}return a}function An(e,t,n){const r=(0,Ot.B)();{const n=__VUE_I18N_LEGACY_API__&&t?r.run((()=>an(e))):r.run((()=>sn(e)));if(null==n)throw Vt(jt.UNEXPECTED_ERROR);return[r,n]}}function Tn(e){{const t=(0,Nt.f3)(e.isCE?Sn:e.appContext.app.__VUE_I18N_SYMBOL__);if(!t)throw Vt(e.isCE?jt.NOT_INSLALLED_WITH_PROVIDE:jt.UNEXPECTED_ERROR);return t}}function Rn(e,t){return h(e)?"__i18n"in t?"local":"global":e.useScope?e.useScope:"local"}function Cn(e){return"composition"===e.mode?e.global:e.global.__composer}function Pn(e,t,n=!1){let r=null;const s=t.root;let i=t.parent;while(null!=i){const t=e;if("composition"===e.mode)r=t.__getInstance(i);else if(__VUE_I18N_LEGACY_API__){const e=t.__getInstance(i);null!=e&&(r=e.__composer,n&&r&&!r[qt]&&(r=null))}if(null!=r)break;if(s===i)break;i=i.parent}return r}function Nn(e,t,n){(0,Nt.bv)((()=>{0}),t),(0,Nt.Ah)((()=>{e.__deleteInstance(t)}),t)}function On(e,t,n,r={}){const s="local"===t,i=(0,Ot.XI)(null);if(s&&e.proxy&&!e.proxy.$options.i18n&&!e.proxy.$options.__i18n)throw Vt(jt.MUST_DEFINE_I18N_OPTION_IN_ALLOW_COMPOSITION);const o=!E(r.inheritLocale)||r.inheritLocale,a=(0,Ot.iH)(s&&o?n.locale.value:_(r.locale)?r.locale:Fe),c=(0,Ot.iH)(s&&o?n.fallbackLocale.value:_(r.fallbackLocale)||b(r.fallbackLocale)||A(r.fallbackLocale)||!1===r.fallbackLocale?r.fallbackLocale:a.value),l=(0,Ot.iH)(Gt(a.value,r)),h=(0,Ot.iH)(A(r.datetimeFormats)?r.datetimeFormats:{[a.value]:{}}),d=(0,Ot.iH)(A(r.numberFormats)?r.numberFormats:{[a.value]:{}}),f=s?n.missingWarn:!E(r.missingWarn)&&!u(r.missingWarn)||r.missingWarn,p=s?n.fallbackWarn:!E(r.fallbackWarn)&&!u(r.fallbackWarn)||r.fallbackWarn,g=s?n.fallbackRoot:!E(r.fallbackRoot)||r.fallbackRoot,y=!!r.fallbackFormat,m=v(r.missing)?r.missing:null,w=v(r.postTranslation)?r.postTranslation:null,S=s?n.warnHtmlMessage:!E(r.warnHtmlMessage)||r.warnHtmlMessage,k=!!r.escapeParameter,I=s?n.modifiers:A(r.modifiers)?r.modifiers:{},T=r.pluralRules||s&&n.pluralRules;function R(){return[a.value,c.value,l.value,h.value,d.value]}const C=(0,Nt.Fl)({get:()=>i.value?i.value.locale.value:a.value,set:e=>{i.value&&(i.value.locale.value=e),a.value=e}}),P=(0,Nt.Fl)({get:()=>i.value?i.value.fallbackLocale.value:c.value,set:e=>{i.value&&(i.value.fallbackLocale.value=e),c.value=e}}),N=(0,Nt.Fl)((()=>i.value?i.value.messages.value:l.value)),O=(0,Nt.Fl)((()=>h.value)),D=(0,Nt.Fl)((()=>d.value));function L(){return i.value?i.value.getPostTranslationHandler():w}function x(e){i.value&&i.value.setPostTranslationHandler(e)}function B(){return i.value?i.value.getMissingHandler():m}function M(e){i.value&&i.value.setMissingHandler(e)}function U(e){return R(),e()}function F(...e){return i.value?U((()=>Reflect.apply(i.value.t,null,[...e]))):U((()=>""))}function j(...e){return i.value?Reflect.apply(i.value.rt,null,[...e]):""}function V(...e){return i.value?U((()=>Reflect.apply(i.value.d,null,[...e]))):U((()=>""))}function z(...e){return i.value?U((()=>Reflect.apply(i.value.n,null,[...e]))):U((()=>""))}function $(e){return i.value?i.value.tm(e):{}}function K(e,t){return!!i.value&&i.value.te(e,t)}function H(e){return i.value?i.value.getLocaleMessage(e):{}}function q(e,t){i.value&&(i.value.setLocaleMessage(e,t),l.value[e]=t)}function W(e,t){i.value&&i.value.mergeLocaleMessage(e,t)}function G(e){return i.value?i.value.getDateTimeFormat(e):{}}function Y(e,t){i.value&&(i.value.setDateTimeFormat(e,t),h.value[e]=t)}function Q(e,t){i.value&&i.value.mergeDateTimeFormat(e,t)}function X(e){return i.value?i.value.getNumberFormat(e):{}}function J(e,t){i.value&&(i.value.setNumberFormat(e,t),d.value[e]=t)}function Z(e,t){i.value&&i.value.mergeNumberFormat(e,t)}const ee={get id(){return i.value?i.value.id:-1},locale:C,fallbackLocale:P,messages:N,datetimeFormats:O,numberFormats:D,get inheritLocale(){return i.value?i.value.inheritLocale:o},set inheritLocale(e){i.value&&(i.value.inheritLocale=e)},get availableLocales(){return i.value?i.value.availableLocales:Object.keys(l.value)},get modifiers(){return i.value?i.value.modifiers:I},get pluralRules(){return i.value?i.value.pluralRules:T},get isGlobal(){return!!i.value&&i.value.isGlobal},get missingWarn(){return i.value?i.value.missingWarn:f},set missingWarn(e){i.value&&(i.value.missingWarn=e)},get fallbackWarn(){return i.value?i.value.fallbackWarn:p},set fallbackWarn(e){i.value&&(i.value.missingWarn=e)},get fallbackRoot(){return i.value?i.value.fallbackRoot:g},set fallbackRoot(e){i.value&&(i.value.fallbackRoot=e)},get fallbackFormat(){return i.value?i.value.fallbackFormat:y},set fallbackFormat(e){i.value&&(i.value.fallbackFormat=e)},get warnHtmlMessage(){return i.value?i.value.warnHtmlMessage:S},set warnHtmlMessage(e){i.value&&(i.value.warnHtmlMessage=e)},get escapeParameter(){return i.value?i.value.escapeParameter:k},set escapeParameter(e){i.value&&(i.value.escapeParameter=e)},t:F,getPostTranslationHandler:L,setPostTranslationHandler:x,getMissingHandler:B,setMissingHandler:M,rt:j,d:V,n:z,tm:$,te:K,getLocaleMessage:H,setLocaleMessage:q,mergeLocaleMessage:W,getDateTimeFormat:G,setDateTimeFormat:Y,mergeDateTimeFormat:Q,getNumberFormat:X,setNumberFormat:J,mergeNumberFormat:Z};function te(e){e.locale.value=a.value,e.fallbackLocale.value=c.value,Object.keys(l.value).forEach((t=>{e.mergeLocaleMessage(t,l.value[t])})),Object.keys(h.value).forEach((t=>{e.mergeDateTimeFormat(t,h.value[t])})),Object.keys(d.value).forEach((t=>{e.mergeNumberFormat(t,d.value[t])})),e.escapeParameter=k,e.fallbackFormat=y,e.fallbackRoot=g,e.fallbackWarn=p,e.missingWarn=f,e.warnHtmlMessage=S}return(0,Nt.wF)((()=>{if(null==e.proxy||null==e.proxy.$i18n)throw Vt(jt.NOT_AVAILABLE_COMPOSITION_IN_LEGACY);const n=i.value=e.proxy.$i18n.__composer;"global"===t?(a.value=n.locale.value,c.value=n.fallbackLocale.value,l.value=n.messages.value,h.value=n.datetimeFormats.value,d.value=n.numberFormats.value):s&&te(n)})),ee}const Dn=["locale","fallbackLocale","availableLocales"],Ln=["t","rt","d","n","tm"];function xn(e,t){const n=Object.create(null);Dn.forEach((e=>{const r=Object.getOwnPropertyDescriptor(t,e);if(!r)throw Vt(jt.UNEXPECTED_ERROR);const s=(0,Ot.dq)(r.value)?{get(){return r.value.value},set(e){r.value.value=e}}:{get(){return r.get&&r.get()}};Object.defineProperty(n,e,s)})),e.config.globalProperties.$i18n=n,Ln.forEach((n=>{const r=Object.getOwnPropertyDescriptor(t,n);if(!r||!r.value)throw Vt(jt.UNEXPECTED_ERROR);Object.defineProperty(e.config.globalProperties,`$${n}`,r)}))}if(qe(at),We(ye),Ge(De),Lt(),__INTLIFY_PROD_DEVTOOLS__){const e=g();e.__INTLIFY__=!0,Te(e.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}},89:function(e,t){"use strict";t.Z=(e,t)=>{const n=e.__vccOpts||e;for(const[r,s]of t)n[r]=s;return n}},6866:function(e,t,n){"use strict";n.r(t),n.d(t,{BaseTransition:function(){return r.P$},Comment:function(){return r.sv},EffectScope:function(){return r.Bj},Fragment:function(){return r.HY},KeepAlive:function(){return r.Ob},ReactiveEffect:function(){return r.qq},Static:function(){return r.qG},Suspense:function(){return r.n4},Teleport:function(){return r.lR},Text:function(){return r.xv},Transition:function(){return r.uT},TransitionGroup:function(){return r.W3},VueElement:function(){return r.a2},callWithAsyncErrorHandling:function(){return r.$d},callWithErrorHandling:function(){return r.KU},camelize:function(){return r._A},capitalize:function(){return r.kC},cloneVNode:function(){return r.Ho},compatUtils:function(){return r.ry},compile:function(){return s},computed:function(){return r.Fl},createApp:function(){return r.ri},createBlock:function(){return r.j4},createCommentVNode:function(){return r.kq},createElementBlock:function(){return r.iD},createElementVNode:function(){return r._},createHydrationRenderer:function(){return r.Eo},createPropsRestProxy:function(){return r.p1},createRenderer:function(){return r.Us},createSSRApp:function(){return r.vr},createSlots:function(){return r.Nv},createStaticVNode:function(){return r.uE},createTextVNode:function(){return r.Uk},createVNode:function(){return r.Wm},customRef:function(){return r.ZM},defineAsyncComponent:function(){return r.RC},defineComponent:function(){return r.aZ},defineCustomElement:function(){return r.MW},defineEmits:function(){return r.Bz},defineExpose:function(){return r.WY},defineProps:function(){return r.yb},defineSSRCustomElement:function(){return r.Ah},devtools:function(){return r.mW},effect:function(){return r.cE},effectScope:function(){return r.B},getCurrentInstance:function(){return r.FN},getCurrentScope:function(){return r.nZ},getTransitionRawChildren:function(){return r.Q6},guardReactiveProps:function(){return r.F4},h:function(){return r.h},handleError:function(){return r.S3},hydrate:function(){return r.ZB},initCustomFormatter:function(){return r.Mr},initDirectivesForSSR:function(){return r.Nd},inject:function(){return r.f3},isMemoSame:function(){return r.nQ},isProxy:function(){return r.X3},isReactive:function(){return r.PG},isReadonly:function(){return r.$y},isRef:function(){return r.dq},isRuntimeOnly:function(){return r.of},isShallow:function(){return r.yT},isVNode:function(){return r.lA},markRaw:function(){return r.Xl},mergeDefaults:function(){return r.u_},mergeProps:function(){return r.dG},nextTick:function(){return r.Y3},normalizeClass:function(){return r.C_},normalizeProps:function(){return r.vs},normalizeStyle:function(){return r.j5},onActivated:function(){return r.dl},onBeforeMount:function(){return r.wF},onBeforeUnmount:function(){return r.Jd},onBeforeUpdate:function(){return r.Xn},onDeactivated:function(){return r.se},onErrorCaptured:function(){return r.d1},onMounted:function(){return r.bv},onRenderTracked:function(){return r.bT},onRenderTriggered:function(){return r.Yq},onScopeDispose:function(){return r.EB},onServerPrefetch:function(){return r.vl},onUnmounted:function(){return r.SK},onUpdated:function(){return r.ic},openBlock:function(){return r.wg},popScopeId:function(){return r.Cn},provide:function(){return r.JJ},proxyRefs:function(){return r.WL},pushScopeId:function(){return r.dD},queuePostFlushCb:function(){return r.qb},reactive:function(){return r.qj},readonly:function(){return r.OT},ref:function(){return r.iH},registerRuntimeCompiler:function(){return r.Y1},render:function(){return r.sY},renderList:function(){return r.Ko},renderSlot:function(){return r.WI},resolveComponent:function(){return r.up},resolveDirective:function(){return r.Q2},resolveDynamicComponent:function(){return r.LL},resolveFilter:function(){return r.eq},resolveTransitionHooks:function(){return r.U2},setBlockTracking:function(){return r.qZ},setDevtoolsHook:function(){return r.ec},setTransitionHooks:function(){return r.nK},shallowReactive:function(){return r.Um},shallowReadonly:function(){return r.YS},shallowRef:function(){return r.XI},ssrContextKey:function(){return r.Uc},ssrUtils:function(){return r.G},stop:function(){return r.sT},toDisplayString:function(){return r.zw},toHandlerKey:function(){return r.hR},toHandlers:function(){return r.mx},toRaw:function(){return r.IU},toRef:function(){return r.Vh},toRefs:function(){return r.BK},transformVNodeArgs:function(){return r.C3},triggerRef:function(){return r.oR},unref:function(){return r.SU},useAttrs:function(){return r.l1},useCssModule:function(){return r.fb},useCssVars:function(){return r.sj},useSSRContext:function(){return r.Zq},useSlots:function(){return r.Rr},useTransitionState:function(){return r.Y8},vModelCheckbox:function(){return r.e8},vModelDynamic:function(){return r.YZ},vModelRadio:function(){return r.G2},vModelSelect:function(){return r.bM},vModelText:function(){return r.nr},vShow:function(){return r.F8},version:function(){return r.i8},warn:function(){return r.ZK},watch:function(){return r.YP},watchEffect:function(){return r.m0},watchPostEffect:function(){return r.Rh},watchSyncEffect:function(){return r.yX},withAsyncContext:function(){return r.mv},withCtx:function(){return r.w5},withDefaults:function(){return r.b9},withDirectives:function(){return r.wy},withKeys:function(){return r.D2},withMemo:function(){return r.MX},withModifiers:function(){return r.iM},withScopeId:function(){return r.HX}});var r=n(9242);const s=()=>{0}},65:function(e,t,n){"use strict";n.d(t,{MT:function(){return ee}});n(7658),n(541);var r=n(3396),s=n(4870);function i(){return o().__VUE_DEVTOOLS_GLOBAL_HOOK__}function o(){return"undefined"!==typeof navigator&&"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{}}const a="function"===typeof Proxy,c="devtools-plugin:setup",l="plugin:settings:set";let u,h;function d(){var e;return void 0!==u||("undefined"!==typeof window&&window.performance?(u=!0,h=window.performance):"undefined"!==typeof n.g&&(null===(e=n.g.perf_hooks)||void 0===e?void 0:e.performance)?(u=!0,h=n.g.perf_hooks.performance):u=!1),u}function f(){return d()?h.now():Date.now()}class p{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const n={};if(e.settings)for(const o in e.settings){const t=e.settings[o];n[o]=t.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},n);try{const e=localStorage.getItem(r),t=JSON.parse(e);Object.assign(s,t)}catch(i){}this.fallbacks={getSettings(){return s},setSettings(e){try{localStorage.setItem(r,JSON.stringify(e))}catch(i){}s=e},now(){return f()}},t&&t.on(l,((e,t)=>{e===this.plugin.id&&this.fallbacks.setSettings(t)})),this.proxiedOn=new Proxy({},{get:(e,t)=>this.target?this.target.on[t]:(...e)=>{this.onQueue.push({method:t,args:e})}}),this.proxiedTarget=new Proxy({},{get:(e,t)=>this.target?this.target[t]:"on"===t?this.proxiedOn:Object.keys(this.fallbacks).includes(t)?(...e)=>(this.targetQueue.push({method:t,args:e,resolve:()=>{}}),this.fallbacks[t](...e)):(...e)=>new Promise((n=>{this.targetQueue.push({method:t,args:e,resolve:n})}))})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function g(e,t){const n=e,r=o(),s=i(),l=a&&n.enableEarlyProxy;if(!s||!r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&l){const e=l?new p(n,s):null,i=r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[];i.push({pluginDescriptor:n,setupFn:t,proxy:e}),e&&t(e.proxiedTarget)}else s.emit(c,e,t)}
/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */
var y="store";function m(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function w(e){return null!==e&&"object"===typeof e}function b(e){return e&&"function"===typeof e.then}function v(e,t){return function(){return e(t)}}function _(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function E(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;k(e,n,[],e._modules.root,!0),S(e,n,t)}function S(e,t,n){var i=e._state,o=e._scope;e.getters={},e._makeLocalGettersCache=Object.create(null);var a=e._wrappedGetters,c={},l={},u=(0,s.B)(!0);u.run((function(){m(a,(function(t,n){c[n]=v(t,e),l[n]=(0,r.Fl)((function(){return c[n]()})),Object.defineProperty(e.getters,n,{get:function(){return l[n].value},enumerable:!0})}))})),e._state=(0,s.qj)({data:t}),e._scope=u,e.strict&&P(e),i&&n&&e._withCommit((function(){i.data=null})),o&&o.stop()}function k(e,t,n,r,s){var i=!n.length,o=e._modules.getNamespace(n);if(r.namespaced&&(e._modulesNamespaceMap[o],e._modulesNamespaceMap[o]=r),!i&&!s){var a=N(t,n.slice(0,-1)),c=n[n.length-1];e._withCommit((function(){a[c]=r.state}))}var l=r.context=I(e,o,n);r.forEachMutation((function(t,n){var r=o+n;T(e,r,t,l)})),r.forEachAction((function(t,n){var r=t.root?n:o+n,s=t.handler||t;R(e,r,s,l)})),r.forEachGetter((function(t,n){var r=o+n;C(e,r,t,l)})),r.forEachChild((function(r,i){k(e,t,n.concat(i),r,s)}))}function I(e,t,n){var r=""===t,s={dispatch:r?e.dispatch:function(n,r,s){var i=O(n,r,s),o=i.payload,a=i.options,c=i.type;return a&&a.root||(c=t+c),e.dispatch(c,o)},commit:r?e.commit:function(n,r,s){var i=O(n,r,s),o=i.payload,a=i.options,c=i.type;a&&a.root||(c=t+c),e.commit(c,o,a)}};return Object.defineProperties(s,{getters:{get:r?function(){return e.getters}:function(){return A(e,t)}},state:{get:function(){return N(e.state,n)}}}),s}function A(e,t){if(!e._makeLocalGettersCache[t]){var n={},r=t.length;Object.keys(e.getters).forEach((function(s){if(s.slice(0,r)===t){var i=s.slice(r);Object.defineProperty(n,i,{get:function(){return e.getters[s]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}function T(e,t,n,r){var s=e._mutations[t]||(e._mutations[t]=[]);s.push((function(t){n.call(e,r.state,t)}))}function R(e,t,n,r){var s=e._actions[t]||(e._actions[t]=[]);s.push((function(t){var s=n.call(e,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:e.getters,rootState:e.state},t);return b(s)||(s=Promise.resolve(s)),e._devtoolHook?s.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):s}))}function C(e,t,n,r){e._wrappedGetters[t]||(e._wrappedGetters[t]=function(e){return n(r.state,r.getters,e.state,e.getters)})}function P(e){(0,r.YP)((function(){return e._state.data}),(function(){0}),{deep:!0,flush:"sync"})}function N(e,t){return t.reduce((function(e,t){return e[t]}),e)}function O(e,t,n){return w(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}var D="vuex bindings",L="vuex:mutations",x="vuex:actions",B="vuex",M=0;function U(e,t){g({id:"org.vuejs.vuex",app:e,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[D]},(function(n){n.addTimelineLayer({id:L,label:"Vuex Mutations",color:F}),n.addTimelineLayer({id:x,label:"Vuex Actions",color:F}),n.addInspector({id:B,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree((function(n){if(n.app===e&&n.inspectorId===B)if(n.filter){var r=[];H(r,t._modules.root,n.filter,""),n.rootNodes=r}else n.rootNodes=[K(t._modules.root,"")]})),n.on.getInspectorState((function(n){if(n.app===e&&n.inspectorId===B){var r=n.nodeId;A(t,r),n.state=q(G(t._modules,r),"root"===r?t.getters:t._makeLocalGettersCache,r)}})),n.on.editInspectorState((function(n){if(n.app===e&&n.inspectorId===B){var r=n.nodeId,s=n.path;"root"!==r&&(s=r.split("/").filter(Boolean).concat(s)),t._withCommit((function(){n.set(t._state.data,s,n.state.value)}))}})),t.subscribe((function(e,t){var r={};e.payload&&(r.payload=e.payload),r.state=t,n.notifyComponentUpdate(),n.sendInspectorTree(B),n.sendInspectorState(B),n.addTimelineEvent({layerId:L,event:{time:Date.now(),title:e.type,data:r}})})),t.subscribeAction({before:function(e,t){var r={};e.payload&&(r.payload=e.payload),e._id=M++,e._time=Date.now(),r.state=t,n.addTimelineEvent({layerId:x,event:{time:e._time,title:e.type,groupId:e._id,subtitle:"start",data:r}})},after:function(e,t){var r={},s=Date.now()-e._time;r.duration={_custom:{type:"duration",display:s+"ms",tooltip:"Action duration",value:s}},e.payload&&(r.payload=e.payload),r.state=t,n.addTimelineEvent({layerId:x,event:{time:Date.now(),title:e.type,groupId:e._id,subtitle:"end",data:r}})}})}))}var F=8702998,j=6710886,V=16777215,z={label:"namespaced",textColor:V,backgroundColor:j};function $(e){return e&&"root"!==e?e.split("/").slice(-2,-1)[0]:"Root"}function K(e,t){return{id:t||"root",label:$(t),tags:e.namespaced?[z]:[],children:Object.keys(e._children).map((function(n){return K(e._children[n],t+n+"/")}))}}function H(e,t,n,r){r.includes(n)&&e.push({id:r||"root",label:r.endsWith("/")?r.slice(0,r.length-1):r||"Root",tags:t.namespaced?[z]:[]}),Object.keys(t._children).forEach((function(s){H(e,t._children[s],n,r+s+"/")}))}function q(e,t,n){t="root"===n?t:t[n];var r=Object.keys(t),s={state:Object.keys(e.state).map((function(t){return{key:t,editable:!0,value:e.state[t]}}))};if(r.length){var i=W(t);s.getters=Object.keys(i).map((function(e){return{key:e.endsWith("/")?$(e):e,editable:!1,value:Y((function(){return i[e]}))}}))}return s}function W(e){var t={};return Object.keys(e).forEach((function(n){var r=n.split("/");if(r.length>1){var s=t,i=r.pop();r.forEach((function(e){s[e]||(s[e]={_custom:{value:{},display:e,tooltip:"Module",abstract:!0}}),s=s[e]._custom.value})),s[i]=Y((function(){return e[n]}))}else t[n]=Y((function(){return e[n]}))})),t}function G(e,t){var n=t.split("/").filter((function(e){return e}));return n.reduce((function(e,r,s){var i=e[r];if(!i)throw new Error('Missing module "'+r+'" for path "'+t+'".');return s===n.length-1?i:i._children}),"root"===t?e:e.root._children)}function Y(e){try{return e()}catch(t){return t}}var Q=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"===typeof n?n():n)||{}},X={namespaced:{configurable:!0}};X.namespaced.get=function(){return!!this._rawModule.namespaced},Q.prototype.addChild=function(e,t){this._children[e]=t},Q.prototype.removeChild=function(e){delete this._children[e]},Q.prototype.getChild=function(e){return this._children[e]},Q.prototype.hasChild=function(e){return e in this._children},Q.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},Q.prototype.forEachChild=function(e){m(this._children,e)},Q.prototype.forEachGetter=function(e){this._rawModule.getters&&m(this._rawModule.getters,e)},Q.prototype.forEachAction=function(e){this._rawModule.actions&&m(this._rawModule.actions,e)},Q.prototype.forEachMutation=function(e){this._rawModule.mutations&&m(this._rawModule.mutations,e)},Object.defineProperties(Q.prototype,X);var J=function(e){this.register([],e,!1)};function Z(e,t,n){if(t.update(n),n.modules)for(var r in n.modules){if(!t.getChild(r))return void 0;Z(e.concat(r),t.getChild(r),n.modules[r])}}J.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},J.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return t=t.getChild(n),e+(t.namespaced?n+"/":"")}),"")},J.prototype.update=function(e){Z([],this.root,e)},J.prototype.register=function(e,t,n){var r=this;void 0===n&&(n=!0);var s=new Q(t,n);if(0===e.length)this.root=s;else{var i=this.get(e.slice(0,-1));i.addChild(e[e.length-1],s)}t.modules&&m(t.modules,(function(t,s){r.register(e.concat(s),t,n)}))},J.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],r=t.getChild(n);r&&r.runtime&&t.removeChild(n)},J.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};function ee(e){return new te(e)}var te=function(e){var t=this;void 0===e&&(e={});var n=e.plugins;void 0===n&&(n=[]);var r=e.strict;void 0===r&&(r=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new J(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var i=this,o=this,a=o.dispatch,c=o.commit;this.dispatch=function(e,t){return a.call(i,e,t)},this.commit=function(e,t,n){return c.call(i,e,t,n)},this.strict=r;var l=this._modules.root.state;k(this,l,[],this._modules.root),S(this,l),n.forEach((function(e){return e(t)}))},ne={state:{configurable:!0}};te.prototype.install=function(e,t){e.provide(t||y,this),e.config.globalProperties.$store=this;var n=void 0!==this._devtools&&this._devtools;n&&U(e,this)},ne.state.get=function(){return this._state.data},ne.state.set=function(e){0},te.prototype.commit=function(e,t,n){var r=this,s=O(e,t,n),i=s.type,o=s.payload,a=(s.options,{type:i,payload:o}),c=this._mutations[i];c&&(this._withCommit((function(){c.forEach((function(e){e(o)}))})),this._subscribers.slice().forEach((function(e){return e(a,r.state)})))},te.prototype.dispatch=function(e,t){var n=this,r=O(e,t),s=r.type,i=r.payload,o={type:s,payload:i},a=this._actions[s];if(a){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(o,n.state)}))}catch(l){0}var c=a.length>1?Promise.all(a.map((function(e){return e(i)}))):a[0](i);return new Promise((function(e,t){c.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(o,n.state)}))}catch(l){0}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(o,n.state,e)}))}catch(l){0}t(e)}))}))}},te.prototype.subscribe=function(e,t){return _(e,this._subscribers,t)},te.prototype.subscribeAction=function(e,t){var n="function"===typeof e?{before:e}:e;return _(n,this._actionSubscribers,t)},te.prototype.watch=function(e,t,n){var s=this;return(0,r.YP)((function(){return e(s.state,s.getters)}),t,Object.assign({},n))},te.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},te.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),k(this,this.state,e,this._modules.get(e),n.preserveState),S(this,this.state)},te.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var n=N(t.state,e.slice(0,-1));delete n[e[e.length-1]]})),E(this)},te.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},te.prototype.hotUpdate=function(e){this._modules.update(e),E(this,!0)},te.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(te.prototype,ne);ie((function(e,t){var n={};return re(t).forEach((function(t){var r=t.key,s=t.val;n[r]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var r=oe(this.$store,"mapState",e);if(!r)return;t=r.context.state,n=r.context.getters}return"function"===typeof s?s.call(this,t,n):t[s]},n[r].vuex=!0})),n})),ie((function(e,t){var n={};return re(t).forEach((function(t){var r=t.key,s=t.val;n[r]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var r=this.$store.commit;if(e){var i=oe(this.$store,"mapMutations",e);if(!i)return;r=i.context.commit}return"function"===typeof s?s.apply(this,[r].concat(t)):r.apply(this.$store,[s].concat(t))}})),n})),ie((function(e,t){var n={};return re(t).forEach((function(t){var r=t.key,s=t.val;s=e+s,n[r]=function(){if(!e||oe(this.$store,"mapGetters",e))return this.$store.getters[s]},n[r].vuex=!0})),n})),ie((function(e,t){var n={};return re(t).forEach((function(t){var r=t.key,s=t.val;n[r]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var r=this.$store.dispatch;if(e){var i=oe(this.$store,"mapActions",e);if(!i)return;r=i.context.dispatch}return"function"===typeof s?s.apply(this,[r].concat(t)):r.apply(this.$store,[s].concat(t))}})),n}));function re(e){return se(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function se(e){return Array.isArray(e)||w(e)}function ie(e){return function(t,n){return"string"!==typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function oe(e,t,n){var r=e._modulesNamespaceMap[n];return r}},8340:function(e,t,n){"use strict";n.d(t,{VU:function(){return K}});var r=n(7862),s=n(3425),i=n(9674);const o=new Map;class a{constructor(e){this.room=e,this.onmessage=null,i.z((t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:s.Gh(t.newValue||"")})))}postMessage(e){i.X.setItem(this.room,s.s3(s.eh(e)))}}const c="undefined"===typeof BroadcastChannel?a:BroadcastChannel,l=e=>r.Yu(o,e,(()=>{const t=new Set,n=new c(e);return n.onmessage=e=>t.forEach((t=>t(e.data,"broadcastchannel"))),{bc:n,subs:t}})),u=(e,t)=>l(e).subs.add(t),h=(e,t)=>l(e).subs.delete(t),d=(e,t,n=null)=>{const r=l(e);r.bc.postMessage(t),r.subs.forEach((e=>e(t,n)))};var f=n(313),p=n(8148),g=n(2294),y=n(2942);const m=0,w=1,b=2,v=(e,t)=>{p.uE(e,m);const n=y.gJ(t);p.mP(e,n)},_=(e,t,n)=>{p.uE(e,w),p.mP(e,y.D$(t,n))},E=(e,t,n)=>_(t,n,g.HN(e)),S=(e,t,n)=>{try{y.NG(t,g.HN(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},k=(e,t)=>{p.uE(e,b),p.mP(e,t)},I=S,A=(e,t,n,r)=>{const s=g.yg(e);switch(s){case m:E(e,t,n);break;case w:S(e,n,r);break;case b:I(e,n,r);break;default:throw new Error("Unknown message type")}return s},T=0,R=(e,t,n)=>{switch(g.yg(e)){case T:n(t,g.kf(e))}};var C=n(114),P=n(6055),N=n(1383),O=n(1370);const D=e=>O.UI(e,((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&"),L=0,x=3,B=1,M=2,U=[];U[L]=(e,t,n,r,s)=>{p.uE(e,L);const i=A(t,e,n.doc,n);r&&i===w&&!n.synced&&(n.synced=!0)},U[x]=(e,t,n,r,s)=>{p.uE(e,B),p.mP(e,C.xq(n.awareness,Array.from(n.awareness.getStates().keys())))},U[B]=(e,t,n,r,s)=>{C.oy(n.awareness,g.HN(t),n)},U[M]=(e,t,n,r,s)=>{R(t,n.doc,((e,t)=>j(n,t)))};const F=3e4,j=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),V=(e,t,n)=>{const r=g.l1(t),s=p.Mf(),i=g.yg(r),o=e.messageHandlers[i];return o?o(s,r,e,n,i):console.error("Unable to compute message"),s},z=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=n=>{e.wsLastMessageReceived=f.ZG();const r=V(e,new Uint8Array(n.data),!0);p.kE(r)>1&&t.send(p._f(r))},t.onerror=t=>{e.emit("connection-error",[t,e])},t.onclose=t=>{e.emit("connection-close",[t,e]),e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,C.Ag(e.awareness,Array.from(e.awareness.getStates().keys()).filter((t=>t!==e.doc.clientID)),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(z,N.VV(100*N.sQ(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e)},t.onopen=()=>{e.wsLastMessageReceived=f.ZG(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const n=p.Mf();if(p.uE(n,L),v(n,e.doc),t.send(p._f(n)),null!==e.awareness.getLocalState()){const n=p.Mf();p.uE(n,B),p.mP(n,C.xq(e.awareness,[e.doc.clientID])),t.send(p._f(n))}},e.emit("status",[{status:"connecting"}])}},$=(e,t)=>{e.wsconnected&&e.ws.send(t),e.bcconnected&&d(e.bcChannel,t,e)};class K extends P.y{constructor(e,t,n,{connect:r=!0,awareness:s=new C.GL(n),params:i={},WebSocketPolyfill:o=WebSocket,resyncInterval:a=-1,maxBackoffTime:c=2500,disableBc:l=!1}={}){super();while("/"===e[e.length-1])e=e.slice(0,e.length-1);const u=D(i);this.maxBackoffTime=c,this.bcChannel=e+"/"+t,this.url=e+"/"+t+(0===u.length?"":"?"+u),this.roomname=t,this.doc=n,this._WS=o,this.awareness=s,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=l,this.wsUnsuccessfulReconnects=0,this.messageHandlers=U.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=r,this._resyncInterval=0,a>0&&(this._resyncInterval=setInterval((()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){const e=p.Mf();p.uE(e,L),v(e,n),this.ws.send(p._f(e))}}),a)),this._bcSubscriber=(e,t)=>{if(t!==this){const t=V(this,new Uint8Array(e),!1);p.kE(t)>1&&d(this.bcChannel,p._f(t),this)}},this._updateHandler=(e,t)=>{if(t!==this){const t=p.Mf();p.uE(t,L),k(t,e),$(this,p._f(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:n},r)=>{const i=e.concat(t).concat(n),o=p.Mf();p.uE(o,B),p.mP(o,C.xq(s,i)),$(this,p._f(o))},this._unloadHandler=()=>{C.Ag(this.awareness,[n.clientID],"window unload")},"undefined"!==typeof window?window.addEventListener("unload",this._unloadHandler):"undefined"!==typeof process&&process.on("exit",this._unloadHandler),s.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval((()=>{this.wsconnected&&F<f.ZG()-this.wsLastMessageReceived&&this.ws.close()}),F/10),r&&this.connect()}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),"undefined"!==typeof window?window.removeEventListener("unload",this._unloadHandler):"undefined"!==typeof process&&process.off("exit",this._unloadHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;this.bcconnected||(u(this.bcChannel,this._bcSubscriber),this.bcconnected=!0);const e=p.Mf();p.uE(e,L),v(e,this.doc),d(this.bcChannel,p._f(e),this);const t=p.Mf();p.uE(t,L),_(t,this.doc),d(this.bcChannel,p._f(t),this);const n=p.Mf();p.uE(n,x),d(this.bcChannel,p._f(n),this);const r=p.Mf();p.uE(r,B),p.mP(r,C.xq(this.awareness,[this.doc.clientID])),d(this.bcChannel,p._f(r),this)}disconnectBc(){const e=p.Mf();p.uE(e,B),p.mP(e,C.xq(this.awareness,[this.doc.clientID],new Map)),$(this,p._f(e)),this.bcconnected&&(h(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(z(this),this.connectBc())}}},4482:function(e,t,n){var r,s,i;(function(o,a){s=[n(5797)],r=a,i="function"===typeof r?r.apply(t,s):r,void 0===i||(e.exports=i)})(0,(function(e){"use strict";var t=e.Reader,n=e.Writer,r=e.util,s=e.roots["default"]||(e.roots["default"]={});return s.RPC=function(){function i(e){if(this.subscriptions=[],this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.subscriptions=r.emptyArray,i.prototype.messages=r.emptyArray,i.prototype.control=null,Object.defineProperty(i.prototype,"_control",{get:r.oneOfGetter(o=["control"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=n.create()),null!=e.subscriptions&&e.subscriptions.length)for(var r=0;r<e.subscriptions.length;++r)s.RPC.SubOpts.encode(e.subscriptions[r],t.uint32(10).fork()).ldelim();if(null!=e.messages&&e.messages.length)for(r=0;r<e.messages.length;++r)s.RPC.Message.encode(e.messages[r],t.uint32(18).fork()).ldelim();return null!=e.control&&Object.hasOwnProperty.call(e,"control")&&s.RPC.ControlMessage.encode(e.control,t.uint32(26).fork()).ldelim(),t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.push(s.RPC.SubOpts.decode(e,e.uint32()));break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.push(s.RPC.Message.decode(e,e.uint32()));break;case 3:i.control=s.RPC.ControlMessage.decode(e,e.uint32());break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC)return e;var t=new s.RPC;if(e.subscriptions){if(!Array.isArray(e.subscriptions))throw TypeError(".RPC.subscriptions: array expected");t.subscriptions=[];for(var n=0;n<e.subscriptions.length;++n){if("object"!==typeof e.subscriptions[n])throw TypeError(".RPC.subscriptions: object expected");t.subscriptions[n]=s.RPC.SubOpts.fromObject(e.subscriptions[n])}}if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".RPC.messages: array expected");t.messages=[];for(n=0;n<e.messages.length;++n){if("object"!==typeof e.messages[n])throw TypeError(".RPC.messages: object expected");t.messages[n]=s.RPC.Message.fromObject(e.messages[n])}}if(null!=e.control){if("object"!==typeof e.control)throw TypeError(".RPC.control: object expected");t.control=s.RPC.ControlMessage.fromObject(e.control)}return t},i.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.subscriptions=[],n.messages=[]),e.subscriptions&&e.subscriptions.length){n.subscriptions=[];for(var r=0;r<e.subscriptions.length;++r)n.subscriptions[r]=s.RPC.SubOpts.toObject(e.subscriptions[r],t)}if(e.messages&&e.messages.length){n.messages=[];for(r=0;r<e.messages.length;++r)n.messages[r]=s.RPC.Message.toObject(e.messages[r],t)}return null!=e.control&&e.hasOwnProperty("control")&&(n.control=s.RPC.ControlMessage.toObject(e.control,t),t.oneofs&&(n._control="control")),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i.SubOpts=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.subscribe=null,i.prototype.topic=null,Object.defineProperty(i.prototype,"_subscribe",{get:r.oneOfGetter(o=["subscribe"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_topic",{get:r.oneOfGetter(o=["topic"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=n.create()),null!=e.subscribe&&Object.hasOwnProperty.call(e,"subscribe")&&t.uint32(8).bool(e.subscribe),null!=e.topic&&Object.hasOwnProperty.call(e,"topic")&&t.uint32(18).string(e.topic),t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.SubOpts;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.subscribe=e.bool();break;case 2:i.topic=e.string();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.SubOpts)return e;var t=new s.RPC.SubOpts;return null!=e.subscribe&&(t.subscribe=Boolean(e.subscribe)),null!=e.topic&&(t.topic=String(e.topic)),t},i.toObject=function(e,t){t||(t={});var n={};return null!=e.subscribe&&e.hasOwnProperty("subscribe")&&(n.subscribe=e.subscribe,t.oneofs&&(n._subscribe="subscribe")),null!=e.topic&&e.hasOwnProperty("topic")&&(n.topic=e.topic,t.oneofs&&(n._topic="topic")),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.Message=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.from=null,i.prototype.data=null,i.prototype.seqno=null,i.prototype.topic="",i.prototype.signature=null,i.prototype.key=null,Object.defineProperty(i.prototype,"_from",{get:r.oneOfGetter(o=["from"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_data",{get:r.oneOfGetter(o=["data"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_seqno",{get:r.oneOfGetter(o=["seqno"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signature",{get:r.oneOfGetter(o=["signature"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_key",{get:r.oneOfGetter(o=["key"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=n.create()),null!=e.from&&Object.hasOwnProperty.call(e,"from")&&t.uint32(10).bytes(e.from),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.seqno&&Object.hasOwnProperty.call(e,"seqno")&&t.uint32(26).bytes(e.seqno),t.uint32(34).string(e.topic),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(50).bytes(e.key),t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var i=void 0===n?e.len:e.pos+n,o=new s.RPC.Message;while(e.pos<i){var a=e.uint32();switch(a>>>3){case 1:o.from=e.bytes();break;case 2:o.data=e.bytes();break;case 3:o.seqno=e.bytes();break;case 4:o.topic=e.string();break;case 5:o.signature=e.bytes();break;case 6:o.key=e.bytes();break;default:e.skipType(7&a);break}}if(!o.hasOwnProperty("topic"))throw r.ProtocolError("missing required 'topic'",{instance:o});return o},i.fromObject=function(e){if(e instanceof s.RPC.Message)return e;var t=new s.RPC.Message;return null!=e.from&&("string"===typeof e.from?r.base64.decode(e.from,t.from=r.newBuffer(r.base64.length(e.from)),0):e.from.length&&(t.from=e.from)),null!=e.data&&("string"===typeof e.data?r.base64.decode(e.data,t.data=r.newBuffer(r.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.seqno&&("string"===typeof e.seqno?r.base64.decode(e.seqno,t.seqno=r.newBuffer(r.base64.length(e.seqno)),0):e.seqno.length&&(t.seqno=e.seqno)),null!=e.topic&&(t.topic=String(e.topic)),null!=e.signature&&("string"===typeof e.signature?r.base64.decode(e.signature,t.signature=r.newBuffer(r.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),null!=e.key&&("string"===typeof e.key?r.base64.decode(e.key,t.key=r.newBuffer(r.base64.length(e.key)),0):e.key.length&&(t.key=e.key)),t},i.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.topic=""),null!=e.from&&e.hasOwnProperty("from")&&(n.from=t.bytes===String?r.base64.encode(e.from,0,e.from.length):t.bytes===Array?Array.prototype.slice.call(e.from):e.from,t.oneofs&&(n._from="from")),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?r.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data,t.oneofs&&(n._data="data")),null!=e.seqno&&e.hasOwnProperty("seqno")&&(n.seqno=t.bytes===String?r.base64.encode(e.seqno,0,e.seqno.length):t.bytes===Array?Array.prototype.slice.call(e.seqno):e.seqno,t.oneofs&&(n._seqno="seqno")),null!=e.topic&&e.hasOwnProperty("topic")&&(n.topic=e.topic),null!=e.signature&&e.hasOwnProperty("signature")&&(n.signature=t.bytes===String?r.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature,t.oneofs&&(n._signature="signature")),null!=e.key&&e.hasOwnProperty("key")&&(n.key=t.bytes===String?r.base64.encode(e.key,0,e.key.length):t.bytes===Array?Array.prototype.slice.call(e.key):e.key,t.oneofs&&(n._key="key")),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlMessage=function(){function i(e){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.ihave=r.emptyArray,i.prototype.iwant=r.emptyArray,i.prototype.graft=r.emptyArray,i.prototype.prune=r.emptyArray,i.encode=function(e,t){if(t||(t=n.create()),null!=e.ihave&&e.ihave.length)for(var r=0;r<e.ihave.length;++r)s.RPC.ControlIHave.encode(e.ihave[r],t.uint32(10).fork()).ldelim();if(null!=e.iwant&&e.iwant.length)for(r=0;r<e.iwant.length;++r)s.RPC.ControlIWant.encode(e.iwant[r],t.uint32(18).fork()).ldelim();if(null!=e.graft&&e.graft.length)for(r=0;r<e.graft.length;++r)s.RPC.ControlGraft.encode(e.graft[r],t.uint32(26).fork()).ldelim();if(null!=e.prune&&e.prune.length)for(r=0;r<e.prune.length;++r)s.RPC.ControlPrune.encode(e.prune[r],t.uint32(34).fork()).ldelim();return t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.ControlMessage;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.ihave&&i.ihave.length||(i.ihave=[]),i.ihave.push(s.RPC.ControlIHave.decode(e,e.uint32()));break;case 2:i.iwant&&i.iwant.length||(i.iwant=[]),i.iwant.push(s.RPC.ControlIWant.decode(e,e.uint32()));break;case 3:i.graft&&i.graft.length||(i.graft=[]),i.graft.push(s.RPC.ControlGraft.decode(e,e.uint32()));break;case 4:i.prune&&i.prune.length||(i.prune=[]),i.prune.push(s.RPC.ControlPrune.decode(e,e.uint32()));break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlMessage)return e;var t=new s.RPC.ControlMessage;if(e.ihave){if(!Array.isArray(e.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");t.ihave=[];for(var n=0;n<e.ihave.length;++n){if("object"!==typeof e.ihave[n])throw TypeError(".RPC.ControlMessage.ihave: object expected");t.ihave[n]=s.RPC.ControlIHave.fromObject(e.ihave[n])}}if(e.iwant){if(!Array.isArray(e.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");t.iwant=[];for(n=0;n<e.iwant.length;++n){if("object"!==typeof e.iwant[n])throw TypeError(".RPC.ControlMessage.iwant: object expected");t.iwant[n]=s.RPC.ControlIWant.fromObject(e.iwant[n])}}if(e.graft){if(!Array.isArray(e.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");t.graft=[];for(n=0;n<e.graft.length;++n){if("object"!==typeof e.graft[n])throw TypeError(".RPC.ControlMessage.graft: object expected");t.graft[n]=s.RPC.ControlGraft.fromObject(e.graft[n])}}if(e.prune){if(!Array.isArray(e.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");t.prune=[];for(n=0;n<e.prune.length;++n){if("object"!==typeof e.prune[n])throw TypeError(".RPC.ControlMessage.prune: object expected");t.prune[n]=s.RPC.ControlPrune.fromObject(e.prune[n])}}return t},i.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.ihave=[],n.iwant=[],n.graft=[],n.prune=[]),e.ihave&&e.ihave.length){n.ihave=[];for(var r=0;r<e.ihave.length;++r)n.ihave[r]=s.RPC.ControlIHave.toObject(e.ihave[r],t)}if(e.iwant&&e.iwant.length){n.iwant=[];for(r=0;r<e.iwant.length;++r)n.iwant[r]=s.RPC.ControlIWant.toObject(e.iwant[r],t)}if(e.graft&&e.graft.length){n.graft=[];for(r=0;r<e.graft.length;++r)n.graft[r]=s.RPC.ControlGraft.toObject(e.graft[r],t)}if(e.prune&&e.prune.length){n.prune=[];for(r=0;r<e.prune.length;++r)n.prune[r]=s.RPC.ControlPrune.toObject(e.prune[r],t)}return n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIHave=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.topicID=null,i.prototype.messageIDs=r.emptyArray,Object.defineProperty(i.prototype,"_topicID",{get:r.oneOfGetter(o=["topicID"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=n.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.messageIDs&&e.messageIDs.length)for(var r=0;r<e.messageIDs.length;++r)t.uint32(18).bytes(e.messageIDs[r]);return t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.ControlIHave;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes());break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlIHave)return e;var t=new s.RPC.ControlIHave;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");t.messageIDs=[];for(var n=0;n<e.messageIDs.length;++n)"string"===typeof e.messageIDs[n]?r.base64.decode(e.messageIDs[n],t.messageIDs[n]=r.newBuffer(r.base64.length(e.messageIDs[n])),0):e.messageIDs[n].length&&(t.messageIDs[n]=e.messageIDs[n])}return t},i.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.messageIDs=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(n.topicID=e.topicID,t.oneofs&&(n._topicID="topicID")),e.messageIDs&&e.messageIDs.length){n.messageIDs=[];for(var s=0;s<e.messageIDs.length;++s)n.messageIDs[s]=t.bytes===String?r.base64.encode(e.messageIDs[s],0,e.messageIDs[s].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[s]):e.messageIDs[s]}return n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlIWant=function(){function i(e){if(this.messageIDs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return i.prototype.messageIDs=r.emptyArray,i.encode=function(e,t){if(t||(t=n.create()),null!=e.messageIDs&&e.messageIDs.length)for(var r=0;r<e.messageIDs.length;++r)t.uint32(10).bytes(e.messageIDs[r]);return t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.ControlIWant;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.messageIDs&&i.messageIDs.length||(i.messageIDs=[]),i.messageIDs.push(e.bytes());break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlIWant)return e;var t=new s.RPC.ControlIWant;if(e.messageIDs){if(!Array.isArray(e.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");t.messageIDs=[];for(var n=0;n<e.messageIDs.length;++n)"string"===typeof e.messageIDs[n]?r.base64.decode(e.messageIDs[n],t.messageIDs[n]=r.newBuffer(r.base64.length(e.messageIDs[n])),0):e.messageIDs[n].length&&(t.messageIDs[n]=e.messageIDs[n])}return t},i.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.messageIDs=[]),e.messageIDs&&e.messageIDs.length){n.messageIDs=[];for(var s=0;s<e.messageIDs.length;++s)n.messageIDs[s]=t.bytes===String?r.base64.encode(e.messageIDs[s],0,e.messageIDs[s].length):t.bytes===Array?Array.prototype.slice.call(e.messageIDs[s]):e.messageIDs[s]}return n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlGraft=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.topicID=null,Object.defineProperty(i.prototype,"_topicID",{get:r.oneOfGetter(o=["topicID"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=n.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.ControlGraft;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlGraft)return e;var t=new s.RPC.ControlGraft;return null!=e.topicID&&(t.topicID=String(e.topicID)),t},i.toObject=function(e,t){t||(t={});var n={};return null!=e.topicID&&e.hasOwnProperty("topicID")&&(n.topicID=e.topicID,t.oneofs&&(n._topicID="topicID")),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.ControlPrune=function(){function i(e){if(this.peers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.topicID=null,i.prototype.peers=r.emptyArray,i.prototype.backoff=null,Object.defineProperty(i.prototype,"_topicID",{get:r.oneOfGetter(o=["topicID"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_backoff",{get:r.oneOfGetter(o=["backoff"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){if(t||(t=n.create()),null!=e.topicID&&Object.hasOwnProperty.call(e,"topicID")&&t.uint32(10).string(e.topicID),null!=e.peers&&e.peers.length)for(var r=0;r<e.peers.length;++r)s.RPC.PeerInfo.encode(e.peers[r],t.uint32(18).fork()).ldelim();return null!=e.backoff&&Object.hasOwnProperty.call(e,"backoff")&&t.uint32(24).uint64(e.backoff),t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.ControlPrune;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.topicID=e.string();break;case 2:i.peers&&i.peers.length||(i.peers=[]),i.peers.push(s.RPC.PeerInfo.decode(e,e.uint32()));break;case 3:i.backoff=e.uint64();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.ControlPrune)return e;var t=new s.RPC.ControlPrune;if(null!=e.topicID&&(t.topicID=String(e.topicID)),e.peers){if(!Array.isArray(e.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");t.peers=[];for(var n=0;n<e.peers.length;++n){if("object"!==typeof e.peers[n])throw TypeError(".RPC.ControlPrune.peers: object expected");t.peers[n]=s.RPC.PeerInfo.fromObject(e.peers[n])}}return null!=e.backoff&&(r.Long?(t.backoff=r.Long.fromValue(e.backoff)).unsigned=!0:"string"===typeof e.backoff?t.backoff=parseInt(e.backoff,10):"number"===typeof e.backoff?t.backoff=e.backoff:"object"===typeof e.backoff&&(t.backoff=new r.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0))),t},i.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.peers=[]),null!=e.topicID&&e.hasOwnProperty("topicID")&&(n.topicID=e.topicID,t.oneofs&&(n._topicID="topicID")),e.peers&&e.peers.length){n.peers=[];for(var i=0;i<e.peers.length;++i)n.peers[i]=s.RPC.PeerInfo.toObject(e.peers[i],t)}return null!=e.backoff&&e.hasOwnProperty("backoff")&&("number"===typeof e.backoff?n.backoff=t.longs===String?String(e.backoff):e.backoff:n.backoff=t.longs===String?r.Long.prototype.toString.call(e.backoff):t.longs===Number?new r.LongBits(e.backoff.low>>>0,e.backoff.high>>>0).toNumber(!0):e.backoff,t.oneofs&&(n._backoff="backoff")),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i.PeerInfo=function(){function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var o;return i.prototype.peerID=null,i.prototype.signedPeerRecord=null,Object.defineProperty(i.prototype,"_peerID",{get:r.oneOfGetter(o=["peerID"]),set:r.oneOfSetter(o)}),Object.defineProperty(i.prototype,"_signedPeerRecord",{get:r.oneOfGetter(o=["signedPeerRecord"]),set:r.oneOfSetter(o)}),i.encode=function(e,t){return t||(t=n.create()),null!=e.peerID&&Object.hasOwnProperty.call(e,"peerID")&&t.uint32(10).bytes(e.peerID),null!=e.signedPeerRecord&&Object.hasOwnProperty.call(e,"signedPeerRecord")&&t.uint32(18).bytes(e.signedPeerRecord),t},i.decode=function(e,n){e instanceof t||(e=t.create(e));var r=void 0===n?e.len:e.pos+n,i=new s.RPC.PeerInfo;while(e.pos<r){var o=e.uint32();switch(o>>>3){case 1:i.peerID=e.bytes();break;case 2:i.signedPeerRecord=e.bytes();break;default:e.skipType(7&o);break}}return i},i.fromObject=function(e){if(e instanceof s.RPC.PeerInfo)return e;var t=new s.RPC.PeerInfo;return null!=e.peerID&&("string"===typeof e.peerID?r.base64.decode(e.peerID,t.peerID=r.newBuffer(r.base64.length(e.peerID)),0):e.peerID.length&&(t.peerID=e.peerID)),null!=e.signedPeerRecord&&("string"===typeof e.signedPeerRecord?r.base64.decode(e.signedPeerRecord,t.signedPeerRecord=r.newBuffer(r.base64.length(e.signedPeerRecord)),0):e.signedPeerRecord.length&&(t.signedPeerRecord=e.signedPeerRecord)),t},i.toObject=function(e,t){t||(t={});var n={};return null!=e.peerID&&e.hasOwnProperty("peerID")&&(n.peerID=t.bytes===String?r.base64.encode(e.peerID,0,e.peerID.length):t.bytes===Array?Array.prototype.slice.call(e.peerID):e.peerID,t.oneofs&&(n._peerID="peerID")),null!=e.signedPeerRecord&&e.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=t.bytes===String?r.base64.encode(e.signedPeerRecord,0,e.signedPeerRecord.length):t.bytes===Array?Array.prototype.slice.call(e.signedPeerRecord):e.signedPeerRecord,t.oneofs&&(n._signedPeerRecord="signedPeerRecord")),n},i.prototype.toJSON=function(){return this.constructor.toObject(this,e.util.toJSONOptions)},i}(),i}(),s}))},6402:function(e){(function(){e.exports=y;var t=86400,n=3200,r=146097*n/400,s=t*r,i=1e3*s,o=864e13,a=4294967296,c=1e6,l="000000000",u=Math.trunc||function(e){var t=e-e%1;return 0==t&&(e<0||0===e&&1/e!=1/0)?-0:t},h=y.prototype,d=(y.fromDate=function(e){return new y(+e)},y.fromInt64BE=_(0,1,2,3,0,4),y.fromInt64LE=_(3,2,1,0,4,0),y.fromString=function(e){var t,n=new y;e=(e+="").replace(/^\s*[+\-]?\d+/,(function(e){e=+e;var t=1970+(e-1970)%400;return n.year=e-t,t})).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,(function(e,n,r){return n<0&&(r*=-1),t=6e4*(60*+n+ +r),""})).replace(/\.\d+$/,(function(e){return n.nano=+(e+l).substr(1,9),""})).split(/\D+/);if(1<e.length?e[1]--:e[1]=0,n.time=t=Date.UTC.apply(Date,e)-(t||0),isNaN(t))throw new TypeError("Invalid Date");return m(n)},y.fromTimeT=function(e){return b(e,0)},h.year=0,h.time=0,h.nano=0,h.addNano=function(e){return this.nano+=+e||0,this},h.getNano=function(){var e=m(this);return(e.time%1e3*c+ +e.nano+1e9)%1e9},h.getTimeT=function(){var e=m(this),s=Math.floor(e.time/1e3);e=e.year;return e&&(s+=e*r*t/n),s},h.getYear=function(){return this.toDate().getUTCFullYear()+this.year},h.toDate=function(){return w(m(this).time)},h.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},h.toString=function(e){var t=this,n=t.toDate(),r={H:function(){return S(n.getUTCHours())},L:function(){return k(n.getUTCMilliseconds(),3)},M:function(){return S(n.getUTCMinutes())},N:function(){return k(t.getNano(),9)},S:function(){return S(n.getUTCSeconds())},Y:function(){var e=t.getYear();return 999999<e?"+"+e:9999<e?"+"+k(e,6):0<=e?k(e,4):-999999<=e?"-"+k(-e,6):e},a:function(){return p[n.getUTCDay()]},b:function(){return f[n.getUTCMonth()]},d:function(){return S(n.getUTCDate())},e:function(){return function(e){return(9<e?"":" ")+(0|e)}(n.getUTCDate())},m:function(){return S(n.getUTCMonth()+1)}};return function e(t){return t.replace(/%./g,(function(t){var n=t[1],s=g[n];n=r[n];return s?e(s):n?n():t}))}(e||d)},h.writeInt64BE=v(0,1,2,3,0,4),h.writeInt64LE=v(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],g={"%":"%",F:"%Y-%m-%d",n:"\n",R:"%H:%M",T:"%H:%M:%S",t:"\t",X:"%T",Z:"GMT",z:"+0000"};return y;function y(e,t,n){var r=this;if(!(r instanceof y))return new y(e,t,n);r.time=+e||0,r.nano=+t||0,r.year=+n||0,m(r)}function m(e){var t,r,s,a=e.year,l=e.time,h=e.nano,d=((h<0||c<=h)&&(h-=(r=Math.floor(h/c))*c,l+=r,r=1),a%n);return(l<-o||o<l||d)&&((t=u(l/i))&&(a+=t*n,l-=t*i),(s=w(l)).setUTCFullYear(d+s.getUTCFullYear()),s=(l=+s)+(t=u((a-=d)/n))*i,t&&-o<=s&&s<=o&&(a-=t*n,l=s),r=1),r&&(e.year=a,e.time=l,e.nano=h),e}function w(e){var t=new Date(0);return t.setTime(e),t}function b(e,t){e=+e||0;var r=u((t=(0|t)*a)/s)+u(e/s);t=t%s+e%s,e=u(t/s);return e&&(r+=e,t-=e*s),new y(1e3*t,0,r*n)}function v(e,s,i,o,c,l){return function(e,s){var i=m(this);e=e||new Array(8),E(e,s|=0);var o=Math.floor(i.time/1e3),d=(i=i.year*(r*t/n),u(i/a)+u(o/a));i=i%a+o%a,o=Math.floor(i/a);return o&&(d+=o,i-=o*a),h(e,s+c,d),h(e,s+l,i),e};function h(t,n,r){t[n+e]=r>>24&255,t[n+s]=r>>16&255,t[n+i]=r>>8&255,t[n+o]=255&r}}function _(e,t,n,r,s,i){return function(e,t){E(e,t|=0);var n=o(e,t+s);return b(o(e,t+i),n)};function o(s,i){return 16777216*s[i+e]+(s[i+t]<<16|s[i+n]<<8|s[i+r])}}function E(e,t){if(e=e&&e.length,null==e)throw new TypeError("Invalid Buffer");if(e<t+8)throw new RangeError("Out of range")}function S(e){return(9<e?"":"0")+(0|e)}function k(e,t){return(l+(0|e)).substr(-t)}})()},908:function(e,t,n){"use strict";n.r(t),n.d(t,{code:function(){return f},decode:function(){return g},encode:function(){return p},name:function(){return d}});var r=n(9559),s=n(608);const i=42;function o(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=s.k0.asCID(e);if(!t)return null;const n=new Uint8Array(t.bytes.byteLength+1);return n.set(t.bytes,1),[new r.WU(r.Dy.tag,i),new r.WU(r.Dy.bytes,n)]}function a(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function c(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const l={float64:!0,typeEncoders:{Object:o,undefined:a,number:c}};function u(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return s.k0.decode(e.subarray(1))}const h={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};h.tags[i]=u;const d="dag-cbor",f=113,p=e=>r.cv(e,l),g=e=>r.Jx(e,h)},9559:function(e,t,n){"use strict";n.d(t,{Dy:function(){return i.D},Jx:function(){return s.Jx},WU:function(){return i.W},cv:function(){return r.cv}});var r=n(3098),s=n(9355),i=n(470)},9325:function(e,t,n){"use strict";n.d(t,{Fh:function(){return p},Jl:function(){return c},Km:function(){return u},Tp:function(){return g},X0:function(){return a},YX:function(){return l},Zh:function(){return h},cs:function(){return d},kj:function(){return o},or:function(){return i},uN:function(){return f}});n(7658);var r=n(470),s=n(9039);const i=[24,256,65536,4294967296,BigInt("18446744073709551616")];function o(e,t,n){(0,s.DO)(e,t,1);const r=e[t];if(!0===n.strict&&r<i[0])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);return r}function a(e,t,n){(0,s.DO)(e,t,2);const r=e[t]<<8|e[t+1];if(!0===n.strict&&r<i[1])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);return r}function c(e,t,n){(0,s.DO)(e,t,4);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===n.strict&&r<i[2])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);return r}function l(e,t,n){(0,s.DO)(e,t,8);const r=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],a=(BigInt(r)<<BigInt(32))+BigInt(o);if(!0===n.strict&&a<i[3])throw new Error(`${s.IR} integer encoded in more bytes than necessary (strict decode)`);if(a<=Number.MAX_SAFE_INTEGER)return Number(a);if(!0===n.allowBigInt)return a;throw new Error(`${s.IR} integers outside of the safe integer range are not supported`)}function u(e,t,n,s){return new r.W(r.D.uint,o(e,t+1,s),2)}function h(e,t,n,s){return new r.W(r.D.uint,a(e,t+1,s),3)}function d(e,t,n,s){return new r.W(r.D.uint,c(e,t+1,s),5)}function f(e,t,n,s){return new r.W(r.D.uint,l(e,t+1,s),9)}function p(e,t){return g(e,0,t.value)}function g(e,t,n){if(n<i[0]){const r=Number(n);e.push([t|r])}else if(n<i[1]){const r=Number(n);e.push([24|t,r])}else if(n<i[2]){const r=Number(n);e.push([25|t,r>>>8,255&r])}else if(n<i[3]){const r=Number(n);e.push([26|t,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<i[4]))throw new Error(`${s.IR} encountered BigInt larger than allowable range`);{const n=[27|t,0,0,0,0,0,0,0];let s=Number(r&BigInt(4294967295)),i=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&s,s>>=8,n[7]=255&s,s>>=8,n[6]=255&s,s>>=8,n[5]=255&s,n[4]=255&i,i>>=8,n[3]=255&i,i>>=8,n[2]=255&i,i>>=8,n[1]=255&i,e.push(n)}}}p.encodedSize=function(e){return g.encodedSize(e.value)},g.encodedSize=function(e){return e<i[0]?1:e<i[1]?2:e<i[2]?3:e<i[3]?5:9},p.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}},9349:function(e,t,n){"use strict";n.d(t,{UT:function(){return d},ec:function(){return h},r0:function(){return a},wy:function(){return c},yr:function(){return o}});var r=n(470),s=n(9325),i=n(9039);function o(e,t,n,i){return new r.W(r.D.negint,-1-s.kj(e,t+1,i),2)}function a(e,t,n,i){return new r.W(r.D.negint,-1-s.X0(e,t+1,i),3)}function c(e,t,n,i){return new r.W(r.D.negint,-1-s.Jl(e,t+1,i),5)}const l=BigInt(-1),u=BigInt(1);function h(e,t,n,o){const a=s.YX(e,t+1,o);if("bigint"!==typeof a){const e=-1-a;if(e>=Number.MIN_SAFE_INTEGER)return new r.W(r.D.negint,e,9)}if(!0!==o.allowBigInt)throw new Error(`${i.IR} integers outside of the safe integer range are not supported`);return new r.W(r.D.negint,l-BigInt(a),9)}function d(e,t){const n=t.value,r="bigint"===typeof n?n*l-u:-1*n-1;s.Tp(e,t.type.majorEncoded,r)}d.encodedSize=function(e){const t=e.value,n="bigint"===typeof t?t*l-u:-1*t-1;return n<s.or[0]?1:n<s.or[1]?2:n<s.or[2]?3:n<s.or[3]?5:9},d.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}},4435:function(e,t,n){"use strict";n.d(t,{BS:function(){return u},Ii:function(){return c},ME:function(){return d},UQ:function(){return l},hg:function(){return p},zU:function(){return h}});n(7658);var r=n(470),s=n(9039),i=n(9325),o=n(8526);function a(e,t,n,i){(0,s.DO)(e,t,n+i);const a=(0,o.tP)(e,t+n,t+n+i);return new r.W(r.D.bytes,a,n+i)}function c(e,t,n,r){return a(e,t,1,n)}function l(e,t,n,r){return a(e,t,2,i.kj(e,t+1,r))}function u(e,t,n,r){return a(e,t,3,i.X0(e,t+1,r))}function h(e,t,n,r){return a(e,t,5,i.Jl(e,t+1,r))}function d(e,t,n,r){const o=i.YX(e,t+1,r);if("bigint"===typeof o)throw new Error(`${s.IR} 64-bit integer bytes lengths not supported`);return a(e,t,9,o)}function f(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===r.D.string?(0,o.mL)(e.value):e.value),e.encodedBytes}function p(e,t){const n=f(t);i.Tp(e,t.type.majorEncoded,n.length),e.push(n)}function g(e,t){return e.length<t.length?-1:e.length>t.length?1:(0,o.qu)(e,t)}p.encodedSize=function(e){const t=f(e);return i.Tp.encodedSize(t.length)+t.length},p.compareTokens=function(e,t){return g(f(e),f(t))}},2878:function(e,t,n){"use strict";n.d(t,{Bq:function(){return u},YW:function(){return p},bc:function(){return f},h:function(){return h},nt:function(){return l},q0:function(){return d}});var r=n(470),s=n(9039),i=n(9325),o=n(4435),a=n(8526);function c(e,t,n,i,o){const c=n+i;(0,s.DO)(e,t,c);const l=new r.W(r.D.string,(0,a.BB)(e,t+n,t+c),c);return!0===o.retainStringBytes&&(l.byteValue=(0,a.tP)(e,t+n,t+c)),l}function l(e,t,n,r){return c(e,t,1,n,r)}function u(e,t,n,r){return c(e,t,2,i.kj(e,t+1,r),r)}function h(e,t,n,r){return c(e,t,3,i.X0(e,t+1,r),r)}function d(e,t,n,r){return c(e,t,5,i.Jl(e,t+1,r),r)}function f(e,t,n,r){const o=i.YX(e,t+1,r);if("bigint"===typeof o)throw new Error(`${s.IR} 64-bit integer string lengths not supported`);return c(e,t,9,o,r)}const p=o.hg},9315:function(e,t,n){"use strict";n.d(t,{HF:function(){return f},Ju:function(){return a},OC:function(){return l},a8:function(){return h},h7:function(){return c},lY:function(){return u},s5:function(){return d}});var r=n(470),s=n(9325),i=n(9039);function o(e,t,n,s){return new r.W(r.D.array,s,n)}function a(e,t,n,r){return o(e,t,1,n)}function c(e,t,n,r){return o(e,t,2,s.kj(e,t+1,r))}function l(e,t,n,r){return o(e,t,3,s.X0(e,t+1,r))}function u(e,t,n,r){return o(e,t,5,s.Jl(e,t+1,r))}function h(e,t,n,r){const a=s.YX(e,t+1,r);if("bigint"===typeof a)throw new Error(`${i.IR} 64-bit integer array lengths not supported`);return o(e,t,9,a)}function d(e,t,n,r){if(!1===r.allowIndefinite)throw new Error(`${i.IR} indefinite length items not allowed`);return o(e,t,1,1/0)}function f(e,t){s.Tp(e,r.D.array.majorEncoded,t.value)}f.compareTokens=s.Fh.compareTokens,f.encodedSize=function(e){return s.Tp.encodedSize(e.value)}},3964:function(e,t,n){"use strict";n.d(t,{F2:function(){return h},G:function(){return c},IY:function(){return u},KI:function(){return f},_K:function(){return a},ng:function(){return d},qe:function(){return l}});var r=n(470),s=n(9325),i=n(9039);function o(e,t,n,s){return new r.W(r.D.map,s,n)}function a(e,t,n,r){return o(e,t,1,n)}function c(e,t,n,r){return o(e,t,2,s.kj(e,t+1,r))}function l(e,t,n,r){return o(e,t,3,s.X0(e,t+1,r))}function u(e,t,n,r){return o(e,t,5,s.Jl(e,t+1,r))}function h(e,t,n,r){const a=s.YX(e,t+1,r);if("bigint"===typeof a)throw new Error(`${i.IR} 64-bit integer map lengths not supported`);return o(e,t,9,a)}function d(e,t,n,r){if(!1===r.allowIndefinite)throw new Error(`${i.IR} indefinite length items not allowed`);return o(e,t,1,1/0)}function f(e,t){s.Tp(e,r.D.map.majorEncoded,t.value)}f.compareTokens=s.Fh.compareTokens,f.encodedSize=function(e){return s.Tp.encodedSize(e.value)}},9887:function(e,t,n){"use strict";n.d(t,{CF:function(){return a},MV:function(){return l},ZR:function(){return o},qJ:function(){return i},vP:function(){return c},xy:function(){return u}});var r=n(470),s=n(9325);function i(e,t,n,s){return new r.W(r.D.tag,n,1)}function o(e,t,n,i){return new r.W(r.D.tag,s.kj(e,t+1,i),2)}function a(e,t,n,i){return new r.W(r.D.tag,s.X0(e,t+1,i),3)}function c(e,t,n,i){return new r.W(r.D.tag,s.Jl(e,t+1,i),5)}function l(e,t,n,i){return new r.W(r.D.tag,s.YX(e,t+1,i),9)}function u(e,t){s.Tp(e,r.D.tag.majorEncoded,t.value)}u.compareTokens=s.Fh.compareTokens,u.encodedSize=function(e){return s.Tp.encodedSize(e.value)}},3182:function(e,t,n){"use strict";n.d(t,{GI:function(){return p},h1:function(){return u},mW:function(){return f},tA:function(){return y},vV:function(){return g},y7:function(){return h}});n(7658);var r=n(470),s=n(9039),i=n(9325);const o=20,a=21,c=22,l=23;function u(e,t,n,i){if(!1===i.allowUndefined)throw new Error(`${s.IR} undefined values are not supported`);return!0===i.coerceUndefinedToNull?new r.W(r.D["null"],null,1):new r.W(r.D.undefined,void 0,1)}function h(e,t,n,i){if(!1===i.allowIndefinite)throw new Error(`${s.IR} indefinite length items not allowed`);return new r.W(r.D["break"],void 0,1)}function d(e,t,n){if(n){if(!1===n.allowNaN&&Number.isNaN(e))throw new Error(`${s.IR} NaN values are not supported`);if(!1===n.allowInfinity&&(e===1/0||e===-1/0))throw new Error(`${s.IR} Infinity values are not supported`)}return new r.W(r.D.float,e,t)}function f(e,t,n,r){return d(_(e,t+1),3,r)}function p(e,t,n,r){return d(S(e,t+1),5,r)}function g(e,t,n,r){return d(I(e,t+1),9,r)}function y(e,t,n){const s=t.value;if(!1===s)e.push([r.D.float.majorEncoded|o]);else if(!0===s)e.push([r.D.float.majorEncoded|a]);else if(null===s)e.push([r.D.float.majorEncoded|c]);else if(void 0===s)e.push([r.D.float.majorEncoded|l]);else{let t,r=!1;n&&!0===n.float64||(v(s),t=_(b,1),s===t||Number.isNaN(s)?(b[0]=249,e.push(b.slice(0,3)),r=!0):(E(s),t=S(b,1),s===t&&(b[0]=250,e.push(b.slice(0,5)),r=!0))),r||(k(s),t=I(b,1),b[0]=251,e.push(b.slice(0,9)))}}y.encodedSize=function(e,t){const n=e.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!t||!0!==t.float64){v(n);let e=_(b,1);if(n===e||Number.isNaN(n))return 3;if(E(n),e=S(b,1),n===e)return 5}return 9};const m=new ArrayBuffer(9),w=new DataView(m,1),b=new Uint8Array(m,0);function v(e){if(e===1/0)w.setUint16(0,31744,!1);else if(e===-1/0)w.setUint16(0,64512,!1);else if(Number.isNaN(e))w.setUint16(0,32256,!1);else{w.setFloat32(0,e);const t=w.getUint32(0),n=(2139095040&t)>>23,r=8388607&t;if(255===n)w.setUint16(0,31744,!1);else if(0===n)w.setUint16(0,(2147483648&e)>>16|r>>13,!1);else{const e=n-127;e<-24?w.setUint16(0,0):e<-14?w.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):w.setUint16(0,(2147483648&t)>>16|e+15<<10|r>>13,!1)}}}function _(e,t){if(e.length-t<2)throw new Error(`${s.IR} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,i=1023&n;let o;return o=0===r?i*2**-24:31!==r?(i+1024)*2**(r-25):0===i?1/0:NaN,32768&n?-o:o}function E(e){w.setFloat32(0,e,!1)}function S(e,t){if(e.length-t<4)throw new Error(`${s.IR} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function k(e){w.setFloat64(0,e,!1)}function I(e,t){if(e.length-t<8)throw new Error(`${s.IR} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}y.compareTokens=i.Fh.compareTokens},8526:function(e,t,n){"use strict";n.d(t,{BB:function(){return c},Dz:function(){return a},Pu:function(){return w},mL:function(){return l},nI:function(){return u},qu:function(){return p},tP:function(){return h},un:function(){return f},zo:function(){return d}});n(7658);const r=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,s=new TextDecoder,i=new TextEncoder;function o(e){return r&&globalThis.Buffer.isBuffer(e)}function a(e){return e instanceof Uint8Array?o(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const c=r?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):y(e,t,n):(e,t,n)=>n-t>64?s.decode(e.subarray(t,n)):y(e,t,n),l=r?e=>e.length>64?globalThis.Buffer.from(e):g(e):e=>e.length>64?i.encode(e):g(e),u=e=>Uint8Array.from(e),h=r?(e,t,n)=>o(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),d=r?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),a(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let r=0;for(let s of e)r+s.length>n.length&&(s=s.subarray(0,n.length-r)),n.set(s,r),r+=s.length;return n},f=r?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function p(e,t){if(o(e)&&o(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function g(e,t=1/0){let n;const r=e.length;let s=null;const i=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function y(e,t,n){const r=[];while(t<n){const s=e[t];let i=null,o=s>239?4:s>223?3:s>191?2:1;if(t+o<=n){let n,r,a,c;switch(o){case 1:s<128&&(i=s);break;case 2:n=e[t+1],128===(192&n)&&(c=(31&s)<<6|63&n,c>127&&(i=c));break;case 3:n=e[t+1],r=e[t+2],128===(192&n)&&128===(192&r)&&(c=(15&s)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[t+1],r=e[t+2],a=e[t+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&s)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),t+=o}return w(r)}const m=4096;function w(e){const t=e.length;if(t<=m)return String.fromCharCode.apply(String,e);let n="",r=0;while(r<t)n+=String.fromCharCode.apply(String,e.slice(r,r+=m));return n}},9039:function(e,t,n){"use strict";n.d(t,{DO:function(){return o},IR:function(){return r},OO:function(){return s}});const r="CBOR decode error:",s="CBOR encode error:",i=[];function o(e,t,n){if(e.length-t<n)throw new Error(`${r} not enough data for type`)}i[23]=1,i[24]=2,i[25]=3,i[26]=5,i[27]=9},9355:function(e,t,n){"use strict";n.d(t,{Jx:function(){return f}});var r=n(9039),s=n(470),i=n(6346);const o={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class a{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=i.PS[e];if(void 0===t){const n=i.cW[e];if(!n)throw new Error(`${r.IR} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const s=31&e;t=n(this.data,this.pos,s,this.options)}return this.pos+=t.encodedLength,t}}const c=Symbol.for("DONE"),l=Symbol.for("BREAK");function u(e,t,n){const s=[];for(let i=0;i<e.value;i++){const o=d(t,n);if(o===l){if(e.value===1/0)break;throw new Error(`${r.IR} got unexpected break to lengthed array`)}if(o===c)throw new Error(`${r.IR} found array but not enough entries (got ${i}, expected ${e.value})`);s[i]=o}return s}function h(e,t,n){const s=!0===n.useMaps,i=s?void 0:{},o=s?new Map:void 0;for(let a=0;a<e.value;a++){const u=d(t,n);if(u===l){if(e.value===1/0)break;throw new Error(`${r.IR} got unexpected break to lengthed map`)}if(u===c)throw new Error(`${r.IR} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(!0!==s&&"string"!==typeof u)throw new Error(`${r.IR} non-string keys not supported (got ${typeof u})`);if(!0===n.rejectDuplicateMapKeys&&(s&&o.has(u)||!s&&u in i))throw new Error(`${r.IR} found repeat map key "${u}"`);const h=d(t,n);if(h===c)throw new Error(`${r.IR} found map but not enough entries (got ${a} [no value], expected ${e.value})`);s?o.set(u,h):i[u]=h}return s?o:i}function d(e,t){if(e.done())return c;const n=e.next();if(n.type===s.D["break"])return l;if(n.type.terminal)return n.value;if(n.type===s.D.array)return u(n,e,t);if(n.type===s.D.map)return h(n,e,t);if(n.type===s.D.tag){if(t.tags&&"function"===typeof t.tags[n.value]){const r=d(e,t);return t.tags[n.value](r)}throw new Error(`${r.IR} tag not supported (${n.value})`)}throw new Error("unsupported")}function f(e,t){if(!(e instanceof Uint8Array))throw new Error(`${r.IR} data to decode must be a Uint8Array`);t=Object.assign({},o,t);const n=t.tokenizer||new a(e,t),s=d(n,t);if(s===c)throw new Error(`${r.IR} did not find any content to decode`);if(s===l)throw new Error(`${r.IR} got unexpected break`);if(!n.done())throw new Error(`${r.IR} too many terminals, data makes no sense`);return s}},3098:function(e,t,n){"use strict";n.d(t,{cv:function(){return L},w$:function(){return D}});const r=["string","number","bigint","symbol"],s=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function i(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(r.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(o(e))return"Buffer";const n=a(e);return n||"Object"}function o(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function a(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(s.includes(t))return t}var c=n(470),l=(n(7658),n(8526));const u=256;class h{constructor(e=u){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];const n=this.cursor+e.length;if(n<=this.maxCursor+1){const n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=(0,l.un)(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=(0,l.tP)(n,0,this.cursor)}else t=(0,l.zo)(this.chunks,this.cursor);return e&&this.reset(),t}}var d=n(9039),f=n(6346),p=n(9325),g=n(9349),y=n(4435),m=n(2878),w=n(9315),b=n(3964),v=n(9887),_=n(3182);const E={float64:!1,mapSorter:N,quickEncodeToken:f.JN};function S(){const e=[];return e[c.D.uint.major]=p.Fh,e[c.D.negint.major]=g.UT,e[c.D.bytes.major]=y.hg,e[c.D.string.major]=m.YW,e[c.D.array.major]=w.HF,e[c.D.map.major]=b.KI,e[c.D.tag.major]=v.xy,e[c.D.float.major]=_.tA,e}const k=S(),I=new h;class A{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${d.OO} object contains circular references`);return new A(t,e)}}const T={null:new c.W(c.D["null"],null),undefined:new c.W(c.D.undefined,void 0),true:new c.W(c.D["true"],!0),false:new c.W(c.D["false"],!1),emptyArray:new c.W(c.D.array,0),emptyMap:new c.W(c.D.map,0)},R={number(e,t,n,r){return Number.isInteger(e)&&Number.isSafeInteger(e)?e>=0?new c.W(c.D.uint,e):new c.W(c.D.negint,e):new c.W(c.D.float,e)},bigint(e,t,n,r){return e>=BigInt(0)?new c.W(c.D.uint,e):new c.W(c.D.negint,e)},Uint8Array(e,t,n,r){return new c.W(c.D.bytes,e)},string(e,t,n,r){return new c.W(c.D.string,e)},boolean(e,t,n,r){return e?T.true:T.false},null(e,t,n,r){return T.null},undefined(e,t,n,r){return T.undefined},ArrayBuffer(e,t,n,r){return new c.W(c.D.bytes,new Uint8Array(e))},DataView(e,t,n,r){return new c.W(c.D.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,r){if(!e.length)return!0===n.addBreakTokens?[T.emptyArray,new c.W(c.D["break"])]:T.emptyArray;r=A.createCheck(r,e);const s=[];let i=0;for(const o of e)s[i++]=C(o,n,r);return n.addBreakTokens?[new c.W(c.D.array,e.length),s,new c.W(c.D["break"])]:[new c.W(c.D.array,e.length),s]},Object(e,t,n,r){const s="Object"!==t,i=s?e.keys():Object.keys(e),o=s?e.size:i.length;if(!o)return!0===n.addBreakTokens?[T.emptyMap,new c.W(c.D["break"])]:T.emptyMap;r=A.createCheck(r,e);const a=[];let l=0;for(const c of i)a[l++]=[C(c,n,r),C(s?e.get(c):e[c],n,r)];return P(a,n),n.addBreakTokens?[new c.W(c.D.map,o),a,new c.W(c.D["break"])]:[new c.W(c.D.map,o),a]}};R.Map=R.Object,R.Buffer=R.Uint8Array;for(const x of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))R[`${x}Array`]=R.DataView;function C(e,t={},n){const r=i(e),s=t&&t.typeEncoders&&t.typeEncoders[r]||R[r];if("function"===typeof s){const i=s(e,r,t,n);if(null!=i)return i}const o=R[r];if(!o)throw new Error(`${d.OO} unsupported type: ${r}`);return o(e,r,t,n)}function P(e,t){t.mapSorter&&e.sort(t.mapSorter)}function N(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==r.type)return n.type.compare(r.type);const s=n.type.major,i=k[s].compareTokens(n,r);return 0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function O(e,t,n,r){if(Array.isArray(t))for(const s of t)O(e,s,n,r);else n[t.type.major](e,t,r)}function D(e,t,n){const r=C(e,n);if(!Array.isArray(r)&&n.quickEncodeToken){const e=n.quickEncodeToken(r);if(e)return e;const s=t[r.type.major];if(s.encodedSize){const e=s.encodedSize(r,n),t=new h(e);if(s(t,r,n),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return(0,l.Dz)(t.chunks[0])}}return I.reset(),O(I,r,t,n),I.toBytes(!0)}function L(e,t){return t=Object.assign({},E,t),D(e,k,t)}},6346:function(e,t,n){"use strict";n.d(t,{JN:function(){return w},PS:function(){return m},cW:function(){return y}});var r=n(470),s=n(9325),i=n(9349),o=n(4435),a=n(2878),c=n(9315),l=n(3964),u=n(9887),h=n(3182),d=n(9039),f=n(8526);function p(e,t,n){throw new Error(`${d.IR} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function g(e){return()=>{throw new Error(`${d.IR} ${e}`)}}const y=[];for(let b=0;b<=23;b++)y[b]=p;y[24]=s.Km,y[25]=s.Zh,y[26]=s.cs,y[27]=s.uN,y[28]=p,y[29]=p,y[30]=p,y[31]=p;for(let b=32;b<=55;b++)y[b]=p;y[56]=i.yr,y[57]=i.r0,y[58]=i.wy,y[59]=i.ec,y[60]=p,y[61]=p,y[62]=p,y[63]=p;for(let b=64;b<=87;b++)y[b]=o.Ii;y[88]=o.UQ,y[89]=o.BS,y[90]=o.zU,y[91]=o.ME,y[92]=p,y[93]=p,y[94]=p,y[95]=g("indefinite length bytes/strings are not supported");for(let b=96;b<=119;b++)y[b]=a.nt;y[120]=a.Bq,y[121]=a.h,y[122]=a.q0,y[123]=a.bc,y[124]=p,y[125]=p,y[126]=p,y[127]=g("indefinite length bytes/strings are not supported");for(let b=128;b<=151;b++)y[b]=c.Ju;y[152]=c.h7,y[153]=c.OC,y[154]=c.lY,y[155]=c.a8,y[156]=p,y[157]=p,y[158]=p,y[159]=c.s5;for(let b=160;b<=183;b++)y[b]=l._K;y[184]=l.G,y[185]=l.qe,y[186]=l.IY,y[187]=l.F2,y[188]=p,y[189]=p,y[190]=p,y[191]=l.ng;for(let b=192;b<=215;b++)y[b]=u.qJ;y[216]=u.ZR,y[217]=u.CF,y[218]=u.vP,y[219]=u.MV,y[220]=p,y[221]=p,y[222]=p,y[223]=p;for(let b=224;b<=243;b++)y[b]=g("simple values are not supported");y[244]=p,y[245]=p,y[246]=p,y[247]=h.h1,y[248]=g("simple values are not supported"),y[249]=h.mW,y[250]=h.GI,y[251]=h.vV,y[252]=p,y[253]=p,y[254]=p,y[255]=h.y7;const m=[];for(let b=0;b<24;b++)m[b]=new r.W(r.D.uint,b,1);for(let b=-1;b>=-24;b--)m[31-b]=new r.W(r.D.negint,b,1);function w(e){switch(e.type){case r.D["false"]:return(0,f.nI)([244]);case r.D["true"]:return(0,f.nI)([245]);case r.D["null"]:return(0,f.nI)([246]);case r.D.bytes:return e.value.length?void 0:(0,f.nI)([64]);case r.D.string:return""===e.value?(0,f.nI)([96]):void 0;case r.D.array:return 0===e.value?(0,f.nI)([128]):void 0;case r.D.map:return 0===e.value?(0,f.nI)([160]):void 0;case r.D.uint:return e.value<24?(0,f.nI)([Number(e.value)]):void 0;case r.D.negint:if(e.value>=-24)return(0,f.nI)([31-Number(e.value)])}}m[64]=new r.W(r.D.bytes,new Uint8Array(0),1),m[96]=new r.W(r.D.string,"",1),m[128]=new r.W(r.D.array,0,1),m[160]=new r.W(r.D.map,0,1),m[244]=new r.W(r.D["false"],!1,1),m[245]=new r.W(r.D["true"],!0,1),m[246]=new r.W(r.D["null"],null,1)},470:function(e,t,n){"use strict";n.d(t,{D:function(){return r},W:function(){return s}});class r{constructor(e,t,n){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}r.uint=new r(0,"uint",!0),r.negint=new r(1,"negint",!0),r.bytes=new r(2,"bytes",!0),r.string=new r(3,"string",!0),r.array=new r(4,"array",!1),r.map=new r(5,"map",!1),r.tag=new r(6,"tag",!1),r.float=new r(7,"float",!0),r.false=new r(7,"false",!0),r.true=new r(7,"true",!0),r.null=new r(7,"null",!0),r.undefined=new r(7,"undefined",!0),r.break=new r(7,"break",!0);class s{constructor(e,t,n){this.type=e,this.value=t,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}},5356:function(e,t,n){"use strict";n.d(t,{Ue:function(){return OQ}});var r={};n.r(r),n.d(r,{base64:function(){return N},base64pad:function(){return O},base64url:function(){return D},base64urlpad:function(){return L}});var s={};n.r(s),n.d(s,{code:function(){return Ae},createLink:function(){return ke},createNode:function(){return Se},decode:function(){return Re},encode:function(){return Te},name:function(){return Ie},prepare:function(){return _e},validate:function(){return Ee}});var i={};n.r(i),n.d(i,{code:function(){return Xe},decode:function(){return Ze},encode:function(){return Je},format:function(){return et},name:function(){return Qe},parse:function(){return nt},stringify:function(){return et}});var o={};n.r(o),n.d(o,{code:function(){return mt},decode:function(){return kt},encode:function(){return St},name:function(){return yt},toGeneral:function(){return Et}});var a={};n.r(a),n.d(a,{identity:function(){return Nt}});var c={};n.r(c),n.d(c,{identity:function(){return Ot}});var l={};n.r(l),n.d(l,{base2:function(){return Dt}});var u={};n.r(u),n.d(u,{base8:function(){return Lt}});var h={};n.r(h),n.d(h,{base10:function(){return xt}});var d={};n.r(d),n.d(d,{base16:function(){return Bt},base16upper:function(){return Mt}});var f={};n.r(f),n.d(f,{base36:function(){return Ut},base36upper:function(){return Ft}});var p={};n.r(p),n.d(p,{base256emoji:function(){return Ht}});var g={};n.r(g),n.d(g,{sha256:function(){return Gt},sha512:function(){return Yt}});var y={};n.r(y),n.d(y,{code:function(){return Xt},decode:function(){return Zt},encode:function(){return Jt},name:function(){return Qt}});var m={};n.r(m),n.d(m,{code:function(){return rn},decode:function(){return on},encode:function(){return sn},name:function(){return nn}});var w={};n.r(w),n.d(w,{RsaPrivateKey:function(){return tl},RsaPublicKey:function(){return el},fromJwk:function(){return sl},generateKeyPair:function(){return il},unmarshalRsaPrivateKey:function(){return nl},unmarshalRsaPublicKey:function(){return rl}});var b={};n.r(b),n.d(b,{Ed25519PrivateKey:function(){return mu},Ed25519PublicKey:function(){return yu},generateKeyPair:function(){return vu},generateKeyPairFromSeed:function(){return _u},unmarshalEd25519PrivateKey:function(){return wu},unmarshalEd25519PublicKey:function(){return bu}});var v={};n.r(v),n.d(v,{Secp256k1PrivateKey:function(){return Nu},Secp256k1PublicKey:function(){return Pu},generateKeyPair:function(){return Lu},unmarshalSecp256k1PrivateKey:function(){return Ou},unmarshalSecp256k1PublicKey:function(){return Du}});var _={};n.r(_),n.d(_,{InvalidValueError:function(){return eC},MissingRepoOptionsError:function(){return tC},NonReversibleMigrationError:function(){return XR},NotInitializedRepoError:function(){return JR},RequiredParameterError:function(){return ZR}});var E={};n.r(E),n.d(E,{Decoder:function(){return tF},Encoder:function(){return eF},PacketType:function(){return ZU},protocol:function(){return JU}});var S={};n.r(S),n.d(S,{abortedError:function(){return oQ},notFoundError:function(){return iQ}});n(7658);var k=n(535),I=k,A=n(798),T=n(5652),R=n(1780),C=n(248),P=n(7082);const N=(0,P.ET)({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),O=(0,P.ET)({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),D=(0,P.ET)({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),L=(0,P.ET)({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function x(e){return Object.assign(T(e),{error:T(`${e}:error`),trace:T(`${e}:trace`)})}T.formatters.b=e=>null==e?"undefined":R.base58btc.baseEncode(e),T.formatters.t=e=>null==e?"undefined":C.base32.baseEncode(e),T.formatters.m=e=>null==e?"undefined":N.baseEncode(e),T.formatters.p=e=>null==e?"undefined":e.toString(),T.formatters.c=e=>null==e?"undefined":e.toString(),T.formatters.k=e=>null==e?"undefined":e.toString();var B=n(9998),M=n(6425);const U=M.Reader,F=M.Writer,j=M.util,V=M.roots["ipfs-unixfs"]||(M.roots["ipfs-unixfs"]={}),z=V.Data=(()=>{function e(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.Type=0,e.prototype.Data=j.newBuffer([]),e.prototype.filesize=j.Long?j.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=j.emptyArray,e.prototype.hashType=j.Long?j.Long.fromBits(0,0,!0):0,e.prototype.fanout=j.Long?j.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(e,t){if(t||(t=F.create()),t.uint32(8).int32(e.Type),null!=e.Data&&Object.hasOwnProperty.call(e,"Data")&&t.uint32(18).bytes(e.Data),null!=e.filesize&&Object.hasOwnProperty.call(e,"filesize")&&t.uint32(24).uint64(e.filesize),null!=e.blocksizes&&e.blocksizes.length)for(var n=0;n<e.blocksizes.length;++n)t.uint32(32).uint64(e.blocksizes[n]);return null!=e.hashType&&Object.hasOwnProperty.call(e,"hashType")&&t.uint32(40).uint64(e.hashType),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(48).uint64(e.fanout),null!=e.mode&&Object.hasOwnProperty.call(e,"mode")&&t.uint32(56).uint32(e.mode),null!=e.mtime&&Object.hasOwnProperty.call(e,"mtime")&&V.UnixTime.encode(e.mtime,t.uint32(66).fork()).ldelim(),t},e.decode=function(e,t){e instanceof U||(e=U.create(e));var n=void 0===t?e.len:e.pos+t,r=new V.Data;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.Type=e.int32();break;case 2:r.Data=e.bytes();break;case 3:r.filesize=e.uint64();break;case 4:if(r.blocksizes&&r.blocksizes.length||(r.blocksizes=[]),2===(7&s)){var i=e.uint32()+e.pos;while(e.pos<i)r.blocksizes.push(e.uint64())}else r.blocksizes.push(e.uint64());break;case 5:r.hashType=e.uint64();break;case 6:r.fanout=e.uint64();break;case 7:r.mode=e.uint32();break;case 8:r.mtime=V.UnixTime.decode(e,e.uint32());break;default:e.skipType(7&s);break}}if(!r.hasOwnProperty("Type"))throw j.ProtocolError("missing required 'Type'",{instance:r});return r},e.fromObject=function(e){if(e instanceof V.Data)return e;var t=new V.Data;switch(e.Type){case"Raw":case 0:t.Type=0;break;case"Directory":case 1:t.Type=1;break;case"File":case 2:t.Type=2;break;case"Metadata":case 3:t.Type=3;break;case"Symlink":case 4:t.Type=4;break;case"HAMTShard":case 5:t.Type=5;break}if(null!=e.Data&&("string"===typeof e.Data?j.base64.decode(e.Data,t.Data=j.newBuffer(j.base64.length(e.Data)),0):e.Data.length&&(t.Data=e.Data)),null!=e.filesize&&(j.Long?(t.filesize=j.Long.fromValue(e.filesize)).unsigned=!0:"string"===typeof e.filesize?t.filesize=parseInt(e.filesize,10):"number"===typeof e.filesize?t.filesize=e.filesize:"object"===typeof e.filesize&&(t.filesize=new j.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0))),e.blocksizes){if(!Array.isArray(e.blocksizes))throw TypeError(".Data.blocksizes: array expected");t.blocksizes=[];for(var n=0;n<e.blocksizes.length;++n)j.Long?(t.blocksizes[n]=j.Long.fromValue(e.blocksizes[n])).unsigned=!0:"string"===typeof e.blocksizes[n]?t.blocksizes[n]=parseInt(e.blocksizes[n],10):"number"===typeof e.blocksizes[n]?t.blocksizes[n]=e.blocksizes[n]:"object"===typeof e.blocksizes[n]&&(t.blocksizes[n]=new j.LongBits(e.blocksizes[n].low>>>0,e.blocksizes[n].high>>>0).toNumber(!0))}if(null!=e.hashType&&(j.Long?(t.hashType=j.Long.fromValue(e.hashType)).unsigned=!0:"string"===typeof e.hashType?t.hashType=parseInt(e.hashType,10):"number"===typeof e.hashType?t.hashType=e.hashType:"object"===typeof e.hashType&&(t.hashType=new j.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0))),null!=e.fanout&&(j.Long?(t.fanout=j.Long.fromValue(e.fanout)).unsigned=!0:"string"===typeof e.fanout?t.fanout=parseInt(e.fanout,10):"number"===typeof e.fanout?t.fanout=e.fanout:"object"===typeof e.fanout&&(t.fanout=new j.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0))),null!=e.mode&&(t.mode=e.mode>>>0),null!=e.mtime){if("object"!==typeof e.mtime)throw TypeError(".Data.mtime: object expected");t.mtime=V.UnixTime.fromObject(e.mtime)}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.blocksizes=[]),t.defaults){if(n.Type=t.enums===String?"Raw":0,t.bytes===String?n.Data="":(n.Data=[],t.bytes!==Array&&(n.Data=j.newBuffer(n.Data))),j.Long){var r=new j.Long(0,0,!0);n.filesize=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.filesize=t.longs===String?"0":0;if(j.Long){r=new j.Long(0,0,!0);n.hashType=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.hashType=t.longs===String?"0":0;if(j.Long){r=new j.Long(0,0,!0);n.fanout=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.fanout=t.longs===String?"0":0;n.mode=0,n.mtime=null}if(null!=e.Type&&e.hasOwnProperty("Type")&&(n.Type=t.enums===String?V.Data.DataType[e.Type]:e.Type),null!=e.Data&&e.hasOwnProperty("Data")&&(n.Data=t.bytes===String?j.base64.encode(e.Data,0,e.Data.length):t.bytes===Array?Array.prototype.slice.call(e.Data):e.Data),null!=e.filesize&&e.hasOwnProperty("filesize")&&("number"===typeof e.filesize?n.filesize=t.longs===String?String(e.filesize):e.filesize:n.filesize=t.longs===String?j.Long.prototype.toString.call(e.filesize):t.longs===Number?new j.LongBits(e.filesize.low>>>0,e.filesize.high>>>0).toNumber(!0):e.filesize),e.blocksizes&&e.blocksizes.length){n.blocksizes=[];for(var s=0;s<e.blocksizes.length;++s)"number"===typeof e.blocksizes[s]?n.blocksizes[s]=t.longs===String?String(e.blocksizes[s]):e.blocksizes[s]:n.blocksizes[s]=t.longs===String?j.Long.prototype.toString.call(e.blocksizes[s]):t.longs===Number?new j.LongBits(e.blocksizes[s].low>>>0,e.blocksizes[s].high>>>0).toNumber(!0):e.blocksizes[s]}return null!=e.hashType&&e.hasOwnProperty("hashType")&&("number"===typeof e.hashType?n.hashType=t.longs===String?String(e.hashType):e.hashType:n.hashType=t.longs===String?j.Long.prototype.toString.call(e.hashType):t.longs===Number?new j.LongBits(e.hashType.low>>>0,e.hashType.high>>>0).toNumber(!0):e.hashType),null!=e.fanout&&e.hasOwnProperty("fanout")&&("number"===typeof e.fanout?n.fanout=t.longs===String?String(e.fanout):e.fanout:n.fanout=t.longs===String?j.Long.prototype.toString.call(e.fanout):t.longs===Number?new j.LongBits(e.fanout.low>>>0,e.fanout.high>>>0).toNumber(!0):e.fanout),null!=e.mode&&e.hasOwnProperty("mode")&&(n.mode=e.mode),null!=e.mtime&&e.hasOwnProperty("mtime")&&(n.mtime=V.UnixTime.toObject(e.mtime,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.DataType=function(){const e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),e})(),$=(V.UnixTime=(()=>{function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.Seconds=j.Long?j.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(e,t){return t||(t=F.create()),t.uint32(8).int64(e.Seconds),null!=e.FractionalNanoseconds&&Object.hasOwnProperty.call(e,"FractionalNanoseconds")&&t.uint32(21).fixed32(e.FractionalNanoseconds),t},e.decode=function(e,t){e instanceof U||(e=U.create(e));var n=void 0===t?e.len:e.pos+t,r=new V.UnixTime;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.Seconds=e.int64();break;case 2:r.FractionalNanoseconds=e.fixed32();break;default:e.skipType(7&s);break}}if(!r.hasOwnProperty("Seconds"))throw j.ProtocolError("missing required 'Seconds'",{instance:r});return r},e.fromObject=function(e){if(e instanceof V.UnixTime)return e;var t=new V.UnixTime;return null!=e.Seconds&&(j.Long?(t.Seconds=j.Long.fromValue(e.Seconds)).unsigned=!1:"string"===typeof e.Seconds?t.Seconds=parseInt(e.Seconds,10):"number"===typeof e.Seconds?t.Seconds=e.Seconds:"object"===typeof e.Seconds&&(t.Seconds=new j.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber())),null!=e.FractionalNanoseconds&&(t.FractionalNanoseconds=e.FractionalNanoseconds>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(j.Long){var r=new j.Long(0,0,!1);n.Seconds=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.Seconds=t.longs===String?"0":0;n.FractionalNanoseconds=0}return null!=e.Seconds&&e.hasOwnProperty("Seconds")&&("number"===typeof e.Seconds?n.Seconds=t.longs===String?String(e.Seconds):e.Seconds:n.Seconds=t.longs===String?j.Long.prototype.toString.call(e.Seconds):t.longs===Number?new j.LongBits(e.Seconds.low>>>0,e.Seconds.high>>>0).toNumber():e.Seconds),null!=e.FractionalNanoseconds&&e.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=e.FractionalNanoseconds),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),V.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.MimeType="",e.encode=function(e,t){return t||(t=F.create()),null!=e.MimeType&&Object.hasOwnProperty.call(e,"MimeType")&&t.uint32(10).string(e.MimeType),t},e.decode=function(e,t){e instanceof U||(e=U.create(e));var n=void 0===t?e.len:e.pos+t,r=new V.Metadata;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.MimeType=e.string();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof V.Metadata)return e;var t=new V.Metadata;return null!=e.MimeType&&(t.MimeType=String(e.MimeType)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.MimeType=""),null!=e.MimeType&&e.hasOwnProperty("MimeType")&&(n.MimeType=e.MimeType),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),z),K=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],H=["directory","hamt-sharded-directory"],q=parseInt("0644",8),W=parseInt("0755",8);function G(e){if(null!=e)return"number"===typeof e?4095&e:(e=e.toString(),"0"===e.substring(0,1)?4095&parseInt(e,8):4095&parseInt(e,10))}function Y(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const n=e.getTime(),r=Math.floor(n/1e3);t={secs:r,nsecs:1e3*(n-1e3*r)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw B(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}class Q{static unmarshal(e){const t=$.decode(e),n=$.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),r=new Q({type:K[n.Type],data:n.Data,blockSizes:n.blocksizes,mode:n.mode,mtime:n.mtime?{secs:n.mtime.Seconds,nsecs:n.mtime.FractionalNanoseconds}:void 0});return r._originalMode=n.mode||0,r}constructor(e={type:"file"}){const{type:t,data:n,blockSizes:r,hashType:s,fanout:i,mtime:o,mode:a}=e;if(t&&!K.includes(t))throw B(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=n,this.hashType=s,this.fanout=i,this.blockSizes=r||[],this._originalMode=0,this.mode=G(a),o&&(this.mtime=Y(o),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?W:q;const t=G(e);void 0!==t&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&H.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach((t=>{e+=t})),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=$.DataType.Raw;break;case"directory":e=$.DataType.Directory;break;case"file":e=$.DataType.File;break;case"metadata":e=$.DataType.Metadata;break;case"symlink":e=$.DataType.Symlink;break;case"hamt-sharded-directory":e=$.DataType.HAMTShard;break;default:throw B(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t,n,r=this.data;if(this.data&&this.data.length||(r=void 0),null!=this.mode&&(t=4294963200&this._originalMode|(G(this.mode)||0),t!==q||this.isDirectory()||(t=void 0),t===W&&this.isDirectory()&&(t=void 0)),null!=this.mtime){const e=Y(this.mtime);e&&(n={Seconds:e.secs,FractionalNanoseconds:e.nsecs},0===n.FractionalNanoseconds&&delete n.FractionalNanoseconds)}const s={Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:t,mtime:n};return $.encode(s).finish()}}var X=n(608);const J=new TextDecoder;function Z(e,t){let n=0;for(let r=0;;r+=7){if(r>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const s=e[t++];if(n+=r<28?(127&s)<<r:(127&s)*2**r,s<128)break}return[n,t]}function ee(e,t){let n;[n,t]=Z(e,t);const r=t+n;if(n<0||r<0)throw new Error("protobuf: invalid length");if(r>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,r),r]}function te(e,t){let n;return[n,t]=Z(e,t),[7&n,n>>3,t]}function ne(e){const t={},n=e.length;let r=0;while(r<n){let n,s;if([n,s,r]=te(e,r),1===s){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==n)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(void 0!==t.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,r]=ee(e,r)}else if(2===s){if(void 0!==t.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==n)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,r]=ee(e,r),t.Name=J.decode(s)}else{if(3!==s)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`);if(void 0!==t.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==n)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[t.Tsize,r]=Z(e,r)}}if(r>n)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function re(e){const t=e.length;let n,r,s=0,i=!1;while(s<t){let t,o;if([t,o,s]=te(e,s),2!==t)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${t}`);if(1===o){if(r)throw new Error("protobuf: (PBNode) duplicate Data section");[r,s]=ee(e,s),n&&(i=!0)}else{if(2!==o)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${o}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let t;n||(n=[]),[t,s]=ee(e,s),n.push(ne(t))}}}if(s>t)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return r&&(o.Data=r),o.Links=n||[],o}const se=new TextEncoder,ie=2**32,oe=2**31;function ae(e,t){let n=t.length;if("number"===typeof e.Tsize){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");n=he(t,n,e.Tsize)-1,t[n]=24}if("string"===typeof e.Name){const r=se.encode(e.Name);n-=r.length,t.set(r,n),n=he(t,n,r.length)-1,t[n]=18}return e.Hash&&(n-=e.Hash.length,t.set(e.Hash,n),n=he(t,n,e.Hash.length)-1,t[n]=10),t.length-n}function ce(e){const t=ue(e),n=new Uint8Array(t);let r=t;if(e.Data&&(r-=e.Data.length,n.set(e.Data,r),r=he(n,r,e.Data.length)-1,n[r]=10),e.Links)for(let s=e.Links.length-1;s>=0;s--){const t=ae(e.Links[s],n.subarray(0,r));r-=t,r=he(n,r,t)-1,n[r]=18}return n}function le(e){let t=0;if(e.Hash){const n=e.Hash.length;t+=1+n+de(n)}if("string"===typeof e.Name){const n=se.encode(e.Name).length;t+=1+n+de(n)}return"number"===typeof e.Tsize&&(t+=1+de(e.Tsize)),t}function ue(e){let t=0;if(e.Data){const n=e.Data.length;t+=1+n+de(n)}if(e.Links)for(const n of e.Links){const e=le(n);t+=1+e+de(e)}return t}function he(e,t,n){t-=de(n);const r=t;while(n>=oe)e[t++]=127&n|128,n/=128;while(n>=128)e[t++]=127&n|128,n>>>=7;return e[t]=n,r}function de(e){return e%2===0&&e++,Math.floor((fe(e)+6)/7)}function fe(e){let t=0;return e>=ie&&(e=Math.floor(e/ie),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+pe[e]}const pe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],ge=["Data","Links"],ye=["Hash","Name","Tsize"],me=new TextEncoder;function we(e,t){if(e===t)return 0;const n=e.Name?me.encode(e.Name):[],r=t.Name?me.encode(t.Name):[];let s=n.length,i=r.length;for(let o=0,a=Math.min(s,i);o<a;++o)if(n[o]!==r[o]){s=n[o],i=r[o];break}return s<i?-1:i<s?1:0}function be(e,t){return!Object.keys(e).some((e=>!t.includes(e)))}function ve(e){if("object"===typeof e.asCID){const t=X.k0.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if("object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=X.k0.asCID(e.Hash);try{r||("string"===typeof e.Hash?r=X.k0.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=X.k0.decode(e.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return"string"===typeof e.Name&&(t.Name=e.Name),"number"===typeof e.Tsize&&(t.Tsize=e.Tsize),t}function _e(e){if((e instanceof Uint8Array||"string"===typeof e)&&(e={Data:e}),"object"!==typeof e||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(void 0!==e.Data)if("string"===typeof e.Data)t.Data=me.encode(e.Data);else{if(!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");t.Data=e.Data}if(void 0!==e.Links){if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form");t.Links=e.Links.map(ve),t.Links.sort(we)}else t.Links=[];return t}function Ee(e){if(!e||"object"!==typeof e||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!be(e,ge))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==e.Data&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const n=e.Links[t];if(!n||"object"!==typeof n||Array.isArray(n)||n instanceof Uint8Array||n["/"]&&n["/"]===n.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!be(n,ye))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===n.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==n.Hash||!n.Hash["/"]||n.Hash["/"]!==n.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==n.Name&&"string"!==typeof n.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==n.Tsize){if("number"!==typeof n.Tsize||n.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(n.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&-1===we(n,e.Links[t-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Se(e,t=[]){return _e({Data:e,Links:t})}function ke(e,t,n){return ve({Hash:n,Name:e,Tsize:t})}const Ie="dag-pb",Ae=112;function Te(e){Ee(e);const t={};return e.Links&&(t.Links=e.Links.map((e=>{const t={};return e.Hash&&(t.Hash=e.Hash.bytes),void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),e.Data&&(t.Data=e.Data),ce(t)}function Re(e){const t=re(e),n={};return t.Data&&(n.Data=t.Data),t.Links&&(n.Links=t.Links.map((e=>{const t={};try{t.Hash=X.k0.decode(e.Hash)}catch(n){}if(!t.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==e.Name&&(t.Name=e.Name),void 0!==e.Tsize&&(t.Tsize=e.Tsize),t}))),n}var Ce=n(908),Pe=n(7985),Ne=n(9559),Oe=n(470),De=n(3098),Le=n(9039),xe=n(8526);class Be extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const t=this.inRecursive[this.inRecursive.length-1];t&&(t.type===Oe.D.array&&(t.elements++,1!==t.elements&&e.push([44])),t.type===Oe.D.map&&(t.elements++,1!==t.elements&&(t.elements%2===1?e.push([44]):e.push([58]))))}[Oe.D.uint.major](e,t){this.prefix(e);const n=String(t.value),r=[];for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);e.push(r)}[Oe.D.negint.major](e,t){this[Oe.D.uint.major](e,t)}[Oe.D.bytes.major](e,t){throw new Error(`${Le.OO} unsupported type: Uint8Array`)}[Oe.D.string.major](e,t){this.prefix(e);const n=(0,xe.mL)(JSON.stringify(t.value));e.push(n.length>32?(0,xe.Dz)(n):n)}[Oe.D.array.major](e,t){this.prefix(e),this.inRecursive.push({type:Oe.D.array,elements:0}),e.push([91])}[Oe.D.map.major](e,t){this.prefix(e),this.inRecursive.push({type:Oe.D.map,elements:0}),e.push([123])}[Oe.D.tag.major](e,t){}[Oe.D.float.major](e,t){if("break"===t.type.name){const t=this.inRecursive.pop();if(t){if(t.type===Oe.D.array)e.push([93]);else{if(t.type!==Oe.D.map)throw new Error("Unexpected recursive type; this should not happen!");e.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===t.value)throw new Error(`${Le.OO} unsupported type: undefined`);if(this.prefix(e),"true"===t.type.name)return void e.push([116,114,117,101]);if("false"===t.type.name)return void e.push([102,97,108,115,101]);if("null"===t.type.name)return void e.push([110,117,108,108]);const n=String(t.value),r=[];let s=!1;for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i),s||46!==r[i]&&101!==r[i]&&69!==r[i]||(s=!0);s||(r.push(46),r.push(48)),e.push(r)}}function Me(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${Le.OO} complex map keys are not supported`);const n=e[0],r=t[0];if(n.type!==Oe.D.string||r.type!==Oe.D.string)throw new Error(`${Le.OO} non-string map keys are not supported`);if(n<r)return-1;if(n>r)return 1;throw new Error(`${Le.OO} unexpected duplicate map keys, this is not supported`)}const Ue={addBreakTokens:!0,mapSorter:Me};function Fe(e,t){return t=Object.assign({},Ue,t),(0,De.w$)(e,new Be,t)}var je=n(9355);class Ve{constructor(e,t={}){this.pos=0,this.data=e,this.options=t,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();while(32===e||9===e||13===e||10===e)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${Le.IR} unexpected end of input at position ${this.pos}`);for(let t=0;t<e.length;t++)if(this.data[this.pos++]!==e[t])throw new Error(`${Le.IR} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this.pos;let t=!1,n=!1;const r=e=>{while(!this.done()){const t=this.ch();if(!e.includes(t))break;this.pos++}};if(45===this.ch()&&(t=!0,this.pos++),48===this.ch()){if(this.pos++,46!==this.ch())return new Oe.W(Oe.D.uint,0,this.pos-e);this.pos++,n=!0}if(r([48,49,50,51,52,53,54,55,56,57]),t&&this.pos===e+1)throw new Error(`${Le.IR} unexpected token at position ${this.pos}`);if(!this.done()&&46===this.ch()){if(n)throw new Error(`${Le.IR} unexpected token at position ${this.pos}`);n=!0,this.pos++,r([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(n=!0,this.pos++,this.done()||43!==this.ch()&&45!==this.ch()||this.pos++,r([48,49,50,51,52,53,54,55,56,57]));const s=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),i=parseFloat(s);return n?new Oe.W(Oe.D.float,i,this.pos-e):!0!==this.options.allowBigInt||Number.isSafeInteger(i)?new Oe.W(i>=0?Oe.D.uint:Oe.D.negint,i,this.pos-e):new Oe.W(i>=0?Oe.D.uint:Oe.D.negint,BigInt(s),this.pos-e)}parseString(){if(34!==this.ch())throw new Error(`${Le.IR} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let s=this.pos,i=0;s<this.data.length&&i<65536;s++,i++){const e=this.data[s];if(92===e||e<32||e>=128)break;if(34===e){const e=String.fromCharCode.apply(null,this.data.subarray(this.pos,s));return this.pos=s+1,new Oe.W(Oe.D.string,e,i)}}const e=this.pos,t=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${Le.IR} unexpected end of unicode escape sequence at position ${this.pos}`);let e=0;for(let t=0;t<4;t++){let t=this.ch();if(t>=48&&t<=57)t-=48;else if(t>=97&&t<=102)t=t-97+10;else{if(!(t>=65&&t<=70))throw new Error(`${Le.IR} unexpected unicode escape character at position ${this.pos}`);t=t-65+10}e=16*e+t,this.pos++}return e},r=()=>{const e=this.ch();let n,r,s,i,o=null,a=e>239?4:e>223?3:e>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${Le.IR} unexpected unicode sequence at position ${this.pos}`);switch(a){case 1:e<128&&(o=e);break;case 2:n=this.data[this.pos+1],128===(192&n)&&(i=(31&e)<<6|63&n,i>127&&(o=i));break;case 3:n=this.data[this.pos+1],r=this.data[this.pos+2],128===(192&n)&&128===(192&r)&&(i=(15&e)<<12|(63&n)<<6|63&r,i>2047&&(i<55296||i>57343)&&(o=i));break;case 4:n=this.data[this.pos+1],r=this.data[this.pos+2],s=this.data[this.pos+3],128===(192&n)&&128===(192&r)&&128===(192&s)&&(i=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&s,i>65535&&i<1114112&&(o=i))}null===o?(o=65533,a=1):o>65535&&(o-=65536,t.push(o>>>10&1023|55296),o=56320|1023&o),t.push(o),this.pos+=a};while(!this.done()){const s=this.ch();let i;switch(s){case 92:if(this.pos++,this.done())throw new Error(`${Le.IR} unexpected string termination at position ${this.pos}`);switch(i=this.ch(),this.pos++,i){case 34:case 39:case 92:case 47:t.push(i);break;case 98:t.push(8);break;case 116:t.push(9);break;case 110:t.push(10);break;case 102:t.push(12);break;case 114:t.push(13);break;case 117:t.push(n());break;default:throw new Error(`${Le.IR} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Oe.W(Oe.D.string,(0,xe.Pu)(t),this.pos-e);default:if(s<32)throw new Error(`${Le.IR} invalid control character at position ${this.pos}`);s<128?(t.push(s),this.pos++):r()}}throw new Error(`${Le.IR} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Oe.W(Oe.D.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Oe.W(Oe.D.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Oe.W(Oe.D["null"],null,4);case 102:return this.expect([102,97,108,115,101]),new Oe.W(Oe.D["false"],!1,5);case 116:return this.expect([116,114,117,101]),new Oe.W(Oe.D["true"],!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Le.IR} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this.pos++,this.skipWhitespace(),new Oe.W(Oe.D["break"],void 0,1);if(44!==this.ch())throw new Error(`${Le.IR} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this.pos++,this.skipWhitespace(),new Oe.W(Oe.D["break"],void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Oe.W(Oe.D["break"],void 0,1);if(44!==this.ch())throw new Error(`${Le.IR} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this.pos++,this.skipWhitespace(),new Oe.W(Oe.D["break"],void 0,1);const e=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${Le.IR} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Le.IR} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function ze(e,t){return t=Object.assign({tokenizer:new Ve(e,t)},t),(0,je.Jx)(e,t)}function $e(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=Pe.k0.asCID(e);if(!t)return null;const n=t.toString();return[new Ne.WU(Ne.Dy.map,1/0,1),new Ne.WU(Ne.Dy.string,"/",1),new Ne.WU(Ne.Dy.string,n,n.length),new Ne.WU(Ne.Dy["break"],void 0,1)]}function Ke(e){const t=N.encode(e).slice(1);return[new Ne.WU(Ne.Dy.map,1/0,1),new Ne.WU(Ne.Dy.string,"/",1),new Ne.WU(Ne.Dy.map,1/0,1),new Ne.WU(Ne.Dy.string,"bytes",5),new Ne.WU(Ne.Dy.string,t,t.length),new Ne.WU(Ne.Dy["break"],void 0,1),new Ne.WU(Ne.Dy["break"],void 0,1)]}function He(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function qe(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const We={typeEncoders:{Object:$e,Uint8Array:Ke,Buffer:Ke,undefined:He,number:qe}};class Ge extends Ve{constructor(e,t){super(e,t),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===Ne.Dy.map){const e=this._next();if(e.type===Ne.Dy.string&&"/"===e.value){const e=this._next();if(e.type===Ne.Dy.string){const t=this._next();if(t.type!==Ne.Dy["break"])throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(e),new Ne.WU(Ne.Dy.tag,42,0)}if(e.type===Ne.Dy.map){const e=this._next();if(e.type===Ne.Dy.string&&"bytes"===e.value){const e=this._next();if(e.type===Ne.Dy.string){for(let e=0;e<2;e++){const e=this._next();if(e.type!==Ne.Dy["break"])throw new Error("Invalid encoded Bytes form")}const t=N.decode(`m${e.value}`);return new Ne.WU(Ne.Dy.bytes,t,e.value.length)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}this.tokenBuffer.push(e)}return e}}const Ye={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Ye.tags[42]=Pe.k0.parse;const Qe="dag-json",Xe=297,Je=e=>Fe(e,We),Ze=e=>{const t=Object.assign(Ye,{tokenizer:new Ge(e,Ye)});return ze(e,t)},et=e=>tt.decode(Je(e)),tt=new TextDecoder,nt=e=>Ze(rt.encode(e)),rt=new TextEncoder;function st(e){return D.encode(e).slice(1)}function it(e){return D.decode(`u${e}`)}function ot(e){const[t,n,r]=e;return{payload:n,signatures:[{protected:t,signature:r}],link:X.k0.decode(it(n))}}function at(e){const t={signature:it(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=it(e.protected)),t}function ct(e){const t=it(e.payload);try{X.k0.decode(t)}catch(n){throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(at)}}function lt(e){const t={signature:st(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=st(e.protected)),t}function ut(e){const t={payload:st(e.payload),signatures:e.signatures.map(lt)};return t.link=X.k0.decode(new Uint8Array(e.payload)),t}function ht(e){const[t,n,r,s,i]=e,o={ciphertext:s,iv:r,protected:t,tag:i};return n&&(o.recipients=[{encrypted_key:n}]),o}function dt(e){const t={};return e.encrypted_key&&(t.encrypted_key=it(e.encrypted_key)),e.header&&(t.header=e.header),t}function ft(e){const t={ciphertext:it(e.ciphertext),protected:it(e.protected),iv:it(e.iv),tag:it(e.tag)};return e.aad&&(t.aad=it(e.aad)),e.recipients&&(t.recipients=e.recipients.map(dt)),e.unprotected&&(t.unprotected=e.unprotected),t}function pt(e){const t={};return e.encrypted_key&&(t.encrypted_key=st(e.encrypted_key)),e.header&&(t.header=e.header),t}function gt(e){const t={ciphertext:st(e.ciphertext),protected:st(e.protected),iv:st(e.iv),tag:st(e.tag)};return e.aad&&(t.aad=st(e.aad)),e.recipients&&(t.recipients=e.recipients.map(pt)),e.unprotected&&(t.unprotected=e.unprotected),t}const yt="dag-jose",mt=133;function wt(e){return"payload"in e&&"string"===typeof e.payload&&"signatures"in e&&Array.isArray(e.signatures)}function bt(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function vt(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function _t(e){return"ciphertext"in e&&"string"===typeof e.ciphertext&&"iv"in e&&"string"===typeof e.iv&&"protected"in e&&"string"===typeof e.protected&&"tag"in e&&"string"===typeof e.tag}function Et(e){if("string"===typeof e){const t=e.split(".");if(3===t.length)return ot(t);if(5===t.length)return ht(t);throw new Error("Not a valid JOSE string")}if(wt(e)||_t(e))return e;throw new Error("Not a valid unencoded JOSE object")}function St(e){let t;if("string"===typeof e&&(e=Et(e)),wt(e))t=ct(e);else{if(!_t(e))throw new Error("Not a valid JOSE object");t=ft(e)}return new Uint8Array(Ce.encode(t))}function kt(e){let t;try{t=Ce.decode(e)}catch(n){throw new Error("Not a valid DAG-JOSE object")}if(bt(t))return ut(t);if(vt(t))return gt(t);throw new Error("Not a valid DAG-JOSE object")}var It=n(9481),At=n(7880);const Tt=0,Rt="identity",Ct=It.coerce,Pt=e=>At.Ue(Tt,Ct(e)),Nt={code:Tt,name:Rt,encode:Ct,digest:Pt},Ot=(0,P.Dp)({prefix:"\0",name:"identity",encode:e=>(0,It.toString)(e),decode:e=>(0,It.fromString)(e)}),Dt=(0,P.ET)({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Lt=(0,P.ET)({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),xt=(0,P.kU)({prefix:"9",name:"base10",alphabet:"0123456789"}),Bt=(0,P.ET)({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mt=(0,P.ET)({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ut=(0,P.kU)({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ft=(0,P.kU)({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),jt=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Vt=jt.reduce(((e,t,n)=>(e[n]=t,e)),[]),zt=jt.reduce(((e,t,n)=>(e[t.codePointAt(0)]=n,e)),[]);function $t(e){return e.reduce(((e,t)=>(e+=Vt[t],e)),"")}function Kt(e){const t=[];for(const n of e){const e=zt[n.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${n}`);t.push(e)}return new Uint8Array(t)}const Ht=(0,P.Dp)({prefix:"🚀",name:"base256emoji",encode:$t,decode:Kt});var qt=n(5040);const Wt=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Gt=(0,qt.D)({name:"sha2-256",code:18,encode:Wt("SHA-256")}),Yt=(0,qt.D)({name:"sha2-512",code:19,encode:Wt("SHA-512")}),Qt="raw",Xt=85,Jt=e=>(0,It.coerce)(e),Zt=e=>(0,It.coerce)(e),en=new TextEncoder,tn=new TextDecoder,nn="json",rn=512,sn=e=>en.encode(JSON.stringify(e)),on=e=>JSON.parse(tn.decode(e)),an={...c,...l,...u,...h,...d,...C,...f,...R,...r,...p},cn={...g,...a},ln={raw:y,json:m};function un(){}class hn extends Error{constructor(e="not initialized"){super(e),this.name="NotInitializedError",this.code=hn.code}}hn.code="ERR_NOT_INITIALIZED";class dn extends Error{constructor(e="cannot initialize an initializing node"){super(e),this.name="AlreadyInitializingError",this.code=fn.code}}dn.code="ERR_ALREADY_INITIALIZING";class fn extends Error{constructor(e="cannot re-initialize an initialized node"){super(e),this.name="AlreadyInitializedError",this.code=fn.code}}fn.code="ERR_ALREADY_INITIALIZED";class pn extends Error{constructor(e="not started"){super(e),this.name="NotStartedError",this.code=pn.code}}pn.code="ERR_NOT_STARTED";class gn extends Error{constructor(e="cannot start, already startin"){super(e),this.name="AlreadyStartingError",this.code=gn.code}}gn.code="ERR_ALREADY_STARTING";class yn extends Error{constructor(e="cannot start, already started"){super(e),this.name="AlreadyStartedError",this.code=yn.code}}yn.code="ERR_ALREADY_STARTED";class mn extends Error{constructor(e="not enabled"){super(e),this.name="NotEnabledError",this.code=mn.code}}function wn(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function bn(e=0){return null!=globalThis.Buffer?.alloc?wn(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function vn(e=0){return null!=globalThis.Buffer?.allocUnsafe?wn(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function _n(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}mn.code="ERR_NOT_ENABLED";const En=_n("utf8","u",(e=>{const t=new TextDecoder("utf8");return"u"+t.decode(e)}),(e=>{const t=new TextEncoder;return t.encode(e.substring(1))})),Sn=_n("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{e=e.substring(1);const t=vn(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),kn={utf8:En,"utf-8":En,hex:an.base16,latin1:Sn,ascii:Sn,binary:Sn,...an};var In=kn;function An(e,t="utf8"){const n=In[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.decoder.decode(`${n.prefix}${e}`):wn(globalThis.Buffer.from(e,"utf-8"))}var Tn=n(2856);n(541);function Rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Cn{constructor(){Rn(this,"index",0),Rn(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,n=e();return void 0===n&&(this.index=t),n}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,n){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return n()}))}readNumber(e,t,n,r){return this.readAtomically((()=>{let s=0,i=0;const o=this.peekChar();if(void 0===o)return;const a="0"===o,c=2**(8*r)-1;while(1){const n=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const n=Number.parseInt(t,e);return Number.isNaN(n)?void 0:n}));if(void 0===n)break;if(s*=e,s+=n,s>c)return;if(i+=1,void 0!==t&&i>t)return}return 0===i||!n&&a&&i>1?void 0:s}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const n=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===n)return;e[t]=n}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const n=2*t;if(t<e.length-3){const r=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==r)return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],[n+4,!0]}const r=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===r)return[n,!1];e[n]=r>>8,e[n+1]=255&r}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[n,r]=e(t);if(16===n)return t;if(r)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const s=new Uint8Array(14),i=16-(n+2),[o]=e(s.subarray(0,i));return t.set(s.subarray(0,o),16-o),t}))}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const Pn=45,Nn=15,On=new Cn;function Dn(e){if(!(e.length>Nn))return On.new(e).parseWith((()=>On.readIPv4Addr()))}function Ln(e){if(!(e.length>Pn))return On.new(e).parseWith((()=>On.readIPv6Addr()))}function xn(e){if(!(e.length>Pn))return On.new(e).parseWith((()=>On.readIPAddr()))}function Bn(e){return Boolean(Dn(e))}function Mn(e){return Boolean(Ln(e))}function Un(e){return Boolean(xn(e))}function Fn(e,t="utf8"){const n=In[t];if(null==n)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?n.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}const jn=Bn,Vn=Mn,zn=function(e){let t=0;if(e=e.toString().trim(),jn(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(Vn(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){const e=jn(n[r]);let t;e&&(t=zn(n[r]),n[r]=Fn(t.slice(0,2),"base16")),null!=t&&++r<8&&n.splice(r,0,Fn(t.slice(2,4),"base16"))}if(""===n[0])while(n.length<8)n.unshift("0");else if(""===n[n.length-1])while(n.length<8)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const s=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);s[t++]=e>>8&255,s[t++]=255&e}return s}throw new Error("invalid ip address")},$n=function(e,t=0,n){t=~~t,n=n??e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let s=0;s<n;s++)r.push(e[t+s]);return r.join(".")}if(16===n){const e=[];for(let s=0;s<n;s+=2)e.push(r.getUint16(t+s).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},Kn=-1,Hn={},qn={},Wn=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Kn,"ip6zone"],[43,8,"ipcidr"],[53,Kn,"dns",!0],[54,Kn,"dns4",!0],[55,Kn,"dns6",!0],[56,Kn,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Kn,"unix",!1,!0],[421,Kn,"ipfs"],[421,Kn,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Kn,"garlic64"],[448,0,"tls"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,Kn,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Kn,"memory"]];function Gn(e,t,n,r,s){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(s)}}function Yn(e){if("number"===typeof e){if(null!=qn[e])return qn[e];throw new Error(`no protocol with code: ${e}`)}if("string"===typeof e){if(null!=Hn[e])return Hn[e];throw new Error(`no protocol with name: ${e}`)}throw new Error("invalid protocol id type: "+typeof e)}Wn.forEach((e=>{const t=Gn(...e);qn[t.code]=t,Hn[t.name]=t}));var Qn=n(2611);function Xn(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=vn(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return wn(n)}function Jn(e,t){const n=Yn(e);switch(n.code){case 4:case 41:return rr(t);case 42:return ar(t);case 6:case 273:case 33:case 132:return ir(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return ar(t);case 421:return hr(t);case 444:return pr(t);case 445:return pr(t);case 466:return ur(t);default:return Fn(t,"base16")}}function Zn(e,t){const n=Yn(e);switch(n.code){case 4:return nr(t);case 41:return nr(t);case 42:return or(t);case 6:case 273:case 33:case 132:return sr(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return or(t);case 421:return cr(t);case 444:return dr(t);case 445:return fr(t);case 466:return lr(t);default:return An(t,"base16")}}const er=Object.values(an).map((e=>e.decoder)),tr=function(){let e=er[0].or(er[1]);return er.slice(2).forEach((t=>e=e.or(t))),e}();function nr(e){if(!Un(e))throw new Error("invalid ip address");return zn(e)}function rr(e){const t=$n(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!Un(t))throw new Error("invalid ip address");return t}function sr(e){const t=new ArrayBuffer(2),n=new DataView(t);return n.setUint16(0,e),new Uint8Array(t)}function ir(e){const t=new DataView(e.buffer);return t.getUint16(e.byteOffset)}function or(e){const t=An(e),n=Uint8Array.from(Qn.encode(t.length));return Xn([n,t],n.length+t.length)}function ar(e){const t=Qn.decode(e);if(e=e.slice(Qn.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return Fn(e)}function cr(e){let t;t="Q"===e[0]||"1"===e[0]?At.Jx(R.base58btc.decode(`z${e}`)).bytes:X.k0.parse(e).multihash.bytes;const n=Uint8Array.from(Qn.encode(t.length));return Xn([n,t],n.length+t.length)}function lr(e){const t=tr.decode(e),n=Uint8Array.from(Qn.encode(t.length));return Xn([n,t],n.length+t.length)}function ur(e){const t=Qn.decode(e),n=e.slice(Qn.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return"u"+Fn(n,"base64url")}function hr(e){const t=Qn.decode(e),n=e.slice(Qn.decode.bytes);if(n.length!==t)throw new Error("inconsistent lengths");return Fn(n,"base58btc")}function dr(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(16!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const n=C.base32.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const s=sr(r);return Xn([n,s],n.length+s.length)}function fr(e){const t=e.split(":");if(2!==t.length)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(56!==t[0].length)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const n=C.base32.decode(`b${t[0]}`),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const s=sr(r);return Xn([n,s],n.length+s.length)}function pr(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2),r=Fn(t,"base32"),s=ir(n);return`${r}:${s}`}function gr(e){const t=[],n=e.split("/").slice(1);if(1===n.length&&""===n[0])return[];for(let r=0;r<n.length;r++){const s=n[r],i=Yn(s);if(0!==i.size){if(r++,r>=n.length)throw Rr("invalid address: "+e);if(!0===i.path){t.push([s,Tr(n.slice(r).join("/"))]);break}t.push([s,n[r]])}else t.push([s])}return t}function yr(e){const t=[];return e.map((e=>{const n=Cr(e);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),Tr(t.join("/"))}function mr(e){return e.map((e=>{Array.isArray(e)||(e=[e]);const t=Cr(e);return e.length>1?[t.code,Zn(t.code,e[1])]:[t.code]}))}function wr(e){return e.map((e=>{const t=Cr(e);return null!=e[1]?[t.code,Jn(t.code,e[1])]:[t.code]}))}function br(e){return Ir(Xn(e.map((e=>{const t=Cr(e);let n=Uint8Array.from(Qn.encode(t.code));return e.length>1&&null!=e[1]&&(n=Xn([n,e[1]])),n}))))}function vr(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=Qn.decode(t);return e+(Qn.decode.bytes??0)}}function _r(e){const t=[];let n=0;while(n<e.length){const r=Qn.decode(e,n),s=Qn.decode.bytes??0,i=Yn(r),o=vr(i,e.slice(n+s));if(0===o){t.push([r]),n+=s;continue}const a=e.slice(n+s,n+s+o);if(n+=o+s,n>e.length)throw Rr("Invalid address Uint8Array: "+Fn(e,"base16"));t.push([r,a])}return t}function Er(e){const t=_r(e),n=wr(t);return yr(n)}function Sr(e){e=Tr(e);const t=gr(e),n=mr(t);return br(n)}function kr(e){return Sr(e)}function Ir(e){const t=Ar(e);if(null!=t)throw t;return Uint8Array.from(e)}function Ar(e){try{_r(e)}catch(rb){return rb}}function Tr(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}function Rr(e){return new Error("Error parsing address: "+e)}function Cr(e){const t=Yn(e[0]);return t}function Pr(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}var Nr,Or,Dr,Lr,xr=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Br=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};const Mr=Symbol.for("nodejs.util.inspect.custom"),Ur=[Yn("dns").code,Yn("dns4").code,Yn("dns6").code,Yn("dnsaddr").code],Fr=new Map,jr=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Vr(e,t){if(null==e)throw new Error("requires node address object");if(null==t)throw new Error("requires transport protocol");let n,r=e.address;switch(e.family){case 4:n="ip4";break;case 6:if(n="ip6",r.includes("%")){const e=r.split("%");if(2!==e.length)throw Error("Multiple ip6 zones in multiaddr");r=e[0];const t=e[1];n=`/ip6zone/${t}/ip6`}break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new Kr("/"+[n,r,t,e.port].join("/"))}function zr(e){return!!$r(e)&&e.protos().some((e=>e.resolvable))}function $r(e){return Boolean(e?.[jr])}class Kr{constructor(e){if(Nr.set(this,void 0),Or.set(this,void 0),Dr.set(this,void 0),this[Lr]=!0,null==e&&(e=""),e instanceof Uint8Array)this.bytes=Ir(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=kr(e)}else{if(!$r(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=Ir(e.bytes)}}toString(){return null==xr(this,Nr,"f")&&Br(this,Nr,Er(this.bytes),"f"),xr(this,Nr,"f")}toJSON(){return this.toString()}toOptions(){let e,t,n,r,s="";const i=Yn("tcp"),o=Yn("udp"),a=Yn("ip4"),c=Yn("ip6"),l=Yn("dns6"),u=Yn("ip6zone");for(const[d,f]of this.stringTuples())d===u.code&&(s=`%${f??""}`),Ur.includes(d)&&(t=i.name,r=443,n=`${f??""}${s}`,e=d===l.code?6:4),d!==i.code&&d!==o.code||(t=Yn(d).name,r=parseInt(f??"")),d!==a.code&&d!==c.code||(t=Yn(d).name,n=`${f??""}${s}`,e=d===c.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');const h={family:e,host:n,transport:t,port:r};return h}protos(){return this.protoCodes().map((e=>Object.assign({},Yn(e))))}protoCodes(){const e=[],t=this.bytes;let n=0;while(n<t.length){const r=Qn.decode(t,n),s=Qn.decode.bytes??0,i=Yn(r),o=vr(i,t.slice(n+s));n+=o+s,e.push(r)}return e}protoNames(){return this.protos().map((e=>e.name))}tuples(){return null==xr(this,Or,"f")&&Br(this,Or,_r(this.bytes),"f"),xr(this,Or,"f")}stringTuples(){return null==xr(this,Dr,"f")&&Br(this,Dr,wr(this.tuples()),"f"),xr(this,Dr,"f")}encapsulate(e){return e=new Kr(e),new Kr(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Kr(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new Kr(br(t.slice(0,n)));return this}getPeerId(){try{const e=this.stringTuples().filter((e=>e[0]===Hn.ipfs.code)),t=e.pop();if(null!=t?.[1]){const e=t[1];return"Q"===e[0]||"1"===e[0]?Fn(R.base58btc.decode(`z${e}`),"base58btc"):Fn(X.k0.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter((e=>{const t=Yn(e[0]);return!0===t.path}))[0][1],null==e&&(e=null)}catch{e=null}return e}equals(e){return Pr(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=Fr.get(t.name);if(null==n)throw B(new Error(`no available resolver for ${t.name}`),"ERR_NO_AVAILABLE_RESOLVER");const r=await n(this,e);return r.map((e=>new Kr(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(e??this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[(Nr=new WeakMap,Or=new WeakMap,Dr=new WeakMap,Lr=jr,Mr)](){return`Multiaddr(${Er(this.bytes)})`}}function Hr(e){return new Kr(e)}const qr=ms("dns4"),Wr=ms("dns6"),Gr=ms("dnsaddr"),Yr=ys(ms("dns"),Gr,qr,Wr),Qr=ys(ms("ip4"),ms("ip6")),Xr=ys(gs(Qr,ms("tcp")),gs(Yr,ms("tcp"))),Jr=gs(Qr,ms("udp")),Zr=gs(Jr,ms("utp")),es=gs(Jr,ms("quic")),ts=ys(gs(Xr,ms("ws")),gs(Yr,ms("ws"))),ns=ys(gs(Xr,ms("wss")),gs(Yr,ms("wss"))),rs=ys(gs(Xr,ms("http")),gs(Qr,ms("http")),gs(Yr,ms("http"))),ss=ys(gs(Xr,ms("https")),gs(Qr,ms("https")),gs(Yr,ms("https"))),is=ys(gs(ts,ms("p2p-webrtc-star"),ms("p2p")),gs(ns,ms("p2p-webrtc-star"),ms("p2p")),gs(ts,ms("p2p-webrtc-star")),gs(ns,ms("p2p-webrtc-star"))),os=(ys(gs(ts,ms("p2p-websocket-star"),ms("p2p")),gs(ns,ms("p2p-websocket-star"),ms("p2p")),gs(ts,ms("p2p-websocket-star")),gs(ns,ms("p2p-websocket-star"))),ys(gs(rs,ms("p2p-webrtc-direct"),ms("p2p")),gs(ss,ms("p2p-webrtc-direct"),ms("p2p")),gs(rs,ms("p2p-webrtc-direct")),gs(ss,ms("p2p-webrtc-direct")))),as=ys(ts,ns,rs,ss,is,os,Xr,Zr,es,Yr),cs=(ys(gs(as,ms("p2p-stardust"),ms("p2p")),gs(as,ms("p2p-stardust"))),ys(gs(as,ms("p2p")),is,os,ms("p2p"))),ls=ys(gs(cs,ms("p2p-circuit"),cs),gs(cs,ms("p2p-circuit")),gs(ms("p2p-circuit"),cs),gs(as,ms("p2p-circuit")),gs(ms("p2p-circuit"),as),ms("p2p-circuit")),us=()=>ys(gs(ls,us),ls),hs=us(),ds=ys(gs(hs,cs,hs),gs(cs,hs),gs(hs,cs),hs,cs),fs=ds;function ps(e){function t(t){let n;try{n=Hr(t)}catch(rb){return!1}const r=e(n.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}return t}function gs(...e){function t(t){if(t.length<e.length)return null;let n=t;return e.some((e=>(n="function"===typeof e?e().partialMatch(t):e.partialMatch(t),Array.isArray(n)&&(t=n),null===n))),n}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:ps(t),partialMatch:t}}function ys(...e){function t(t){let n=null;return e.some((e=>{const r="function"===typeof e?e().partialMatch(t):e.partialMatch(t);return null!=r&&(n=r,!0)})),n}const n={toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:ps(t),partialMatch:t};return n}function ms(e){const t=e;function n(e){let n;try{n=Hr(e)}catch(rb){return!1}const r=n.protoNames();return 1===r.length&&r[0]===t}function r(e){return 0===e.length?null:e[0]===t?e.slice(1):null}return{toString:function(){return t},matches:n,partialMatch:r}}var ws=n(9339);const bs=/^\/(ip[fn]s)\/([^/?#]+)/,vs=1,_s=2,Es=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,Ss=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function ks(e){try{return Ts(e)?Boolean(X.k0.parse(e)):e instanceof Uint8Array?Boolean(X.k0.decode(e)):Boolean(X.k0.asCID(e))}catch{return!1}}function Is(e,t,n=vs,r=_s){const s=Rs(e);if(!1===s)return!1;const i=s.match(t);if(null==i)return!1;if("ipfs"!==i[n])return!1;let o=i[r];return null!=o&&t===Es&&(o=o.toLowerCase()),ks(o)}function As(e,t,n=vs,r=_s){const s=Rs(e);if(!1===s)return!1;const i=s.match(t);if(null==i)return!1;if("ipns"!==i[n])return!1;let o=i[r];if(null!=o&&t===Es){if(o=o.toLowerCase(),ks(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:e}=new ws.URL(`http://${o}`);return Ss.test(e)}catch(a){return!1}}return!0}function Ts(e){return"string"===typeof e}function Rs(e){return e instanceof Uint8Array?Fn(e,"base58btc"):!!Ts(e)&&e}const Cs=e=>Is(e,bs)||As(e,bs),Ps=e=>Is(e,bs),Ns=e=>As(e,bs);let Os=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>(t&=63,e+=t<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_",e)),"");const Ds="/",Ls=(new TextEncoder).encode(Ds),xs=Ls[0];class Bs{constructor(e,t){if("string"===typeof e)this._buf=An(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==xs)throw new Error("Invalid key")}toString(e="utf8"){return Fn(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Bs(e.join(Ds))}static random(){return new Bs(Os().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new Bs(e):"function"===typeof e.uint8Array?new Bs(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=Ls),this._buf[0]!==xs){const e=new Uint8Array(this._buf.byteLength+1);e.fill(xs,0,1),e.set(this._buf,1),this._buf=e}while(this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===xs)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],s=n[r];if(e<s)return!0;if(e>s)return!1}return t.length<n.length}reverse(){return Bs.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Ds).slice(1)}type(){return Ms(this.baseNamespace())}name(){return Us(this.baseNamespace())}instance(e){return new Bs(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Ds)||(e+=Ds),e+=this.type(),new Bs(e)}parent(){const e=this.list();return 1===e.length?new Bs(Ds):new Bs(e.slice(0,-1).join(Ds))}child(e){return this.toString()===Ds?e:e.toString()===Ds?this:new Bs(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(...e){return Bs.withNamespaces([...this.namespaces(),...Fs(e.map((e=>e.namespaces())))])}}function Ms(e){const t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function Us(e){const t=e.split(":");return t[t.length-1]}function Fs(e){return[].concat(...e)}var js=n(4908);let Vs=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function zs(e="",t="ms"){var n=null;return e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"),e.replace(Vs,(function(e,t,r){r=$s(r),r&&(n=(n||0)+parseFloat(t,10)*r)})),n&&n/($s(t)||1)}function $s(e){return zs[e]||zs[e.toLowerCase().replace(/s$/,"")]}zs.nanosecond=zs.ns=1e-6,zs["µs"]=zs["μs"]=zs.us=zs.microsecond=.001,zs.millisecond=zs.ms=zs[""]=1,zs.second=zs.sec=zs.s=1e3*zs.ms,zs.minute=zs.min=zs.m=60*zs.s,zs.hour=zs.hr=zs.h=60*zs.m,zs.day=zs.d=24*zs.h,zs.week=zs.wk=zs.w=7*zs.d,zs.month=zs.b=30.4375*zs.d,zs.year=zs.yr=zs.y=365.25*zs.d;var Ks=zs;class Hs extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=Hs.code}}function qs(e,t){return(...n)=>{const r=n[null==t?n.length-1:t];if(!r||!r.timeout)return e(...n);const s="string"===typeof r.timeout?Ks(r.timeout):r.timeout,i=new Tn.TimeoutController(s);r.signal=(0,js.anySignal)([r.signal,i.signal]);const o=e(...n),a=new Promise(((e,t)=>{i.signal.addEventListener("abort",(()=>{t(new Hs)}))})),c=Date.now(),l=()=>{if(i.signal.aborted)throw new Hs;const e=Date.now()-c;if(e>s)throw i.abort(),new Hs};return o[Symbol.asyncIterator]?async function*(){const e=o[Symbol.asyncIterator]();try{while(1){const{value:t,done:n}=await Promise.race([e.next(),a]);if(n)break;l(),yield t}}catch(rb){throw l(),rb}finally{i.clear(),e.return&&e.return()}}():(async()=>{try{const e=await Promise.race([o,a]);return l(),e}catch(rb){throw l(),rb}finally{i.clear()}})()}}Hs.code="ERR_TIMEOUT";const Ws="/ipfs/";function Gs(e){if(e instanceof Uint8Array)try{e=X.k0.decode(e)}catch(rb){throw B(rb,"ERR_INVALID_CID")}let t=X.k0.asCID(e);if(t)return{cid:t,path:void 0};e=e.toString(),e.startsWith(Ws)&&(e=e.substring(Ws.length));const n=e.split("/");let r;try{t=X.k0.parse(n.shift()||"")}catch(rb){throw B(rb,"ERR_INVALID_CID")}return n.length&&(r=`/${n.join("/")}`),{cid:t,path:r}}const Ys="ERR_BAD_PATH",Qs="This command must be run in online mode. Try running 'ipfs daemon' first.",Xs=new Bs("/local/filesroot"),Js=262144,Zs=e=>{const t=X.k0.asCID(e);if(t)return`/ipfs/${e}`;const n=e.toString();try{return`/ipfs/${X.k0.parse(n)}`}catch{}if(Cs(n))return n;throw B(new Error(`invalid path: ${e}`),Ys)},ei=e=>e instanceof Uint8Array?X.k0.decode(e).toString():(e=e.toString(),0===e.indexOf("/ipfs/")&&(e=e.substring("/ipfs/".length)),"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e),ti=async function(e,t,n,r={}){const{cid:s,path:i}=Gs(n);i&&(r.path=i);let o=s,a=r.path||"";if(a.startsWith("/")&&(a=a.substring(1)),r.path)try{for await(const{value:n,remainderPath:i}of si(s,r.path,t,e,{signal:r.signal})){if(!X.k0.asCID(n))break;a=i,o=n}}catch(rb){throw rb.message.startsWith("Object has no property")&&(rb.message=`no link named "${a.split("/")[0]}" under ${o}`,rb.code="ERR_NO_LINK"),rb}return{cid:o,remainderPath:a||""}},ni=e=>{if("file"!==e.type&&"directory"!==e.type&&"raw"!==e.type)throw new Error(`Unknown node type '${e.type}'`);const t={cid:e.cid,path:e.path,name:e.name,size:e.size,type:"file"};return"directory"===e.type&&(t.type="dir"),"file"===e.type&&(t.size=e.unixfs.fileSize()),"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,void 0!==e.unixfs.mtime&&(t.mtime=e.unixfs.mtime)),t},ri=qs((async(e,t)=>await e)),si=async function*(e,t,n,r,s){const i=async e=>{const t=await n.getCodec(e.code),i=await r.blocks.get(e,s);return t.decode(i)},o=t.split("/").filter(Boolean);let a=await i(e),c=e;while(o.length){const n=o.shift();if(!n)throw B(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(e.code===Ae&&Array.isArray(a.Links)){const e=a.Links.find((e=>e.Name===n));if(e){yield{value:e.Hash,remainderPath:o.join("/")},a=await i(e.Hash),c=e.Hash;continue}}if(!Object.prototype.hasOwnProperty.call(a,n))throw B(new Error(`no link named "${n}" under ${c}`),"ERR_NO_LINK");a=a[n],yield{value:a,remainderPath:o.join("/")},X.k0.asCID(a)&&(c=a,a=await i(a))}yield{value:a,remainderPath:""}};class ii{static create({start:e,stop:t}){return new ii(e,t)}static async start(e,t){const{state:n,activate:r}=e;switch(n.status){case"stopped":try{const n=r(t);e.state={status:"starting",ready:n};const s=await n;return e.state={status:"started",value:s},s}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new gn;case"started":throw new yn;case"stopping":return await n.ready,await ii.start(e,t);default:return ii.panic(e)}}static async stop(e){const{state:t,deactivate:n}=e;switch(t.status){case"stopped":break;case"starting":try{await t.ready}catch(r){}return await ii.stop(e);case"stopping":return await t.ready;case"started":n&&await n(t.value),e.state={status:"stopped"};break;default:ii.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await ri(e.ready,t);default:throw new pn}}static panic({state:e}){const t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await ii.use(this,e)}try(){return ii.try(this)}}function oi({network:e,preload:t,peerId:n,keychain:r,repo:s,ipns:i,mfsPreload:o,print:a,hashers:c,options:l}){const u=async()=>{const{libp2p:u}=await ii.start(e,{peerId:n,repo:s,print:a,hashers:c,options:l});await Promise.all([i.startOnline({keychain:r,libp2p:u,peerId:n,repo:s}),t.start(),o.start()])};return u}function ai({network:e,preload:t,ipns:n,repo:r,mfsPreload:s}){const i=async()=>{await Promise.all([t.stop(),n.stop(),s.stop()]),await ii.stop(e),await r.close()};return i}var ci=n(8694);class li{constructor(e){this.lru=ci(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,n){this.lru.set(e,{value:t,expire:Date.now()+n})}has(e){const t=this.get(e);return!!t}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}var ui=n(6856);n(2801);class hi extends Error{constructor(e){super(e),this.name="TimeoutError"}}class di extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const fi=e=>void 0===globalThis.DOMException?new di(e):new DOMException(e),pi=e=>{const t=void 0===e.reason?fi("This operation was aborted."):e.reason;return t instanceof Error?t:fi(t)};function gi(e,t,n,r){let s;const i=new Promise(((i,o)=>{if("number"!==typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if(r={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...r},r.signal){const{signal:e}=r;e.aborted&&o(pi(e)),e.addEventListener("abort",(()=>{o(pi(e))}))}s=r.customTimers.setTimeout.call(void 0,(()=>{if("function"===typeof n){try{i(n())}catch(a){o(a)}return}const r="string"===typeof n?n:`Promise timed out after ${t} milliseconds`,s=n instanceof Error?n:new hi(r);"function"===typeof e.cancel&&e.cancel(),o(s)}),t),(async()=>{try{i(await e)}catch(t){o(t)}finally{r.customTimers.clearTimeout.call(void 0,s)}})()}else i(e)}));return i.clear=()=>{clearTimeout(s),s=void 0},i}function yi(e,t,n){let r=0,s=e.length;while(s>0){const i=Math.trunc(s/2);let o=r+i;n(e[o],t)<=0?(r=++o,s-=i+1):s=i}return r}var mi,wi=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class bi{constructor(){mi.set(this,[])}enqueue(e,t){t={priority:0,...t};const n={priority:t.priority,run:e};if(this.size&&wi(this,mi,"f")[this.size-1].priority>=t.priority)return void wi(this,mi,"f").push(n);const r=yi(wi(this,mi,"f"),n,((e,t)=>t.priority-e.priority));wi(this,mi,"f").splice(r,0,n)}dequeue(){const e=wi(this,mi,"f").shift();return null===e||void 0===e?void 0:e.run}filter(e){return wi(this,mi,"f").filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return wi(this,mi,"f").length}}mi=new WeakMap;var vi,_i,Ei,Si,ki,Ii,Ai,Ti,Ri,Ci,Pi,Ni,Oi,Di,Li,xi,Bi,Mi,Ui,Fi,ji,Vi,zi,$i,Ki,Hi,qi=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},Wi=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class Gi extends Error{}class Yi extends ui{constructor(e){var t,n,r,s;if(super(),vi.add(this),_i.set(this,void 0),Ei.set(this,void 0),Si.set(this,0),ki.set(this,void 0),Ii.set(this,void 0),Ai.set(this,0),Ti.set(this,void 0),Ri.set(this,void 0),Ci.set(this,void 0),Pi.set(this,void 0),Ni.set(this,0),Oi.set(this,void 0),Di.set(this,void 0),Li.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:bi,...e},!("number"===typeof e.intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${null!==(n=null===(t=e.intervalCap)||void 0===t?void 0:t.toString())&&void 0!==n?n:""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${null!==(s=null===(r=e.interval)||void 0===r?void 0:r.toString())&&void 0!==s?s:""}\` (${typeof e.interval})`);qi(this,_i,e.carryoverConcurrencyCount,"f"),qi(this,Ei,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,"f"),qi(this,ki,e.intervalCap,"f"),qi(this,Ii,e.interval,"f"),qi(this,Ci,new e.queueClass,"f"),qi(this,Pi,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,qi(this,Li,!0===e.throwOnTimeout,"f"),qi(this,Di,!1===e.autoStart,"f")}get concurrency(){return Wi(this,Oi,"f")}set concurrency(e){if(!("number"===typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);qi(this,Oi,e,"f"),Wi(this,vi,"m",$i).call(this)}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:Wi(this,Li,"f"),...t},new Promise(((n,r)=>{Wi(this,Ci,"f").enqueue((async()=>{var s,i,o;qi(this,Ni,(i=Wi(this,Ni,"f"),i++,i),"f"),qi(this,Si,(o=Wi(this,Si,"f"),o++,o),"f");try{if(null===(s=t.signal)||void 0===s?void 0:s.aborted)throw new Gi("The task was aborted.");let r=e({signal:t.signal});t.timeout&&(r=gi(Promise.resolve(r),t.timeout)),t.signal&&(r=Promise.race([r,Wi(this,vi,"m",Ki).call(this,t.signal)]));const i=await r;n(i),this.emit("completed",i)}catch(a){if(a instanceof hi&&!t.throwOnTimeout)return void n();r(a),this.emit("error",a)}finally{Wi(this,vi,"m",Mi).call(this)}}),t),this.emit("add"),Wi(this,vi,"m",ji).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return Wi(this,Di,"f")?(qi(this,Di,!1,"f"),Wi(this,vi,"m",$i).call(this),this):this}pause(){qi(this,Di,!0,"f")}clear(){qi(this,Ci,new(Wi(this,Pi,"f")),"f")}async onEmpty(){0!==Wi(this,Ci,"f").size&&await Wi(this,vi,"m",Hi).call(this,"empty")}async onSizeLessThan(e){Wi(this,Ci,"f").size<e||await Wi(this,vi,"m",Hi).call(this,"next",(()=>Wi(this,Ci,"f").size<e))}async onIdle(){0===Wi(this,Ni,"f")&&0===Wi(this,Ci,"f").size||await Wi(this,vi,"m",Hi).call(this,"idle")}get size(){return Wi(this,Ci,"f").size}sizeBy(e){return Wi(this,Ci,"f").filter(e).length}get pending(){return Wi(this,Ni,"f")}get isPaused(){return Wi(this,Di,"f")}}_i=new WeakMap,Ei=new WeakMap,Si=new WeakMap,ki=new WeakMap,Ii=new WeakMap,Ai=new WeakMap,Ti=new WeakMap,Ri=new WeakMap,Ci=new WeakMap,Pi=new WeakMap,Ni=new WeakMap,Oi=new WeakMap,Di=new WeakMap,Li=new WeakMap,vi=new WeakSet,xi=function(){return Wi(this,Ei,"f")||Wi(this,Si,"f")<Wi(this,ki,"f")},Bi=function(){return Wi(this,Ni,"f")<Wi(this,Oi,"f")},Mi=function(){var e;qi(this,Ni,(e=Wi(this,Ni,"f"),e--,e),"f"),Wi(this,vi,"m",ji).call(this),this.emit("next")},Ui=function(){Wi(this,vi,"m",zi).call(this),Wi(this,vi,"m",Vi).call(this),qi(this,Ri,void 0,"f")},Fi=function(){const e=Date.now();if(void 0===Wi(this,Ti,"f")){const t=Wi(this,Ai,"f")-e;if(!(t<0))return void 0===Wi(this,Ri,"f")&&qi(this,Ri,setTimeout((()=>{Wi(this,vi,"m",Ui).call(this)}),t),"f"),!0;qi(this,Si,Wi(this,_i,"f")?Wi(this,Ni,"f"):0,"f")}return!1},ji=function(){if(0===Wi(this,Ci,"f").size)return Wi(this,Ti,"f")&&clearInterval(Wi(this,Ti,"f")),qi(this,Ti,void 0,"f"),this.emit("empty"),0===Wi(this,Ni,"f")&&this.emit("idle"),!1;if(!Wi(this,Di,"f")){const e=!Wi(this,vi,"a",Fi);if(Wi(this,vi,"a",xi)&&Wi(this,vi,"a",Bi)){const t=Wi(this,Ci,"f").dequeue();return!!t&&(this.emit("active"),t(),e&&Wi(this,vi,"m",Vi).call(this),!0)}}return!1},Vi=function(){Wi(this,Ei,"f")||void 0!==Wi(this,Ti,"f")||(qi(this,Ti,setInterval((()=>{Wi(this,vi,"m",zi).call(this)}),Wi(this,Ii,"f")),"f"),qi(this,Ai,Date.now()+Wi(this,Ii,"f"),"f"))},zi=function(){0===Wi(this,Si,"f")&&0===Wi(this,Ni,"f")&&Wi(this,Ti,"f")&&(clearInterval(Wi(this,Ti,"f")),qi(this,Ti,void 0,"f")),qi(this,Si,Wi(this,_i,"f")?Wi(this,Ni,"f"):0,"f"),Wi(this,vi,"m",$i).call(this)},$i=function(){while(Wi(this,vi,"m",ji).call(this));},Ki=async function(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(new Gi("The task was aborted."))}),{once:!0})}))},Hi=async function(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))};var Qi=n(3436);const Xi=new li(1e3),Ji=6e4,Zi=Yi["default"]?Yi["default"]:Yi,eo=new Zi({concurrency:4}),to=e=>{if(e.Path)return e.Path;throw new Error(e.Message)};async function no(e,t){const n=async(e,t={})=>{const n=new URLSearchParams(t);n.set("arg",e);const r=n.toString();if(!t.nocache&&Xi.has(r)){const e=Xi.get(r);return to(e)}const s=await eo.add((async()=>{const e=await Qi.get("https://ipfs.io/api/v0/dns",{searchParams:n}),t=new URL(e.url).search.slice(1),r=await e.json();return Xi.set(t,r,Ji),r}));return to(s)};return n(e,t)}function ro(e){return e.endsWith(".eth")&&(e=e.replace(/.eth$/,".eth.link")),e}function so(){const e=async(e,t={recursive:!0})=>{if("string"!==typeof e)throw new Error("Invalid arguments, domain must be a string");return e=ro(e),no(e,t)};return qs(e)}function io({network:e}){return()=>{const t=e.try();return null!=t&&Boolean(t.libp2p.isStarted())}}class oo extends Error{constructor(e="The operation was aborted"){super(e),this.code=oo.code,this.type=oo.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}}class ao extends Error{constructor(e,t,n){super(e),this.code=t,this.name=n?.name??"CodeError",this.props=n??{}}}const co=Symbol.for("@libp2p/peer-id");function lo(e){return null!=e&&Boolean(e[co])}const uo=Symbol.for("nodejs.util.inspect.custom"),ho=Object.values(an).map((e=>e.decoder)).reduce(((e,t)=>e.or(t)),an.identity.decoder),fo=114,po=36,go=37;class yo{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[co](){return!0}toString(){return null==this.string&&(this.string=R.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return X.k0.createV1(fo,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Pr(this.multihash.bytes,e);if("string"===typeof e)return _o(e).equals(this);if(null!=e?.multihash?.bytes)return Pr(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[uo](){return`PeerId(${this.toString()})`}}class mo extends yo{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}}class wo extends yo{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}}class bo extends yo{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}}function vo(e){if("RSA"===e.type)return new mo(e);if("Ed25519"===e.type)return new wo(e);if("secp256k1"===e.type)return new bo(e);throw new ao("Not a PeerId","ERR_INVALID_PARAMETERS")}function _o(e,t){if(t=t??ho,"1"===e.charAt(0)||"Q"===e.charAt(0)){const t=At.Jx(R.base58btc.decode(`z${e}`));return e.startsWith("12D")?new wo({multihash:t}):e.startsWith("16U")?new bo({multihash:t}):new mo({multihash:t})}return Eo(ho.decode(e))}function Eo(e){try{const t=At.Jx(e);if(t.code===Nt.code){if(t.digest.length===po)return new wo({multihash:t});if(t.digest.length===go)return new bo({multihash:t})}if(t.code===Gt.code)return new mo({multihash:t})}catch{return So(X.k0.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function So(e){if(null==e||null==e.multihash||null==e.version||1===e.version&&e.code!==fo)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===Gt.code)return new mo({multihash:e.multihash});if(t.code===Nt.code){if(t.digest.length===po)return new wo({multihash:e.multihash});if(t.digest.length===go)return new bo({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function ko(e,t){return e.length===po?new wo({multihash:At.Ue(Nt.code,e),privateKey:t}):e.length===go?new bo({multihash:At.Ue(Nt.code,e),privateKey:t}):new mo({multihash:await Gt.digest(e),publicKey:e,privateKey:t})}function Io({repo:e,codecs:t,bases:n,name:r}){async function s(s,i={}){if(!Cs(s))throw new Error("invalid argument "+s);if(Ns(s))for await(const e of r.resolve(s,i))s=e;const[,o,a,...c]=s.split("/"),l=i.cidBase?await n.getBase(i.cidBase):void 0,u=Ao(a);if(0===c.length){const e=l?l.encoder.encode(u):a;return`/${o}/${e}`}const h=X.k0.decode(u);s=c.join("/");const d=si(h,s,t,e,i);let f=h,p=s;for await(const e of d)X.k0.asCID(e.value)&&(f=e.value,p=e.remainderPath);return`/ipfs/${f.toString(l&&l.encoder)}${p?"/"+p:""}`}return qs(s)}function Ao(e){try{return _o(e).toBytes()}catch{return X.k0.parse(e).bytes}}async function To(e){let t;for await(const n of e)t=n;return t}function Ro({addAll:e}){return(t,n={})=>{let r;const s=X.k0.asCID(t);return r=e(s?[{cid:s,...n}]:[{path:t.toString(),...n}],n),To(r)}}function Co(e){return Symbol.iterator in e}function Po(e){return Symbol.asyncIterator in e}function No(e){return null!=X.k0.asCID(e)}async function*Oo(e){if(null===e||void 0===e)throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=X.k0.asCID(e);if(t)yield Do({cid:t});else{if(!(e instanceof String||"string"===typeof e)){if(null!=e.cid||null!=e.path)return yield Do(e);if(Co(e)){const t=e[Symbol.iterator](),n=t.next();if(n.done)return t;if(No(n.value)){yield Do({cid:n.value});for(const e of t)yield Do({cid:e});return}if(n.value instanceof String||"string"===typeof n.value){yield Do({path:n.value});for(const e of t)yield Do({path:e});return}if(null!=n.value.cid||null!=n.value.path){yield Do(n.value);for(const e of t)yield Do(e);return}throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Po(e)){const t=e[Symbol.asyncIterator](),n=await t.next();if(n.done)return t;if(No(n.value)){yield Do({cid:n.value});for await(const e of t)yield Do({cid:e});return}if(n.value instanceof String||"string"===typeof n.value){yield Do({path:n.value});for await(const e of t)yield Do({path:e});return}if(null!=n.value.cid||null!=n.value.path){yield Do(n.value);for await(const e of t)yield Do(e);return}throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}yield Do({path:e})}}function Do(e){const t=e.cid||`${e.path}`;if(!t)throw B(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const n={path:t,recursive:!1!==e.recursive};return null!=e.metadata&&(n.metadata=e.metadata),n}const Lo={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function xo({repo:e,codecs:t}){async function*n(n,r={}){const s=async function*(){for await(const{path:r,recursive:s,metadata:i}of Oo(n)){const{cid:n}=await ti(e,t,r),{reason:o}=await e.pins.isPinnedWithType(n,[Lo.recursive,Lo.direct]);if("recursive"===o&&!s)throw new Error(`${n} already pinned recursively`);s?await e.pins.pinRecursively(n,{metadata:i}):await e.pins.pinDirectly(n,{metadata:i}),yield n}},i=Boolean(r.lock);if(!i)return void(yield*s());const o=await e.gcLock.readLock();try{yield*s()}finally{o()}}return qs(n)}function Bo(e,t,n){const r={type:e,cid:t};return n&&(r.metadata=n),r}function Mo({repo:e,codecs:t}){async function*n(n={}){let r=Lo.all;if(n.type&&(r=n.type,!Object.keys(Lo).includes(r)))throw B(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(n.paths){let s=!1;for await(const{path:i}of Oo(n.paths)){const{cid:n}=await ti(e,t,i),{reason:o,pinned:a,parent:c,metadata:l}=await e.pins.isPinnedWithType(n,r);if(!a)throw B(new Error(`path '${i}' is not pinned`),"ERR_NOT_PINNED");switch(o){case Lo.direct:case Lo.recursive:s=!0,yield Bo(o,n,l);break;default:s=!0,yield Bo(`${Lo.indirect} through ${c}`,n,l)}}if(!s)throw new Error("No match found")}else{if(r===Lo.recursive||r===Lo.all)for await(const{cid:t,metadata:n}of e.pins.recursiveKeys())yield Bo(Lo.recursive,t,n);if(r===Lo.indirect||r===Lo.all)for await(const t of e.pins.indirectKeys(n))yield Bo(Lo.indirect,t);if(r===Lo.direct||r===Lo.all)for await(const{cid:t,metadata:n}of e.pins.directKeys())yield Bo(Lo.direct,t,n)}}return qs(n)}function Uo({rmAll:e}){async function t(t,n={}){const r=await To(e([{path:t,...n}],n));if(!r)throw new Error("CID expected");return r}return t}function Fo({repo:e,codecs:t}){async function*n(n,r={}){const s=await e.gcLock.readLock();try{for await(const{path:r,recursive:s}of Oo(n)){const{cid:n}=await ti(e,t,r),{pinned:i,reason:o}=await e.pins.isPinnedWithType(n,Lo.all);if(!i)throw new Error(`${n} is not pinned`);switch(o){case Lo.recursive:if(!s)throw new Error(`${n} is pinned recursively`);await e.pins.unpin(n),yield n;break;case Lo.direct:await e.pins.unpin(n),yield n;break;default:throw new Error(`${n} is pinned indirectly under ${o}`)}}}finally{s()}}return qs(n)}class jo{constructor({codecs:e,repo:t}){const n=xo({codecs:e,repo:t});this.addAll=n,this.add=Ro({addAll:n});const r=Fo({codecs:e,repo:t});this.rmAll=r,this.rm=Uo({rmAll:r}),this.ls=Mo({codecs:e,repo:t}),this.remote={add:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:async function*(e,t={}){return Promise.reject(new Error("Not implemented"))},rm:(e,t={})=>Promise.reject(new Error("Not implemented")),rmAll:(e,t={})=>Promise.reject(new Error("Not implemented")),service:{add:(e,t)=>Promise.reject(new Error("Not implemented")),rm:(e,t={})=>Promise.reject(new Error("Not implemented")),ls:(e={})=>Promise.reject(new Error("Not implemented"))}}}}function Vo(e){return e=e||new Error("Cannot open database"),B(e,"ERR_DB_OPEN_FAILED")}function zo(e){return e=e||new Error("Delete failed"),B(e,"ERR_DB_DELETE_FAILED")}function $o(e){return e=e||new Error("Write failed"),B(e,"ERR_DB_WRITE_FAILED")}function Ko(e){return e=e||new Error("Not Found"),B(e,"ERR_NOT_FOUND")}var Ho=n(6402),qo=n(9799),Wo=n(8894),Go=n(7156),Yo=n(8252),Qo=n(7102);function Xo(){Qo._configure(),qo._configure(Wo),Go._configure(Yo)}Xo();const Jo=["uint64","int64","sint64","fixed64","sfixed64"];function Zo(e){for(const t of Jo){if(null==e[t])continue;const n=e[t];e[t]=function(){return BigInt(n.call(this).toString())}}return e}function ea(e){return Zo(new qo(e))}function ta(e){for(const t of Jo){if(null==e[t])continue;const n=e[t];e[t]=function(e){return n.call(this,e.toString())}}return e}function na(){return ta(Go.create())}function ra(e,t){const n=ea(e instanceof Uint8Array?e:e.subarray());return t.decode(n)}function sa(e,t){const n=na();return t.encode(e,n,{lengthDelimited:!1}),n.finish()}var ia,oa,aa,ca,la;function ua(e,t,n,r){return{name:e,type:t,encode:n,decode:r}}function ha(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}const n=function(e,n){const r=t(e);n.int32(r)},r=function(e){const n=e.int32();return t(n)};return ua("enum",ia.VARINT,n,r)}function da(e,t){return ua("message",ia.LENGTH_DELIMITED,e,t)}(function(e){e[e["VARINT"]=0]="VARINT",e[e["BIT64"]=1]="BIT64",e[e["LENGTH_DELIMITED"]=2]="LENGTH_DELIMITED",e[e["START_GROUP"]=3]="START_GROUP",e[e["END_GROUP"]=4]="END_GROUP",e[e["BIT32"]=5]="BIT32"})(ia||(ia={})),function(e){e["RSA"]="RSA",e["Ed25519"]="Ed25519",e["Secp256k1"]="Secp256k1"}(oa||(oa={})),function(e){e[e["RSA"]=0]="RSA",e[e["Ed25519"]=1]="Ed25519",e[e["Secp256k1"]=2]="Secp256k1"}(aa||(aa={})),function(e){e.codec=()=>ha(aa)}(oa||(oa={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),oa.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.Type=oa.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(ca||(ca={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),oa.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.Type=oa.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(la||(la={}));n(1041),n(1352);var fa=n(5736),pa={get(e=globalThis){const t=e.crypto;if(null==t||null==t.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var ga=n(4292);n(5970);function ya(e,t){let n=Uint8Array.from(e.abs().toByteArray());if(n=0===n[0]?n.subarray(1):n,null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=Xn([new Uint8Array(t-n.length),n])}return Fn(n,"base64url")}function ma(e){const t=wa(e);return new fa.jsbn.BigInteger(Fn(t,"base16"),16)}function wa(e,t){let n=An(e,"base64urlpad");if(null!=t){if(n.length>t)throw new Error("byte array longer than desired length");n=Xn([new Uint8Array(t-n.length),n])}return n}const ba={"P-256":256,"P-384":384,"P-521":521},va=Object.keys(ba);va.join(" / ");function _a(e){const t=e?.algorithm??"AES-GCM";let n=e?.keyLength??16;const r=e?.nonceLength??12,s=e?.digest??"SHA-256",i=e?.saltLength??16,o=e?.iterations??32767,a=pa.get();async function c(e,c){const l=a.getRandomValues(new Uint8Array(i)),u=a.getRandomValues(new Uint8Array(r)),h={name:t,iv:u};"string"===typeof c&&(c=An(c));const d={name:"PBKDF2",salt:l,iterations:o,hash:{name:s}},f=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),p=await a.subtle.deriveKey(d,f,{name:t,length:n},!0,["encrypt"]),g=await a.subtle.encrypt(h,p,e);return Xn([l,h.iv,new Uint8Array(g)])}async function l(e,c){const l=e.subarray(0,i),u=e.subarray(i,i+r),h=e.subarray(i+r),d={name:t,iv:u};"string"===typeof c&&(c=An(c));const f={name:"PBKDF2",salt:l,iterations:o,hash:{name:s}},p=await a.subtle.importKey("raw",c,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),g=await a.subtle.deriveKey(f,p,{name:t,length:n},!0,["decrypt"]),y=await a.subtle.decrypt(d,g,h);return new Uint8Array(y)}n*=8;const u={encrypt:c,decrypt:l};return u}async function Ea(e,t){const n=N.decode(e),r=_a();return await r.decrypt(n,t)}n(2328);var Sa=n(5856),ka=n.t(Sa,2);
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
const Ia=BigInt(0),Aa=BigInt(1),Ta=BigInt(2),Ra=BigInt(3),Ca=BigInt(8),Pa=Object.freeze({a:Ia,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:Aa,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Na=(e,t)=>(e+t/Ta)/t,Oa={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){const{n:t}=Pa,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Aa*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=Na(i*e,t),c=Na(-r*e,t);let l=cc(e-a*n-c*s,t),u=cc(-a*r-c*i,t);const h=l>o,d=u>o;if(h&&(l=t-l),d&&(u=t-u),l>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:l,k2neg:d,k2:u}}},Da=32,La=32,xa=32,Ba=Da+1,Ma=2*Da+1;function Ua(e){const{a:t,b:n}=Pa,r=cc(e*e),s=cc(r*e);return cc(s+t*e+n)}const Fa=Pa.a===Ia;class ja extends Error{constructor(e){super(e)}}function Va(e){if(!(e instanceof za))throw new TypeError("JacobianPoint expected")}class za{constructor(e,t,n){this.x=e,this.y=t,this.z=n}static fromAffine(e){if(!(e instanceof Ha))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(Ha.ZERO)?za.ZERO:new za(e.x,e.y,Aa)}static toAffineBatch(e){const t=dc(e.map((e=>e.z)));return e.map(((e,n)=>e.toAffine(t[n])))}static normalizeZ(e){return za.toAffineBatch(e).map(za.fromAffine)}equals(e){Va(e);const{x:t,y:n,z:r}=this,{x:s,y:i,z:o}=e,a=cc(r*r),c=cc(o*o),l=cc(t*c),u=cc(s*a),h=cc(cc(n*o)*c),d=cc(cc(i*r)*a);return l===u&&h===d}negate(){return new za(this.x,cc(-this.y),this.z)}double(){const{x:e,y:t,z:n}=this,r=cc(e*e),s=cc(t*t),i=cc(s*s),o=e+s,a=cc(Ta*(cc(o*o)-r-i)),c=cc(Ra*r),l=cc(c*c),u=cc(l-Ta*a),h=cc(c*(a-u)-Ca*i),d=cc(Ta*t*n);return new za(u,h,d)}add(e){Va(e);const{x:t,y:n,z:r}=this,{x:s,y:i,z:o}=e;if(s===Ia||i===Ia)return this;if(t===Ia||n===Ia)return e;const a=cc(r*r),c=cc(o*o),l=cc(t*c),u=cc(s*a),h=cc(cc(n*o)*c),d=cc(cc(i*r)*a),f=cc(u-l),p=cc(d-h);if(f===Ia)return p===Ia?this.double():za.ZERO;const g=cc(f*f),y=cc(f*g),m=cc(l*g),w=cc(p*p-y-Ta*m),b=cc(p*(m-w)-h*y),v=cc(r*o*f);return new za(w,b,v)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){const t=za.ZERO;if("bigint"===typeof e&&e===Ia)return t;let n=ac(e);if(n===Aa)return this;if(!Fa){let e=t,r=this;while(n>Ia)n&Aa&&(e=e.add(r)),r=r.double(),n>>=Aa;return e}let{k1neg:r,k1:s,k2neg:i,k2:o}=Oa.splitScalar(n),a=t,c=t,l=this;while(s>Ia||o>Ia)s&Aa&&(a=a.add(l)),o&Aa&&(c=c.add(l)),l=l.double(),s>>=Aa,o>>=Aa;return r&&(a=a.negate()),i&&(c=c.negate()),c=new za(cc(c.x*Oa.beta),c.y,c.z),a.add(c)}precomputeWindow(e){const t=Fa?128/e+1:256/e+1,n=[];let r=this,s=r;for(let i=0;i<t;i++){s=r,n.push(s);for(let t=1;t<2**(e-1);t++)s=s.add(r),n.push(s);r=s.double()}return n}wNAF(e,t){!t&&this.equals(za.BASE)&&(t=Ha.BASE);const n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=t&&Ka.get(t);r||(r=this.precomputeWindow(n),t&&1!==n&&(r=za.normalizeZ(r),Ka.set(t,r)));let s=za.ZERO,i=za.BASE;const o=1+(Fa?128/n:256/n),a=2**(n-1),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let h=0;h<o;h++){const t=h*a;let n=Number(e&c);e>>=u,n>a&&(n-=l,e+=Aa);const o=t,d=t+Math.abs(n)-1,f=h%2!==0,p=n<0;0===n?i=i.add($a(f,r[o])):s=s.add($a(p,r[d]))}return{p:s,f:i}}multiply(e,t){let n,r,s=ac(e);if(Fa){const{k1neg:e,k1:i,k2neg:o,k2:a}=Oa.splitScalar(s);let{p:c,f:l}=this.wNAF(i,t),{p:u,f:h}=this.wNAF(a,t);c=$a(e,c),u=$a(o,u),u=new za(cc(u.x*Oa.beta),u.y,u.z),n=c.add(u),r=l.add(h)}else{const{p:e,f:i}=this.wNAF(s,t);n=e,r=i}return za.normalizeZ([n,r])[0]}toAffine(e){const{x:t,y:n,z:r}=this,s=this.equals(za.ZERO);null==e&&(e=s?Ca:hc(r));const i=e,o=cc(i*i),a=cc(o*i),c=cc(t*o),l=cc(n*a),u=cc(r*i);if(s)return Ha.ZERO;if(u!==Aa)throw new Error("invZ was invalid");return new Ha(c,l)}}function $a(e,t){const n=t.negate();return e?n:t}za.BASE=new za(Pa.Gx,Pa.Gy,Aa),za.ZERO=new za(Ia,Aa,Ia);const Ka=new WeakMap;class Ha{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,Ka.delete(this)}hasEvenY(){return this.y%Ta===Ia}static fromCompressedHex(e){const t=32===e.length,n=ic(t?e:e.subarray(1));if(!bc(n))throw new Error("Point is not on curve");const r=Ua(n);let s=uc(r);const i=(s&Aa)===Aa;if(t)i&&(s=cc(-s));else{const t=1===(1&e[0]);t!==i&&(s=cc(-s))}const o=new Ha(n,s);return o.assertValidity(),o}static fromUncompressedHex(e){const t=ic(e.subarray(1,Da+1)),n=ic(e.subarray(Da+1,2*Da+1)),r=new Ha(t,n);return r.assertValidity(),r}static fromHex(e){const t=oc(e),n=t.length,r=t[0];if(n===Da)return this.fromCompressedHex(t);if(n===Ba&&(2===r||3===r))return this.fromCompressedHex(t);if(n===Ma&&4===r)return this.fromUncompressedHex(t);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Ba} compressed bytes or ${Ma} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return Ha.BASE.multiply(_c(e))}static fromSignature(e,t,n){const{r:r,s:s}=Sc(t);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");const i=pc(oc(e)),{n:o}=Pa,a=2===n||3===n?r+o:r,c=hc(a,o),l=cc(-i*c,o),u=cc(s*c,o),h=1&n?"03":"02",d=Ha.fromHex(h+ec(a)),f=Ha.BASE.multiplyAndAddUnsafe(d,l,u);if(!f)throw new Error("Cannot recover signature: point at infinify");return f.assertValidity(),f}toRawBytes(e=!1){return sc(this.toHex(e))}toHex(e=!1){const t=ec(this.x);if(e){const e=this.hasEvenY()?"02":"03";return`${e}${t}`}return`04${t}${ec(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const e="Point is not on elliptic curve",{x:t,y:n}=this;if(!bc(t)||!bc(n))throw new Error(e);const r=cc(n*n),s=Ua(t);if(cc(r-s)!==Ia)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Ha(this.x,cc(-this.y))}double(){return za.fromAffine(this).double().toAffine()}add(e){return za.fromAffine(this).add(za.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return za.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,n){const r=za.fromAffine(this),s=t===Ia||t===Aa||this!==Ha.BASE?r.multiplyUnsafe(t):r.multiply(t),i=za.fromAffine(e).multiplyUnsafe(n),o=s.add(i);return o.equals(za.ZERO)?void 0:o.toAffine()}}function qa(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Wa(e){if(e.length<2||2!==e[0])throw new Error(`Invalid signature integer tag: ${Ja(e)}`);const t=e[1],n=e.subarray(2,t+2);if(!t||n.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===n[0]&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ic(n),left:e.subarray(t+2)}}function Ga(e){if(e.length<2||48!=e[0])throw new Error(`Invalid signature tag: ${Ja(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:n}=Wa(e.subarray(2)),{data:r,left:s}=Wa(n);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${Ja(s)}`);return{r:t,s:r}}Ha.BASE=new Ha(Pa.Gx,Pa.Gy),Ha.ZERO=new Ha(Ia,Ia);class Ya{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){const t=e instanceof Uint8Array,n="Signature.fromCompact";if("string"!==typeof e&&!t)throw new TypeError(`${n}: Expected string or Uint8Array`);const r=t?Ja(e):e;if(128!==r.length)throw new Error(`${n}: Expected 64-byte hex`);return new Ya(rc(r.slice(0,64)),rc(r.slice(64,128)))}static fromDER(e){const t=e instanceof Uint8Array;if("string"!==typeof e&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:n,s:r}=Ga(t?e:sc(e));return new Ya(n,r)}static fromHex(e){return this.fromDER(e)}assertValidity(){const{r:e,s:t}=this;if(!wc(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!wc(t))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const e=Pa.n>>Aa;return this.s>e}normalizeS(){return this.hasHighS()?new Ya(this.r,cc(-this.s,Pa.n)):this}toDERRawBytes(){return sc(this.toDERHex())}toDERHex(){const e=qa(nc(this.s)),t=qa(nc(this.r)),n=e.length/2,r=t.length/2,s=nc(n),i=nc(r),o=nc(r+n+4);return`30${o}02${i}${t}02${s}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return sc(this.toCompactHex())}toCompactHex(){return ec(this.r)+ec(this.s)}}function Qa(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const t=e[r];n.set(t,s),s+=t.length}return n}const Xa=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Ja(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let n=0;n<e.length;n++)t+=Xa[e[n]];return t}const Za=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function ec(e){if("bigint"!==typeof e)throw new Error("Expected bigint");if(!(Ia<=e&&e<Za))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function tc(e){const t=sc(ec(e));if(32!==t.length)throw new Error("Error: expected 32 bytes");return t}function nc(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function rc(e){if("string"!==typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function sc(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,s=e.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function ic(e){return rc(Ja(e))}function oc(e){return e instanceof Uint8Array?Uint8Array.from(e):sc(e)}function ac(e){if("number"===typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"===typeof e&&wc(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function cc(e,t=Pa.P){const n=e%t;return n>=Ia?n:t+n}function lc(e,t){const{P:n}=Pa;let r=e;while(t-- >Ia)r*=r,r%=n;return r}function uc(e){const{P:t}=Pa,n=BigInt(6),r=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),c=e*e*e%t,l=c*c*e%t,u=lc(l,Ra)*l%t,h=lc(u,Ra)*l%t,d=lc(h,Ta)*c%t,f=lc(d,r)*d%t,p=lc(f,s)*f%t,g=lc(p,o)*p%t,y=lc(g,a)*g%t,m=lc(y,o)*p%t,w=lc(m,Ra)*l%t,b=lc(w,i)*f%t,v=lc(b,n)*c%t,_=lc(v,Ta),E=_*_%t;if(E!==e)throw new Error("Cannot find square root");return _}function hc(e,t=Pa.P){if(e===Ia||t<=Ia)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=cc(e,t),r=t,s=Ia,i=Aa,o=Aa,a=Ia;while(n!==Ia){const e=r/n,t=r%n,c=s-o*e,l=i-a*e;r=n,n=t,s=o,i=a,o=c,a=l}const c=r;if(c!==Aa)throw new Error("invert: does not exist");return cc(s,t)}function dc(e,t=Pa.P){const n=new Array(e.length),r=e.reduce(((e,r,s)=>r===Ia?e:(n[s]=e,cc(e*r,t))),Aa),s=hc(r,t);return e.reduceRight(((e,r,s)=>r===Ia?e:(n[s]=cc(e*n[s],t),cc(e*r,t))),s),n}function fc(e){const t=8*e.length-8*La,n=ic(e);return t>0?n>>BigInt(t):n}function pc(e,t=!1){const n=fc(e);if(t)return n;const{n:r}=Pa;return n>=r?n-r:n}let gc,yc;class mc{constructor(e,t){if(this.hashLen=e,this.qByteLen=t,"number"!==typeof e||e<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return xc.hmacSha256(this.k,...e)}hmacSync(...e){return yc(this.k,...e)}checkSync(){if("function"!==typeof yc)throw new ja("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),0!==e.length&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0;const t=[];while(e<this.qByteLen){this.v=await this.hmac(this.v);const n=this.v.slice();t.push(n),e+=this.v.length}return Qa(...t)}generateSync(){this.checkSync(),this.incr();let e=0;const t=[];while(e<this.qByteLen){this.v=this.hmacSync(this.v);const n=this.v.slice();t.push(n),e+=this.v.length}return Qa(...t)}}function wc(e){return Ia<e&&e<Pa.n}function bc(e){return Ia<e&&e<Pa.P}function vc(e,t,n,r=!0){const{n:s}=Pa,i=pc(e,!0);if(!wc(i))return;const o=hc(i,s),a=Ha.BASE.multiply(i),c=cc(a.x,s);if(c===Ia)return;const l=cc(o*cc(t+n*c,s),s);if(l===Ia)return;let u=new Ya(c,l),h=(a.x===u.r?0:2)|Number(a.y&Aa);return r&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function _c(e){let t;if("bigint"===typeof e)t=e;else if("number"===typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"===typeof e){if(e.length!==2*La)throw new Error("Expected 32 bytes of private key");t=rc(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(e.length!==La)throw new Error("Expected 32 bytes of private key");t=ic(e)}if(!wc(t))throw new Error("Expected private key: 0 < key < n");return t}function Ec(e){return e instanceof Ha?(e.assertValidity(),e):Ha.fromHex(e)}function Sc(e){if(e instanceof Ya)return e.assertValidity(),e;try{return Ya.fromDER(e)}catch(t){return Ya.fromCompact(e)}}function kc(e,t=!1){return Ha.fromPrivateKey(e).toRawBytes(t)}function Ic(e){const t=e.length>Da?e.slice(0,Da):e;return ic(t)}function Ac(e){const t=Ic(e),n=cc(t,Pa.n);return Tc(n<Ia?t:n)}function Tc(e){return tc(e)}function Rc(e,t,n){if(null==e)throw new Error(`sign: expected valid message hash, not "${e}"`);const r=oc(e),s=_c(t),i=[Tc(s),Ac(r)];if(null!=n){!0===n&&(n=xc.randomBytes(Da));const e=oc(n);if(e.length!==Da)throw new Error(`sign: Expected ${Da} bytes of extra data`);i.push(e)}const o=Qa(...i),a=Ic(r);return{seed:o,m:a,d:s}}function Cc(e,t){const{sig:n,recovery:r}=e,{der:s,recovered:i}=Object.assign({canonical:!0,der:!0},t),o=s?n.toDERRawBytes():n.toCompactRawBytes();return i?[o,r]:o}async function Pc(e,t,n={}){const{seed:r,m:s,d:i}=Rc(e,t,n.extraEntropy),o=new mc(xa,La);let a;await o.reseed(r);while(!(a=vc(await o.generate(),s,i,n.canonical)))await o.reseed();return Cc(a,n)}const Nc={strict:!0};function Oc(e,t,n,r=Nc){let s;try{s=Sc(e),t=oc(t)}catch(g){return!1}const{r:i,s:o}=s;if(r.strict&&s.hasHighS())return!1;const a=pc(t);let c;try{c=Ec(n)}catch(g){return!1}const{n:l}=Pa,u=hc(o,l),h=cc(a*u,l),d=cc(i*u,l),f=Ha.BASE.multiplyAndAddUnsafe(c,h,d);if(!f)return!1;const p=cc(f.x,l);return p===i}Ha.BASE._setWindowSize(8);const Dc={node:ka,web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},Lc={},xc={bytesToHex:Ja,hexToBytes:sc,concatBytes:Qa,mod:cc,invert:hc,isValidPrivateKey(e){try{return _c(e),!0}catch(t){return!1}},_bigintTo32Bytes:tc,_normalizePrivateKey:_c,hashToPrivateKey:e=>{e=oc(e);const t=La+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");const n=cc(ic(e),Pa.n-Aa)+Aa;return tc(n)},randomBytes:(e=32)=>{if(Dc.web)return Dc.web.getRandomValues(new Uint8Array(e));if(Dc.node){const{randomBytes:t}=Dc.node;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>xc.hashToPrivateKey(xc.randomBytes(La+8)),precompute(e=8,t=Ha.BASE){const n=t===Ha.BASE?t:new Ha(t.x,t.y);return n._setWindowSize(e),n.multiply(Ra),n},sha256:async(...e)=>{if(Dc.web){const t=await Dc.web.subtle.digest("SHA-256",Qa(...e));return new Uint8Array(t)}if(Dc.node){const{createHash:t}=Dc.node,n=t("sha256");return e.forEach((e=>n.update(e))),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(Dc.web){const n=await Dc.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=Qa(...t),s=await Dc.web.subtle.sign("HMAC",n,r);return new Uint8Array(s)}if(Dc.node){const{createHmac:n}=Dc.node,r=n("sha256",e);return t.forEach((e=>r.update(e))),Uint8Array.from(r.digest())}throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let n=Lc[e];if(void 0===n){const t=await xc.sha256(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=Qa(t,t),Lc[e]=n}return xc.sha256(n,...t)},taggedHashSync:(e,...t)=>{if("function"!==typeof gc)throw new ja("sha256Sync is undefined, you need to set it");let n=Lc[e];if(void 0===n){const t=gc(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=Qa(t,t),Lc[e]=n}return gc(n,...t)},_JacobianPoint:za};function Bc(e){if(isNaN(e)||e<=0)throw new ao("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return xc.randomBytes(e)}Object.defineProperties(xc,{sha256Sync:{configurable:!1,get(){return gc},set(e){gc||(gc=e)}},hmacSha256Sync:{configurable:!1,get(){return yc},set(e){yc||(yc=e)}}});n(5070);function Mc(e){const t=fa.asn1.fromDer(Fn(e,"ascii")),n=fa.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:ya(n.n),e:ya(n.e),d:ya(n.d),p:ya(n.p),q:ya(n.q),dp:ya(n.dP),dq:ya(n.dQ),qi:ya(n.qInv),alg:"RS256"}}function Uc(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new ao("JWK was missing components","ERR_INVALID_PARAMETERS");const t=fa.pki.privateKeyToAsn1({n:ma(e.n),e:ma(e.e),d:ma(e.d),p:ma(e.p),q:ma(e.q),dP:ma(e.dp),dQ:ma(e.dq),qInv:ma(e.qi)});return An(fa.asn1.toDer(t).getBytes(),"ascii")}function Fc(e){const t=fa.asn1.fromDer(Fn(e,"ascii")),n=fa.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:ya(n.n),e:ya(n.e)}}function jc(e){if(null==e.n||null==e.e)throw new ao("JWK was missing components","ERR_INVALID_PARAMETERS");const t=fa.pki.publicKeyToAsn1({n:ma(e.n),e:ma(e.e)});return An(fa.asn1.toDer(t).getBytes(),"ascii")}function Vc(e,t){return t.map((t=>ma(e[t])))}function zc(e){return fa.pki.setRsaPrivateKey(...Vc(e,["n","e","d","p","q","dp","dq","qi"]))}function $c(e){return fa.pki.setRsaPublicKey(...Vc(e,["n","e"]))}async function Kc(e){const t=await pa.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await Gc(t);return{privateKey:n[0],publicKey:n[1]}}async function Hc(e){const t=await pa.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),n=[t,await Yc(e)],r=await Gc({privateKey:n[0],publicKey:n[1]});return{privateKey:r[0],publicKey:r[1]}}async function qc(e,t){const n=await pa.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await pa.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,Uint8Array.from(t));return new Uint8Array(r,0,r.byteLength)}async function Wc(e,t,n){const r=await pa.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await pa.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n)}async function Gc(e){if(null==e.privateKey||null==e.publicKey)throw new ao("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([pa.get().subtle.exportKey("jwk",e.privateKey),pa.get().subtle.exportKey("jwk",e.publicKey)])}async function Yc(e){return await pa.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Qc(e,t,n,r){const s=t?$c(e):zc(e),i=Fn(Uint8Array.from(n),"ascii"),o=r(i,s);return An(o,"ascii")}function Xc(e,t){return Qc(e,!0,t,((e,t)=>t.encrypt(e)))}function Jc(e,t){return Qc(e,!1,t,((e,t)=>t.decrypt(e)))}async function Zc(e,t){const n=_a(),r=await n.encrypt(e,t);return N.encode(r)}class el{constructor(e){this._key=e}async verify(e,t){return await Wc(this._key,t,e)}marshal(){return jc(this._key)}get bytes(){return ca.encode({Type:oa.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Xc(this._key,e)}equals(e){return Pr(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Gt.digest(this.bytes);return e}}class tl{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Bc(16)}async sign(e){return await qc(this._key,e)}get public(){if(null==this._publicKey)throw new ao("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new el(this._publicKey)}decrypt(e){return Jc(this._key,e)}marshal(){return Uc(this._key)}get bytes(){return la.encode({Type:oa.RSA,Data:this.marshal()}).subarray()}equals(e){return Pr(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Gt.digest(this.bytes);return e}async id(){const e=await this.public.hash();return Fn(e,"base58btc")}async export(e,t="pkcs-8"){if("pkcs-8"===t){const t=new fa.util.ByteBuffer(this.marshal()),n=fa.asn1.fromDer(t),r=fa.pki.privateKeyFromAsn1(n),s={algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"};return fa.pki.encryptRsaPrivateKey(r,e,s)}if("libp2p-key"===t)return await Zc(this.bytes,e);throw new ao(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}async function nl(e){const t=Mc(e),n=await Hc(t);return new tl(n.privateKey,n.publicKey)}function rl(e){const t=Fc(e);return new el(t)}async function sl(e){const t=await Hc(e);return new tl(t.privateKey,t.publicKey)}async function il(e){const t=await Kc(e);return new tl(t.privateKey,t.publicKey)}var ol=n(7420),al=n.t(ol,2);
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
const cl=BigInt(0),ll=BigInt(1),ul=BigInt(2),hl=BigInt(8),dl=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),fl=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:dl,n:dl,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),pl=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),gl=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),yl=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),ml=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),wl=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),bl=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class vl{constructor(e,t,n,r){this.x=e,this.y=t,this.z=n,this.t=r}static fromAffine(e){if(!(e instanceof Tl))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Tl.ZERO)?vl.ZERO:new vl(e.x,e.y,ll,Fl(e.x*e.y))}static toAffineBatch(e){const t=Vl(e.map((e=>e.z)));return e.map(((e,n)=>e.toAffine(t[n])))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){El(e);const{x:t,y:n,z:r}=this,{x:s,y:i,z:o}=e,a=Fl(t*o),c=Fl(s*r),l=Fl(n*o),u=Fl(i*r);return a===c&&l===u}negate(){return new vl(Fl(-this.x),this.y,this.z,Fl(-this.t))}double(){const{x:e,y:t,z:n}=this,{a:r}=fl,s=Fl(e*e),i=Fl(t*t),o=Fl(ul*Fl(n*n)),a=Fl(r*s),c=e+t,l=Fl(Fl(c*c)-s-i),u=a+i,h=u-o,d=a-i,f=Fl(l*h),p=Fl(u*d),g=Fl(l*d),y=Fl(h*u);return new vl(f,p,y,g)}add(e){El(e);const{x:t,y:n,z:r,t:s}=this,{x:i,y:o,z:a,t:c}=e,l=Fl((n-t)*(o+i)),u=Fl((n+t)*(o-i)),h=Fl(u-l);if(h===cl)return this.double();const d=Fl(r*ul*c),f=Fl(s*ul*a),p=f+d,g=u+l,y=f-d,m=Fl(p*h),w=Fl(g*y),b=Fl(p*y),v=Fl(h*g);return new vl(m,w,v,b)}subtract(e){return this.add(e.negate())}precomputeWindow(e){const t=1+256/e,n=[];let r=this,s=r;for(let i=0;i<t;i++){s=r,n.push(s);for(let t=1;t<2**(e-1);t++)s=s.add(r),n.push(s);r=s.double()}return n}wNAF(e,t){!t&&this.equals(vl.BASE)&&(t=Tl.BASE);const n=t&&t._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let r=t&&Al.get(t);r||(r=this.precomputeWindow(n),t&&1!==n&&(r=vl.normalizeZ(r),Al.set(t,r)));let s=vl.ZERO,i=vl.BASE;const o=1+256/n,a=2**(n-1),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let h=0;h<o;h++){const t=h*a;let n=Number(e&c);e>>=u,n>a&&(n-=l,e+=ll);const o=t,d=t+Math.abs(n)-1,f=h%2!==0,p=n<0;0===n?i=i.add(_l(f,r[o])):s=s.add(_l(p,r[d]))}return vl.normalizeZ([s,i])[0]}multiply(e,t){return this.wNAF(Yl(e,fl.l),t)}multiplyUnsafe(e){let t=Yl(e,fl.l,!1);const n=vl.BASE,r=vl.ZERO;if(t===cl)return r;if(this.equals(r)||t===ll)return this;if(this.equals(n))return this.wNAF(t);let s=r,i=this;while(t>cl)t&ll&&(s=s.add(i)),i=i.double(),t>>=ll;return s}isSmallOrder(){return this.multiplyUnsafe(fl.h).equals(vl.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(fl.l/ul).double();return fl.l%ul&&(e=e.add(this)),e.equals(vl.ZERO)}toAffine(e){const{x:t,y:n,z:r}=this,s=this.equals(vl.ZERO);null==e&&(e=s?hl:jl(r));const i=Fl(t*e),o=Fl(n*e),a=Fl(r*e);if(s)return Tl.ZERO;if(a!==ll)throw new Error("invZ was invalid");return new Tl(i,o)}fromRistrettoBytes(){kl()}toRistrettoBytes(){kl()}fromRistrettoHash(){kl()}}function _l(e,t){const n=t.negate();return e?n:t}function El(e){if(!(e instanceof vl))throw new TypeError("ExtendedPoint expected")}function Sl(e){if(!(e instanceof Il))throw new TypeError("RistrettoPoint expected")}function kl(){throw new Error("Legacy method: switch to RistrettoPoint")}vl.BASE=new vl(fl.Gx,fl.Gy,ll,Fl(fl.Gx*fl.Gy)),vl.ZERO=new vl(cl,ll,ll,cl);class Il{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){const{d:t}=fl,n=Fl(gl*e*e),r=Fl((n+ll)*wl);let s=BigInt(-1);const i=Fl((s-t*n)*Fl(n+t));let{isValid:o,value:a}=Kl(r,i),c=Fl(a*e);xl(c)||(c=Fl(-c)),o||(a=c),o||(s=n);const l=Fl(s*(n-ll)*bl-i),u=a*a,h=Fl((a+a)*i),d=Fl(l*yl),f=Fl(ll-u),p=Fl(ll+u);return new vl(Fl(h*p),Fl(f*d),Fl(d*p),Fl(h*f))}static hashToCurve(e){e=Gl(e,64);const t=Ul(e.slice(0,32)),n=this.calcElligatorRistrettoMap(t),r=Ul(e.slice(32,64)),s=this.calcElligatorRistrettoMap(r);return new Il(n.add(s))}static fromHex(e){e=Gl(e,32);const{a:t,d:n}=fl,r="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Ul(e);if(!Wl(Ll(s),e)||xl(s))throw new Error(r);const i=Fl(s*s),o=Fl(ll+t*i),a=Fl(ll-t*i),c=Fl(o*o),l=Fl(a*a),u=Fl(t*n*c-l),{isValid:h,value:d}=Hl(Fl(u*l)),f=Fl(d*a),p=Fl(d*f*u);let g=Fl((s+s)*f);xl(g)&&(g=Fl(-g));const y=Fl(o*p),m=Fl(g*y);if(!h||xl(m)||y===cl)throw new Error(r);return new Il(new vl(g,y,ll,m))}toRawBytes(){let{x:e,y:t,z:n,t:r}=this.ep;const s=Fl(Fl(n+t)*Fl(n-t)),i=Fl(e*t),o=Fl(i*i),{value:a}=Hl(Fl(s*o)),c=Fl(a*s),l=Fl(a*i),u=Fl(c*l*r);let h;if(xl(r*u)){let n=Fl(t*gl),r=Fl(e*gl);e=n,t=r,h=Fl(c*ml)}else h=l;xl(e*u)&&(t=Fl(-t));let d=Fl((n-t)*h);return xl(d)&&(d=Fl(-d)),Ll(d)}toHex(){return Nl(this.toRawBytes())}toString(){return this.toHex()}equals(e){Sl(e);const t=this.ep,n=e.ep,r=Fl(t.x*n.y)===Fl(t.y*n.x),s=Fl(t.y*n.y)===Fl(t.x*n.x);return r||s}add(e){return Sl(e),new Il(this.ep.add(e.ep))}subtract(e){return Sl(e),new Il(this.ep.subtract(e.ep))}multiply(e){return new Il(this.ep.multiply(e))}multiplyUnsafe(e){return new Il(this.ep.multiplyUnsafe(e))}}Il.BASE=new Il(vl.BASE),Il.ZERO=new Il(vl.ZERO);const Al=new WeakMap;class Tl{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,Al.delete(this)}static fromHex(e,t=!0){const{d:n,P:r}=fl;e=Gl(e,32);const s=e.slice();s[31]=-129&e[31];const i=Bl(s);if(t&&i>=r)throw new Error("Expected 0 < hex < P");if(!t&&i>=pl)throw new Error("Expected 0 < hex < 2**256");const o=Fl(i*i),a=Fl(o-ll),c=Fl(n*o+ll);let{isValid:l,value:u}=Kl(a,c);if(!l)throw new Error("Point.fromHex: invalid y coordinate");const h=(u&ll)===ll,d=0!==(128&e[31]);return d!==h&&(u=Fl(-u)),new Tl(u,i)}static async fromPrivateKey(e){return(await eu(e)).point}toRawBytes(){const e=Ll(this.y);return e[31]|=this.x&ll?128:0,e}toHex(){return Nl(this.toRawBytes())}toX25519(){const{y:e}=this,t=Fl((ll+e)*jl(ll-e));return Ll(t)}isTorsionFree(){return vl.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Tl(Fl(-this.x),this.y)}add(e){return vl.fromAffine(this).add(vl.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return vl.fromAffine(this).multiply(e,this).toAffine()}}Tl.BASE=new Tl(fl.Gx,fl.Gy),Tl.ZERO=new Tl(cl,ll);class Rl{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){const t=Gl(e,64),n=Tl.fromHex(t.slice(0,32),!1),r=Bl(t.slice(32,64));return new Rl(n,r)}assertValidity(){const{r:e,s:t}=this;if(!(e instanceof Tl))throw new Error("Expected Point instance");return Yl(t,fl.l,!1),this}toRawBytes(){const e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Ll(this.s),32),e}toHex(){return Nl(this.toRawBytes())}}function Cl(...e){if(!e.every((e=>e instanceof Uint8Array)))throw new Error("Expected Uint8Array list");if(1===e.length)return e[0];const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const t=e[r];n.set(t,s),s+=t.length}return n}const Pl=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Nl(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=Pl[e[n]];return t}function Ol(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=2*n,s=e.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function Dl(e){const t=32,n=e.toString(16).padStart(2*t,"0");return Ol(n)}function Ll(e){return Dl(e).reverse()}function xl(e){return(Fl(e)&ll)===ll}function Bl(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Nl(Uint8Array.from(e).reverse()))}const Ml=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Ul(e){return Fl(Bl(e)&Ml)}function Fl(e,t=fl.P){const n=e%t;return n>=cl?n:t+n}function jl(e,t=fl.P){if(e===cl||t<=cl)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=Fl(e,t),r=t,s=cl,i=ll,o=ll,a=cl;while(n!==cl){const e=r/n,t=r%n,c=s-o*e,l=i-a*e;r=n,n=t,s=o,i=a,o=c,a=l}const c=r;if(c!==ll)throw new Error("invert: does not exist");return Fl(s,t)}function Vl(e,t=fl.P){const n=new Array(e.length),r=e.reduce(((e,r,s)=>r===cl?e:(n[s]=e,Fl(e*r,t))),ll),s=jl(r,t);return e.reduceRight(((e,r,s)=>r===cl?e:(n[s]=Fl(e*n[s],t),Fl(e*r,t))),s),n}function zl(e,t){const{P:n}=fl;let r=e;while(t-- >cl)r*=r,r%=n;return r}function $l(e){const{P:t}=fl,n=BigInt(5),r=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),a=e*e%t,c=a*e%t,l=zl(c,ul)*c%t,u=zl(l,ll)*e%t,h=zl(u,n)*u%t,d=zl(h,r)*h%t,f=zl(d,s)*d%t,p=zl(f,i)*f%t,g=zl(p,o)*p%t,y=zl(g,o)*p%t,m=zl(y,r)*h%t,w=zl(m,ul)*e%t;return{pow_p_5_8:w,b2:c}}function Kl(e,t){const n=Fl(t*t*t),r=Fl(n*n*t),s=$l(e*r).pow_p_5_8;let i=Fl(e*n*s);const o=Fl(t*i*i),a=i,c=Fl(i*gl),l=o===e,u=o===Fl(-e),h=o===Fl(-e*gl);return l&&(i=a),(u||h)&&(i=c),xl(i)&&(i=Fl(-i)),{isValid:l||u,value:i}}function Hl(e){return Kl(ll,e)}function ql(e){return Fl(Bl(e),fl.l)}function Wl(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Gl(e,t){const n=e instanceof Uint8Array?Uint8Array.from(e):Ol(e);if("number"===typeof t&&n.length!==t)throw new Error(`Expected ${t} bytes`);return n}function Yl(e,t,n=!0){if(!t)throw new TypeError("Specify max value");if("number"===typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"===typeof e&&e<t)if(n){if(cl<e)return e}else if(cl<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Ql(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Xl(e){if(e="bigint"===typeof e||"number"===typeof e?Dl(Yl(e,pl)):Gl(e),32!==e.length)throw new Error("Expected 32 bytes");return e}function Jl(e){const t=Ql(e.slice(0,32)),n=e.slice(32,64),r=ql(t),s=Tl.BASE.multiply(r),i=s.toRawBytes();return{head:t,prefix:n,scalar:r,point:s,pointBytes:i}}let Zl;async function eu(e){return Jl(await au.sha512(Xl(e)))}async function tu(e){return(await eu(e)).pointBytes}async function nu(e,t){e=Gl(e);const{prefix:n,scalar:r,pointBytes:s}=await eu(t),i=ql(await au.sha512(n,e)),o=Tl.BASE.multiply(i),a=ql(await au.sha512(o.toRawBytes(),s,e)),c=Fl(i+a*r,fl.l);return new Rl(o,c).toRawBytes()}function ru(e,t,n){t=Gl(t),n instanceof Tl||(n=Tl.fromHex(n,!1));const{r:r,s:s}=e instanceof Rl?e.assertValidity():Rl.fromHex(e),i=vl.BASE.multiplyUnsafe(s);return{r:r,s:s,SB:i,pub:n,msg:t}}function su(e,t,n,r){const s=ql(r),i=vl.fromAffine(e).multiplyUnsafe(s),o=vl.fromAffine(t).add(i);return o.subtract(n).multiplyUnsafe(fl.h).equals(vl.ZERO)}async function iu(e,t,n){const{r:r,SB:s,msg:i,pub:o}=ru(e,t,n),a=await au.sha512(r.toRawBytes(),o.toRawBytes(),i);return su(o,r,s,a)}Tl.BASE._setWindowSize(8);const ou={node:al,web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},au={bytesToHex:Nl,hexToBytes:Ol,concatBytes:Cl,getExtendedPublicKey:eu,mod:Fl,invert:jl,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=Gl(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return Fl(Bl(e),fl.l-ll)+ll},randomBytes:(e=32)=>{if(ou.web)return ou.web.getRandomValues(new Uint8Array(e));if(ou.node){const{randomBytes:t}=ou.node;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>au.randomBytes(32),sha512:async(...e)=>{const t=Cl(...e);if(ou.web){const e=await ou.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}if(ou.node)return Uint8Array.from(ou.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")},precompute(e=8,t=Tl.BASE){const n=t.equals(Tl.BASE)?t:new Tl(t.x,t.y);return n._setWindowSize(e),n.multiply(ul),n},sha512Sync:void 0};Object.defineProperties(au,{sha512Sync:{configurable:!1,get(){return Zl},set(e){Zl||(Zl=e)}}});const cu=32,lu=64,uu=32;async function hu(){const e=au.randomPrivateKey(),t=await tu(e),n=gu(e,t);return{privateKey:n,publicKey:t}}async function du(e){if(e.length!==uu)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const t=e,n=await tu(t),r=gu(t,n);return{privateKey:r,publicKey:n}}async function fu(e,t){const n=e.subarray(0,uu);return await nu(t,n)}async function pu(e,t,n){return await iu(t,n,e)}function gu(e,t){const n=new Uint8Array(lu);for(let r=0;r<uu;r++)n[r]=e[r],n[uu+r]=t[r];return n}class yu{constructor(e){this._key=Eu(e,cu)}async verify(e,t){return await pu(this._key,t,e)}marshal(){return this._key}get bytes(){return ca.encode({Type:oa.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Pr(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Gt.digest(this.bytes);return e}}class mu{constructor(e,t){this._key=Eu(e,lu),this._publicKey=Eu(t,cu)}async sign(e){return await fu(this._key,e)}get public(){return new yu(this._publicKey)}marshal(){return this._key}get bytes(){return la.encode({Type:oa.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Pr(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Gt.digest(this.bytes);return e}async id(){const e=await Nt.digest(this.public.bytes);return R.base58btc.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await Zc(this.bytes,e);throw new ao(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function wu(e){if(e.length>lu){e=Eu(e,lu+cu);const t=e.subarray(0,lu),n=e.subarray(lu,e.length);return new mu(t,n)}e=Eu(e,lu);const t=e.subarray(0,lu),n=e.subarray(cu);return new mu(t,n)}function bu(e){return e=Eu(e,cu),new yu(e)}async function vu(){const{privateKey:e,publicKey:t}=await hu();return new mu(e,t)}async function _u(e){const{privateKey:t,publicKey:n}=await du(e);return new mu(t,n)}function Eu(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new ao(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}function Su(){return xc.randomPrivateKey()}async function ku(e,t){const{digest:n}=await Gt.digest(t);try{return await Pc(n,e)}catch(rb){throw new ao(String(rb),"ERR_INVALID_INPUT")}}async function Iu(e,t,n){try{const{digest:r}=await Gt.digest(n);return Oc(t,r,e)}catch(rb){throw new ao(String(rb),"ERR_INVALID_INPUT")}}function Au(e){const t=Ha.fromHex(e).toRawBytes(!0);return t}function Tu(e){try{kc(e,!0)}catch(rb){throw new ao(String(rb),"ERR_INVALID_PRIVATE_KEY")}}function Ru(e){try{Ha.fromHex(e)}catch(rb){throw new ao(String(rb),"ERR_INVALID_PUBLIC_KEY")}}function Cu(e){try{return kc(e,!0)}catch(rb){throw new ao(String(rb),"ERR_INVALID_PRIVATE_KEY")}}class Pu{constructor(e){Ru(e),this._key=e}async verify(e,t){return await Iu(this._key,t,e)}marshal(){return Au(this._key)}get bytes(){return ca.encode({Type:oa.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Pr(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Gt.digest(this.bytes);return e}}class Nu{constructor(e,t){this._key=e,this._publicKey=t??Cu(e),Tu(this._key),Ru(this._publicKey)}async sign(e){return await ku(this._key,e)}get public(){return new Pu(this._publicKey)}marshal(){return this._key}get bytes(){return la.encode({Type:oa.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Pr(this.bytes,e.bytes)}async hash(){const{bytes:e}=await Gt.digest(this.bytes);return e}async id(){const e=await this.public.hash();return Fn(e,"base58btc")}async export(e,t="libp2p-key"){if("libp2p-key"===t)return await Zc(this.bytes,e);throw new ao(`export format '${t}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function Ou(e){return new Nu(e)}function Du(e){return new Pu(e)}async function Lu(){const e=await Su();return new Nu(e)}const xu={rsa:w,ed25519:b,secp256k1:v};function Bu(e){const t=Object.keys(xu).join(" / ");return new ao(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Mu(e){if(e=e.toLowerCase(),"rsa"===e||"ed25519"===e||"secp256k1"===e)return xu[e];throw Bu(e)}async function Uu(e,t){return await Mu(e).generateKeyPair(t??2048)}function Fu(e){const t=ca.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case oa.RSA:return xu.rsa.unmarshalRsaPublicKey(n);case oa.Ed25519:return xu.ed25519.unmarshalEd25519PublicKey(n);case oa.Secp256k1:return xu.secp256k1.unmarshalSecp256k1PublicKey(n);default:throw Bu(t.Type??"RSA")}}function ju(e,t){return t=(t??"rsa").toLowerCase(),Mu(t),e.bytes}async function Vu(e){const t=la.decode(e),n=t.Data??new Uint8Array;switch(t.Type){case oa.RSA:return await xu.rsa.unmarshalRsaPrivateKey(n);case oa.Ed25519:return xu.ed25519.unmarshalEd25519PrivateKey(n);case oa.Secp256k1:return xu.secp256k1.unmarshalSecp256k1PrivateKey(n);default:throw Bu(t.Type??"RSA")}}function zu(e,t){return t=(t??"rsa").toLowerCase(),Mu(t),e.bytes}async function $u(e,t){try{const n=await Ea(e,t);return await Vu(n)}catch(s){}const n=fa.pki.decryptRsaPrivateKey(e,t);if(null===n)throw new ao("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let r=fa.asn1.toDer(fa.pki.privateKeyToAsn1(n));return r=An(r.getBytes(),"ascii"),await xu.rsa.unmarshalRsaPrivateKey(r)}const Ku="ERR_IPNS_EXPIRED_RECORD",Hu="ERR_UNRECOGNIZED_VALIDITY",qu="ERR_SIGNATURE_CREATION",Wu="ERR_SIGNATURE_VERIFICATION",Gu="ERR_UNRECOGNIZED_FORMAT",Yu="ERR_UNDEFINED_PARAMETER",Qu="ERR_INVALID_RECORD_DATA",Xu="ERR_INVALID_EMBEDDED_KEY",Ju="ERR_MISSING_PRIVATE_KEY";var Zu;(function(e){let t,n,r;(function(e){e["EOL"]="EOL"})(t=e.ValidityType||(e.ValidityType={})),function(e){e[e["EOL"]=0]="EOL"}(n||(n={})),function(e){e.codec=()=>ha(n)}(t=e.ValidityType||(e.ValidityType={})),e.codec=()=>(null==r&&(r=da(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.value&&(n.uint32(10),n.bytes(t.value)),null!=t.signature&&(n.uint32(18),n.bytes(t.signature)),null!=t.validityType&&(n.uint32(24),e.ValidityType.codec().encode(t.validityType,n)),null!=t.validity&&(n.uint32(34),n.bytes(t.validity)),null!=t.sequence&&(n.uint32(40),n.uint64(t.sequence)),null!=t.ttl&&(n.uint32(48),n.uint64(t.ttl)),null!=t.pubKey&&(n.uint32(58),n.bytes(t.pubKey)),null!=t.signatureV2&&(n.uint32(66),n.bytes(t.signatureV2)),null!=t.data&&(n.uint32(74),n.bytes(t.data)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},s=null==n?t.len:t.pos+n;while(t.pos<s){const n=t.uint32();switch(n>>>3){case 1:r.value=t.bytes();break;case 2:r.signature=t.bytes();break;case 3:r.validityType=e.ValidityType.codec().decode(t);break;case 4:r.validity=t.bytes();break;case 5:r.sequence=t.uint64();break;case 6:r.ttl=t.uint64();break;case 7:r.pubKey=t.bytes();break;case 8:r.signatureV2=t.bytes();break;case 9:r.data=t.bytes();break;default:t.skipType(7&n);break}}return r}))),r),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(Zu||(Zu={}));const eh=x("ipns:utils"),th=An("/ipns/");function nh(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),s=parseInt(n[2],10)-1,i=parseInt(n[3],10),o=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),l=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,s,i,o,a,c,l))}const rh=async(e,t)=>{if(null==t||null==e){const e=new Error("one or more of the provided parameters are not defined");throw eh.error(e),B(e,Yu)}let n;if(null!=t.pubKey){try{n=Fu(t.pubKey)}catch(rb){throw eh.error(rb),rb}const r=await ko(t.pubKey);if(!r.equals(e))throw B(new Error("Embedded public key did not match PeerID"),Xu)}else null!=e.publicKey&&(n=Fu(e.publicKey));if(null!=n)return n;throw B(new Error("no public key is available"),Yu)},sh=(e,t,n)=>{const r=An(t);return Xn([e,n,r])},ih=e=>{const t=An("ipns-signature:");return Xn([t,e])},oh=e=>Zu.encode(e),ah=e=>{const t=Zu.decode(e);return null!=t.sequence&&(t.sequence=BigInt(t.sequence)),null!=t.ttl&&(t.ttl=BigInt(t.ttl)),{value:t.value??new Uint8Array(0),signature:t.signature??new Uint8Array(0),validityType:t.validityType??Zu.ValidityType.EOL,validity:t.validity??new Uint8Array(0),sequence:t.sequence??0n,pubKey:t.pubKey,ttl:t.ttl??void 0,signatureV2:t.signatureV2,data:t.data}},ch=e=>Xn([th,e.toBytes()]),lh=e=>Eo(e.slice(th.length)),uh=(e,t,n,r,s)=>{let i;if(n!==Zu.ValidityType.EOL)throw B(new Error("Unknown validity type"),Hu);i=0;const o={Value:e,Validity:t,ValidityType:i,Sequence:r,TTL:s};return Ne.cv(o)},hh=e=>{const t=Ne.Jx(e);if(0!==t.ValidityType)throw B(new Error("Unknown validity type"),Hu);return t.ValidityType=Zu.ValidityType.EOL,Number.isInteger(t.Sequence)&&(t.Sequence=BigInt(t.Sequence)),Number.isInteger(t.TTL)&&(t.TTL=BigInt(t.TTL)),t},dh=x("ipns"),fh=Nt.code,ph="/ipns/",gh=ph.length,yh=async(e,t,n,r)=>{const s=new Ho(Date.now()+Number(r)),i=Zu.ValidityType.EOL,[o,a]=r.toString().split("."),c=BigInt(o)*BigInt(1e5)+BigInt(a??"0");return await mh(e,t,n,i,s,c)},mh=async(e,t,n,r,s,i)=>{n=BigInt(n);const o=An(s.toString());if(null==e.privateKey)throw B(new Error("Missing private key"),Ju);const a=await Vu(e.privateKey),c=await vh(a,t,r,o),l=uh(t,o,r,n,i),u=ih(l),h=await a.sign(u),d={value:t,signature:c,validityType:r,validity:o,sequence:n,ttl:i,signatureV2:h,data:l};if(null!=e.publicKey){const t=At.Jx(e.toBytes());t.code===fh&&Pr(e.publicKey,t.digest)||(d.pubKey=e.publicKey)}return dh("ipns entry for %b created",t),d},wh=e=>C.base32upper.encode(e).slice(1),bh=e=>new Bs(`/ipns/${wh(e)}`),vh=async(e,t,n,r)=>{try{const s=sh(t,n,r);return await e.sign(s)}catch(s){throw dh.error("record signature creation failed",s),B(new Error("record signature creation failed"),qu)}},_h=x("ipfs:ipns:publisher"),Eh=Ko().code,Sh=36e5;class kh{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,n,r){const s=await this._updateOrCreateRecord(e,t,n,r);return this._putRecordToRouting(s,e,r)}publish(e,t,n){return this.publishWithEOL(e,t,Sh,n)}async _putRecordToRouting(e,t,n){if(!lo(t)){const e="peerId received is not valid";throw _h.error(e),B(new Error(e),"ERR_INVALID_PEER_ID")}if(null==t.publicKey)throw B(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");const r=ch(t);return await this._publishEntry(r,e,n),e}async _publishEntry(e,t,n){try{const r=await this._routing.put(e,t,n);return _h(`ipns record for ${Fn(e,"base32")} was stored in the routing`),r}catch(rb){const n=`ipns record for ${Fn(e,"base32")} could not be stored in the routing - ${rb.stack}`;throw _h.error(n),_h.error(rb),B(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!lo(e)){const e="peerId received is not valid";throw _h.error(e),B(new Error(e),"ERR_INVALID_PEER_ID")}const n=!1!==t.checkRouting;try{const t=await this._datastore.get(bh(e.toBytes()));return this._unmarshalData(t)}catch(rb){if(rb.code!==Eh){const t=`unexpected error getting the ipns record ${e.toString()} from datastore`;throw _h.error(t),B(new Error(t),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!n)throw B(rb,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const t=ch(e),n=await this._routing.get(t);return this._unmarshalData(n)}catch(rb){throw _h.error(rb),rb}}}_unmarshalData(e){try{return ah(e)}catch(rb){throw B(rb,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,n,r){if(!lo(e)){const e="peerId received is not valid";throw _h.error(e),B(new Error(e),"ERR_INVALID_PEER_ID")}const s={checkRouting:!0};let i;try{i=await this._getPublished(e,s)}catch(rb){if(rb.code!==Eh){const n=`unexpected error when determining the last published IPNS record for ${e.toString()} ${rb.stack}`;throw _h.error(n),B(new Error(n),"ERR_DETERMINING_PUBLISHED_RECORD")}}let o,a=0n;i&&void 0!==i.sequence&&(a=Pr(i.value,t)?i.sequence:i.sequence+BigInt(1));try{o=await yh(e,t,a,n)}catch(rb){const n=`ipns record for ${t} could not be created`;throw _h.error(rb),B(new Error(n),"ERR_CREATING_IPNS_RECORD")}try{const n=oh(o);return await this._datastore.put(bh(e.toBytes()),n,r),_h(`ipns record for ${Fn(t,"base32")} was stored in the datastore`),n}catch(rb){const n=`ipns record for ${t} could not be stored in the datastore`;throw _h.error(n),B(new Error(n),"ERR_STORING_IN_DATASTORE")}}}kh.defaultRecordLifetime=Sh;const Ih=x("ipfs:ipns:republisher"),Ah=6e4,Th=60*Ah,Rh=4*Th,Ch=24*Th;class Ph{constructor(e,t,n,r,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=n,this._keychain=r,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw B(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:t=>{e._timeoutId=setTimeout((async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(t)}catch(rb){Ih.error(rb)}}),t())},cancel:async()=>{null!=e._timeoutId&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{pass:t}=this._options;let n=!0;e._task=async()=>{const e=new Tn.TimeoutController(3e4);try{await this._republishEntries(this._peerId,t,{signal:e.signal})}finally{e.clear()}},e.runPeriodically((()=>n?(n=!1,this._options.initialBroadcastInterval||Ah):this._options.broadcastInterval||Rh)),this._republishHandle=e}async stop(){const e=this._republishHandle;if(!e)throw B(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t,n){try{await this._republishEntry(e,n)}catch(rb){const t="cannot republish entry for the node's private key";return void Ih.error(t)}if(t)try{const e=await this._keychain.listKeys();for(const r of e){if("self"===r.name)continue;const e=await this._keychain.exportKey(r.name,t),s=await $u(e,t),i=await ko(s.public.bytes,s.bytes);await this._republishEntry(i,n)}}catch(rb){Ih.error(rb)}}async _republishEntry(e,t){try{const n=await this._getPreviousValue(e);await this._publisher.publishWithEOL(e,n,Ch,t)}catch(rb){if("ERR_NO_ENTRY_FOUND"===rb.code)return;throw rb}}async _getPreviousValue(e){if(!lo(e))throw B(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const t=await this._datastore.get(bh(e.toBytes()));if(!(t instanceof Uint8Array))throw B(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{const e=ah(t);return e.value}catch(rb){throw Ih.error(rb),B(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(rb){if(rb&&rb.notFound)throw B(new Error(`no previous entry for record with id: ${e.toString()}`),"ERR_NO_ENTRY_FOUND");throw rb}}}const Nh=x("ipns:validator"),Oh=async(e,t)=>{const{value:n,validityType:r,validity:s}=t;let i,o,a;if(null==t.signatureV2||null==t.data)throw B(new Error("missing data or signatureV2"),Wu);o=t.signatureV2,i=ih(t.data),Dh(t);try{a=await e.verify(i,o)}catch(rb){a=!1}if(!a)throw Nh.error("record signature verification failed"),B(new Error("record signature verification failed"),Wu);if(null!=s&&r===Zu.ValidityType.EOL){let e;try{e=nh(Fn(s))}catch(c){throw Nh.error("unrecognized validity format (not an rfc3339 format)"),B(new Error("unrecognized validity format (not an rfc3339 format)"),Gu)}if(e.getTime()<Date.now())throw Nh.error("record has expired"),B(new Error("record has expired"),Ku)}else if(null!=r)throw Nh.error("unrecognized validity type"),B(new Error("unrecognized validity type"),Hu);Nh("ipns entry for %b is valid",n)},Dh=e=>{if(null==e.data)throw B(new Error("Record data is missing"),Qu);const t=hh(e.data);if(!Pr(t.Value,e.value))throw B(new Error('Field "value" did not match between protobuf and CBOR'),Wu);if(!Pr(t.Validity,e.validity))throw B(new Error('Field "validity" did not match between protobuf and CBOR'),Wu);if(t.ValidityType!==e.validityType)throw B(new Error('Field "validityType" did not match between protobuf and CBOR'),Wu);if(t.Sequence!==e.sequence)throw B(new Error('Field "sequence" did not match between protobuf and CBOR'),Wu);if(t.TTL!==e.ttl)throw B(new Error('Field "ttl" did not match between protobuf and CBOR'),Wu)},Lh=async(e,t)=>{const n=lh(e),r=ah(t),s=await rh(n,r);await Oh(s,r)},xh=x("ipfs:ipns:resolver"),Bh=Ko().code,Mh=32;class Uh{constructor(e){this._routing=e}async resolve(e,t={}){if("string"!==typeof e)throw B(new Error("invalid name"),"ERR_INVALID_NAME");const n=t.recursive&&"true"===t.recursive.toString(),r=e.split("/");if(3!==r.length||""!==r[0])throw B(new Error("invalid name"),"ERR_INVALID_NAME");const s=r[2];let i=1/0;n&&(i=Mh);const o=await this.resolver(s,i,t);return xh(`${e} was locally resolved correctly`),o}async resolver(e,t,n){if(0===t){const e=`could not resolve name (recursion limit of ${Mh} exceeded)`;throw xh.error(e),B(new Error(e),"ERR_RESOLVE_RECURSION_LIMIT")}const r=await this._resolveName(e,n),s=r.split("/");return"ipfs"!==s[1]&&t?this.resolver(s[2],t-1,n):r}async _resolveName(e,t){const n=_o(e),r=ch(n);let s;try{s=await this._routing.get(r,t)}catch(rb){if(xh.error("could not get record from routing",rb),rb.code===Bh)throw B(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND");throw B(new Error(`unexpected error getting the ipns record ${n.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(n,s)}async _validateRecord(e,t){await Lh(Xn([An("/ipns/"),e.toBytes()]),t);const n=ah(t);return Fn(n.value)}}class Fh{constructor(e){this.lru=ci(e)}get(e){const t=this.lru.get(e);if(t)return t.expire&&t.expire<Date.now()?void this.lru.remove(e):t.value}set(e,t,n){this.lru.set(e,{value:t,expire:Date.now()+n})}has(e){const t=this.get(e);return!!t}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}}const jh=x("ipfs:ipns"),Vh=6e4;class zh{constructor(e,t,n,r,s){this.publisher=new kh(e,t),this.republisher=new Ph(this.publisher,t,n,r,s),this.resolver=new Uh(e),this.cache=new Fh(1e3),this.routing=e}async publish(e,t,n=kh.defaultRecordLifetime,r){try{await this.publisher.publishWithEOL(e,t,n,r),jh(`IPNS value ${Fn(t,"base32")} was published correctly`);const s=e.toString(),i=parseFloat(n),o=i<Vh?i:Vh;return this.cache.set(s,t,o),jh(`IPNS value ${Fn(t,"base32")} was cached correctly`),{name:s,value:t}}catch(rb){throw jh.error(rb),rb}}async resolve(e,t={}){if("string"!==typeof e)throw B(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){const t=e.split("/")[2],n=this.cache.get(t);if(n)return n}try{const n=await this.resolver.resolve(e,t);return jh(`IPNS record from ${e} was resolved correctly`),n}catch(rb){throw jh.error(rb),rb}}async initializeKeyspace(e,t,n){return this.publish(e,t,kh.defaultRecordLifetime,n)}}async function $h(e){const t=[];for await(const n of e)t.push(n);return t}const Kh=(e,t)=>async function*(){const n=await $h(e);yield*n.sort(t)}();async function Hh(e){for await(const t of e);}async function*qh(e,t){for await(const n of e)await t(n)&&(yield n)}async function*Wh(e,t){let n=0;if(!(t<1))for await(const r of e)if(yield r,n++,n===t)return}class Gh{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:n,value:r}of e)await this.put(n,r,t),yield{key:n,value:r}}async*getMany(e,t={}){for await(const n of e)yield this.get(n,t)}async*deleteMany(e,t={}){for await(const n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(t,n){e.push({key:t,value:n})},delete(e){t.push(e)},commit:async n=>{await Hh(this.putMany(e,n)),e=[],await Hh(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(null!=e.prefix&&(n=qh(n,(t=>t.key.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>qh(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>Kh(e,t)),n)),null!=e.offset){let t=0;n=qh(n,(()=>t++>=e.offset))}return null!=e.limit&&(n=Wh(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix&&(n=qh(n,(t=>t.toString().startsWith(e.prefix)))),Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>qh(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>Kh(e,t)),n)),null!=e.offset){let t=0;n=qh(n,(()=>t++>=e.offset))}return null!=e.limit&&(n=Wh(n,e.limit)),n}}class Yh{constructor(e){if(!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Qh{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Yh(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=e?.byteLength?e.byteLength:1}push(e){if(null!=e?.value&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new Yh(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(void 0===e&&null!=this.tail.next){const t=this.tail.next;this.tail.next=null,this.tail=t,e=this.tail.shift()}return null!=e?.value&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}}function Xh(e={}){const t=e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}};return Zh(t,e)}function Jh(e={}){const t=e=>{let t;const n=[];while(!e.isEmpty()){if(t=e.shift(),null==t)break;if(null!=t.error)throw t.error;!1===t.done&&n.push(t.value)}return null==t?{done:!0}:{done:!0===t.done,value:n}};return Zh(t,e)}function Zh(e,t){t=t??{};let n,r,s,i=t.onEnd,o=new Qh;const a=async()=>o.isEmpty()?s?{done:!0}:await new Promise(((t,s)=>{r=i=>{r=null,o.push(i);try{t(e(o))}catch(rb){s(rb)}return n}})):e(o),c=e=>null!=r?r(e):(o.push(e),n),l=e=>(o=new Qh,null!=r?r({error:e}):(o.push({error:e}),n)),u=e=>{if(s)return n;if(!0!==t?.objectMode&&null==e?.byteLength)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:e})},h=e=>s?n:(s=!0,null!=e?l(e):c({done:!0})),d=()=>(o=new Qh,h(),{done:!0}),f=e=>(h(e),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:a,return:d,throw:f,push:u,end:h,get readableLength(){return o.size}},null==i)return n;const p=n;return n={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(e){return p.throw(e),null!=i&&(i(e),i=void 0),{done:!0}},return(){return p.return(),null!=i&&(i(),i=void 0),{done:!0}},push:u,end(e){return p.end(e),null!=i&&(i(e),i=void 0),n},get readableLength(){return p.readableLength}},n}const ed=x("datastore:core:tiered");class td extends Gh{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map((e=>e.open())))}catch(rb){throw Vo(rb)}}async put(e,t,n){try{await Promise.all(this.stores.map((r=>r.put(e,t,n))))}catch(rb){throw $o(rb)}}async get(e,t){for(const n of this.stores)try{const r=await n.get(e,t);if(r)return r}catch(rb){ed.error(rb)}throw Ko()}async has(e,t){for(const n of this.stores)if(await n.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map((n=>n.delete(e,t))))}catch(rb){throw zo(rb)}}async*putMany(e,t={}){let n;const r=this.stores.map((e=>{const r=Xh({objectMode:!0});return Hh(e.putMany(r,t)).catch((e=>{n=e})),r}));try{for await(const t of e){if(n)throw n;r.forEach((e=>e.push(t))),yield t}}finally{r.forEach((e=>e.end()))}}async*deleteMany(e,t={}){let n;const r=this.stores.map((e=>{const r=Xh({objectMode:!0});return Hh(e.deleteMany(r,t)).catch((e=>{n=e})),r}));try{for await(const t of e){if(n)throw n;r.forEach((e=>e.push(t))),yield t}}finally{r.forEach((e=>e.end()))}}async close(){await Promise.all(this.stores.map((e=>e.close())))}batch(){const e=this.stores.map((e=>e.batch()));return{put:(t,n)=>{e.forEach((e=>e.put(t,n)))},delete:t=>{e.forEach((e=>e.delete(t)))},commit:async t=>{for(const n of e)await n.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}}var nd=n(2883);const rd=(e,t)=>{const n=t.map(((e,t)=>({entry:Zu.decode(e),index:t})));return n.sort(((e,t)=>{if(null!=e.entry.signatureV2&&null==t.entry.signatureV2)return-1;if(null==e.entry.signatureV2&&null!=t.entry.signatureV2)return 1;const n=e.entry.sequence??0n,r=t.entry.sequence??0n;if(n>r)return-1;if(n<r)return 1;const s=e.entry.validity??new Uint8Array(0),i=t.entry.validity??new Uint8Array(0),o=nh(Fn(s)),a=nh(Fn(i));return o.getTime()>a.getTime()?-1:o.getTime()<a.getTime()?1:0})),n[0].index},sd="SHARDING",id="_README";class od extends Gh{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){const t=await this.has(e);if(!t)throw Ko();return this.data[e.toString()]}async has(e){return void 0!==this.data[e.toString()]}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map((([e,t])=>({key:new Bs(e),value:t})))}async*_allKeys(){yield*Object.entries(this.data).map((([e])=>new Bs(e)))}}async function*ad(...e){const t=Xh({objectMode:!0});Promise.resolve().then((async()=>{try{await Promise.all(e.map((async e=>{for await(const n of e)t.push(n)}))),t.end()}catch(rb){t.end(rb)}})),yield*t}const cd=(...e)=>{let t;while(e.length>0)t=e.shift()(t);return t},ld=e=>null!=e&&("function"===typeof e[Symbol.asyncIterator]||"function"===typeof e[Symbol.iterator]||"function"===typeof e.next),ud=e=>null!=e&&"function"===typeof e.sink&&ld(e.source),hd=e=>t=>{const n=e.sink(t);if(null!=n.then){const t=Xh({objectMode:!0});n.then((()=>{t.end()}),(e=>{t.end(e)}));const r=async function*(){yield*e.source,t.end()};return ad(t,r())}return e.source};function dd(e,...t){if(ud(e)){const t=e;e=()=>t.source}else if(ld(e)){const t=e;e=()=>t}const n=[e,...t];if(n.length>1&&ud(n[n.length-1])&&(n[n.length-1]=n[n.length-1].sink),n.length>2)for(let r=1;r<n.length-1;r++)ud(n[r])&&(n[r]=hd(n[r]));return cd(...n)}new Bs(sd),new Bs(id);const fd="/record/";function pd(e){return Fn(e,"base32")}function gd(e){("string"===typeof e||e instanceof String)&&(e=An(e.toString()));const t=Fn(e,"base64url");return`${fd}${t}`}function yd(e){if(e.substring(0,fd.length)!==fd)throw new ao("topic received is not from a record","ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const t=e.substring(fd.length);return An(t,"base64url")}const md=x("datastore-pubsub:publisher");class wd extends Gh{constructor(e,t,n,r,s,i){if(super(),!r)throw new ao("missing validator","ERR_INVALID_PARAMETERS");if("function"!==typeof r)throw new ao("missing validate function","ERR_INVALID_PARAMETERS");if("function"!==typeof s)throw new ao("missing select function","ERR_INVALID_PARAMETERS");if(i&&"function"!==typeof i)throw new ao("invalid subscriptionKeyFn received","ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=n,this._validator=r,this._selector=s,this._handleSubscriptionKeyFn=i,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,t,n){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw md.error(e),new ao(e,"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){const e="received value is not a Uint8Array";throw md.error(e),new ao(e,"ERR_INVALID_VALUE_RECEIVED")}const r=gd(e);md(`publish value for topic ${r}`),await this._pubsub.publish(r,t)}async get(e,t){if(!(e instanceof Uint8Array)){const e="datastore key does not have a valid format";throw md.error(e),new ao(e,"ERR_INVALID_DATASTORE_KEY")}const n=gd(e),r=await this._pubsub.getTopics();if(r&&Array.isArray(r)&&r.indexOf(n)>-1)return this._getLocal(e,t);try{await this._pubsub.subscribe(n)}catch(rb){const t=`cannot subscribe topic ${n}`;throw md.error(t),new ao(t,"ERR_SUBSCRIBING_TOPIC")}return md(`subscribed values for key ${n}`),this._getLocal(e)}unsubscribe(e){const t=gd(e);return this._pubsub.unsubscribe(t)}async _getLocal(e,t){const n=new Bs("/"+pd(e),!1);let r;try{r=await this._datastore.get(n,t)}catch(rb){if("ERR_NOT_FOUND"!==rb.code){const e=`unexpected error getting the ipns record for ${n.toString()}`;throw md.error(e),new ao(e,"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const t=`local record requested was not found for ${n.toString()}`;throw md.error(t),new ao(t,"ERR_NOT_FOUND")}if(!(r instanceof Uint8Array)){const e="found record that we couldn't convert to a value";throw md.error(e),new ao(e,"ERR_INVALID_RECORD_RECEIVED")}return r}async _onMessage(e){const t=e.detail;if("signed"!==t.type)return void md.error("unsigned message received, this module can only work with signed messages");const{data:n,from:r,topic:s}=t;let i;try{i=yd(s)}catch(rb){return void md.error(rb)}if(md(`message received for topic ${s}`),this._peerId.equals(r))md("message discarded as it is from the same peer");else{if(this._handleSubscriptionKeyFn){let e;try{e=await this._handleSubscriptionKeyFn(i)}catch(rb){return void md.error("message discarded by the subscriptionKeyFn")}i=e}try{await this._storeIfSubscriptionIsBetter(i,n)}catch(rb){md.error(rb)}}}async _storeIfSubscriptionIsBetter(e,t,n){let r=!1;try{r=await this._isBetter(e,t)}catch(rb){if("ERR_NOT_VALID_RECORD"!==rb.code)throw rb}r&&await this._storeRecord(e,t,n)}async _validateRecord(e,t){return this._validator(e,t)}async _selectRecord(e,t){const n=await this._selector(e,t);return 0===n}async _isBetter(e,t){try{await this._validateRecord(e,t)}catch(rb){const t="record received through pubsub is not valid";throw md.error(t),new ao(t,"ERR_NOT_VALID_RECORD")}const n=new Bs(e);let r;try{r=await this._getLocal(n.uint8Array())}catch(rb){return!0}return!Pr(r,t)&&this._selectRecord(e,[r,t])}async _storeRecord(e,t,n){const r=new Bs("/"+pd(e),!1);await this._datastore.put(r,t,n),md(`record for ${gd(e)} was stored in the datastore`)}}const bd=x("ipfs:ipns:pubsub");class vd{constructor(e,t,n){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new wd(e,t,n,Lh,rd,this._handleSubscriptionKey)}async put(e,t,n){try{await this._pubsubDs.put(e,t,n)}catch(rb){throw bd.error(rb),rb}}async get(e,t){let n,r;try{n=await this._pubsubDs.get(e,t)}catch(i){r=i}const s=e.slice(0,gh);if(Fn(s)===ph){const t=R.base58btc.encode(e).substring(1),n=R.base58btc.encode(e.slice(gh)).substring(1);this._subscriptions[t]=n,bd(`subscribed to pubsub topic ${t}, id ${n}`)}if(r)throw r;return n}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=Fn(e,"base58btc"));const t=this._subscriptions[e];if(!t)throw B(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");try{const e=ch(_o(t));return e}catch(rb){throw bd.error(rb),rb}}getSubscriptions(){const e=Object.values(this._subscriptions).filter(Boolean);return e.map((e=>`${ph}${e}`))}async cancel(e){if("string"!==typeof e)throw B(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(ph)&&(e=e.substring(gh));const t=Object.keys(this._subscriptions).find((t=>this._subscriptions[t]===e));if(!t)return{canceled:!1};const n=An(t);return this._pubsubDs.unsubscribe(n),delete this._subscriptions[t],bd(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}}var _d;function Ed(e){const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),s=String(e.getUTCHours()).padStart(2,"0"),i=String(e.getUTCMinutes()).padStart(2,"0"),o=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),c=String(1e3*a*1e3).padStart(9,"0");return`${t}-${n}-${r}T${s}:${i}:${o}.${c}Z`}function Sd(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),s=parseInt(n[2],10)-1,i=parseInt(n[3],10),o=parseInt(n[4],10),a=parseInt(n[5],10),c=parseInt(n[6],10),l=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,s,i,o,a,c,l))}(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.key&&e.key.byteLength>0)&&(t.uint32(10),t.bytes(e.key)),(!0===n.writeDefaults||null!=e.value&&e.value.byteLength>0)&&(t.uint32(18),t.bytes(e.value)),!0!==n.writeDefaults&&""===e.timeReceived||(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(_d||(_d={}));class kd{constructor(e,t,n){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return _d.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:Ed(this.timeReceived)}}static deserialize(e){const t=_d.decode(e);return new kd(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=Sd(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");const n=new kd(e.key,e.value,t);return n}}const Id=x("ipfs:ipns:offline-datastore");class Ad{constructor(e){this._datastore=e,this.stores=[]}async put(e,t,n){if(!(e instanceof Uint8Array))throw B(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw B(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let r;try{r=this._routingKey(e)}catch(rb){throw Id.error(rb),B(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const s=new kd(e,t,new Date);await this._datastore.put(r,s.serialize(),n)}async get(e,t){if(!(e instanceof Uint8Array))throw B(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let n;try{n=this._routingKey(e)}catch(rb){throw Id.error(rb),B(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const r=await this._datastore.get(n,t);let s;try{s=kd.deserialize(r)}catch(rb){throw Id.error(rb),rb}return s.value}_routingKey(e){return new Bs("/dht/record/"+Fn(e,"base32"),!1)}}const Td=x("ipfs:ipns:dht-datastore");class Rd{constructor(e){this._dht=e}async put(e,t,n){try{await Hh(this._dht.put(e,t,n))}catch(rb){throw Td.error(rb),rb}}async get(e,t){for await(const n of this._dht.get(e,t))if("VALUE"===n.name)return n.value;throw Ko()}}function Cd({libp2p:e,repo:t,peerId:n,options:r}){const s=[];let i;if(nd(r,"EXPERIMENTAL.ipnsPubsub",!1)&&(i=new vd(e.pubsub,t.datastore,n),s.push(i)),!0!==nd(r,"offline",!1)&&["dht","dhtclient","dhtserver"].includes(nd(r,"config.Routing.Type","none"))&&s.push(new Rd(e.dht)),nd(r,"offline",!1)||0===s.length){const e=new Ad(t.datastore);s.push(e)}return new td(s)}const Pd=x("ipfs:components:ipns");class Nd{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){const e=this.online||this.offline;if(e)return e;throw new hn}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:n}){if(null!=this.offline)throw new fn;Pd("initializing IPNS keyspace (offline)");const r=new Ad(e.datastore),s=new zh(r,e.datastore,t,n,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:n,keychain:r}){if(null!=this.online)throw new fn;const s=Cd({libp2p:e,repo:t,peerId:n,options:this.options}),i=new zh(s,t.datastore,n,r,this.options);await i.republisher.start(),this.online=i}async stop(){const e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,n,r){return this.getIPNS().publish(e,t,n,r)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t,n){return this.getIPNS().initializeKeyspace(e,t,n)}}async function Od({ipns:e,repo:t,codecs:n},r,s){if(Ns(r))return e.resolve(r);const{cid:i,path:o}=Gs(r);await Hh(si(i,o||"",n,t,s))}const Dd=x("ipfs:name:publish");function Ld({ipns:e,repo:t,codecs:n,peerId:r,isOnline:s,keychain:i}){const o=async e=>{let t;if("self"===e&&null!=r.privateKey)t=await Vu(r.privateKey);else try{const n=await i.exportKey(e,"temp");t=await $u(n,"temp")}catch(rb){throw Dd.error(rb),B(rb,"ERR_CANNOT_GET_KEY")}return ko(t.public.bytes,t.bytes)};async function a(r,i={}){const a=!(!1===i.resolve),c=i.lifetime||"24h",l=i.key||"self";if(!s())throw B(new Error(Qs),"OFFLINE_ERROR");try{r=Zs(r)}catch(rb){throw Dd.error(rb),rb}let u=0;try{u=Ks(c)||0,u=parseFloat(u.toFixed(6))}catch(rb){throw Dd.error(rb),rb}const h=await Promise.all([o(l),a?Od({ipns:e,repo:t,codecs:n},r):Promise.resolve()]),d=An(r),f=await e.publish(h[0],d,u,i);return{name:f.name,value:Fn(f.value)}}return qs(a)}var xd=n(1050);const Bd=I.bind({ignoreUndefined:!0}),Md=x("ipfs:name:resolve"),Ud=(e,t)=>t.length>0?e+"/"+t.join("/"):e;function Fd({dns:e,ipns:t,isOnline:n,options:{offline:r}}){async function*s(s,i={}){if(i=Bd({nocache:!1,recursive:!0},i),r&&i&&i.nocache)throw B(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!n()&&!r)throw B(new Error(Qs),"OFFLINE_ERROR");let o=s.toString();o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[a,c,...l]=o.slice(1).split("/");try{if("1"===c.substring(0,1)){const e=_o(c),t=At.Jx(e.toBytes()),n=X.k0.createV1(114,t);c=n.toString(Ut)}else{const e=X.k0.parse(c);1===e.version&&(c=e.toString(Ut))}}catch(rb){if(xd(c))return void(yield Ud(await e(c,i),l));throw Md.error(rb),B(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}const u=await t.resolve(`/${a}/${c}`,i);yield Ud(u instanceof Uint8Array?Fn(u):u,l)}return qs(s)}function jd(e,t){if(!e||!t||!t.ipnsPubsub)throw B(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(e.routing instanceof vd)return e.routing;const n=(e.routing.stores||[]).find((e=>e instanceof vd));if(!n)throw B(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return n}function Vd({ipns:e,options:t}){const n=t.EXPERIMENTAL;async function r(t,r={}){const s=jd(e,n);return s.cancel(t,r)}return qs(r)}function zd({ipns:e,options:t}){const n=t.EXPERIMENTAL;async function r(t={}){try{return{enabled:Boolean(jd(e,n))}}catch(rb){return{enabled:!1}}}return qs(r)}function $d({ipns:e,options:t}){const n=t.EXPERIMENTAL;async function r(t={}){const r=jd(e,n);return r.getSubscriptions(t)}return qs(r)}class Kd{constructor({ipns:e,options:t}){this.cancel=Vd({ipns:e,options:t}),this.state=zd({ipns:e,options:t}),this.subs=$d({ipns:e,options:t})}}class Hd{constructor({dns:e,ipns:t,repo:n,codecs:r,peerId:s,isOnline:i,keychain:o,options:a}){this.publish=Ld({ipns:t,repo:n,codecs:r,peerId:s,isOnline:i,keychain:o}),this.resolve=Fd({dns:e,ipns:t,isOnline:i,options:a}),this.pubsub=new Kd({ipns:t,options:a})}}const qd=Ko().code,Wd={default:"<dst>",edges:"<src> -> <dst>"};function Gd({repo:e,codecs:t,resolve:n,preload:r}){async function*s(s,i={}){if(0===i.maxDepth)return;if(i.edges&&i.format&&i.format!==Wd.default)throw new Error("Cannot set edges to true and also specify format");if(i.format=i.edges?Wd.edges:i.format,"number"!==typeof i.maxDepth&&(i.maxDepth=i.recursive?1/0:1),i.timeout){const e=new Tn.TimeoutController(i.timeout),t=[e.signal];i.signal&&t.push(i.signal),i.signal=(0,js.anySignal)(t)}const o=Array.isArray(s)?s:[s],a=o.map((e=>Yd(r,e,i)));for(const r of a)try{yield*Qd(n,e,t,r,i)}catch(rb){yield{ref:"",err:rb.message}}}return s}function Yd(e,t,n){const{cid:r,path:s}=Gs(t);return!1!==n.preload&&e(r),`/ipfs/${r}${s||""}`}async function*Qd(e,t,n,r,s){const i=await e(r,s),{cid:o}=Gs(i),a=null!=s.maxDepth?s.maxDepth:1/0,c=s.unique||!1;for await(const l of Jd(t,n,o,a,c,s))l.parent&&(l.isDuplicate||(yield{ref:Xd(l.parent.cid,l.node.cid,l.node.name,s.format)}))}function Xd(e,t,n="",r=Wd.default){let s=r.replace(/<src>/g,e.toString());return s=s.replace(/<dst>/g,t.toString()),s=s.replace(/<linkname>/g,n),s}async function*Jd(e,t,n,r,s,i){const o=new Set;async function*a(n,c){const l=c+1;if(!(l>r))try{for await(const r of Zd(e,t,n.cid,i))yield{parent:n,node:r,isDuplicate:s&&o.has(r.cid.toString())},s&&o.add(r.cid.toString()),yield*a(r,l)}catch(rb){throw rb.code===qd&&(rb.message=`Could not find object with CID: ${n.cid}`),rb}}yield*a({cid:n},0)}async function*Zd(e,t,n,r){const s=await e.blocks.get(n,r),i=await t.getCodec(n.code),o=i.decode(s),a=n.code===Ae,c=[];for(const[l,u]of ef(o,c)){if(a){const e=l.match(/^Links\/(\d+)\/Hash$/);if(e){const t=Number(e[1]);if(t<o.Links.length){yield{name:o.Links[t].Name,cid:u};continue}}}yield{name:l,cid:u}}}const ef=function*(e,t){if(null!=e&&!(e instanceof Uint8Array)){for(const[n,r]of Object.entries(e)){const e=[...t,n];if(null!=r&&"object"===typeof r)if(Array.isArray(r))for(const[t,n]of r.entries()){const r=[...e,t],s=X.k0.asCID(n);s?yield[r.join("/"),s]:"object"===typeof n&&(yield*ef(n,r))}else{const t=X.k0.asCID(r);t?yield[e.join("/"),t]:yield*ef(r,e)}}return[]}};function tf({repo:e}){async function*t(t={}){for await(const n of e.blocks.queryKeys({},{signal:t.signal}))yield{ref:n.toString()}}return qs(t)}function nf({network:e}){async function t(t={}){const{bitswap:n}=await e.use(t),r=n.getWantlist();return Array.from(r).map((e=>e[1].cid))}return qs(t)}function rf({network:e}){async function t(t,n={}){const{bitswap:r}=await e.use(n),s=r.wantlistForPeer(t);return Array.from(s).map((e=>e[1].cid))}return qs(t)}function sf({network:e}){async function t(t,n={}){const{bitswap:r}=await e.use(n);return Array.isArray(t)||(t=[t]),r.unwant(t)}return qs(t)}function of({network:e}){async function t(t={}){const n=(await e.use(t)).bitswap,r=n.stat().snapshot;return{provideBufLen:parseInt(r.providesBufferLength.toString()),blocksReceived:BigInt(r.blocksReceived.toString()),wantlist:Array.from(n.getWantlist()).map((e=>e[1].cid)),peers:n.peers(),dupBlksReceived:BigInt(r.dupBlksReceived.toString()),dupDataReceived:BigInt(r.dupDataReceived.toString()),dataReceived:BigInt(r.dataReceived.toString()),blocksSent:BigInt(r.blocksSent.toString()),dataSent:BigInt(r.dataSent.toString())}}return qs(t)}class af{constructor({network:e}){this.wantlist=nf({network:e}),this.wantlistForPeer=rf({network:e}),this.unwant=sf({network:e}),this.stat=of({network:e})}}function cf(e){try{return fs.matches(e)}catch(rb){return!1}}function lf({repo:e}){async function t(t,n={}){if(!cf(t))throw new Error(`${t} is not a valid Multiaddr`);const r=await e.config.getAll(n),s=r.Bootstrap||[];return s.push(t.toString()),r.Bootstrap=Array.from(new Set(s)).sort(((e,t)=>e.localeCompare(t))),await e.config.replace(r),{Peers:[t]}}return qs(t)}function uf({repo:e}){async function t(t={}){const n=await e.config.getAll(t),r=n.Bootstrap||[];return n.Bootstrap=[],await e.config.replace(n),{Peers:r.map((e=>Hr(e)))}}return qs(t)}function hf({repo:e}){async function t(t={}){const n=await e.config.get("Bootstrap",t);return{Peers:(n||[]).map((e=>Hr(e)))}}return qs(t)}var df=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function ff({repo:e}){async function t(t={}){const n=await e.config.getAll(t);return n.Bootstrap=df().Bootstrap,await e.config.replace(n),{Peers:df().Bootstrap.map((e=>Hr(e)))}}return qs(t)}function pf({repo:e}){async function t(t,n={}){if(!cf(t))throw new Error(`${t} is not a valid Multiaddr`);const r=await e.config.getAll(n);return r.Bootstrap=(r.Bootstrap||[]).filter((e=>e.toString()!==t.toString())),await e.config.replace(r),{Peers:[t]}}return qs(t)}class gf{constructor({repo:e}){this.add=lf({repo:e}),this.list=hf({repo:e}),this.rm=pf({repo:e}),this.clear=uf({repo:e}),this.reset=ff({repo:e})}}function yf({preload:e,repo:t}){async function n(n,r={}){return!1!==r.preload&&e(n),t.blocks.get(n,r)}return qs(n)}function mf({codecs:e,hashers:t,repo:n,preload:r}){async function s(s,i={}){const o=i.pin?await n.gcLock.readLock():null;try{const a=null!=i.version?i.version:0,c=i.format||(0===a?"dag-pb":"raw"),l=await t.getHasher(i.mhtype||"sha2-256"),u=await l.digest(s),h=await e.getCodec(c),d=X.k0.create(a,h.code,u);return await n.blocks.put(d,s,{signal:i.signal}),!1!==i.preload&&r(d),!0===i.pin&&await n.pins.pinRecursively(d,{signal:i.signal}),d}finally{o&&o()}}return qs(s)}function wf(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}const bf=globalThis.CustomEvent??Event;async function*vf(e,t={}){let n=t.concurrency??1/0;n<1&&(n=1/0);const r=null!=t.ordered&&t.ordered,s=new EventTarget,i=[];let o,a=wf(),c=wf(),l=!1,u=!1;function h(){return r?i[0]?.done:Boolean(i.find((e=>e.done)))}function*d(){while(i.length>0&&i[0].done){const e=i[0];if(i.shift(),!e.ok)throw u=!0,a.resolve(),e.err;yield e.value,a.resolve()}}function*f(){while(h())for(let e=0;e<i.length;e++)if(i[e].done){const t=i[e];if(i.splice(e,1),e--,!t.ok)throw u=!0,a.resolve(),t.err;yield t.value,a.resolve()}}s.addEventListener("task-complete",(()=>{c.resolve()})),Promise.resolve().then((async()=>{try{for await(const t of e){if(i.length===n&&(a=wf(),await a.promise),u)break;const e={done:!1};i.push(e),t().then((t=>{e.done=!0,e.ok=!0,e.value=t,s.dispatchEvent(new bf("task-complete"))}),(t=>{e.done=!0,e.err=t,s.dispatchEvent(new bf("task-complete"))}))}l=!0,s.dispatchEvent(new bf("task-complete"))}catch(rb){o=rb,s.dispatchEvent(new bf("task-complete"))}}));while(1){if(h()||(c=wf(),await c.promise),null!=o)throw o;if(r?yield*d():yield*f(),l&&0===i.length)break}}async function*_f(e,t){for await(const n of e)yield t(n)}function Ef(e){return e instanceof Uint8Array?X.k0.decode(e):X.k0.parse(e.toString())}const Sf=8;function kf({repo:e}){async function*t(t,n={}){Array.isArray(t)||(t=[t]);const r=await e.gcLock.writeLock();try{yield*dd(t,(t=>_f(t,(t=>async()=>{t=Ef(t);const r={cid:t};try{const n=await e.blocks.has(t);if(!n)throw B(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await e.blocks.delete(t)}catch(rb){n.force||(rb.message=`cannot remove ${t}: ${rb.message}`,r.error=rb)}return r}))),(e=>vf(e,{concurrency:Sf})),(e=>qh(e,(()=>!n.quiet))))}finally{r()}}return qs(t)}function If({repo:e,preload:t}){async function n(n,r={}){n=Ef(n),!1!==r.preload&&t(n);const s=await e.blocks.get(n);return{cid:n,size:s.length}}return qs(n)}class Af{constructor({codecs:e,hashers:t,preload:n,repo:r}){this.get=yf({preload:n,repo:r}),this.put=mf({codecs:e,hashers:t,preload:n,repo:r}),this.rm=kf({repo:r}),this.stat=If({preload:n,repo:r})}}async function*Tf(e,t={}){const n=e.getReader();try{while(1){const e=await n.read();if(e.done)return;yield e.value}}finally{!0!==t.preventCancel&&await n.cancel(),n.releaseLock()}}function Rf(e){return"function"===typeof e.stream?Tf(e.stream()):Tf(new Response(e).body)}function Cf(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}}function Pf(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function Nf(e){return e.constructor&&("Blob"===e.constructor.name||"File"===e.constructor.name)&&"function"===typeof e.stream}function Of(e){return"object"===typeof e&&(e.path||e.content)}const Df=e=>e&&"function"===typeof e.getReader;async function*Lf(e){yield e}async function xf(e){if(Pf(e))return Lf(Bf(e));if("string"===typeof e||e instanceof String)return Lf(Bf(e.toString()));if(Nf(e))return Rf(e);if(Df(e)&&(e=Tf(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=Cf(e),{value:n,done:r}=await t.peek();if(r)return Lf(new Uint8Array(0));if(t.push(n),Number.isInteger(n))return Lf(Uint8Array.from(await $h(t)));if(Pf(n)||"string"===typeof n||n instanceof String)return _f(t,Bf)}throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function Bf(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):An(e.toString())}async function*Mf(e,t){if(null===e||void 0===e)throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if("string"===typeof e||e instanceof String)yield Uf(e.toString(),t);else if(Pf(e)||Nf(e))yield Uf(e,t);else{if(Df(e)&&(e=Tf(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const n=Cf(e),{value:r,done:s}=await n.peek();if(s)return void(yield{content:[]});if(n.push(r),Number.isInteger(r)||Pf(r)||"string"===typeof r||r instanceof String)return void(yield Uf(n,t));throw B(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!Of(e))throw B(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield Uf(e,t)}}async function Uf(e,t){const{path:n,mode:r,mtime:s,content:i}=e,o={path:n||"",mode:G(r),mtime:Y(s)};return i?o.content=await t(i):n||(o.content=await t(e)),o}function Ff(e){return Mf(e,xf)}function jf({addAll:e}){async function t(t,n={}){const r=await To(e(Ff(t),n));if(null==r)throw Error("Failed to add a file, if you see this please report a bug");return r}return t}async function*Vf(e,t=1){let n=[];t<1&&(t=1);for await(const r of e){n.push(r);while(n.length>=t)yield n.slice(0,t),n=n.slice(t)}while(n.length>0)yield n.slice(0,t),n=n.slice(t)}async function*zf(e,t=1){for await(const n of Vf(e,t)){const e=n.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const n=await e[t];if(!n.ok)throw n.err;yield n.value}}}var $f=n(716);function Kf(e){const t=new Array(4);for(let n=0;n<4;n++)t[n]=255&e,e>>=8;return new Uint8Array(t)}(0,qt.D)({name:"murmur3-32",code:35,encode:e=>Kf($f.x86.hash32(e))});const Hf=(0,qt.D)({name:"murmur3-128",code:34,encode:e=>Pe.aI.fromHex($f.x64.hash128(e))});(0,qt.D)({name:"murmur3-x64-64",code:34,encode:e=>Pe.aI.fromHex($f.x64.hash128(e)).subarray(0,8)});async function qf(e){return(await Hf.encode(e)).slice(0,8).reverse()}const Wf={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:Gt,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:qf,hamtHashCode:34,hamtBucketBits:8};var Gf=(e={})=>{const t=I.bind({ignoreUndefined:!0});return t(Wf,e)};const Yf=async(e,t,n)=>{n.codec||(n.codec=s),n.hasher||(n.hasher=Gt),void 0===n.cidVersion&&(n.cidVersion=1),n.codec===s&&n.hasher!==Gt&&(n.cidVersion=1);const r=await n.hasher.digest(e),i=X.k0.create(n.cidVersion,n.codec.code,r);return n.onlyHash||await t.put(i,e,{signal:n.signal}),i};var Qf=Yf;const Xf=async(e,t,n)=>{const r=new Q({type:"directory",mtime:e.mtime,mode:e.mode}),s=Te(_e({Data:r.marshal()})),i=await Qf(s,t,n),o=e.path;return{cid:i,path:o,unixfs:r,size:s.length}};var Jf=Xf;async function Zf(e,t){return t(await $h(e))}var ep=Zf;function tp(e,t,n){return np(e,t,n)}async function np(e,t,n){const r=[];for await(const s of Vf(e,n.maxChildrenPerNode))r.push(await t(s));return r.length>1?np(r,t,n):r[0]}var rp=tp;async function sp(e,t,n){const r=new ap(n.layerRepeat);let s=0,i=1,o=r;for await(const a of Vf(e,n.maxChildrenPerNode))o.isFull()&&(o!==r&&r.addChild(await o.reduce(t)),s&&s%n.layerRepeat===0&&i++,o=new op(i,n.layerRepeat,s),s++),o.append(a);return o&&o!==r&&r.addChild(await o.reduce(t)),r.reduce(t)}var ip=sp;class op{constructor(e,t,n=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=n,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;const e=this._findParent(this.node,this.currentDepth);return!e||(this._addNextNodeToParent(e),!1)}_addNextNodeToParent(e){this.parent=e;const t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let n=[];return e.children.length&&(n=await Promise.all(e.children.filter((e=>e.data)).map((e=>this._reduce(e,t))))),t((e.data||[]).concat(n))}_findParent(e,t){const n=e.parent;if(n&&0!==n.depth)return n.children.length!==n.maxChildren&&n.maxChildren?n:this._findParent(n,t)}}class ap extends op{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}async function*cp(e,t,n){for await(let r of e.content)yield async()=>{let i;n.progress(r.length,e.path);const o={codec:s,cidVersion:n.cidVersion,hasher:n.hasher,onlyHash:n.onlyHash};return n.rawLeaves?(o.codec=y,o.cidVersion=1):(i=new Q({type:n.leafType,data:r}),r=Te({Data:i.marshal(),Links:[]})),{cid:await Qf(r,t,o),unixfs:i,size:r.length}}}var lp=cp;const up={flat:ep,balanced:rp,trickle:ip};async function*hp(e,t,n){let r,s,i=-1;s="function"===typeof n.bufferImporter?n.bufferImporter:lp;for await(const o of zf(s(e,t,n),n.blockWriteConcurrency))i++,0!==i?(1===i&&r&&(yield r,r=null),yield o):r=o;r&&(r.single=!0,yield r)}const dp=(e,t,n)=>{async function r(r){if(1===r.length&&r[0].single&&n.reduceSingleLeafToSelf){const i=r[0];if(void 0!==e.mtime||void 0!==e.mode){let r=await t.get(i.cid);i.unixfs=new Q({type:"file",mtime:e.mtime,mode:e.mode,data:r}),r=Te(_e({Data:i.unixfs.marshal()})),i.cid=await Qf(r,t,{...n,codec:s,hasher:n.hasher,cidVersion:n.cidVersion}),i.size=r.length}return{cid:i.cid,path:e.path,unixfs:i.unixfs,size:i.size}}const i=new Q({type:"file",mtime:e.mtime,mode:e.mode}),o=r.filter((e=>!(e.cid.code!==Xt||!e.size)||(!(!e.unixfs||e.unixfs.data||!e.unixfs.fileSize())||Boolean(e.unixfs&&e.unixfs.data&&e.unixfs.data.length)))).map((e=>e.cid.code===Xt?(i.addBlockSize(e.size),{Name:"",Tsize:e.size,Hash:e.cid}):(e.unixfs&&e.unixfs.data?i.addBlockSize(e.unixfs.data.length):i.addBlockSize(e.unixfs&&e.unixfs.fileSize()||0),{Name:"",Tsize:e.size,Hash:e.cid}))),a={Data:i.marshal(),Links:o},c=Te(_e(a)),l=await Qf(c,t,n);return{cid:l,path:e.path,unixfs:i,size:c.length+a.Links.reduce(((e,t)=>e+t.Tsize),0)}}return r};function fp(e,t,n){const r=up[n.strategy];if(!r)throw B(new Error(`Unknown importer build strategy name: ${n.strategy}`),"ERR_BAD_STRATEGY");return r(hp(e,t,n),dp(e,t,n),n)}var pp=fp;const gp=Symbol.for("@achingbrain/uint8arraylist");function yp(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let n=0;for(const r of e){const e=n+r.byteLength;if(t<e)return{buf:r,index:t-n};n=e}throw new RangeError("index is out of bounds")}function mp(e){return Boolean(e?.[gp])}class wp{constructor(...e){Object.defineProperty(this,gp,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let t=0;for(const n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else{if(!mp(n))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.push(...n.bufs)}this.length+=t}prepend(...e){this.prependAll(e)}prependAll(e){let t=0;for(const n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else{if(!mp(n))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.unshift(...n.bufs)}this.length+=t}get(e){const t=yp(this.bufs,e);return t.buf[t.index]}set(e,t){const n=yp(this.bufs,e);n.buf[n.index]=t}write(e,t=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else{if(!mp(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let n=0;n<e.length;n++)this.set(t+n,e.get(n))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);while(this.bufs.length>0){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:n,length:r}=this._subList(e,t);return Xn(n,r)}subarray(e,t){const{bufs:n,length:r}=this._subList(e,t);return 1===n.length?n[0]:Xn(n,r)}sublist(e,t){const{bufs:n,length:r}=this._subList(e,t),s=new wp;return s.length=r,s.bufs=n,s}_subList(e,t){if(e=e??0,t=t??this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:[...this.bufs],length:this.length};const n=[];let r=0;for(let s=0;s<this.bufs.length;s++){const i=this.bufs[s],o=r,a=o+i.byteLength;if(r=a,e>=a)continue;const c=e>=o&&e<a,l=t>o&&t<=a;if(c&&l){if(e===o&&t===a){n.push(i);break}const r=e-o;n.push(i.subarray(r,r+(t-e)));break}if(c){if(0===e){n.push(i);continue}n.push(i.subarray(e-o))}else{if(l){if(t===a){n.push(i);break}n.push(i.subarray(0,t-o));break}n.push(i)}}return{bufs:n,length:t-e}}indexOf(e,t=0){if(!mp(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const n=e instanceof Uint8Array?e:e.subarray();if(t=Number(t??0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const r=n.byteLength;if(0===r)throw new TypeError("search must be at least 1 byte long");const s=256,i=new Int32Array(s);for(let u=0;u<s;u++)i[u]=-1;for(let u=0;u<r;u++)i[n[u]]=u;const o=i,a=this.byteLength-n.byteLength,c=n.byteLength-1;let l;for(let u=t;u<=a;u+=l){l=0;for(let e=c;e>=0;e--){const t=this.get(u+e);if(n[e]!==t){l=Math.max(1,e-o[t]);break}}if(0===l)return u}return-1}getInt8(e){const t=this.subarray(e,e+1),n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.getInt8(0)}setInt8(e,t){const n=vn(1),r=new DataView(n.buffer,n.byteOffset,n.byteLength);r.setInt8(0,t),this.write(n,e)}getInt16(e,t){const n=this.subarray(e,e+2),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getInt16(0,t)}setInt16(e,t,n){const r=bn(2),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setInt16(0,t,n),this.write(r,e)}getInt32(e,t){const n=this.subarray(e,e+4),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getInt32(0,t)}setInt32(e,t,n){const r=bn(4),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setInt32(0,t,n),this.write(r,e)}getBigInt64(e,t){const n=this.subarray(e,e+8),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getBigInt64(0,t)}setBigInt64(e,t,n){const r=bn(8),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setBigInt64(0,t,n),this.write(r,e)}getUint8(e){const t=this.subarray(e,e+1),n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.getUint8(0)}setUint8(e,t){const n=vn(1),r=new DataView(n.buffer,n.byteOffset,n.byteLength);r.setUint8(0,t),this.write(n,e)}getUint16(e,t){const n=this.subarray(e,e+2),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getUint16(0,t)}setUint16(e,t,n){const r=bn(2),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setUint16(0,t,n),this.write(r,e)}getUint32(e,t){const n=this.subarray(e,e+4),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getUint32(0,t)}setUint32(e,t,n){const r=bn(4),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setUint32(0,t,n),this.write(r,e)}getBigUint64(e,t){const n=this.subarray(e,e+8),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getBigUint64(0,t)}setBigUint64(e,t,n){const r=bn(8),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setBigUint64(0,t,n),this.write(r,e)}getFloat32(e,t){const n=this.subarray(e,e+4),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat32(0,t)}setFloat32(e,t,n){const r=bn(4),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setFloat32(0,t,n),this.write(r,e)}getFloat64(e,t){const n=this.subarray(e,e+8),r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.getFloat64(0,t)}setFloat64(e,t,n){const r=bn(8),s=new DataView(r.buffer,r.byteOffset,r.byteLength);s.setFloat64(0,t,n),this.write(r,e)}equals(e){if(null==e)return!1;if(!(e instanceof wp))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!Pr(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const n=new wp;return n.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),n.length=t,n}}var bp=n(7393);async function*vp(e,t){let n,r,s;if(t.minChunkSize&&t.maxChunkSize&&t.avgChunkSize)s=t.avgChunkSize,n=t.minChunkSize,r=t.maxChunkSize;else{if(!t.avgChunkSize)throw B(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");s=t.avgChunkSize,n=s/3,r=s+s/2}if(n<16)throw B(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");r<n&&(r=n),s<n&&(s=n);const i=Math.floor(Math.log2(s));for await(const o of Ep(e,{min:n,max:r,bits:i,window:t.window,polynomial:t.polynomial}))yield o}var _p=vp;async function*Ep(e,t){const n=await(0,bp.create)(t.bits,t.min,t.max,t.window),r=new wp;for await(const s of e){r.append(s);const e=n.fingerprint(s);for(let t=0;t<e.length;t++){const n=e[t],s=r.slice(0,n);r.consume(n),yield s}}r.length&&(yield r.subarray(0))}async function*Sp(e,t){let n=new wp,r=0,s=!1;const i=t.maxChunkSize;for await(const o of e){n.append(o),r+=o.length;while(r>=i)if(yield n.slice(0,i),s=!0,i===n.length)n=new wp,r=0;else{const e=new wp;e.append(n.sublist(i)),n=e,r-=i}}s&&!r||(yield n.subarray(0,r))}var kp=Sp;async function*Ip(e){for await(const t of e){if(void 0===t.length)throw B(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if("string"===typeof t||t instanceof String)yield An(t.toString());else if(Array.isArray(t))yield Uint8Array.from(t);else{if(!(t instanceof Uint8Array))throw B(new Error("Content was invalid"),"ERR_INVALID_CONTENT");yield t}}}var Ap=Ip;function Tp(e){return Symbol.iterator in e}function Rp(e){return Symbol.asyncIterator in e}function Cp(e){try{if(e instanceof Uint8Array)return async function*(){yield e}();if(Tp(e))return async function*(){yield*e}();if(Rp(e))return e}catch{throw B(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw B(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*Pp(e,t,n){for await(const r of e)if(r.path&&("./"===r.path.substring(0,2)&&(n.wrapWithDirectory=!0),r.path=r.path.split("/").filter((e=>e&&"."!==e)).join("/")),r.content){let e,s;e="function"===typeof n.chunker?n.chunker:"rabin"===n.chunker?_p:kp,s="function"===typeof n.chunkValidator?n.chunkValidator:Ap;const i={path:r.path,mtime:r.mtime,mode:r.mode,content:e(s(Cp(r.content),n),n)};yield()=>pp(i,t,n)}else{if(!r.path)throw new Error("Import candidate must have content or path or both");{const e={path:r.path,mtime:r.mtime,mode:r.mode};yield()=>Jf(e,t,n)}}}var Np=Pp;class Op{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}}var Dp=Op;class Lp extends Dp{constructor(e,t){super(e,t),this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){const e=Object.keys(this._children);for(let t=0;t<e.length;t++){const n=e[t];yield{key:n,child:this._children[n]}}}async*flush(e){const t=Object.keys(this._children),n=[];for(let c=0;c<t.length;c++){let r=this._children[t[c]];if(r instanceof Dp)for await(const t of r.flush(e))r=t,yield r;null!=r.size&&r.cid&&n.push({Name:t[c],Tsize:r.size,Hash:r.cid})}const r=new Q({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:r.marshal(),Links:n},i=Te(_e(s)),o=await Qf(i,e,this.options),a=i.length+s.Links.reduce(((e,t)=>e+(null==t.Tsize?0:t.Tsize)),0);this.cid=o,this.size=a,yield{cid:o,unixfs:r,path:this.path,size:a}}}var xp=Lp,Bp=n(1946);class Mp{constructor(e,t,n=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=n,this._children=new Bp,this.key=null}async put(e,t){const n=await this._findNewBucketAndPos(e);await n.bucket._putAt(n,e,t)}async get(e){const t=await this._findChild(e);if(null!=t)return t.value}async del(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);null!=n&&n.key===e&&t.bucket._delAt(t.pos)}leafCount(){const e=this._children.compactArray();return e.reduce(((e,t)=>t instanceof Mp?e+t.leafCount():e+1),0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const e=this._children.compactArray();for(const t of e)t instanceof Mp?yield*t.eachLeafSeries():yield t}serialize(e,t){const n=[];return t(this._children.reduce(((n,r,s)=>(null!=r&&(r instanceof Mp?n.push(r.serialize(e,t)):n.push(e(r,s))),n)),n))}async asyncTransform(e,t){return await Vp(this,e,t)}toJSON(){return this.serialize(Fp,jp)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){const t=await this._findPlace(e),n=t.bucket._at(t.pos);if(!(n instanceof Mp))return null!=n&&n.key===e?n:void 0}async _findPlace(e){const t=this._options.hash("string"===typeof e?An(e):e),n=await t.take(this._options.bits),r=this._children.get(n);return r instanceof Mp?await r._findPlace(t):{bucket:this,pos:n,hash:t,existingChild:r}}async _findNewBucketAndPos(e){const t=await this._findPlace(e);if(null!=t.existingChild&&t.existingChild.key!==e){const e=new Mp(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,e);const n=await e._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),await e._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,n){this._putObjectAt(e.pos,{key:t,value:n,hash:e.hash})}_putObjectAt(e,t){null==this._children.get(e)&&this._popCount++,this._children.set(e,t)}_delAt(e){if(-1===e)throw new Error("Invalid position");null!=this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(null!=this._parent&&this._popCount<=1)if(1===this._popCount){const e=this._children.find(Up);if(null!=e&&!(e instanceof Mp)){const t=e.hash;t.untake(this._options.bits);const n={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(n,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}}function Up(e){return Boolean(e)}function Fp(e,t){return e.key}function jp(e){return e}async function Vp(e,t,n){const r=[];for(const s of e._children.compactArray())if(s instanceof Mp)await Vp(s,t,n);else{const n=await t(s);r.push({bitField:e._children.bitField(),children:n})}return await n(r)}const zp=[255,254,252,248,240,224,192,128],$p=[1,3,7,15,31,63,127,255];class Kp{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+8*this._currentBytePos}totalBits(){return 8*this._value.length}take(e){let t=e,n=0;while(t>0&&this._haveBits()){const e=this._value[this._currentBytePos],r=this._currentBitPos+1,s=Math.min(r,t),i=Hp(e,r-s,s);n=(n<<s)+i,t-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){this._currentBitPos+=e;while(this._currentBitPos>7)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function Hp(e,t,n){const r=qp(t,n);return(e&r)>>>t}function qp(e,t){return zp[e]&$p[Math.min(t+e-1,7)]}function Wp(e){function t(t){return t instanceof Gp?t:new Gp(t,e)}return t}class Gp{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;while(this._availableBits<t)await this._produceMoreBits();let n=0;while(t>0){const e=this._buffers[this._currentBufferIndex],r=Math.min(e.availableBits(),t),s=e.take(r);n=(n<<r)+s,t-=r,this._availableBits-=r,0===e.availableBits()&&this._currentBufferIndex++}return n}untake(e){let t=e;while(t>0){const e=this._buffers[this._currentBufferIndex],n=Math.min(e.totalBits()-e.availableBits(),t);e.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&e.totalBits()===e.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const e=this._depth>0?Xn([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),n=new Kp(t);this._buffers.push(n),this._availableBits+=n.availableBits()}}function Yp(e){if(null==e||null==e.hashFn)throw new Error("please define an options.hashFn");const t={bits:e.bits??8,hash:Wp(e.hashFn)};return new Mp(t)}class Qp extends Dp{constructor(e,t){super(e,t),this._bucket=Yp({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(const t of Jp(this._bucket,e,this,this.options))yield{...t,path:this.path}}}var Xp=Qp;async function*Jp(e,t,n,r){const s=e._children,i=[];let o=0;for(let f=0;f<s.length;f++){const e=s.get(f);if(!e)continue;const n=f.toString(16).toUpperCase().padStart(2,"0");if(e instanceof Mp){let s;for await(const n of await Jp(e,t,null,r))s=n;if(!s)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:n,Tsize:s.size,Hash:s.cid}),o+=s.size}else if("function"===typeof e.value.flush){const r=e.value;let s;for await(const e of r.flush(t))s=e,yield s;const a=n+e.key;i.push({Name:a,Tsize:s.size,Hash:s.cid}),o+=s.size}else{const t=e.value;if(!t.cid)continue;const r=n+e.key,s=t.size;i.push({Name:r,Tsize:s,Hash:t.cid}),o+=s}}const a=Uint8Array.from(s.bitField().reverse()),c=new Q({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:r.hamtHashCode,mtime:n&&n.mtime,mode:n&&n.mode}),l={Data:c.marshal(),Links:i},u=Te(_e(l)),h=await Qf(u,t,r),d=u.length+o;yield{cid:h,unixfs:c,size:d}}async function Zp(e,t,n,r){let s=t;t instanceof xp&&t.directChildrenCount()>=n&&(s=await eg(t,r));const i=s.parent;if(i){if(s!==t){if(e&&(e.parent=s),!s.parentKey)throw new Error("No parent key found");await i.put(s.parentKey,s)}return Zp(s,i,n,r)}return s}async function eg(e,t){const n=new Xp({root:e.root,dir:!0,parent:e.parent,parentKey:e.parentKey,path:e.path,dirty:e.dirty,flat:!1,mtime:e.mtime,mode:e.mode},t);for await(const{key:r,child:s}of e.eachChildSeries())await n.put(r,s);return n}var tg=Zp;const ng=(e="")=>(e.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean);var rg=ng;async function sg(e,t,n){const r=rg(e.path||""),s=r.length-1;let i=t,o="";for(let a=0;a<r.length;a++){const c=r[a];o+=`${o?"/":""}${c}`;const l=a===s;if(i.dirty=!0,i.cid=void 0,i.size=void 0,l)await i.put(c,e),t=await tg(null,i,n.shardSplitThreshold,n);else{let e=await i.get(c);e&&e instanceof Dp||(e=new xp({root:!1,dir:!0,parent:i,parentKey:c,path:o,dirty:!0,flat:!0,mtime:e&&e.unixfs&&e.unixfs.mtime,mode:e&&e.unixfs&&e.unixfs.mode},n)),await i.put(c,e),i=e}}return t}async function*ig(e,t){e instanceof Dp?yield*e.flush(t):e&&e.unixfs&&e.unixfs.isDirectory()&&(yield e)}async function*og(e,t,n){let r=new xp({root:!0,dir:!0,path:"",dirty:!0,flat:!0},n);for await(const s of e)s&&(r=await sg(s,r,n),s.unixfs&&s.unixfs.isDirectory()||(yield s));if(n.wrapWithDirectory)yield*ig(r,t);else for await(const s of r.eachChildSeries())s&&(yield*ig(s.child,t))}var ag=og;async function*cg(e,t,n={}){const r=Gf(n);let s,i,o;s="function"===typeof n.dagBuilder?n.dagBuilder:Np,i="function"===typeof n.treeBuilder?n.treeBuilder:ag,o=Symbol.asyncIterator in e||Symbol.iterator in e?e:[e];for await(const a of i(zf(s(o,t,r),r.fileImportConcurrency),t,r))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}async function*lg(e,t){if("string"===typeof e||e instanceof String||Pf(e)||Nf(e)||e._readableState)throw B(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Df(e)&&(e=Tf(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const n=Cf(e),{value:r,done:s}=await n.peek();if(s)return void(yield*[]);if(n.push(r),Number.isInteger(r))throw B(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(r._readableState)return void(yield*_f(n,(e=>ug({content:e},t))));if(Pf(r))return void(yield ug({content:n},t));if(Of(r)||r[Symbol.iterator]||r[Symbol.asyncIterator]||Df(r)||Nf(r))return void(yield*_f(n,(e=>ug(e,t))))}if(Of(e))throw B(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw B(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function ug(e,t){const{path:n,mode:r,mtime:s,content:i}=e,o={path:n||"",mode:G(r),mtime:Y(s)};return i?o.content=await t(i):n||(o.content=await t(e)),o}function hg(e){return lg(e,xf)}const dg=e=>{if(e){if(e.startsWith("size-")){const t=e.split("-")[1],n=parseInt(t);if(isNaN(n))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:n}}if(e.startsWith("rabin"))return{chunker:"rabin",...fg(e)};throw new Error(`Unrecognized chunker option: ${e}`)}return{chunker:"fixed"}},fg=e=>{const t={},n=e.split("-");switch(n.length){case 1:t.avgChunkSize=262144;break;case 2:t.avgChunkSize=pg(n[1],"avg");break;case 4:t.minChunkSize=pg(n[1],"min"),t.avgChunkSize=pg(n[2],"avg"),t.maxChunkSize=pg(n[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return t},pg=(e,t)=>{const n=parseInt(e);if(isNaN(n))throw new Error(`Chunker parameter ${t} must be an integer`);return n},gg=I.bind({ignoreUndefined:!0});function yg({repo:e,preload:t,hashers:n,options:r}){const s=r&&r.sharding;async function*i(r,i={}){const o=gg({shardSplitThreshold:s?1e3:1/0,strategy:"balanced"},i,{...dg(i.chunker)});o.hashAlg&&"sha2-256"!==o.hashAlg&&1!==o.cidVersion&&(o.cidVersion=1),o.trickle&&(o.strategy="trickle"),"trickle"===o.strategy&&(o.leafType="raw",o.reduceSingleLeafToSelf=!1),o.cidVersion>0&&void 0===o.rawLeaves&&(o.rawLeaves=!0),void 0!==o.hashAlg&&void 0===o.rawLeaves&&(o.rawLeaves=!0),delete o.trickle;const a={};if(o.progress){const e=o.progress;o.progress=(t,n)=>{a[n]||(a[n]=0),a[n]+=t,e(a[n],n)}}let c;null!=o.hashAlg&&(c=await n.getHasher(o.hashAlg));const l=dd(hg(r),(t=>cg(t,e.blocks,{...o,hasher:c,pin:!1})),mg(o),wg(t,o),bg(e,o)),u=await e.gcLock.readLock();try{for await(const e of l){const t=e.path??e.cid.toString();delete a[t],yield{...e,path:t}}}finally{u()}}return qs(i)}function mg(e){async function*t(t){for await(const n of t){let t=n.cid;1===e.cidVersion&&(t=t.toV1());let r=n.path?n.path:t.toString();e.wrapWithDirectory&&!n.path&&(r=""),yield{path:r,cid:t,size:n.size,mode:n.unixfs&&n.unixfs.mode,mtime:n.unixfs&&n.unixfs.mtime}}}return t}function wg(e,t){async function*n(n){for await(const r of n){const n=!r.path||t.wrapWithDirectory?""===r.path:!r.path.includes("/"),s=n&&!t.onlyHash&&!1!==t.preload;s&&e(r.cid),yield r}}return n}function bg(e,t){async function*n(n){for await(const r of n){const n=!(r.path&&r.path.includes("/")),s=(null==t.pin||t.pin)&&n&&!t.onlyHash;s&&await e.pins.pinRecursively(r.cid),yield r}}return n}const vg=async function(e){return(await Hf.encode(e)).slice(0,8).reverse()},_g=(e,t,n)=>Promise.all(e.map((e=>{if(null==e.Name)throw new Error("Unexpected Link without a Name");if(2===e.Name.length){const r=parseInt(e.Name,16);return t._putObjectAt(r,new Mp({hash:n._options.hash,bits:n._options.bits},t,r))}return n.put(e.Name.substring(2),!0)}))),Eg=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),Sg=e=>{let t=e.bucket;const n=[];while(t._parent)n.push(t),t=t._parent;return n.push(t),n.reverse()},kg=async(e,t,n,r,s)=>{if(!r){const e=Yp({hashFn:vg});r={rootBucket:e,hamtDepth:1,lastBucket:e}}await _g(e.Links,r.lastBucket,r.rootBucket);const i=await r.rootBucket._findNewBucketAndPos(t);let o=Eg(i.pos);const a=Sg(i);a.length>r.hamtDepth&&(r.lastBucket=a[r.hamtDepth],o=Eg(r.lastBucket._posAtParent));const c=e.Links.find((e=>{if(null==e.Name)return!1;const n=e.Name.substring(0,2),r=e.Name.substring(2);return n===o&&(!r||r===t)}));if(!c)return null;if(null!=c.Name&&c.Name.substring(2)===t)return c.Hash;r.hamtDepth++;const l=await n.get(c.Hash,s);return e=Re(l),kg(e,t,n,r,s)};var Ig=kg;function Ag(e,t,n,r){const s=e.length,i=t+s;return n>=i||r<t?new Uint8Array(0):(r>=t&&r<i&&(e=e.subarray(0,r-t)),n>=t&&n<i&&(e=e.subarray(n-t)),e)}var Tg=Ag;const Rg=(e,t,n)=>{if(t||(t=0),t<0)throw B(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(t>e)throw B(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(n||0===n||(n=e-t),n<0)throw B(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return t+n>e&&(n=e-t),{offset:t,length:n}};var Cg=Rg;async function Pg(e,t,n,r,s,i,o,a){if(t instanceof Uint8Array)return void n.push(Tg(t,r,s,i));if(null==t.Data)throw B(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let c;try{c=Q.unmarshal(t.Data)}catch(rb){throw B(rb,"ERR_NOT_UNIXFS")}if(null!=c.data){const e=c.data,t=Tg(e,r,s,i);n.push(t),r+=t.byteLength}const l=[];for(let u=0;u<t.Links.length;u++){const e=t.Links[u],n=r,o=n+c.blockSizes[u];if((s>=n&&s<o||i>=n&&i<=o||s<n&&i>o)&&l.push({link:e,blockStart:r}),r=o,r>i)break}await dd(l,(t=>_f(t,(t=>async()=>{const n=await e.get(t.link.Hash,{signal:a.signal});return{...t,block:n}}))),(e=>vf(e,{ordered:!0})),(async t=>{for await(const{link:r,block:c,blockStart:l}of t){let t;switch(r.Hash.code){case Ae:t=Re(c);break;case Xt:t=c;break;default:return void n.end(B(new Error(`Unsupported codec: ${r.Hash.code}`),"ERR_NOT_UNIXFS"))}o.add((async()=>{await Pg(e,t,n,l,s,i,o,a)}))}}))}const Ng=(e,t,n,r,s,i,o)=>{async function*a(e={}){const r=n.fileSize();if(void 0===r)throw new Error("File was a directory");const{offset:s,length:i}=Cg(r,e.offset,e.length);if(0===i)return;const a=new Yi({concurrency:1}),c=Xh();a.add((async()=>{await Pg(o,t,c,0,s,s+i,a,e)})),a.on("error",(e=>{c.end(e)}));let l=0;for await(const t of c)null!=t&&(l+=t.byteLength,l===i&&c.end(),yield t)}return a};var Og=Ng;const Dg=(e,t,n,r,s,i,o)=>{async function*a(e={}){const n=e.offset||0,a=e.length||t.Links.length,c=t.Links.slice(n,a);for(const t of c){const n=await s(t.Hash,t.Name||"",`${r}/${t.Name||""}`,[],i+1,o,e);n.entry&&(yield n.entry)}}return a};var Lg=Dg;const xg=(e,t,n,r,s,i,o)=>{function a(e={}){return Bg(t,r,s,i,o,e)}return a};async function*Bg(e,t,n,r,s,i){const o=e.Links;for(const a of o){const o=null!=a.Name?a.Name.substring(2):null;if(o){const e=await n(a.Hash,o,`${t}/${o}`,[],r+1,s,i);yield e.entry}else{const o=await s.get(a.Hash);e=Re(o);for await(const a of Bg(e,t,n,r,s,i))yield a}}}var Mg=xg;const Ug=(e,t)=>{const n=e.Links.find((e=>e.Name===t));return n&&n.Hash},Fg={raw:Og,file:Og,directory:Lg,"hamt-sharded-directory":Mg,metadata:(e,t,n,r,s,i,o)=>()=>[],symlink:(e,t,n,r,s,i,o)=>()=>[]},jg=async(e,t,n,r,s,i,o,a)=>{const c=await o.get(e,a),l=Re(c);let u,h;if(t||(t=e.toString()),null==l.Data)throw B(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{u=Q.unmarshal(l.Data)}catch(rb){throw B(rb,"ERR_NOT_UNIXFS")}if(n||(n=t),r.length){let e;if(e=u&&"hamt-sharded-directory"===u.type?await Ig(l,r[0],o):Ug(l,r[0]),!e)throw B(new Error("file does not exist"),"ERR_NOT_FOUND");const t=r.shift(),s=`${n}/${t}`;h={cid:e,toResolve:r,name:t||"",path:s}}return{entry:{type:u.isDirectory()?"directory":"file",name:t,path:n,cid:e,content:Fg[u.type](e,l,u,n,s,i,o),unixfs:u,depth:i,node:l,size:u.fileSize()},next:h}};var Vg=jg;const zg=e=>{async function*t(t={}){const{offset:n,length:r}=Cg(e.length,t.offset,t.length);yield Tg(e,0,n,n+r)}return t},$g=async(e,t,n,r,s,i,o,a)=>{if(r.length)throw B(new Error(`No link named ${n} found in raw node ${e}`),"ERR_NOT_FOUND");const c=await o.get(e,a);return{entry:{type:"raw",name:t,path:n,cid:e,content:zg(c),depth:i,size:c.length,node:c}}};var Kg=$g;const Hg=async(e,t,n,r,s,i,o,a)=>{const c=await o.get(e),l=Ce.decode(c);let u=l,h=n;while(r.length){const s=r[0];if(!(s in u))throw B(new Error(`No property named ${s} found in cbor node ${e}`),"ERR_NO_PROP");{r.shift(),h=`${h}/${s}`;const o=X.k0.asCID(u[s]);if(o)return{entry:{type:"object",name:t,path:n,cid:e,node:c,depth:i,size:c.length,content:async function*(){yield l}},next:{cid:o,name:s,path:h,toResolve:r}};u=u[s]}}return{entry:{type:"object",name:t,path:n,cid:e,node:c,depth:i,size:c.length,content:async function*(){yield l}}}};var qg=Hg;const Wg=e=>{async function*t(t={}){const{offset:n,length:r}=Cg(e.length,t.offset,t.length);yield Tg(e,0,n,n+r)}return t},Gg=async(e,t,n,r,s,i,o,a)=>{if(r.length)throw B(new Error(`No link named ${n} found in raw node ${e}`),"ERR_NOT_FOUND");const c=await At.Jx(e.multihash.bytes);return{entry:{type:"identity",name:t,path:n,cid:e,content:Wg(c.digest),depth:i,size:c.digest.length,node:c.digest}}};var Yg=Gg;const Qg={[Ae]:Vg,[Xt]:Kg,[Ce.code]:qg,[Nt.code]:Yg};function Xg(e,t,n,r,s,i,o){const a=Qg[e.code];if(!a)throw B(new Error(`No resolver for code ${e.code}`),"ERR_NO_RESOLVER");return a(e,t,n,r,Xg,s,i,o)}var Jg=Xg;const Zg=(e="")=>(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),ey=e=>{if(e instanceof Uint8Array)return{cid:X.k0.decode(e),toResolve:[]};const t=X.k0.asCID(e);if(t)return{cid:t,toResolve:[]};if("string"===typeof e){0===e.indexOf("/ipfs/")&&(e=e.substring(6));const t=Zg(e);return{cid:X.k0.parse(t[0]),toResolve:t.slice(1)}}throw B(new Error(`Unknown path type ${e}`),"ERR_BAD_PATH")};async function*ty(e,t,n={}){let{cid:r,toResolve:s}=ey(e),i=r.toString(),o=i;const a=s.length;while(1){const c=await Jg(r,i,o,s,a,t,n);if(!c.entry&&!c.next)throw B(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;s=c.next.toResolve,r=c.next.cid,i=c.next.name,o=c.next.path}}async function ny(e,t,n={}){const r=await To(ty(e,t,n));if(!r)throw B(new Error(`Could not resolve ${e}`),"ERR_NOT_FOUND");return r}async function*ry(e,t,n={}){const r=await ny(e,t,n);if(r&&(yield r,"directory"===r.type))for await(const i of s(r,n))yield i;async function*s(e,t){for await(const n of e.content(t))yield n,n instanceof Uint8Array||"directory"===n.type&&(yield*s(n,t))}}function sy({repo:e,preload:t}){async function*n(n,r={}){if(n=ei(n),!1!==r.preload){const e=n.split("/");t(X.k0.parse(e[0]))}const s=await ny(n,e.blocks,r);if("directory"===s.type)throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(r)}return qs(n)}"0".charCodeAt(0),An("ustar\0","binary"),An("ustar ","binary"),An(" \0","binary");function iy(e){const t=async function*(){let t=yield,n=new wp;for await(const r of e)if(null!=t){n.append(r);while(n.length>=t){const e=n.sublist(0,t);if(n.consume(t),t=yield e,null==t){n.length>0&&(t=yield n,n=new wp);break}}}else n.append(r),t=yield n,n=new wp;if(null!=t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return t.next(),t}var oy=n(3837);async function ay(e){let t=new Uint8Array(0);for await(const n of e)t=Xn([t,n],t.length+n.length);return t}const cy="0000000000000000000",ly="7777777777777777777",uy="0".charCodeAt(0),hy=An("ustar\0","binary"),dy=An("00","binary"),fy=parseInt("7777",8),py=257,gy=263,yy=function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72;default:return 0}},my=function(e){let t=256;for(let n=0;n<148;n++)t+=e[n];for(let n=156;n<512;n++)t+=e[n];return t},wy=function(e,t){const n=e.toString(8);return n.length>t?An(ly.slice(0,t)+" "):An(cy.slice(0,t-n.length)+n+" ")},by=function(e){const t=An(e).byteLength;let n=Math.floor(Math.log(t)/Math.log(10))+1;return t+n>=Math.pow(10,n)&&n++,`${t+n}${e}`};function vy(e){let t="";null!=e.name&&(t+=by(" path="+e.name+"\n")),null!=e.linkname&&(t+=by(" linkpath="+e.linkname+"\n"));const n=e.pax;if(null!=n)for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t+=by(" "+r+"="+n[r]+"\n"));return An(t)}function _y(e){const t=new Uint8Array(512);let n=e.name,r="";if(5===e.typeflag&&"/"!==n[n.length-1]&&(n+="/"),An(n).byteLength!==n.length)return null;while(An(n).byteLength>100){const e=n.indexOf("/");if(-1===e)return null;r+=""!==r?"/"+n.slice(0,e):n.slice(0,e),n=n.slice(e+1)}return An(n).byteLength>100||An(r).byteLength>155||null!=e.linkname&&An(e.linkname).byteLength>100?null:(t.set(An(n),0),t.set(wy(e.mode&fy,6),100),t.set(wy(e.uid,6),108),t.set(wy(e.gid,6),116),t.set(wy(e.size,11),124),t.set(wy(e.mtime.getTime()/1e3|0,11),136),t[156]=uy+yy(e.type),null!=e.linkname&&t.set(An(e.linkname),157),t.set(hy,py),t.set(dy,gy),null!=e.uname&&t.set(An(e.uname),265),null!=e.gname&&t.set(An(e.gname),297),t.set(wy(e.devmajor??0,6),329),t.set(wy(e.devminor??0,6),337),null!=r&&t.set(An(r),345),t.set(wy(my(t),6),148),t)}const{S_IFMT:Ey,S_IFBLK:Sy,S_IFCHR:ky,S_IFDIR:Iy,S_IFIFO:Ay,S_IFLNK:Ty}=oy,Ry=parseInt("755",8),Cy=parseInt("644",8),Py=new Uint8Array(1024);function Ny(e=0){switch(e&Ey){case Sy:return"block-device";case ky:return"character-device";case Iy:return"directory";case Ay:return"fifo";case Ty:return"symlink";default:return"file"}}function Oy(e){return e&=511,0!==e?Py.subarray(0,512-e):new Uint8Array(0)}function Dy(e){if(null==e.pax){const t=_y(e);if(null!=t)return t}return Ly(e)}function Ly(e){const t=vy(e),n={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname,uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};return new wp(_y(n)??new Uint8Array(0),t,Oy(t.length),_y({...n,size:e.size,type:e.type})??new Uint8Array(0)).subarray()}function xy(){return async function*(e){for await(let{header:t,body:n}of e){const e={...t,size:"symlink"===t.type?0:t.size??0,type:t.type??Ny(t.mode),mode:t.mode??("directory"===t.type?Ry:Cy),uid:t.uid??0,gid:t.gid??0,mtime:t.mtime??new Date};if("string"===typeof n&&(n=An(n)),n instanceof Uint8Array||mp(n)){e.size=n.length,yield Dy(e),yield mp(n)?n.subarray():n,yield Oy(e.size);continue}if("symlink"===e.type&&null==e.linkname){if(null==n)throw new Error("type was symlink but no linkname or body specified");e.linkname=Fn(await ay(n)),yield Dy(e);continue}if(yield Dy(e),"file"!==e.type&&"contiguous-file"!==e.type)continue;let r=0;for await(const t of n??[])r+=t.length,yield mp(t)?t.subarray():t;if(r!==e.size)throw new Error(`size mismatch, wrote ${r} of ${e.size} bytes`);yield Oy(e.size)}yield Py}}n(2087);
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
const By=4,My=0,Uy=1,Fy=2;function jy(e){let t=e.length;while(--t>=0)e[t]=0}const Vy=0,zy=1,$y=2,Ky=3,Hy=258,qy=29,Wy=256,Gy=Wy+1+qy,Yy=30,Qy=19,Xy=2*Gy+1,Jy=15,Zy=16,em=7,tm=256,nm=16,rm=17,sm=18,im=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),om=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),am=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),cm=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lm=512,um=new Array(2*(Gy+2));jy(um);const hm=new Array(2*Yy);jy(hm);const dm=new Array(lm);jy(dm);const fm=new Array(Hy-Ky+1);jy(fm);const pm=new Array(qy);jy(pm);const gm=new Array(Yy);function ym(e,t,n,r,s){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=s,this.has_stree=e&&e.length}let mm,wm,bm;function vm(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}jy(gm);const _m=e=>e<256?dm[e]:dm[256+(e>>>7)],Em=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Sm=(e,t,n)=>{e.bi_valid>Zy-n?(e.bi_buf|=t<<e.bi_valid&65535,Em(e,e.bi_buf),e.bi_buf=t>>Zy-e.bi_valid,e.bi_valid+=n-Zy):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},km=(e,t,n)=>{Sm(e,n[2*t],n[2*t+1])},Im=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Am=e=>{16===e.bi_valid?(Em(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},Tm=(e,t)=>{const n=t.dyn_tree,r=t.max_code,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let l,u,h,d,f,p,g=0;for(d=0;d<=Jy;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<Xy;l++)u=e.heap[l],d=n[2*n[2*u+1]+1]+1,d>c&&(d=c,g++),n[2*u+1]=d,u>r||(e.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),p=n[2*u],e.opt_len+=p*(d+f),i&&(e.static_len+=p*(s[2*u+1]+f)));if(0!==g){do{d=c-1;while(0===e.bl_count[d])d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(d=c;0!==d;d--){u=e.bl_count[d];while(0!==u)h=e.heap[--l],h>r||(n[2*h+1]!==d&&(e.opt_len+=(d-n[2*h+1])*n[2*h],n[2*h+1]=d),u--)}}},Rm=(e,t,n)=>{const r=new Array(Jy+1);let s,i,o=0;for(s=1;s<=Jy;s++)o=o+n[s-1]<<1,r[s]=o;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=Im(r[t]++,t))}},Cm=()=>{let e,t,n,r,s;const i=new Array(Jy+1);for(n=0,r=0;r<qy-1;r++)for(pm[r]=n,e=0;e<1<<im[r];e++)fm[n++]=r;for(fm[n-1]=r,s=0,r=0;r<16;r++)for(gm[r]=s,e=0;e<1<<om[r];e++)dm[s++]=r;for(s>>=7;r<Yy;r++)for(gm[r]=s<<7,e=0;e<1<<om[r]-7;e++)dm[256+s++]=r;for(t=0;t<=Jy;t++)i[t]=0;e=0;while(e<=143)um[2*e+1]=8,e++,i[8]++;while(e<=255)um[2*e+1]=9,e++,i[9]++;while(e<=279)um[2*e+1]=7,e++,i[7]++;while(e<=287)um[2*e+1]=8,e++,i[8]++;for(Rm(um,Gy+1,i),e=0;e<Yy;e++)hm[2*e+1]=5,hm[2*e]=Im(e,5);mm=new ym(um,im,Wy+1,Gy,Jy),wm=new ym(hm,om,0,Yy,Jy),bm=new ym(new Array(0),am,0,Qy,em)},Pm=e=>{let t;for(t=0;t<Gy;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Yy;t++)e.dyn_dtree[2*t]=0;for(t=0;t<Qy;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*tm]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Nm=e=>{e.bi_valid>8?Em(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Om=(e,t,n,r)=>{const s=2*t,i=2*n;return e[s]<e[i]||e[s]===e[i]&&r[t]<=r[n]},Dm=(e,t,n)=>{const r=e.heap[n];let s=n<<1;while(s<=e.heap_len){if(s<e.heap_len&&Om(t,e.heap[s+1],e.heap[s],e.depth)&&s++,Om(t,r,e.heap[s],e.depth))break;e.heap[n]=e.heap[s],n=s,s<<=1}e.heap[n]=r},Lm=(e,t,n)=>{let r,s,i,o,a=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+a++],r+=(255&e.pending_buf[e.sym_buf+a++])<<8,s=e.pending_buf[e.sym_buf+a++],0===r?km(e,s,t):(i=fm[s],km(e,i+Wy+1,t),o=im[i],0!==o&&(s-=pm[i],Sm(e,s,o)),r--,i=_m(r),km(e,i,n),o=om[i],0!==o&&(r-=gm[i],Sm(e,r,o)))}while(a<e.sym_next);km(e,tm,t)},xm=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.elems;let o,a,c,l=-1;for(e.heap_len=0,e.heap_max=Xy,o=0;o<i;o++)0!==n[2*o]?(e.heap[++e.heap_len]=l=o,e.depth[o]=0):n[2*o+1]=0;while(e.heap_len<2)c=e.heap[++e.heap_len]=l<2?++l:0,n[2*c]=1,e.depth[c]=0,e.opt_len--,s&&(e.static_len-=r[2*c+1]);for(t.max_code=l,o=e.heap_len>>1;o>=1;o--)Dm(e,n,o);c=i;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Dm(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[2*c]=n[2*o]+n[2*a],e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[2*o+1]=n[2*a+1]=c,e.heap[1]=c++,Dm(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Tm(e,t),Rm(n,l,e.bl_count)},Bm=(e,t,n)=>{let r,s,i=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)s=o,o=t[2*(r+1)+1],++a<c&&s===o||(a<l?e.bl_tree[2*s]+=a:0!==s?(s!==i&&e.bl_tree[2*s]++,e.bl_tree[2*nm]++):a<=10?e.bl_tree[2*rm]++:e.bl_tree[2*sm]++,a=0,i=s,0===o?(c=138,l=3):s===o?(c=6,l=3):(c=7,l=4))},Mm=(e,t,n)=>{let r,s,i=-1,o=t[1],a=0,c=7,l=4;for(0===o&&(c=138,l=3),r=0;r<=n;r++)if(s=o,o=t[2*(r+1)+1],!(++a<c&&s===o)){if(a<l)do{km(e,s,e.bl_tree)}while(0!==--a);else 0!==s?(s!==i&&(km(e,s,e.bl_tree),a--),km(e,nm,e.bl_tree),Sm(e,a-3,2)):a<=10?(km(e,rm,e.bl_tree),Sm(e,a-3,3)):(km(e,sm,e.bl_tree),Sm(e,a-11,7));a=0,i=s,0===o?(c=138,l=3):s===o?(c=6,l=3):(c=7,l=4)}},Um=e=>{let t;for(Bm(e,e.dyn_ltree,e.l_desc.max_code),Bm(e,e.dyn_dtree,e.d_desc.max_code),xm(e,e.bl_desc),t=Qy-1;t>=3;t--)if(0!==e.bl_tree[2*cm[t]+1])break;return e.opt_len+=3*(t+1)+5+5+4,t},Fm=(e,t,n,r)=>{let s;for(Sm(e,t-257,5),Sm(e,n-1,5),Sm(e,r-4,4),s=0;s<r;s++)Sm(e,e.bl_tree[2*cm[s]+1],3);Mm(e,e.dyn_ltree,t-1),Mm(e,e.dyn_dtree,n-1)},jm=e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return My;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Uy;for(t=32;t<Wy;t++)if(0!==e.dyn_ltree[2*t])return Uy;return My};let Vm=!1;const zm=e=>{Vm||(Cm(),Vm=!0),e.l_desc=new vm(e.dyn_ltree,mm),e.d_desc=new vm(e.dyn_dtree,wm),e.bl_desc=new vm(e.bl_tree,bm),e.bi_buf=0,e.bi_valid=0,Pm(e)},$m=(e,t,n,r)=>{Sm(e,(Vy<<1)+(r?1:0),3),Nm(e),Em(e,n),Em(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Km=e=>{Sm(e,zy<<1,3),km(e,tm,um),Am(e)},Hm=(e,t,n,r)=>{let s,i,o=0;e.level>0?(e.strm.data_type===Fy&&(e.strm.data_type=jm(e)),xm(e,e.l_desc),xm(e,e.d_desc),o=Um(e),s=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=s&&(s=i)):s=i=n+5,n+4<=s&&-1!==t?$m(e,t,n,r):e.strategy===By||i===s?(Sm(e,(zy<<1)+(r?1:0),3),Lm(e,um,hm)):(Sm(e,($y<<1)+(r?1:0),3),Fm(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Lm(e,e.dyn_ltree,e.dyn_dtree)),Pm(e),r&&Nm(e)},qm=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(fm[n]+Wy+1)]++,e.dyn_dtree[2*_m(t)]++),e.sym_next===e.sym_end);var Wm=zm,Gm=$m,Ym=Hm,Qm=qm,Xm=Km,Jm={_tr_init:Wm,_tr_stored_block:Gm,_tr_flush_block:Ym,_tr_tally:Qm,_tr_align:Xm};const Zm=(e,t,n,r)=>{let s=65535&e|0,i=e>>>16&65535|0,o=0;while(0!==n){o=n>2e3?2e3:n,n-=o;do{s=s+t[r++]|0,i=i+s|0}while(--o);s%=65521,i%=65521}return s|i<<16|0};var ew=Zm;const tw=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t},nw=new Uint32Array(tw()),rw=(e,t,n,r)=>{const s=nw,i=r+n;e^=-1;for(let o=r;o<i;o++)e=e>>>8^s[255&(e^t[o])];return-1^e};var sw=rw,iw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ow={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:aw,_tr_stored_block:cw,_tr_flush_block:lw,_tr_tally:uw,_tr_align:hw}=Jm,{Z_NO_FLUSH:dw,Z_PARTIAL_FLUSH:fw,Z_FULL_FLUSH:pw,Z_FINISH:gw,Z_BLOCK:yw,Z_OK:mw,Z_STREAM_END:ww,Z_STREAM_ERROR:bw,Z_DATA_ERROR:vw,Z_BUF_ERROR:_w,Z_DEFAULT_COMPRESSION:Ew,Z_FILTERED:Sw,Z_HUFFMAN_ONLY:kw,Z_RLE:Iw,Z_FIXED:Aw,Z_DEFAULT_STRATEGY:Tw,Z_UNKNOWN:Rw,Z_DEFLATED:Cw}=ow,Pw=9,Nw=15,Ow=8,Dw=29,Lw=256,xw=Lw+1+Dw,Bw=30,Mw=19,Uw=2*xw+1,Fw=15,jw=3,Vw=258,zw=Vw+jw+1,$w=32,Kw=42,Hw=57,qw=69,Ww=73,Gw=91,Yw=103,Qw=113,Xw=666,Jw=1,Zw=2,eb=3,tb=4,nb=3,rb=(e,t)=>(e.msg=iw[t],t),sb=e=>2*e-(e>4?9:0),ib=e=>{let t=e.length;while(--t>=0)e[t]=0},ob=e=>{let t,n,r,s=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=s?n-s:0}while(--t);t=s,r=t;do{n=e.prev[--r],e.prev[r]=n>=s?n-s:0}while(--t)};let ab=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,cb=ab;const lb=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},ub=(e,t)=>{lw(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,lb(e.strm)},hb=(e,t)=>{e.pending_buf[e.pending++]=t},db=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},fb=(e,t,n,r)=>{let s=e.avail_in;return s>r&&(s=r),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),n),1===e.state.wrap?e.adler=ew(e.adler,t,s,n):2===e.state.wrap&&(e.adler=sw(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)},pb=(e,t)=>{let n,r,s=e.max_chain_length,i=e.strstart,o=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-zw?e.strstart-(e.w_size-zw):0,l=e.window,u=e.w_mask,h=e.prev,d=e.strstart+Vw;let f=l[i+o-1],p=l[i+o];e.prev_length>=e.good_match&&(s>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,l[n+o]===p&&l[n+o-1]===f&&l[n]===l[i]&&l[++n]===l[i+1]){i+=2,n++;do{}while(l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&l[++i]===l[++n]&&i<d);if(r=Vw-(d-i),i=d-Vw,r>o){if(e.match_start=t,o=r,r>=a)break;f=l[i+o-1],p=l[i+o]}}}while((t=h[t&u])>c&&0!==--s);return o<=e.lookahead?o:e.lookahead},gb=e=>{const t=e.w_size;let n,r,s;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-zw)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),ob(e),r+=t),0===e.strm.avail_in)break;if(n=fb(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=jw){s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=cb(e,e.ins_h,e.window[s+1]);while(e.insert)if(e.ins_h=cb(e,e.ins_h,e.window[s+jw-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,e.lookahead+e.insert<jw)break}}while(e.lookahead<zw&&0!==e.strm.avail_in)},yb=(e,t)=>{let n,r,s,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o=0,a=e.strm.avail_in;do{if(n=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s)break;if(s=e.strm.avail_out-s,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>s&&(n=s),n<i&&(0===n&&t!==gw||t===dw||n!==r+e.strm.avail_in))break;o=t===gw&&n===r+e.strm.avail_in?1:0,cw(e,0,0,o),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,lb(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(fb(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===o);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),o?tb:t!==dw&&t!==gw&&0===e.strm.avail_in&&e.strstart===e.block_start?Zw:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(fb(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,i=s>e.w_size?e.w_size:s,r=e.strstart-e.block_start,(r>=i||(r||t===gw)&&t!==dw&&0===e.strm.avail_in&&r<=s)&&(n=r>s?s:r,o=t===gw&&0===e.strm.avail_in&&n===r?1:0,cw(e,e.block_start,n,o),e.block_start+=n,lb(e.strm)),o?eb:Jw)},mb=(e,t)=>{let n,r;for(;;){if(e.lookahead<zw){if(gb(e),e.lookahead<zw&&t===dw)return Jw;if(0===e.lookahead)break}if(n=0,e.lookahead>=jw&&(e.ins_h=cb(e,e.ins_h,e.window[e.strstart+jw-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-zw&&(e.match_length=pb(e,n)),e.match_length>=jw)if(r=uw(e,e.strstart-e.match_start,e.match_length-jw),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=jw){e.match_length--;do{e.strstart++,e.ins_h=cb(e,e.ins_h,e.window[e.strstart+jw-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=cb(e,e.ins_h,e.window[e.strstart+1]);else r=uw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(ub(e,!1),0===e.strm.avail_out))return Jw}return e.insert=e.strstart<jw-1?e.strstart:jw-1,t===gw?(ub(e,!0),0===e.strm.avail_out?eb:tb):e.sym_next&&(ub(e,!1),0===e.strm.avail_out)?Jw:Zw},wb=(e,t)=>{let n,r,s;for(;;){if(e.lookahead<zw){if(gb(e),e.lookahead<zw&&t===dw)return Jw;if(0===e.lookahead)break}if(n=0,e.lookahead>=jw&&(e.ins_h=cb(e,e.ins_h,e.window[e.strstart+jw-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=jw-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-zw&&(e.match_length=pb(e,n),e.match_length<=5&&(e.strategy===Sw||e.match_length===jw&&e.strstart-e.match_start>4096)&&(e.match_length=jw-1)),e.prev_length>=jw&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-jw,r=uw(e,e.strstart-1-e.prev_match,e.prev_length-jw),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=cb(e,e.ins_h,e.window[e.strstart+jw-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=jw-1,e.strstart++,r&&(ub(e,!1),0===e.strm.avail_out))return Jw}else if(e.match_available){if(r=uw(e,0,e.window[e.strstart-1]),r&&ub(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return Jw}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=uw(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<jw-1?e.strstart:jw-1,t===gw?(ub(e,!0),0===e.strm.avail_out?eb:tb):e.sym_next&&(ub(e,!1),0===e.strm.avail_out)?Jw:Zw},bb=(e,t)=>{let n,r,s,i;const o=e.window;for(;;){if(e.lookahead<=Vw){if(gb(e),e.lookahead<=Vw&&t===dw)return Jw;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=jw&&e.strstart>0&&(s=e.strstart-1,r=o[s],r===o[++s]&&r===o[++s]&&r===o[++s])){i=e.strstart+Vw;do{}while(r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&r===o[++s]&&s<i);e.match_length=Vw-(i-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=jw?(n=uw(e,1,e.match_length-jw),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=uw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(ub(e,!1),0===e.strm.avail_out))return Jw}return e.insert=0,t===gw?(ub(e,!0),0===e.strm.avail_out?eb:tb):e.sym_next&&(ub(e,!1),0===e.strm.avail_out)?Jw:Zw},vb=(e,t)=>{let n;for(;;){if(0===e.lookahead&&(gb(e),0===e.lookahead)){if(t===dw)return Jw;break}if(e.match_length=0,n=uw(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(ub(e,!1),0===e.strm.avail_out))return Jw}return e.insert=0,t===gw?(ub(e,!0),0===e.strm.avail_out?eb:tb):e.sym_next&&(ub(e,!1),0===e.strm.avail_out)?Jw:Zw};function _b(e,t,n,r,s){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=s}const Eb=[new _b(0,0,0,0,yb),new _b(4,4,8,4,mb),new _b(4,5,16,8,mb),new _b(4,6,32,32,mb),new _b(4,4,16,16,wb),new _b(8,16,32,32,wb),new _b(8,16,128,128,wb),new _b(8,32,128,256,wb),new _b(32,128,258,1024,wb),new _b(32,258,258,4096,wb)],Sb=e=>{e.window_size=2*e.w_size,ib(e.head),e.max_lazy_match=Eb[e.level].max_lazy,e.good_match=Eb[e.level].good_length,e.nice_match=Eb[e.level].nice_length,e.max_chain_length=Eb[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=jw-1,e.match_available=0,e.ins_h=0};function kb(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Cw,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Uw),this.dyn_dtree=new Uint16Array(2*(2*Bw+1)),this.bl_tree=new Uint16Array(2*(2*Mw+1)),ib(this.dyn_ltree),ib(this.dyn_dtree),ib(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Fw+1),this.heap=new Uint16Array(2*xw+1),ib(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*xw+1),ib(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ib=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Kw&&t.status!==Hw&&t.status!==qw&&t.status!==Ww&&t.status!==Gw&&t.status!==Yw&&t.status!==Qw&&t.status!==Xw?1:0},Ab=e=>{if(Ib(e))return rb(e,bw);e.total_in=e.total_out=0,e.data_type=Rw;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?Hw:t.wrap?Kw:Qw,e.adler=2===t.wrap?0:1,t.last_flush=-2,aw(t),mw},Tb=e=>{const t=Ab(e);return t===mw&&Sb(e.state),t},Rb=(e,t)=>Ib(e)||2!==e.state.wrap?bw:(e.state.gzhead=t,mw),Cb=(e,t,n,r,s,i)=>{if(!e)return bw;let o=1;if(t===Ew&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),s<1||s>Pw||n!==Cw||r<8||r>15||t<0||t>9||i<0||i>Aw||8===r&&1!==o)return rb(e,bw);8===r&&(r=9);const a=new kb;return e.state=a,a.strm=e,a.status=Kw,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+jw-1)/jw),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=i,a.method=n,Tb(e)},Pb=(e,t)=>Cb(e,t,Cw,Nw,Ow,Tw),Nb=(e,t)=>{if(Ib(e)||t>yw||t<0)return e?rb(e,bw):bw;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===Xw&&t!==gw)return rb(e,0===e.avail_out?_w:bw);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(lb(e),0===e.avail_out)return n.last_flush=-1,mw}else if(0===e.avail_in&&sb(t)<=sb(r)&&t!==gw)return rb(e,_w);if(n.status===Xw&&0!==e.avail_in)return rb(e,_w);if(n.status===Kw&&0===n.wrap&&(n.status=Qw),n.status===Kw){let t=Cw+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=kw||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=$w),t+=31-t%31,db(n,t),0!==n.strstart&&(db(n,e.adler>>>16),db(n,65535&e.adler)),e.adler=1,n.status=Qw,lb(e),0!==n.pending)return n.last_flush=-1,mw}if(n.status===Hw)if(e.adler=0,hb(n,31),hb(n,139),hb(n,8),n.gzhead)hb(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),hb(n,255&n.gzhead.time),hb(n,n.gzhead.time>>8&255),hb(n,n.gzhead.time>>16&255),hb(n,n.gzhead.time>>24&255),hb(n,9===n.level?2:n.strategy>=kw||n.level<2?4:0),hb(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(hb(n,255&n.gzhead.extra.length),hb(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=sw(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=qw;else if(hb(n,0),hb(n,0),hb(n,0),hb(n,0),hb(n,0),hb(n,9===n.level?2:n.strategy>=kw||n.level<2?4:0),hb(n,nb),n.status=Qw,lb(e),0!==n.pending)return n.last_flush=-1,mw;if(n.status===qw){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;while(n.pending+r>n.pending_buf_size){let s=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+s),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=sw(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=s,lb(e),0!==n.pending)return n.last_flush=-1,mw;t=0,r-=s}let s=new Uint8Array(n.gzhead.extra);n.pending_buf.set(s.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=sw(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=Ww}if(n.status===Ww){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=sw(e.adler,n.pending_buf,n.pending-r,r)),lb(e),0!==n.pending)return n.last_flush=-1,mw;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,hb(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=sw(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=Gw}if(n.status===Gw){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=sw(e.adler,n.pending_buf,n.pending-r,r)),lb(e),0!==n.pending)return n.last_flush=-1,mw;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,hb(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=sw(e.adler,n.pending_buf,n.pending-r,r))}n.status=Yw}if(n.status===Yw){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(lb(e),0!==n.pending))return n.last_flush=-1,mw;hb(n,255&e.adler),hb(n,e.adler>>8&255),e.adler=0}if(n.status=Qw,lb(e),0!==n.pending)return n.last_flush=-1,mw}if(0!==e.avail_in||0!==n.lookahead||t!==dw&&n.status!==Xw){let r=0===n.level?yb(n,t):n.strategy===kw?vb(n,t):n.strategy===Iw?bb(n,t):Eb[n.level].func(n,t);if(r!==eb&&r!==tb||(n.status=Xw),r===Jw||r===eb)return 0===e.avail_out&&(n.last_flush=-1),mw;if(r===Zw&&(t===fw?hw(n):t!==yw&&(cw(n,0,0,!1),t===pw&&(ib(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),lb(e),0===e.avail_out))return n.last_flush=-1,mw}return t!==gw?mw:n.wrap<=0?ww:(2===n.wrap?(hb(n,255&e.adler),hb(n,e.adler>>8&255),hb(n,e.adler>>16&255),hb(n,e.adler>>24&255),hb(n,255&e.total_in),hb(n,e.total_in>>8&255),hb(n,e.total_in>>16&255),hb(n,e.total_in>>24&255)):(db(n,e.adler>>>16),db(n,65535&e.adler)),lb(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?mw:ww)},Ob=e=>{if(Ib(e))return bw;const t=e.state.status;return e.state=null,t===Qw?rb(e,vw):mw},Db=(e,t)=>{let n=t.length;if(Ib(e))return bw;const r=e.state,s=r.wrap;if(2===s||1===s&&r.status!==Kw||r.lookahead)return bw;if(1===s&&(e.adler=ew(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===s&&(ib(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const i=e.avail_in,o=e.next_in,a=e.input;e.avail_in=n,e.next_in=0,e.input=t,gb(r);while(r.lookahead>=jw){let e=r.strstart,t=r.lookahead-(jw-1);do{r.ins_h=cb(r,r.ins_h,r.window[e+jw-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=jw-1,gb(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=jw-1,r.match_available=0,e.next_in=o,e.input=a,e.avail_in=i,r.wrap=s,mw};var Lb=Pb,xb=Cb,Bb=Tb,Mb=Ab,Ub=Rb,Fb=Nb,jb=Ob,Vb=Db,zb="pako deflate (from Nodeca project)",$b={deflateInit:Lb,deflateInit2:xb,deflateReset:Bb,deflateResetKeep:Mb,deflateSetHeader:Ub,deflate:Fb,deflateEnd:jb,deflateSetDictionary:Vb,deflateInfo:zb};const Kb=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Hb=function(e){const t=Array.prototype.slice.call(arguments,1);while(t.length){const n=t.shift();if(n){if("object"!==typeof n)throw new TypeError(n+"must be non-object");for(const t in n)Kb(n,t)&&(e[t]=n[t])}}return e},qb=e=>{let t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,s=0,i=e.length;r<i;r++){let t=e[r];n.set(t,s),s+=t.length}return n},Wb={assign:Hb,flattenChunks:qb};let Gb=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(DQ){Gb=!1}const Yb=new Uint8Array(256);for(let LQ=0;LQ<256;LQ++)Yb[LQ]=LQ>=252?6:LQ>=248?5:LQ>=240?4:LQ>=224?3:LQ>=192?2:1;Yb[254]=Yb[254]=1;var Qb=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,s,i,o=e.length,a=0;for(s=0;s<o;s++)n=e.charCodeAt(s),55296===(64512&n)&&s+1<o&&(r=e.charCodeAt(s+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),i=0,s=0;i<a;s++)n=e.charCodeAt(s),55296===(64512&n)&&s+1<o&&(r=e.charCodeAt(s+1),56320===(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),s++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t};const Xb=(e,t)=>{if(t<65534&&e.subarray&&Gb)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var Jb=(e,t)=>{const n=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,s;const i=new Array(2*n);for(s=0,r=0;r<n;){let t=e[r++];if(t<128){i[s++]=t;continue}let o=Yb[t];if(o>4)i[s++]=65533,r+=o-1;else{t&=2===o?31:3===o?15:7;while(o>1&&r<n)t=t<<6|63&e[r++],o--;o>1?i[s++]=65533:t<65536?i[s++]=t:(t-=65536,i[s++]=55296|t>>10&1023,i[s++]=56320|1023&t)}}return Xb(i,s)},Zb=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;while(n>=0&&128===(192&e[n]))n--;return n<0||0===n?t:n+Yb[e[n]]>t?n:t},ev={string2buf:Qb,buf2string:Jb,utf8border:Zb};function tv(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var nv=tv;const rv=Object.prototype.toString,{Z_NO_FLUSH:sv,Z_SYNC_FLUSH:iv,Z_FULL_FLUSH:ov,Z_FINISH:av,Z_OK:cv,Z_STREAM_END:lv,Z_DEFAULT_COMPRESSION:uv,Z_DEFAULT_STRATEGY:hv,Z_DEFLATED:dv}=ow;function fv(e){this.options=Wb.assign({level:uv,method:dv,chunkSize:16384,windowBits:15,memLevel:8,strategy:hv},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nv,this.strm.avail_out=0;let n=$b.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==cv)throw new Error(iw[n]);if(t.header&&$b.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?ev.string2buf(t.dictionary):"[object ArrayBuffer]"===rv.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=$b.deflateSetDictionary(this.strm,e),n!==cv)throw new Error(iw[n]);this._dict_set=!0}}function pv(e,t){const n=new fv(t);if(n.push(e,!0),n.err)throw n.msg||iw[n.err];return n.result}function gv(e,t){return t=t||{},t.raw=!0,pv(e,t)}function yv(e,t){return t=t||{},t.gzip=!0,pv(e,t)}fv.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let s,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?av:sv,"string"===typeof e?n.input=ev.string2buf(e):"[object ArrayBuffer]"===rv.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===iv||i===ov)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(s=$b.deflate(n,i),s===lv)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),s=$b.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===cv;if(0!==n.avail_out){if(i>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},fv.prototype.onData=function(e){this.chunks.push(e)},fv.prototype.onEnd=function(e){e===cv&&(this.result=Wb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var mv=fv,wv=pv,bv=gv,vv=yv,_v=ow,Ev={Deflate:mv,deflate:wv,deflateRaw:bv,gzip:vv,constants:_v};const Sv=16209,kv=16191;var Iv=function(e,t){let n,r,s,i,o,a,c,l,u,h,d,f,p,g,y,m,w,b,v,_,E,S,k,I;const A=e.state;n=e.next_in,k=e.input,r=n+(e.avail_in-5),s=e.next_out,I=e.output,i=s-(t-e.avail_out),o=s+(e.avail_out-257),a=A.dmax,c=A.wsize,l=A.whave,u=A.wnext,h=A.window,d=A.hold,f=A.bits,p=A.lencode,g=A.distcode,y=(1<<A.lenbits)-1,m=(1<<A.distbits)-1;e:do{f<15&&(d+=k[n++]<<f,f+=8,d+=k[n++]<<f,f+=8),w=p[d&y];t:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,0===b)I[s++]=65535&w;else{if(!(16&b)){if(0===(64&b)){w=p[(65535&w)+(d&(1<<b)-1)];continue t}if(32&b){A.mode=kv;break e}e.msg="invalid literal/length code",A.mode=Sv;break e}v=65535&w,b&=15,b&&(f<b&&(d+=k[n++]<<f,f+=8),v+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=k[n++]<<f,f+=8,d+=k[n++]<<f,f+=8),w=g[d&m];n:for(;;){if(b=w>>>24,d>>>=b,f-=b,b=w>>>16&255,!(16&b)){if(0===(64&b)){w=g[(65535&w)+(d&(1<<b)-1)];continue n}e.msg="invalid distance code",A.mode=Sv;break e}if(_=65535&w,b&=15,f<b&&(d+=k[n++]<<f,f+=8,f<b&&(d+=k[n++]<<f,f+=8)),_+=d&(1<<b)-1,_>a){e.msg="invalid distance too far back",A.mode=Sv;break e}if(d>>>=b,f-=b,b=s-i,_>b){if(b=_-b,b>l&&A.sane){e.msg="invalid distance too far back",A.mode=Sv;break e}if(E=0,S=h,0===u){if(E+=c-b,b<v){v-=b;do{I[s++]=h[E++]}while(--b);E=s-_,S=I}}else if(u<b){if(E+=c+u-b,b-=u,b<v){v-=b;do{I[s++]=h[E++]}while(--b);if(E=0,u<v){b=u,v-=b;do{I[s++]=h[E++]}while(--b);E=s-_,S=I}}}else if(E+=u-b,b<v){v-=b;do{I[s++]=h[E++]}while(--b);E=s-_,S=I}while(v>2)I[s++]=S[E++],I[s++]=S[E++],I[s++]=S[E++],v-=3;v&&(I[s++]=S[E++],v>1&&(I[s++]=S[E++]))}else{E=s-_;do{I[s++]=I[E++],I[s++]=I[E++],I[s++]=I[E++],v-=3}while(v>2);v&&(I[s++]=I[E++],v>1&&(I[s++]=I[E++]))}break}}break}}while(n<r&&s<o);v=f>>3,n-=v,f-=v<<3,d&=(1<<f)-1,e.next_in=n,e.next_out=s,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=s<o?o-s+257:257-(s-o),A.hold=d,A.bits=f};const Av=15,Tv=852,Rv=592,Cv=0,Pv=1,Nv=2,Ov=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Dv=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Lv=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xv=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Bv=(e,t,n,r,s,i,o,a)=>{const c=a.bits;let l,u,h,d,f,p,g=0,y=0,m=0,w=0,b=0,v=0,_=0,E=0,S=0,k=0,I=null;const A=new Uint16Array(Av+1),T=new Uint16Array(Av+1);let R,C,P,N=null;for(g=0;g<=Av;g++)A[g]=0;for(y=0;y<r;y++)A[t[n+y]]++;for(b=c,w=Av;w>=1;w--)if(0!==A[w])break;if(b>w&&(b=w),0===w)return s[i++]=20971520,s[i++]=20971520,a.bits=1,0;for(m=1;m<w;m++)if(0!==A[m])break;for(b<m&&(b=m),E=1,g=1;g<=Av;g++)if(E<<=1,E-=A[g],E<0)return-1;if(E>0&&(e===Cv||1!==w))return-1;for(T[1]=0,g=1;g<Av;g++)T[g+1]=T[g]+A[g];for(y=0;y<r;y++)0!==t[n+y]&&(o[T[t[n+y]]++]=y);if(e===Cv?(I=N=o,p=20):e===Pv?(I=Ov,N=Dv,p=257):(I=Lv,N=xv,p=0),k=0,y=0,g=m,f=i,v=b,_=0,h=-1,S=1<<b,d=S-1,e===Pv&&S>Tv||e===Nv&&S>Rv)return 1;for(;;){R=g-_,o[y]+1<p?(C=0,P=o[y]):o[y]>=p?(C=N[o[y]-p],P=I[o[y]-p]):(C=96,P=0),l=1<<g-_,u=1<<v,m=u;do{u-=l,s[f+(k>>_)+u]=R<<24|C<<16|P|0}while(0!==u);l=1<<g-1;while(k&l)l>>=1;if(0!==l?(k&=l-1,k+=l):k=0,y++,0===--A[g]){if(g===w)break;g=t[n+o[y]]}if(g>b&&(k&d)!==h){0===_&&(_=b),f+=m,v=g-_,E=1<<v;while(v+_<w){if(E-=A[v+_],E<=0)break;v++,E<<=1}if(S+=1<<v,e===Pv&&S>Tv||e===Nv&&S>Rv)return 1;h=k&d,s[h]=b<<24|v<<16|f-i|0}}return 0!==k&&(s[f+k]=g-_<<24|64<<16|0),a.bits=b,0};var Mv=Bv;const Uv=0,Fv=1,jv=2,{Z_FINISH:Vv,Z_BLOCK:zv,Z_TREES:$v,Z_OK:Kv,Z_STREAM_END:Hv,Z_NEED_DICT:qv,Z_STREAM_ERROR:Wv,Z_DATA_ERROR:Gv,Z_MEM_ERROR:Yv,Z_BUF_ERROR:Qv,Z_DEFLATED:Xv}=ow,Jv=16180,Zv=16181,e_=16182,t_=16183,n_=16184,r_=16185,s_=16186,i_=16187,o_=16188,a_=16189,c_=16190,l_=16191,u_=16192,h_=16193,d_=16194,f_=16195,p_=16196,g_=16197,y_=16198,m_=16199,w_=16200,b_=16201,v_=16202,__=16203,E_=16204,S_=16205,k_=16206,I_=16207,A_=16208,T_=16209,R_=16210,C_=16211,P_=852,N_=592,O_=15,D_=O_,L_=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function x_(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const B_=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Jv||t.mode>C_?1:0},M_=e=>{if(B_(e))return Wv;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Jv,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(P_),t.distcode=t.distdyn=new Int32Array(N_),t.sane=1,t.back=-1,Kv},U_=e=>{if(B_(e))return Wv;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,M_(e)},F_=(e,t)=>{let n;if(B_(e))return Wv;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Wv:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,U_(e))},j_=(e,t)=>{if(!e)return Wv;const n=new x_;e.state=n,n.strm=e,n.window=null,n.mode=Jv;const r=F_(e,t);return r!==Kv&&(e.state=null),r},V_=e=>j_(e,D_);let z_,$_,K_=!0;const H_=e=>{if(K_){z_=new Int32Array(512),$_=new Int32Array(32);let t=0;while(t<144)e.lens[t++]=8;while(t<256)e.lens[t++]=9;while(t<280)e.lens[t++]=7;while(t<288)e.lens[t++]=8;Mv(Fv,e.lens,0,288,z_,0,e.work,{bits:9}),t=0;while(t<32)e.lens[t++]=5;Mv(jv,e.lens,0,32,$_,0,e.work,{bits:5}),K_=!1}e.lencode=z_,e.lenbits=9,e.distcode=$_,e.distbits=5},q_=(e,t,n,r)=>{let s;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>r&&(s=r),i.window.set(t.subarray(n-r,n-r+s),i.wnext),r-=s,r?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},W_=(e,t)=>{let n,r,s,i,o,a,c,l,u,h,d,f,p,g,y,m,w,b,v,_,E,S,k=0;const I=new Uint8Array(4);let A,T;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(B_(e)||!e.output||!e.input&&0!==e.avail_in)return Wv;n=e.state,n.mode===l_&&(n.mode=u_),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,l=n.hold,u=n.bits,h=a,d=c,S=Kv;e:for(;;)switch(n.mode){case Jv:if(0===n.wrap){n.mode=u_;break}while(u<16){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,I[0]=255&l,I[1]=l>>>8&255,n.check=sw(n.check,I,2,0),l=0,u=0,n.mode=Zv;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=T_;break}if((15&l)!==Xv){e.msg="unknown compression method",n.mode=T_;break}if(l>>>=4,u-=4,E=8+(15&l),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=T_;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?a_:l_,l=0,u=0;break;case Zv:while(u<16){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(n.flags=l,(255&n.flags)!==Xv){e.msg="unknown compression method",n.mode=T_;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=T_;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=sw(n.check,I,2,0)),l=0,u=0,n.mode=e_;case e_:while(u<32){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}n.head&&(n.head.time=l),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,n.check=sw(n.check,I,4,0)),l=0,u=0,n.mode=t_;case t_:while(u<16){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=sw(n.check,I,2,0)),l=0,u=0,n.mode=n_;case n_:if(1024&n.flags){while(u<16){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=sw(n.check,I,2,0)),l=0,u=0}else n.head&&(n.head.extra=null);n.mode=r_;case r_:if(1024&n.flags&&(f=n.length,f>a&&(f=a),f&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+f),E)),512&n.flags&&4&n.wrap&&(n.check=sw(n.check,r,f,i)),a-=f,i+=f,n.length-=f),n.length))break e;n.length=0,n.mode=s_;case s_:if(2048&n.flags){if(0===a)break e;f=0;do{E=r[i+f++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=sw(n.check,r,f,i)),a-=f,i+=f,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=i_;case i_:if(4096&n.flags){if(0===a)break e;f=0;do{E=r[i+f++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=sw(n.check,r,f,i)),a-=f,i+=f,E)break e}else n.head&&(n.head.comment=null);n.mode=o_;case o_:if(512&n.flags){while(u<16){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=T_;break}l=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=l_;break;case a_:while(u<32){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}e.adler=n.check=L_(l),l=0,u=0,n.mode=c_;case c_:if(0===n.havedict)return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=l,n.bits=u,qv;e.adler=n.check=1,n.mode=l_;case l_:if(t===zv||t===$v)break e;case u_:if(n.last){l>>>=7&u,u-=7&u,n.mode=k_;break}while(u<3){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}switch(n.last=1&l,l>>>=1,u-=1,3&l){case 0:n.mode=h_;break;case 1:if(H_(n),n.mode=m_,t===$v){l>>>=2,u-=2;break e}break;case 2:n.mode=p_;break;case 3:e.msg="invalid block type",n.mode=T_}l>>>=2,u-=2;break;case h_:l>>>=7&u,u-=7&u;while(u<32){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if((65535&l)!==(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=T_;break}if(n.length=65535&l,l=0,u=0,n.mode=d_,t===$v)break e;case d_:n.mode=f_;case f_:if(f=n.length,f){if(f>a&&(f=a),f>c&&(f=c),0===f)break e;s.set(r.subarray(i,i+f),o),a-=f,i+=f,c-=f,o+=f,n.length-=f;break}n.mode=l_;break;case p_:while(u<14){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(n.nlen=257+(31&l),l>>>=5,u-=5,n.ndist=1+(31&l),l>>>=5,u-=5,n.ncode=4+(15&l),l>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=T_;break}n.have=0,n.mode=g_;case g_:while(n.have<n.ncode){while(u<3){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}n.lens[R[n.have++]]=7&l,l>>>=3,u-=3}while(n.have<19)n.lens[R[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,A={bits:n.lenbits},S=Mv(Uv,n.lens,0,19,n.lencode,0,n.work,A),n.lenbits=A.bits,S){e.msg="invalid code lengths set",n.mode=T_;break}n.have=0,n.mode=y_;case y_:while(n.have<n.nlen+n.ndist){for(;;){if(k=n.lencode[l&(1<<n.lenbits)-1],y=k>>>24,m=k>>>16&255,w=65535&k,y<=u)break;if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(w<16)l>>>=y,u-=y,n.lens[n.have++]=w;else{if(16===w){T=y+2;while(u<T){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(l>>>=y,u-=y,0===n.have){e.msg="invalid bit length repeat",n.mode=T_;break}E=n.lens[n.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===w){T=y+3;while(u<T){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}l>>>=y,u-=y,E=0,f=3+(7&l),l>>>=3,u-=3}else{T=y+7;while(u<T){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}l>>>=y,u-=y,E=0,f=11+(127&l),l>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=T_;break}while(f--)n.lens[n.have++]=E}}if(n.mode===T_)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=T_;break}if(n.lenbits=9,A={bits:n.lenbits},S=Mv(Fv,n.lens,0,n.nlen,n.lencode,0,n.work,A),n.lenbits=A.bits,S){e.msg="invalid literal/lengths set",n.mode=T_;break}if(n.distbits=6,n.distcode=n.distdyn,A={bits:n.distbits},S=Mv(jv,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,A),n.distbits=A.bits,S){e.msg="invalid distances set",n.mode=T_;break}if(n.mode=m_,t===$v)break e;case m_:n.mode=w_;case w_:if(a>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=l,n.bits=u,Iv(e,d),o=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,l=n.hold,u=n.bits,n.mode===l_&&(n.back=-1);break}for(n.back=0;;){if(k=n.lencode[l&(1<<n.lenbits)-1],y=k>>>24,m=k>>>16&255,w=65535&k,y<=u)break;if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(m&&0===(240&m)){for(b=y,v=m,_=w;;){if(k=n.lencode[_+((l&(1<<b+v)-1)>>b)],y=k>>>24,m=k>>>16&255,w=65535&k,b+y<=u)break;if(0===a)break e;a--,l+=r[i++]<<u,u+=8}l>>>=b,u-=b,n.back+=b}if(l>>>=y,u-=y,n.back+=y,n.length=w,0===m){n.mode=S_;break}if(32&m){n.back=-1,n.mode=l_;break}if(64&m){e.msg="invalid literal/length code",n.mode=T_;break}n.extra=15&m,n.mode=b_;case b_:if(n.extra){T=n.extra;while(u<T){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=v_;case v_:for(;;){if(k=n.distcode[l&(1<<n.distbits)-1],y=k>>>24,m=k>>>16&255,w=65535&k,y<=u)break;if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(0===(240&m)){for(b=y,v=m,_=w;;){if(k=n.distcode[_+((l&(1<<b+v)-1)>>b)],y=k>>>24,m=k>>>16&255,w=65535&k,b+y<=u)break;if(0===a)break e;a--,l+=r[i++]<<u,u+=8}l>>>=b,u-=b,n.back+=b}if(l>>>=y,u-=y,n.back+=y,64&m){e.msg="invalid distance code",n.mode=T_;break}n.offset=w,n.extra=15&m,n.mode=__;case __:if(n.extra){T=n.extra;while(u<T){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=T_;break}n.mode=E_;case E_:if(0===c)break e;if(f=d-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=T_;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=s,p=o-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do{s[o++]=g[p++]}while(--f);0===n.length&&(n.mode=w_);break;case S_:if(0===c)break e;s[o++]=n.length,c--,n.mode=w_;break;case k_:if(n.wrap){while(u<32){if(0===a)break e;a--,l|=r[i++]<<u,u+=8}if(d-=c,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?sw(n.check,s,d,o-d):ew(n.check,s,d,o-d)),d=c,4&n.wrap&&(n.flags?l:L_(l))!==n.check){e.msg="incorrect data check",n.mode=T_;break}l=0,u=0}n.mode=I_;case I_:if(n.wrap&&n.flags){while(u<32){if(0===a)break e;a--,l+=r[i++]<<u,u+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=T_;break}l=0,u=0}n.mode=A_;case A_:S=Hv;break e;case T_:S=Gv;break e;case R_:return Yv;case C_:default:return Wv}return e.next_out=o,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=l,n.bits=u,(n.wsize||d!==e.avail_out&&n.mode<T_&&(n.mode<k_||t!==Vv))&&q_(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,n.total+=d,4&n.wrap&&d&&(e.adler=n.check=n.flags?sw(n.check,s,d,e.next_out-d):ew(n.check,s,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(n.mode===l_?128:0)+(n.mode===m_||n.mode===d_?256:0),(0===h&&0===d||t===Vv)&&S===Kv&&(S=Qv),S},G_=e=>{if(B_(e))return Wv;let t=e.state;return t.window&&(t.window=null),e.state=null,Kv},Y_=(e,t)=>{if(B_(e))return Wv;const n=e.state;return 0===(2&n.wrap)?Wv:(n.head=t,t.done=!1,Kv)},Q_=(e,t)=>{const n=t.length;let r,s,i;return B_(e)?Wv:(r=e.state,0!==r.wrap&&r.mode!==c_?Wv:r.mode===c_&&(s=1,s=ew(s,t,n,0),s!==r.check)?Gv:(i=q_(e,t,n,n),i?(r.mode=R_,Yv):(r.havedict=1,Kv)))};var X_=U_,J_=F_,Z_=M_,eE=V_,tE=j_,nE=W_,rE=G_,sE=Y_,iE=Q_,oE="pako inflate (from Nodeca project)",aE={inflateReset:X_,inflateReset2:J_,inflateResetKeep:Z_,inflateInit:eE,inflateInit2:tE,inflate:nE,inflateEnd:rE,inflateGetHeader:sE,inflateSetDictionary:iE,inflateInfo:oE};function cE(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var lE=cE;const uE=Object.prototype.toString,{Z_NO_FLUSH:hE,Z_FINISH:dE,Z_OK:fE,Z_STREAM_END:pE,Z_NEED_DICT:gE,Z_STREAM_ERROR:yE,Z_DATA_ERROR:mE,Z_MEM_ERROR:wE}=ow;function bE(e){this.options=Wb.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new nv,this.strm.avail_out=0;let n=aE.inflateInit2(this.strm,t.windowBits);if(n!==fE)throw new Error(iw[n]);if(this.header=new lE,aE.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=ev.string2buf(t.dictionary):"[object ArrayBuffer]"===uE.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=aE.inflateSetDictionary(this.strm,t.dictionary),n!==fE)))throw new Error(iw[n])}function vE(e,t){const n=new bE(t);if(n.push(e),n.err)throw n.msg||iw[n.err];return n.result}function _E(e,t){return t=t||{},t.raw=!0,vE(e,t)}bE.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let i,o,a;if(this.ended)return!1;for(o=t===~~t?t:!0===t?dE:hE,"[object ArrayBuffer]"===uE.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=aE.inflate(n,o),i===gE&&s&&(i=aE.inflateSetDictionary(n,s),i===fE?i=aE.inflate(n,o):i===mE&&(i=gE));while(n.avail_in>0&&i===pE&&n.state.wrap>0&&0!==e[n.next_in])aE.inflateReset(n),i=aE.inflate(n,o);switch(i){case yE:case mE:case gE:case wE:return this.onEnd(i),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||i===pE))if("string"===this.options.to){let e=ev.utf8border(n.output,n.next_out),t=n.next_out-e,s=ev.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(s)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==fE||0!==a){if(i===pE)return i=aE.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},bE.prototype.onData=function(e){this.chunks.push(e)},bE.prototype.onEnd=function(e){e===fE&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Wb.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var EE=bE,SE=vE,kE=_E,IE=vE,AE=ow,TE={Inflate:EE,inflate:SE,inflateRaw:kE,ungzip:IE,constants:AE};const{Deflate:RE,deflate:CE,deflateRaw:PE,gzip:NE}=Ev,{Inflate:OE,inflate:DE,inflateRaw:LE,ungzip:xE}=TE;var BE=RE,ME=CE,UE=PE,FE=NE,jE=OE,VE=DE,zE=LE,$E=xE,KE=ow,HE={Deflate:BE,deflate:ME,deflateRaw:UE,gzip:FE,Inflate:jE,inflate:VE,inflateRaw:zE,ungzip:$E,constants:KE};const qE=6;function WE({repo:e,preload:t}){async function*n(n,r={}){if(null!=r.compressionLevel&&(r.compressionLevel<-1||r.compressionLevel>9))throw B(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(!1!==r.preload){let e;try{e=ei(n).split("/")}catch(rb){throw B(rb,"ERR_INVALID_PATH")}t(X.k0.parse(e[0]))}const s=X.k0.asCID(n)||n,i=await ny(s,e.blocks,r);if("file"===i.type||"raw"===i.type){const e=[];return r.compress&&!0!==r.archive?e.push(i.content):e.push([{header:{name:i.path,mode:"file"===i.type&&i.unixfs.mode,mtime:"file"===i.type&&i.unixfs.mtime?new Date(1e3*i.unixfs.mtime.secs):void 0,size:i.size,type:"file"},body:i.content()}],xy()),r.compress&&e.push((async function*(e){const t=await ay(e);yield HE.gzip(t,{level:r.compressionLevel||qE})})),void(yield*dd(...e))}if("directory"!==i.type)throw B(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");{const t=[ry(s,e.blocks,r),async function*(e){for await(const t of e){const e={header:{name:t.path,size:t.size}};if("file"===t.type)e.header.type="file",e.header.mode=null!=t.unixfs.mode?t.unixfs.mode:void 0,e.header.mtime=t.unixfs.mtime?new Date(1e3*t.unixfs.mtime.secs):void 0,e.body=t.content();else if("raw"===t.type)e.header.type="file",e.body=t.content();else{if("directory"!==t.type)throw B(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");e.header.type="directory",e.header.mode=null!=t.unixfs.mode?t.unixfs.mode:void 0,e.header.mtime=t.unixfs.mtime?new Date(1e3*t.unixfs.mtime.secs):void 0}yield e}},xy()];if(r.compress){if(!r.archive)throw B(new Error("file is not regular"),"ERR_INVALID_PATH");r.compress&&t.push((async function*(e){const t=await ay(e);yield HE.gzip(t,{level:r.compressionLevel||qE})}))}yield*dd(...t)}}return qs(n)}function GE({repo:e,preload:t}){async function*n(n,r={}){const s=ei(n),i=s.split("/");!1!==r.preload&&t(X.k0.parse(i[0]));const o=X.k0.asCID(s)||s,a=await ny(o,e.blocks,r);if("file"!==a.type){if("directory"!==a.type)throw B(new Error(`Unknown UnixFS type ${a.type}`),"ERR_UNKNOWN_UNIXFS_TYPE");for await(const e of a.content())yield ni(e)}else yield ni(a)}return qs(n)}class YE{constructor({preload:e,repo:t,hashers:n,options:r}){const s=yg({preload:e,repo:t,options:r,hashers:n});this.addAll=s,this.add=jf({addAll:s}),this.cat=sy({repo:t,preload:e}),this.get=WE({repo:t,preload:e}),this.ls=GE({repo:t,preload:e})}}const QE="0.18.0",XE="",JE="^0.158.0";function ZE({repo:e}){async function t(t={}){const n=await e.version.get();return{version:QE,commit:XE,repo:`${n}`,"ipfs-core":QE,"interface-ipfs-core":JE}}return qs(t)}const eS=x("ipfs:components:id");function tS({peerId:e,network:t}){async function n(n={}){const r=t.try();if(!r){if(n.peerId)throw new pn;if(null==e.publicKey)throw B(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:e,publicKey:Fn(e.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${QE}`,protocolVersion:"9000",protocols:[]}}const{libp2p:s}=r,i=n.peerId?n.peerId:e,o=await nS(i,s,n),a=Fn(o.metadata.get("AgentVersion")||new Uint8Array),c=Fn(o.metadata.get("ProtocolVersion")||new Uint8Array),l=o.id.toString(),u=o.publicKey?Fn(o.publicKey,"base64pad"):"";return{id:i,publicKey:u,addresses:(o.addresses||[]).map((e=>{const t=e.toString();return t.endsWith(`/p2p/${l}`)?t:`${t}/p2p/${l}`})).sort().map((e=>Hr(e))),agentVersion:a,protocolVersion:c,protocols:(o.protocols||[]).sort()}}return qs(n)}async function nS(e,t,n){let r=await t.peerStore.get(e);r||(r=await rS(e,t,n));let s=e.publicKey?e.publicKey:await t.peerStore.keyBook.get(e);if(null==s)try{s=await t.getPublicKey(e,n)}catch(rb){eS.error("Could not load public key for",e.toString(),rb)}return{...r,publicKey:s,metadata:r.metadata||new Map,addresses:r.addresses.map((e=>e.multiaddr))}}async function rS(e,t,n){if(null==t.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(const s of t.dht.findPeer(e,n))if("FINAL_PEER"===s.name)break;const r=await t.peerStore.get(e);if(!r)throw B(new Error("Could not find peer"),"ERR_NOT_FOUND");return r}var sS=iS;function iS(e,t,n){var r,s,i;if(Array.isArray(t)&&(r=t.slice(0)),"string"==typeof t&&(r=t.split(".")),"symbol"==typeof t&&(r=[t]),!Array.isArray(r))throw new Error("props arg must be an array, a string or a symbol");if(s=r.pop(),!s)return!1;oS(s);while(i=r.shift())if(oS(i),"undefined"==typeof e[i]&&(e[i]={}),e=e[i],!e||"object"!=typeof e)return!1;return e[s]=n,!0}function oS(e){if("__proto__"==e||"constructor"==e||"prototype"==e)throw new Error("setting of prototype values not supported")}const aS={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:e=>(sS(e,"Discovery.MDNS.Enabled",!1),sS(e,"Discovery.webRTCStar.Enabled",!1),e.Swarm={...e.Swarm||{},DisableNatPortMap:!0},e)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:e=>(sS(e,"Discovery.MDNS.Enabled",!0),sS(e,"Discovery.webRTCStar.Enabled",!0),sS(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:e=>{const t=df();return sS(e,"Addresses.API",t.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),sS(e,"Addresses.Gateway",t.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),sS(e,"Addresses.Swarm",t.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),sS(e,"Addresses.Delegates",[]),sS(e,"Bootstrap",[]),sS(e,"Discovery.MDNS.Enabled",!1),sS(e,"Discovery.webRTCStar.Enabled",!1),sS(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!0}),e}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:e=>{const t=df();return sS(e,"Addresses.API",t.Addresses.API),sS(e,"Addresses.Gateway",t.Addresses.Gateway),sS(e,"Addresses.Swarm",t.Addresses.Swarm),sS(e,"Addresses.Delegates",t.Addresses.Delegates),sS(e,"Bootstrap",t.Bootstrap),sS(e,"Discovery.MDNS.Enabled",t.Discovery.MDNS.Enabled),sS(e,"Discovery.webRTCStar.Enabled",t.Discovery.webRTCStar.Enabled),sS(e,"Swarm",{...e.Swarm||{},DisableNatPortMap:!1}),e}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:e=>{const t=e.Swarm||{},n=t.ConnMgr||{};return n.LowWater=20,n.HighWater=40,t.ConnMgr=n,e.Swarm=t,e}},"default-power":{description:'Inverse of "lowpower" profile.',transform:e=>{const t=df();return e.Swarm=t.Swarm,e}}},cS=x("ipfs:core:config");function lS({repo:e}){return{getAll:qs(t),get:qs(n),set:qs(r),replace:qs(s),profiles:{apply:qs(i),list:qs(uS)}};async function t(t={}){return e.config.getAll(t)}async function n(t,n){return t?e.config.get(t,n):Promise.reject(new Error("key argument is required"))}async function r(t,n,r){return e.config.set(t,n,r)}async function s(t,n){return e.config.replace(t,n)}async function i(t,n={dryRun:!1}){const{dryRun:r}=n,s=aS[t];if(!s)throw new Error(`No profile with name '${t}' exists`);try{const t=await e.config.getAll(n);let i=JSON.parse(JSON.stringify(t));return i=s.transform(i),r||await e.config.replace(i,n),delete t.Identity.PrivKey,delete i.Identity.PrivKey,{original:t,updated:i}}catch(rb){throw cS(rb),new Error(`Could not apply profile '${t}' to config: ${rb.message}`)}}}async function uS(e){return Object.keys(aS).map((e=>({name:e,description:aS[e].description})))}function hS({enumerable:e=!0,configurable:t=!1}={}){return{enumerable:e,configurable:t,writable:!1}}function*dS(e,t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))for(const[n,r]of t.entries()){const t=[...e,n],s=Pe.k0.asCID(r);s?yield[t.join("/"),s]:"object"===typeof r&&(yield*fS(r,t))}else{const n=Pe.k0.asCID(t);n?yield[e.join("/"),n]:yield*fS(t,e)}}function*fS(e,t){if(null==e||e instanceof Uint8Array)return;const n=Pe.k0.asCID(e);n&&(yield[t.join("/"),n]);for(const[r,s]of Object.entries(e)){const e=[...t,r];yield*dS(e,s)}}function*pS(e,t){if(Array.isArray(t))for(const[n,r]of t.entries()){const t=[...e,n];yield t.join("/"),"object"!==typeof r||Pe.k0.asCID(r)||(yield*gS(r,t))}else yield*gS(t,e)}function*gS(e,t){if(null!=e&&"object"===typeof e)for(const[n,r]of Object.entries(e)){const e=[...t,n];yield e.join("/"),null==r||r instanceof Uint8Array||"object"!==typeof r||Pe.k0.asCID(r)||(yield*pS(e,r))}}function yS(e,t){let n=e;for(const[r,s]of t.entries()){if(n=n[s],null==n)throw new Error(`Object has no property at ${t.slice(0,r+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const e=Pe.k0.asCID(n);if(e)return{value:e,remaining:t.slice(r+1).join("/")}}return{value:n}}class mS{constructor({cid:e,bytes:t,value:n}){if(!e||!t||"undefined"===typeof n)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:hS(),bytes:hS(),value:hS(),asBlock:hS()})}links(){return fS(this.value,[])}tree(){return gS(this.value,[])}get(e="/"){return yS(this.value,e.split("/").filter(Boolean))}}function wS({bytes:e,cid:t,value:n,codec:r}){const s=void 0!==n?n:r&&r.decode(e);if(void 0===s)throw new Error('Missing required argument, must either provide "value" or "codec"');return new mS({cid:t,bytes:e,value:s})}function bS(e){const t=(0,Ce.encode)({version:1,roots:e}),n=Qn.encode(t.length),r=new Uint8Array(n.length+t.length);return r.set(n,0),r.set(t,n.length),r}function vS(e){return{async setRoots(t){const n=bS(t);await e.write(n)},async writeBlock(t){const{cid:n,bytes:r}=t;await e.write(new Uint8Array(Qn.encode(n.bytes.length+r.length))),await e.write(n.bytes),r.length&&await e.write(r)},async close(){await e.end()}}}function _S(){}function ES(){const e=[];let t=null,n=_S,r=!1,s=null,i=_S;const o=()=>(t||(t=new Promise((e=>{n=()=>{t=null,n=_S,e()}}))),t),a={write(t){e.push(t);const n=o();return i(),n},async end(){r=!0;const e=o();i(),await e}},c={async next(){const t=e.shift();return t?(0===e.length&&n(),{done:!1,value:t}):r?(n(),{done:!0,value:void 0}):(s||(s=new Promise((e=>{i=()=>(s=null,i=_S,e(c.next()))}))),s)}};return{writer:a,iterator:c}}const SS={Null:e=>null===e,Int:e=>Number.isInteger(e),Float:e=>"number"===typeof e&&Number.isFinite(e),String:e=>"string"===typeof e,Bool:e=>"boolean"===typeof e,Bytes:e=>e instanceof Uint8Array,Link:e=>!SS.Null(e)&&"object"===typeof e&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!SS.Null(e)&&"object"===typeof e&&e.asCID!==e&&!SS.List(e)&&!SS.Bytes(e)},kS={Int:SS.Int,"CarHeader > version":e=>kS.Int(e),"CarHeader > roots (anon) > valueType (anon)":SS.Link,"CarHeader > roots (anon)":e=>SS.List(e)&&Array.prototype.every.call(e,kS["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>kS["CarHeader > roots (anon)"](e),CarHeader:e=>{const t=e&&Object.keys(e);return SS.Map(e)&&["version"].every((e=>t.includes(e)))&&Object.entries(e).every((([e,t])=>kS["CarHeader > "+e]&&kS["CarHeader > "+e](t)))}},IS=kS.CarHeader,AS={SHA2_256:18,LENGTH:32,DAG_PB:112},TS=40;function RS(e,t){if(!e.length)throw new Error("Unexpected end of data");const n=Qn.decode(e);return t.seek(Qn.decode.bytes),n}function CS(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);let n=0;const r={version:2,characteristics:[t.getBigUint64(n,!0),t.getBigUint64(n+=8,!0)],dataOffset:Number(t.getBigUint64(n+=8,!0)),dataSize:Number(t.getBigUint64(n+=8,!0)),indexOffset:Number(t.getBigUint64(n+=8,!0))};return r}function PS(e){Qn.decode(e);const t=Qn.decode.bytes,n=Qn.decode(e.subarray(Qn.decode.bytes)),r=Qn.decode.bytes,s=t+r+n;return s}async function NS(e,t){const n=RS(await e.upTo(8),e);if(0===n)throw new Error("Invalid CAR header (zero length)");const r=await e.exactly(n,!0),s=(0,Ce.decode)(r);if(!IS(s))throw new Error("Invalid CAR header format");if(1!==s.version&&2!==s.version||void 0!==t&&s.version!==t)throw new Error(`Invalid CAR version: ${s.version}${void 0!==t?` (expected ${t})`:""}`);const i=Array.isArray(s.roots);if(1===s.version&&!i||2===s.version&&i)throw new Error("Invalid CAR header format");if(1===s.version)return s;const o=CS(await e.exactly(TS,!0));e.seek(o.dataOffset-e.pos);const a=await NS(e,1);return Object.assign(a,o)}async function OS(e){const t=await e.exactly(2,!1);if(t[0]===AS.SHA2_256&&t[1]===AS.LENGTH){const t=await e.exactly(34,!0),n=At.Jx(t);return X.k0.create(0,AS.DAG_PB,n)}const n=RS(await e.upTo(8),e);if(1!==n)throw new Error(`Unexpected CID version (${n})`);const r=RS(await e.upTo(8),e),s=await e.exactly(PS(await e.upTo(8)),!0),i=At.Jx(s);return X.k0.create(n,r,i)}async function DS(e){const t=e.pos;let n=RS(await e.upTo(8),e);if(0===n)throw new Error("Invalid CAR section (zero length)");n+=e.pos-t;const r=await OS(e),s=n-Number(e.pos-t);return{cid:r,length:n,blockLength:s}}async function LS(e){const{cid:t,blockLength:n}=await DS(e),r=await e.exactly(n,!0);return{bytes:r,cid:t}}async function xS(e){const t=e.pos,{cid:n,length:r,blockLength:s}=await DS(e),i={cid:n,length:r,blockLength:s,offset:t,blockOffset:e.pos};return e.seek(i.blockLength),i}function BS(e){const t=(async()=>{const t=await NS(e);if(2===t.version){const n=e.pos-t.dataOffset;e=jS(e,t.dataSize-n)}return t})();return{header:()=>t,async*blocks(){await t;while((await e.upTo(8)).length>0)yield await LS(e)},async*blocksIndex(){await t;while((await e.upTo(8)).length>0)yield await xS(e)}}}function MS(e){let t=0;return{async upTo(n){const r=e.subarray(t,t+Math.min(n,e.length-t));return r},async exactly(n,r=!1){if(n>e.length-t)throw new Error("Unexpected end of data");const s=e.subarray(t,t+n);return r&&(t+=n),s},seek(e){t+=e},get pos(){return t}}}function US(e){let t=0,n=0,r=0,s=new Uint8Array(0);const i=async t=>{n=s.length-r;const i=[s.subarray(r)];while(n<t){const t=await e();if(null==t)break;n<0?t.length>n&&i.push(t.subarray(-n)):i.push(t),n+=t.length}s=new Uint8Array(i.reduce(((e,t)=>e+t.length),0));let o=0;for(const e of i)s.set(e,o),o+=e.length;r=0};return{async upTo(e){return s.length-r<e&&await i(e),s.subarray(r,r+Math.min(s.length-r,e))},async exactly(e,n=!1){if(s.length-r<e&&await i(e),s.length-r<e)throw new Error("Unexpected end of data");const o=s.subarray(r,r+e);return n&&(t+=e,r+=e),o},seek(e){t+=e,r+=e},get pos(){return t}}}function FS(e){const t=e[Symbol.asyncIterator]();async function n(){const e=await t.next();return e.done?null:e.value}return US(n)}function jS(e,t){let n=0;return{async upTo(r){let s=await e.upTo(r);return s.length+n>t&&(s=s.subarray(0,t-n)),s},async exactly(r,s=!1){const i=await e.exactly(r,s);if(i.length+n>t)throw new Error("Unexpected end of data");return s&&(n+=r),i},seek(t){n+=t,e.seek(t)},get pos(){return e.pos}}}class VS{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const t=X.k0.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then((()=>this._encoder.writeBlock({cid:t,bytes:e.bytes}))),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=KS(e);const{encoder:t,iterator:n}=$S(),r=new VS(e,t),s=new zS(n);return{writer:r,out:s}}static createAppender(){const{encoder:e,iterator:t}=$S();e.setRoots=()=>Promise.resolve();const n=new VS([],e),r=new zS(t);return{writer:n,out:r}}static async updateRootsInBytes(e,t){const n=MS(e);await NS(n);const r=bS(t);if(Number(n.pos)!==r.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${n.pos} bytes, new header is ${r.length} bytes)`);return e.set(r,0),e}}class zS{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function $S(){const e=ES(),{writer:t,iterator:n}=e,r=vS(t);return{encoder:r,iterator:n}}function KS(e){if(void 0===e)return[];if(!Array.isArray(e)){const t=X.k0.asCID(e);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}const t=[];for(const n of e){const e=X.k0.asCID(n);if(!e)throw new TypeError("roots must be a single CID or an array of CIDs");t.push(e)}return t}const HS=async({cid:e,load:t,seen:n})=>{n=n||new Set;const r=e.toString(R.base58btc);if(n.has(r))return;const s=await t(e);if(n.add(r),null!==s)for(const[,i]of s.links())await HS({cid:i,load:t,seen:n})},qS=x("ipfs:components:dag:import"),WS=[Xt,rn];function GS({repo:e,preload:t,codecs:n}){async function*r(r,s={}){!1!==s.preload&&t(r);const i=X.k0.asCID(r);if(!i)throw new Error(`Unexpected error converting CID type: ${r}`);qS(`Exporting ${i} as car`);const{writer:o,out:a}=await VS.create([i]);let c=null;(async()=>{try{const t=YS(e,o,{signal:s.signal,timeout:s.timeout},n);await HS({cid:i,load:t})}catch(t){c=t}finally{o.close()}})();for await(const e of a){if(c)break;yield e}if(c)throw c}return qs(r)}function YS(e,t,n,r){return async s=>{const i=await r.getCodec(s.code);if(!i)throw new Error(`Can't decode links in block with codec 0x${s.code.toString(16)} to form complete DAG`);const o=await e.blocks.get(s,n);return qS(`Adding block ${s} to car`),await t.put({cid:s,bytes:o}),WS.includes(s.code)?null:wS({bytes:o,cid:s,codec:i})}}async function QS(e){for await(const t of e)return t}function XS({codecs:e,repo:t,preload:n}){const r=async function(r,s={}){if(!1!==s.preload&&n(r),s.path){const n=s.localResolve?await QS(si(r,s.path,e,t,s)):await To(si(r,s.path,e,t,s)),i=n;if(!i)throw B(new Error("Not found"),"ERR_NOT_FOUND");return i}const i=await e.getCodec(r.code),o=await t.blocks.get(r,s),a=i.decode(o);return{value:a,remainderPath:""}};return qs(r)}class JS{constructor(e,t,n){this._version=e,this._roots=t,this._iterable=n,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}}class ZS extends JS{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){const{version:t,roots:n,iterator:r}=await tk(e);return new ZS(t,n,r)}static async fromIterable(e){const{version:t,roots:n,iterator:r}=await nk(e);return new ZS(t,n,r)}}class ek extends(null){[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;const e=this._iterable[Symbol.asyncIterator]();return{async next(){const t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){const{version:t,roots:n,iterator:r}=await tk(e);return new ek(t,n,r)}static async fromIterable(e){const{version:t,roots:n,iterator:r}=await nk(e);return new ek(t,n,r)}}async function tk(e){if(!(e instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return rk(MS(e))}async function nk(e){if(!e||"function"!==typeof e[Symbol.asyncIterator])throw new TypeError("fromIterable() requires an async iterable");return rk(FS(e))}async function rk(e){const t=BS(e),{version:n,roots:r}=await t.header();return{version:n,roots:r,iterator:t.blocks()}}const sk=x("ipfs:components:dag:import");function ik({repo:e}){async function*t(t,n={}){const r=await e.gcLock.readLock();try{const s={signal:n.signal,timeout:n.timeout},i=Cf(t),{value:o,done:a}=await i.peek();if(a)return;let c;o&&i.push(o),c=o instanceof Uint8Array?[i]:i;for await(const t of c){const r=await ok(e,s,t);if(!1!==n.pinRoots)for(const t of r){let n="";try{await e.blocks.has(t)?(sk(`Pinning root ${t}`),await e.pins.pinRecursively(t)):n="blockstore: block not found"}catch(rb){n=rb.message}yield{root:{cid:t,pinErrorMsg:n}}}}}finally{r()}}return qs(t)}async function ok(e,t,n){const r=await ZS.fromIterable(n),s=await r.getRoots();return await Hh(e.blocks.putMany(_f(r,(({cid:e,bytes:t})=>(sk(`Import block ${e}`),{key:e,value:t}))),{signal:t.signal})),s}function ak({repo:e,codecs:t,hashers:n,preload:r}){async function s(s,i={}){const o=i.pin?await e.gcLock.readLock():null;try{const a=await t.getCodec(i.storeCodec||"dag-cbor");if(!a)throw new Error(`Unknown storeCodec ${i.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(i.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");const e=await t.getCodec(i.inputCodec);if(!e)throw new Error(`Unknown inputCodec ${i.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);s=e.decode(s)}const c=null!=i.version?i.version:1,l=await n.getHasher(i.hashAlg||"sha2-256");if(!l)throw new Error(`Unknown hash algorithm ${i.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);const u=a.encode(s),h=await l.digest(u),d=X.k0.create(c,a.code,h);return await e.blocks.put(d,u,{signal:i.signal}),i.pin&&await e.pins.pinRecursively(d),!1!==i.preload&&r(d),d}finally{o&&o()}}return qs(s)}function ck({repo:e,codecs:t,preload:n}){async function r(r,s={}){const{cid:i}=Gs(r);return!1!==s.preload&&n(i),ti(e,t,r,s)}return qs(r)}class lk{constructor({repo:e,codecs:t,hashers:n,preload:r}){this.export=GS({repo:e,preload:r,codecs:t}),this.get=XS({codecs:t,repo:e,preload:r}),this.import=ik({repo:e}),this.resolve=ck({repo:e,codecs:t,preload:r}),this.put=ak({repo:e,codecs:t,hashers:n,preload:r})}}const uk=(e,t)=>t,hk=(e,t,n,r)=>{if(null!=r&&!1===r.assumeHttp)return`tcp://${e}:${t}`;let s="tcp",i=`:${t}`;const o=n[n.length-1];return"tcp"===o.protocol&&(s="443"===t?"https":"http",i="443"===t||"80"===t?"":i),`${s}://${e}${i}`},dk={ip4:uk,ip6:(e,t,n,r)=>1===r.length&&"ip6"===r[0].protocol?t:`[${t}]`,tcp:(e,t,n,r,s)=>r.some((e=>["http","https","ws","wss"].includes(e.protocol)))?`${e}:${t}`:hk(e,t,r,s),udp:(e,t)=>`udp://${e}:${t}`,dnsaddr:uk,dns4:uk,dns6:uk,ipfs:(e,t)=>`${e}/ipfs/${t}`,p2p:(e,t)=>`${e}/p2p/${t}`,http:e=>`http://${e}`,https:e=>`https://${e}`,ws:e=>`ws://${e}`,wss:e=>`wss://${e}`,"p2p-websocket-star":e=>`${e}/p2p-websocket-star`,"p2p-webrtc-star":e=>`${e}/p2p-webrtc-star`,"p2p-webrtc-direct":e=>`${e}/p2p-webrtc-direct`};function fk(e,t){const n=Hr(e),r=n.toString().split("/").slice(1);return n.tuples().map((e=>({protocol:r.shift()??"",content:null!=e[1]?r.shift()??"":""}))).reduce(((e,n,r,s)=>{const i=dk[n.protocol];if(null==i)throw new Error(`Unsupported protocol ${n.protocol}`);return i(e,n.content,r,s,t)}),"")}function pk(e){if(!Array.isArray(e))throw new TypeError("Expected an array, got "+typeof e);e=[...e];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}const gk=x("ipfs:preload"),yk=Yi["default"]?Yi["default"]:Yi,mk=new yk({concurrency:4});function wk(e,t={}){return gk(e),mk.add((async()=>{const n=await Qi.post(e,{signal:t.signal}),r=n.body.getReader();try{while(1){const{done:e}=await r.read();if(e)return}}finally{r.releaseLock()}}))}const bk=x("ipfs:preload");function vk(e={}){if(e.enabled=Boolean(e.enabled),e.addresses=e.addresses||[],e.cache=e.cache||1e3,!e.enabled||!e.addresses.length){bk("preload disabled");const e=()=>{};return Object.assign(e,{start:()=>{},stop:()=>{}})}let t=!0,n=[];const r=e.addresses.map((e=>fk(e))),s=ci(e.cache),i=async e=>{try{if(t)throw new Error(`preload ${e} but preloader is not started`);const i=e.toString();if(s.has(i))return;s.set(i,!0);const o=pk(r);let a=!1;const c=Date.now();for(const e of o){if(t)throw new Error(`preload aborted for ${i}`);let r;try{r=new AbortController,n=n.concat(r),await wk(`${e}/api/v0/refs?r=true&arg=${encodeURIComponent(i)}`,{signal:r.signal}),a=!0}catch(rb){"aborted"!==rb.type&&bk.error(rb)}finally{n=n.filter((e=>e!==r))}if(a)break}bk(`${a?"":"un"}successfully preloaded ${i} in ${Date.now()-c}ms`)}catch(rb){bk.error(rb)}};return i.start=()=>{t=!1},i.stop=()=>{t=!0,bk(`aborting ${n.length} pending preload request(s)`),n.forEach((e=>e.abort())),n=[]},i}const _k=x("ipfs:mfs-preload");function Ek({preload:e,files:t,options:n={}}){if(n.interval=n.interval||3e4,!n.enabled){_k("MFS preload disabled");const e=async()=>{};return{start:e,stop:e}}let r,s="";const i=async()=>{try{const o=await t.stat("/"),a=o.cid.toString();s!==a&&(_k(`preloading updated MFS root ${s} -> ${o.cid}`),await e(o.cid),s=a)}catch(rb){_k.error("failed to preload MFS root",rb)}finally{r=setTimeout(i,n.interval)}};return{async start(){const e=await t.stat("/");s=e.cid.toString(),_k(`monitoring MFS root ${e.cid}`),r=setTimeout(i,n.interval)},stop(){clearTimeout(r)}}}class Sk extends Error{constructor(e){super(e),this.name="TimeoutError"}}class kk extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Ik=e=>void 0===globalThis.DOMException?new kk(e):new DOMException(e),Ak=e=>{const t=void 0===e.reason?Ik("This operation was aborted."):e.reason;return t instanceof Error?t:Ik(t)};function Tk(e,t){const{milliseconds:n,fallback:r,message:s,customTimers:i={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let o;const a=new Promise(((a,c)=>{if("number"!==typeof n||1!==Math.sign(n))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(n===Number.POSITIVE_INFINITY)return void a(e);if(t.signal){const{signal:e}=t;e.aborted&&c(Ak(e)),e.addEventListener("abort",(()=>{c(Ak(e))}))}const l=new Sk;o=i.setTimeout.call(void 0,(()=>{if(r)try{a(r())}catch(t){c(t)}else"function"===typeof e.cancel&&e.cancel(),!1===s?a():s instanceof Error?c(s):(l.message=s??`Promise timed out after ${n} milliseconds`,c(l))}),n),(async()=>{try{a(await e)}catch(t){c(t)}finally{i.clearTimeout.call(void 0,o)}})()}));return a.clear=()=>{i.clearTimeout.call(void 0,o),o=void 0},a}let Rk=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>(t&=63,e+=t<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_",e)),"");const Ck="lock:worker:request-read",Pk="lock:worker:release-read",Nk="lock:master:grant-read",Ok="lock:worker:request-write",Dk="lock:worker:release-write",Lk="lock:master:grant-write",xk={},Bk=e=>{e.addEventListener("message",(t=>{Bk.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{Bk.dispatchEvent("message",e,t)}))};Bk.addEventListener=(e,t)=>{null==xk[e]&&(xk[e]=[]),xk[e].push(t)},Bk.removeEventListener=(e,t)=>{null!=xk[e]&&(xk[e]=xk[e].filter((e=>e===t)))},Bk.dispatchEvent=function(e,t,n){null!=xk[e]&&xk[e].forEach((e=>e(t,n)))};var Mk=Bk;const Uk=(e,t,n,r,s)=>(i,o)=>{if(o.data.type!==n)return;const a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>(i.postMessage({type:s,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=n=>{if(null==n||null==n.data)return;const s={type:n.data.type,name:n.data.name,identifier:n.data.identifier};s.type===r&&s.identifier===a.identifier&&(i.removeEventListener("message",t),e())};i.addEventListener("message",t)})))}}))},Fk=(e,t,n,r)=>async()=>{const s=Rk();return globalThis.postMessage({type:t,identifier:s,name:e}),await new Promise((t=>{const i=o=>{if(null==o||null==o.data)return;const a={type:o.data.type,identifier:o.data.identifier};a.type===n&&a.identifier===s&&(globalThis.removeEventListener("message",i),t((()=>{globalThis.postMessage({type:r,identifier:s,name:e})})))};globalThis.addEventListener("message",i)}))},jk={singleProcess:!1};var Vk=e=>{e=Object.assign({},jk,e);const t=Boolean(globalThis.document)||e.singleProcess;if(t){const e=new EventTarget;return Mk.addEventListener("message",Uk(e,"requestReadLock",Ck,Pk,Nk)),Mk.addEventListener("message",Uk(e,"requestWriteLock",Ok,Dk,Lk)),e}return{isWorker:!0,readLock:e=>Fk(e,Ck,Nk,Pk),writeLock:e=>Fk(e,Ok,Lk,Dk)}};const zk={};let $k;async function Kk(e,t){let n;const r=new Promise((e=>{n=e}));return e.add((async()=>await Tk((async()=>await new Promise((e=>{n((()=>{e()}))})))(),{milliseconds:t.timeout}))),await r}const Hk=(e,t)=>{if(!0===$k.isWorker)return{readLock:$k.readLock(e,t),writeLock:$k.writeLock(e,t)};const n=new Yi({concurrency:1});let r;return{async readLock(){if(null!=r)return await Kk(r,t);r=new Yi({concurrency:t.concurrency,autoStart:!1});const e=r,s=Kk(r,t);return n.add((async()=>(e.start(),await e.onIdle().then((()=>{r===e&&(r=null)}))))),await s},async writeLock(){return r=null,await Kk(n,t)}}},qk={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Wk(e){const t=Object.assign({},qk,e);return null==$k&&($k=Vk(t),!0!==$k.isWorker&&($k.addEventListener("requestReadLock",(e=>{null!=zk[e.data.name]&&zk[e.data.name].readLock().then((async t=>await e.data.handler().finally((()=>t()))))})),$k.addEventListener("requestWriteLock",(async e=>{null!=zk[e.data.name]&&zk[e.data.name].writeLock().then((async t=>await e.data.handler().finally((()=>t()))))})))),null==zk[t.name]&&(zk[t.name]=Hk(t.name,t)),zk[t.name]}let Gk;function Yk(e=!1){if(Gk)return Gk;const t=Wk({singleProcess:e});return Gk={readLock:e=>async(...n)=>{const r=await t.readLock();try{return await e.apply(null,n)}finally{r()}},writeLock:e=>async(...n)=>{const r=await t.writeLock();try{return await e.apply(null,n)}finally{r()}}},Gk}const Qk=x("ipfs:mfs:utils:with-mfs-root");async function Xk(e,t){if(t&&t.signal&&t.signal.aborted)throw B(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});let n;await e.repo.datastore.open();try{const t=await e.repo.datastore.get(Xs);n=X.k0.decode(t)}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb;Qk("Creating new MFS root");const s=Te({Data:new Q({type:"directory"}).marshal(),Links:[]}),i=await Gt.digest(s);if(n=X.k0.createV0(i),await e.repo.blocks.put(n,s),t&&t.signal&&t.signal.aborted)throw B(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await e.repo.datastore.put(Xs,n.bytes)}return Qk(`Loaded MFS root /ipfs/${n}`),n}function Jk(e=""){return(e.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}const Zk="ipfs",eI=async(e,t,n)=>{const r=await Xk(e,n);let s={entryType:"file"},i="";if(i=X.k0.asCID(t)?`/ipfs/${t}`:t.toString(),i=i.trim(),i=i.replace(/(\/\/+)/g,"/"),i.endsWith("/")&&i.length>1&&(i=i.substring(0,i.length-1)),!i)throw B(new Error("paths must not be empty"),"ERR_NO_PATH");if("/"!==i.substring(0,1))throw B(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");"/"===i.substring(i.length-1)&&(i=i.substring(0,i.length-1));const o=Jk(i);if(o[0]===Zk){let e;e=2===o.length?`/${o.join("/")}`:`/${o.slice(0,o.length-1).join("/")}`,s={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:e,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{const e=`/${Zk}/${r}${o.length?"/"+o.join("/"):""}`,t=`/${Zk}/${r}/${o.slice(0,o.length-1).join("/")}`;s={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:t,mfsPath:e,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}const a="mfs"===s.type?s.mfsPath:s.path;try{const t=await ny(a,e.repo.blocks,n);s.cid=t.cid,s.mfsPath=`/ipfs/${t.path}`,s.entryType=t.type,s.content=t.content,"file"!==s.entryType&&"directory"!==s.entryType||"file"!==t.type&&"directory"!==t.type||(s.unixfs=t.unixfs)}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}return s.exists=Boolean(s.cid),s},tI=I.bind({ignoreUndefined:!0}),nI=x("ipfs:mfs:stat"),rI={withLocal:!1};function sI(e){async function t(t,n={}){n=tI(rI,n),nI(`Fetching stats for ${t}`);const{type:r,cid:s,mfsPath:i}=await eI(e,t,n),o="ipfs"===r&&s?s:i;let a;try{a=await ny(o,e.repo.blocks)}catch(rb){if("ERR_NOT_FOUND"===rb.code)throw B(new Error(`${t} does not exist`),"ERR_NOT_FOUND");throw rb}if(!iI[a.type])throw new Error(`Cannot stat codec ${a.cid.code}`);return iI[a.type](a)}return qs(t)}const iI={raw:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:e=>{const t={cid:e.cid,type:"file",size:e.unixfs.fileSize(),cumulativeSize:Te(e.node).length+(e.node.Links||[]).reduce(((e,t)=>e+(t.Tsize||0)),0),blocks:e.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},directory:e=>{const t={cid:e.cid,type:"directory",size:0,cumulativeSize:Te(e.node).length+(e.node.Links||[]).reduce(((e,t)=>e+(t.Tsize||0)),0),blocks:e.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:e.unixfs.mode};return e.unixfs.mtime&&(t.mtime=e.unixfs.mtime),t},object:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:e=>({cid:e.cid,size:e.node.length,cumulativeSize:e.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})},oI=x("ipfs:mfs:utils:to-trail");async function aI(e,t){oI(`Creating trail for path ${t}`);const n=[];for await(const r of ty(t,e.repo.blocks))n.push({name:r.name,cid:r.cid,size:r.size,type:r.type});return n}const cI=async(e,t,n)=>{n.codec||(n.codec=s),n.hasher||(n.hasher=Gt),void 0===n.cidVersion&&(n.cidVersion=1),n.codec===s&&n.hasher!==Gt&&(n.cidVersion=1);const r=await n.hasher.digest(e),i=X.k0.create(n.cidVersion,n.codec.code,r);return n.onlyHash||await t.put(i,e,{signal:n.signal}),i},lI=Hf.code,uI=8;async function hI(e){return(await Hf.encode(e)).subarray(0,8).reverse()}class dI{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}}class fI extends dI{constructor(e,t){super(e,t),this._bucket=Yp({hashFn:hI,bits:uI})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*pI(this._bucket,e,this,this.options)}}async function*pI(e,t,n,r){const s=e._children,i=[];let o=0;for(let f=0;f<s.length;f++){const e=s.get(f);if(!e)continue;const n=f.toString(16).toUpperCase().padStart(2,"0");if(e instanceof Mp){let s;for await(const n of await pI(e,t,null,r))s=n;if(!s)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:n,Tsize:s.size,Hash:s.cid}),o+=s.size}else if("function"===typeof e.value.flush){const r=e.value;let s;for await(const e of r.flush(t))s=e,yield s;const a=n+e.key;i.push({Name:a,Tsize:s.size,Hash:s.cid}),o+=s.size}else{const t=e.value;if(!t.cid)continue;const r=n+e.key,s=t.size;i.push({Name:r,Tsize:s,Hash:t.cid}),o+=s}}const a=Uint8Array.from(s.bitField().reverse()),c=new Q({type:"hamt-sharded-directory",data:a,fanout:e.tableSize(),hashType:lI,mtime:n&&n.mtime,mode:n&&n.mode}),l={Data:c.marshal(),Links:i},u=Te(_e(l)),h=await cI(u,t,r),d=u.length+o;yield{cid:h,node:l,size:d}}const gI=x("ipfs:mfs:core:utils:hamt-utils"),yI=async(e,t,n,r)=>{if(!r.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");const s=Uint8Array.from(n._children.bitField().reverse()),i=Q.unmarshal(r.parent.Data),o=new Q({type:"hamt-sharded-directory",data:s,fanout:n.tableSize(),hashType:lI,mode:i.mode,mtime:i.mtime}),a=await e.hashers.getHasher(r.hashAlg),c={Data:o.marshal(),Links:t.sort(((e,t)=>(e.Name||"").localeCompare(t.Name||"")))},l=Te(c),u=await a.digest(l),h=X.k0.create(r.cidVersion,Ae,u);return r.flush&&await e.repo.blocks.put(h,l),{node:c,cid:h,size:t.reduce(((e,t)=>e+(t.Tsize||0)),l.length)}},mI=async(e,t,n,r,s)=>{const i=new Mp({hash:n._options.hash,bits:n._options.bits},r,s);return r._putObjectAt(s,i),await bI(e,t,i,n),i},wI=async e=>{const t=Yp({hashFn:hI,bits:uI});return await Promise.all(e.map((async e=>{const n=e.Name||"";if(2===n.length){const e=parseInt(n,16),r=new Mp({hash:t._options.hash,bits:t._options.bits},t,e);return t._putObjectAt(e,r),Promise.resolve()}return t.put(n.substring(2),{size:e.Tsize,cid:e.Hash})}))),t},bI=async(e,t,n,r)=>{await Promise.all(t.map((async t=>{const s=t.Name||"";if(2===s.length){gI("Populating sub bucket",s);const i=parseInt(s,16),o=await e.repo.blocks.get(t.Hash),a=Re(o),c=new Mp({hash:r._options.hash,bits:r._options.bits},n,i);return n._putObjectAt(i,c),await bI(e,a.Links,c,r),Promise.resolve()}return r.put(s.substring(2),{size:t.Tsize,cid:t.Hash})})))},vI=e=>e.toString(16).toUpperCase().padStart(2,"0").substring(0,2),_I=async(e,t,n)=>{const r=await wI(n.Links),s=await r._findNewBucketAndPos(t),i=[{bucket:s.bucket,prefix:vI(s.pos)}];let o=s.bucket;while(o!==r)i.push({bucket:o,prefix:vI(o._posAtParent)}),o=o._parent;i.reverse(),i[0].node=n;for(let a=0;a<i.length;a++){const n=i[a];if(!n.node)throw new Error("Could not generate HAMT path");const s=n.node.Links.filter((e=>(e.Name||"").substring(0,2)===n.prefix)).pop();if(!s){gI(`Link ${n.prefix}${t} will be added`);continue}if(s.Name===`${n.prefix}${t}`){gI(`Link ${n.prefix}${t} will be replaced`);continue}gI(`Found subshard ${n.prefix}`);const o=await e.repo.blocks.get(s.Hash),c=Re(o);if(!i[a+1]){gI(`Loaded new subshard ${n.prefix}`),await mI(e,c.Links,r,n.bucket,parseInt(n.prefix,16));const s=await r._findNewBucketAndPos(t);i.push({bucket:s.bucket,prefix:vI(s.pos),node:c});continue}const l=i[a+1];await bI(e,c.Links,l.bucket,r),l.node=c}return await r.put(t,!0),i.reverse(),{rootBucket:r,path:i}},EI=async(e,t,n={})=>{const r=new fI({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:n.mtime,mode:n.mode},n);for(let i=0;i<t.length;i++)await r._bucket.put(t[i].name,{size:t[i].size,cid:t[i].cid});const s=await To(r.flush(e.repo.blocks));if(!s)throw new Error("Flushing shard yielded no result");return s},SI=x("ipfs:mfs:core:utils:add-link");async function kI(e,t){let n=t.parent;if(t.parentCid){const r=X.k0.asCID(t.parentCid);if(null===r)throw B(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(r.code!==Ae)throw B(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");SI(`Loading parent node ${r}`);const s=await e.repo.blocks.get(r);n=Re(s)}if(!n)throw B(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!t.cid)throw B(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!t.name)throw B(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!t.size&&0!==t.size)throw B(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!n.Data)throw B(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");const r=Q.unmarshal(n.Data);return"hamt-sharded-directory"===r.type?(SI("Adding link to sharded directory"),TI(e,{...t,parent:n})):n.Links.length>=t.shardSplitThreshold?(SI("Converting directory to sharded directory"),II(e,{...t,parent:n,mtime:r.mtime,mode:r.mode})):(SI(`Adding ${t.name} (${t.cid}) to regular directory`),AI(e,{...t,parent:n}))}const II=async(e,t)=>{const n=await EI(e,t.parent.Links.map((e=>({name:e.Name||"",size:e.Tsize||0,cid:e.Hash}))).concat({name:t.name,size:t.size,cid:t.cid}),t);return SI(`Converted directory to sharded directory ${n.cid}`),n},AI=async(e,t)=>{const n=t.parent.Links.filter((e=>e.Name!==t.name));if(n.push({Name:t.name,Tsize:t.size,Hash:t.cid}),!t.parent.Data)throw B(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");const r=Q.unmarshal(t.parent.Data);let s;if(r.mtime){const e=Date.now(),t=Math.floor(e/1e3);r.mtime={secs:t,nsecs:1e3*(e-1e3*t)},s=r.marshal()}else s=t.parent.Data;t.parent=_e({Data:s,Links:n});const i=await e.hashers.getHasher(t.hashAlg),o=Te(t.parent),a=await i.digest(o),c=X.k0.create(t.cidVersion,Ae,a);return t.flush&&await e.repo.blocks.put(c,o),{node:t.parent,cid:c,size:o.length}},TI=async(e,t)=>{const{shard:n,path:r}=await RI(e,t),s=await To(n.flush(e.repo.blocks));if(!s)throw new Error("No result from flushing shard");const i=await e.repo.blocks.get(s.cid),o=Re(i),a=t.parent.Links.filter((e=>(e.Name||"").substring(0,2)!==r[0].prefix)),c=o.Links.find((e=>(e.Name||"").substring(0,2)===r[0].prefix));if(!c)throw new Error(`No link found with prefix ${r[0].prefix}`);return a.push(c),yI(e,a,r[0].bucket,t)},RI=async(e,t)=>{const n={name:t.name,cid:t.cid,size:t.size};if(!t.parent.Data)throw B(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");const r=await wI(t.parent.Links),s=Q.unmarshal(t.parent.Data),i=new fI({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:s.mode},t);i._bucket=r,s.mtime&&(i.mtime={secs:Math.round(Date.now()/1e3)});const o=await r._findNewBucketAndPos(n.name),a=CI(o);a[0].node=t.parent;let c=0;while(c<a.length){const t=a[c];c++;const s=t.node;if(!s)throw new Error("Segment had no node");const i=s.Links.find((e=>(e.Name||"").substring(0,2)===t.prefix));if(!i){SI(`Link ${t.prefix}${n.name} will be added`),c=a.length;break}if(i.Name===`${t.prefix}${n.name}`){SI(`Link ${t.prefix}${n.name} will be replaced`),c=a.length;break}if((i.Name||"").length>2){SI(`Link ${i.Name} ${i.Hash} will be replaced with a subshard`),c=a.length;break}SI(`Found subshard ${t.prefix}`);const o=await e.repo.blocks.get(i.Hash),l=Re(o);if(!a[c]){SI(`Loaded new subshard ${t.prefix}`),await mI(e,l.Links,r,t.bucket,parseInt(t.prefix,16));const s=await r._findNewBucketAndPos(n.name);a.push({bucket:s.bucket,prefix:vI(s.pos),node:l});break}const u=a[c];await bI(e,l.Links,u.bucket,r),u.node=l}return await i._bucket.put(n.name,{size:n.size,cid:n.cid}),{shard:i,path:a}},CI=e=>{const t=[{bucket:e.bucket,prefix:vI(e.pos)}];let n=e.bucket._parent,r=e.bucket._posAtParent;while(n)t.push({bucket:n,prefix:vI(r)}),r=n._posAtParent,n=n._parent;return t.reverse(),t},PI=x("ipfs:mfs:utils:update-tree"),NI={shardSplitThreshold:1e3};async function OI(e,t,n){n=Object.assign({},NI,n),PI("Trail",t),t=t.slice().reverse();let r,s=0;for await(const o of e.repo.blocks.getMany(t.map((e=>e.cid)))){const i=Re(o),a=t[s].cid,c=t[s].name;if(s++,!r){r={cid:a,name:c,size:o.length};continue}const l=await kI(e,{parent:i,name:r.name,cid:r.cid,size:r.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});r={cid:l.cid,name:c,size:l.size}}const{cid:i}=r;return PI(`Final CID ${i}`),i}const DI=x("ipfs:mfs:utils:update-mfs-root");async function LI(e,t,n){if(n&&n.signal&&n.signal.aborted)throw B(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return DI(`New MFS root will be ${t}`),await e.repo.datastore.put(Xs,t.bytes),t}async function xI(e,t,n){const r=new Q({type:t,mode:n.mode,mtime:n.mtime}),s=await e.hashers.getHasher(n.hashAlg),i={Data:r.marshal(),Links:[]},o=Te(i),a=await s.digest(o),c=X.k0.create(n.cidVersion,Ae,a);return n.flush&&await e.repo.blocks.put(c,o),{cid:c,node:i}}const BI=I.bind({ignoreUndefined:!0}),MI=x("ipfs:mfs:mkdir"),UI={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function FI(e){async function t(t,n={}){const r=BI(UI,n);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),"/"===t){if(r.parents)return;throw B(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if("/"!==t.substring(0,1))throw B(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");MI(`Creating ${t}`);const s=Jk(t);if("ipfs"===s[0])throw B(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");const i=await Xk(e,r);let o;const a=[],c=await xI(e,"directory",r);for(let u=0;u<=s.length;u++){const n=s.slice(0,u),l=`/ipfs/${i}/${n.join("/")}`;try{if(o=await ny(l,e.repo.blocks),"file"!==o.type&&"directory"!==o.type)throw B(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(u===s.length){if(r.parents)return;throw B(new Error("file already exists"),"ERR_ALREADY_EXISTS")}a.push({name:o.name,cid:o.cid})}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb;if(u<s.length&&!r.parents)throw B(new Error(`Intermediate directory path ${l} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await jI(e,n[n.length-1],c,a[a.length-1],a,r)}}const l=await OI(e,a,r);await LI(e,l,r)}return qs(t)}const jI=async(e,t,n,r,s,i)=>{MI(`Adding empty dir called ${t} to ${r.cid}`);const o=await kI(e,{parent:r.node,parentCid:r.cid,size:0,cid:n.cid,name:t,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});s[s.length-1].cid=o.cid,s.push({name:t,cid:n.cid})},VI=I.bind({ignoreUndefined:!0}),zI=x("ipfs:mfs:cp"),$I={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function KI(e){async function t(t,n,r={}){const s=VI($I,r);Array.isArray(t)||(t=[t]);const i=await Promise.all(t.map((t=>eI(e,t,s))));let o=await eI(e,n,s);if(!i.length||!o)throw B(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");const a=i.find((e=>!e.exists));if(a)throw B(new Error(`${a.path} does not exist`),"ERR_INVALID_PARAMS");const c=HI(o);if(o.exists){if(zI("Destination exists"),1===i.length&&!c)throw B(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(zI("Destination does not exist"),i.length>1){if(!s.parents)throw B(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await FI(e)(o.path,s),o=await eI(e,o.path,s)}else if(o.parts.length>1){const t=`/${o.parts.slice(0,-1).join("/")}`;try{await sI(e)(t,s)}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb;if(!s.parents)throw B(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await FI(e)(t,s),o=await eI(e,o.path,s)}}const l=HI(o)?o.mfsPath:o.mfsDirectory,u=await aI(e,l);if(1===i.length){const t=i.pop();if(!t)throw B(new Error("could not find source"),"ERR_INVALID_PARAMS");const n=c?t.name:o.name;return zI(`Only one source, copying to destination ${c?"directory":"file"} ${n}`),qI(e,t,n,u,s)}return zI("Multiple sources, wrapping in a directory"),WI(e,i,o,u,s)}return qs(t)}const HI=e=>e.unixfs&&e.unixfs.type&&e.unixfs.type.includes("directory"),qI=async(e,t,n,r,s)=>{let i=r.pop();if(!i)throw B(new Error("destination had no parent"),"ERR_INVALID_PARAMS");i=await GI(e,t,n,i,s),r.push(i);const o=await OI(e,r,s);await LI(e,o,s)},WI=async(e,t,n,r,s)=>{for(let o=0;o<t.length;o++){const r=t[o];n=await GI(e,r,r.name,n,s)}r[r.length-1]=n;const i=await OI(e,r,s);await LI(e,i,s)},GI=async(e,t,n,r,s)=>{const i=await e.repo.blocks.get(t.cid),{node:o,cid:a,size:c}=await kI(e,{parentCid:r.cid,size:i.length,cid:t.cid,name:n,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});return r.node=o,r.cid=a,r.size=c,r},YI=x("ipfs:mfs:core:utils:remove-link");async function QI(e,t){let n=t.parent;if(t.parentCid){const r=X.k0.asCID(t.parentCid);if(null===r)throw B(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");YI(`Loading parent node ${r}`);const s=await e.repo.blocks.get(r);n=Re(s)}if(!n)throw B(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!t.name)throw B(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!n.Data)throw B(new Error("Parent node had no data"),"ERR_INVALID_NODE");const r=Q.unmarshal(n.Data);return"hamt-sharded-directory"===r.type?(YI(`Removing ${t.name} from sharded directory`),JI(e,{...t,parent:n})):(YI(`Removing link ${t.name} regular directory`),XI(e,{...t,parent:n}))}const XI=async(e,t)=>{t.parent.Links=t.parent.Links.filter((e=>e.Name!==t.name));const n=await Te(t.parent),r=await e.hashers.getHasher(t.hashAlg),s=await r.digest(n),i=X.k0.create(t.cidVersion,Ae,s);return await e.repo.blocks.put(i,n),YI(`Updated regular directory ${i}`),{node:t.parent,cid:i}},JI=async(e,t)=>{const{rootBucket:n,path:r}=await _I(e,t.name,t.parent);await n.del(t.name);const{node:s}=await ZI(e,r,t.name,t);return yI(e,s.Links,n,t)},ZI=async(e,t,n,r)=>{const s=t.pop();if(!s)throw B(new Error("Could not find parent"),"EINVALIDPARENT");const{bucket:i,prefix:o,node:a}=s;if(!a)throw B(new Error("Could not find parent"),"EINVALIDPARENT");const c=a.Links.find((e=>(e.Name||"").substring(0,2)===o));if(!c)throw B(new Error(`No link found with prefix ${o} for file ${n}`),"ERR_NOT_FOUND");if(c.Name===`${o}${n}`){YI(`Removing existing link ${c.Name}`);const t=a.Links.filter((e=>e.Name!==c.Name));return await i.del(n),yI(e,t,i,r)}YI(`Descending into sub-shard ${c.Name} for ${o}${n}`);const l=await ZI(e,t,n,r);let u=l.cid,h=l.size,d=o;if(1===l.node.Links.length){YI(`Removing subshard for ${o}`);const e=l.node.Links[0];d=`${o}${(e.Name||"").substring(2)}`,u=e.Hash,h=e.Tsize||0}return YI(`Updating shard ${o} with name ${d}`),eA(e,i,a,o,d,h,u,r)},eA=(e,t,n,r,s,i,o,a)=>{const c=n.Links.filter((e=>e.Name!==r));return c.push({Name:s,Tsize:i,Hash:o}),yI(e,c,t,a)},tA=I.bind({ignoreUndefined:!0}),nA={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function rA(e){async function t(t,n={}){const r=tA(nA,n);Array.isArray(t)||(t=[t]);const s=await Promise.all(t.map((t=>eI(e,t,r))));if(!s.length)throw B(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach((e=>{if("/"===e.path)throw B(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")}));for(const i of s)await sA(e,i.path,r)}return qs(t)}const sA=async(e,t,n)=>{const r=await eI(e,t,n),s=await aI(e,r.mfsPath),i=s[s.length-1];s.pop();const o=s[s.length-1];if(!o)throw B(new Error(`${t} does not exist`),"ERR_NOT_FOUND");if("directory"===i.type&&!n.recursive)throw B(new Error(`${t} is a directory, use -r to remove directories`),"ERR_WAS_DIR");const{cid:a}=await QI(e,{parentCid:o.cid,name:i.name,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});o.cid=a;const c=await OI(e,s,n);await LI(e,c,n)},iA=I.bind({ignoreUndefined:!0}),oA=x("ipfs:mfs:touch"),aA={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function cA(e,t,n){let r=0;return(e.includes("x")||e.includes("X")&&(n||1&t||8&t||64&t))&&(r+=1),e.includes("w")&&(r+=2),e.includes("r")&&(r+=4),r}function lA(e,t){let n=0;return e.includes("u")&&(n+=t<<6),e.includes("g")&&(n+=t<<3),e.includes("o")&&(n+=t),n}function uA(e,t,n){return t.includes("t")&&(n+=parseInt("1000",8)),t.includes("s")&&(e.includes("u")&&(n+=parseInt("4000",8)),e.includes("g")&&(n+=parseInt("2000",8))),n}function hA(e,t,n){t||(t=0);const r=e.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!r)throw new Error(`Invalid file mode: ${e}`);let[,s,i,o]=r;"a"!==s&&s||(s="ugo");let a=cA(o,t,n);return a=lA(s,a),a=uA(s,o,a),"="===i?(s.includes("u")&&(t&=parseInt("7077",8),t|=a),s.includes("g")&&(t&=parseInt("7707",8),t|=a),s.includes("o")&&(t&=parseInt("7770",8),t|=a),t):"+"===i?a|t:"-"===i?a^t:t}function dA(e,t){if(e instanceof String||"string"===typeof e){const n=`${e}`;e=n.match(/^\d+$/g)?parseInt(n,8):0+n.split(",").reduce(((e,n)=>hA(n,e,t.isDirectory())),t.mode||0)}return e}function fA(e){async function t(t,n,r={}){const s=iA(aA,r);oA(`Fetching stats for ${t}`);const{cid:i,mfsDirectory:o,name:a}=await eI(e,t,s);if(i.code!==Ae)throw B(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){const r=await dd((async function*(){for await(const r of ry(i,e.repo.blocks)){if("file"!==r.type&&"directory"!==r.type)throw B(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");r.unixfs.mode=dA(n,r.unixfs);const e=_e({Data:r.unixfs.marshal(),Links:r.node.Links});yield{path:r.path,content:e}}}),(t=>cg(t,e.repo.blocks,{...s,pin:!1,dagBuilder:async function*(e,t,n){for await(const r of e)yield async function(){const e=r.content,s=Te(e),i=await cI(s,t,n);if(!e.Data)throw B(new Error(`${i} had no data`),"ERR_INVALID_NODE");const o=Q.unmarshal(e.Data);return{cid:i,size:s.length,path:r.path,unixfs:o}}}})),(e=>To(e)));if(!r)throw B(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");return await rA(e)(t,s),void await KI(e)(`/ipfs/${r.cid}`,t,s)}const c=await e.repo.blocks.get(i),l=Re(c);if(!l.Data)throw B(new Error(`${i} had no data`),"ERR_INVALID_NODE");const u=Q.unmarshal(l.Data);u.mode=dA(n,u);const h=Te({Data:u.marshal(),Links:l.Links}),d=s.hashAlg||aA.hashAlg,f=await e.hashers.getHasher(d),p=await f.digest(h),g=X.k0.create(s.cidVersion,Ae,p);s.flush&&await e.repo.blocks.put(g,h);const y=await aI(e,o),m=y[y.length-1],w=X.k0.decode(m.cid.bytes),b=await e.repo.blocks.get(w),v=Re(b),_=await kI(e,{parent:v,name:a,cid:g,size:h.length,flush:s.flush,hashAlg:d,cidVersion:i.version,shardSplitThreshold:1/0});m.cid=_.cid;const E=await OI(e,y,s);await LI(e,E,s)}return qs(t)}const pA=I.bind({ignoreUndefined:!0}),gA={};function yA(e){async function t(t,n={}){n=pA(gA,n);const{cid:r}=await sI(e)(t,n);return r}return qs(t)}const mA=I.bind({ignoreUndefined:!0}),wA={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function bA(e){async function t(t,n,r={}){const s=mA(wA,r);await KI(e)(t,n,s),await rA(e)(t,{...s,recursive:!0})}return qs(t)}const vA=I.bind({ignoreUndefined:!0}),_A=x("ipfs:mfs:touch"),EA={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function SA(e){async function t(t,n={}){const r=vA(EA,n);r.mtime=r.mtime||new Date,_A(`Touching ${t} mtime: ${r.mtime}`);const{cid:s,mfsDirectory:i,name:o,exists:a}=await eI(e,t,r),c=n.hashAlg||EA.hashAlg,l=await e.hashers.getHasher(c);let u,h,d=r.cidVersion;if(a){if(s.code!==Ae)throw B(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");d=s.version;const n=await e.repo.blocks.get(s),i=Re(n);if(!i.Data)throw B(new Error(`${t} had no data`),"ERR_INVALID_NODE");const o=Q.unmarshal(i.Data);o.mtime=r.mtime,u=Te({Data:o.marshal(),Links:i.Links});const a=await l.digest(u);h=X.k0.create(r.cidVersion,Ae,a),r.flush&&await e.repo.blocks.put(h,u)}else{const t=new Q({type:"file",mtime:r.mtime});u=Te({Data:t.marshal(),Links:[]});const n=await l.digest(u);h=X.k0.create(r.cidVersion,Ae,n),r.flush&&await e.repo.blocks.put(h,u)}const f=await aI(e,i),p=f[f.length-1],g=p.cid,y=await e.repo.blocks.get(g),m=Re(y),w=await kI(e,{parent:m,name:o,cid:h,size:u.length,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:d});p.cid=w.cid;const b=await OI(e,f,r);await LI(e,b,r)}return qs(t)}const kA=I.bind({ignoreUndefined:!0}),IA={offset:0,length:1/0};function AA(e){function t(t,n={}){return n=kA(IA,n),{[Symbol.asyncIterator]:async function*(){const r=await eI(e,t,n),s=await ny(r.mfsPath,e.repo.blocks);if("file"!==s.type&&"raw"!==s.type)throw B(new Error(`${t} was not a file or raw bytes`),"ERR_NOT_FILE");if(!s.content)throw B(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(const e of s.content({offset:n.offset,length:n.length}))yield e}}}return qs(t)}const TA=x("ipfs:mfs:utils:to-async-iterator");function RA(e){if(!e)throw B(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if(("string"===typeof e||e instanceof String)&&(TA("Content was a string"),e=An(e.toString())),e.length)return TA("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield e}};if(e[Symbol.asyncIterator])return TA("Content was an async iterator"),e;if(e[Symbol.iterator])return TA("Content was an iterator"),e;if(global.Blob&&e instanceof global.Blob)return TA("Content was an HTML5 Blob"),Tf(e.stream());throw B(new Error(`Don't know how to convert ${e} into an async iterator`),"ERR_INVALID_PARAMS")}const CA=I.bind({ignoreUndefined:!0}),PA=x("ipfs:mfs:write"),NA={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(e,t)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function OA(e){async function t(t,n,r={}){const s=CA(NA,r);let i,o,a;if(PA("Reading source, destination and parent"),await Yk().readLock((async()=>{i=await RA(n),o=await eI(e,t,s),a=await eI(e,o.mfsDirectory,s)}))(),PA("Read source, destination and parent"),!s.parents&&!a.exists)throw B(new Error("directory does not exist"),"ERR_NO_EXIST");if(null==i)throw B(new Error("could not create source"),"ERR_NO_SOURCE");if(null==o)throw B(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!o.exists)throw B(new Error("file does not exist"),"ERR_NO_EXIST");if("file"!==o.entryType)throw B(new Error("not a file"),"ERR_NOT_A_FILE");return DA(e,t,i,o,s)}return qs(t)}const DA=async(e,t,n,r,s)=>{const i=await LA(e,n,r,s);await Yk().writeLock((async()=>{const n=Jk(t),r=n.pop();if(null==r)throw B(new Error("source does not exist"),"ERR_NO_EXIST");let o=!1;try{await sI(e)(`/${n.join("/")}`,s),o=!0}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}o||await FI(e)(`/${n.join("/")}`,s);const a=await eI(e,t,s),c=await aI(e,a.mfsDirectory),l=c[c.length-1];if(!l)throw B(new Error("directory does not exist"),"ERR_NO_EXIST");if(!l.type||!l.type.includes("directory"))throw B(new Error(`cannot write to ${l.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");const u=await e.repo.blocks.get(l.cid),h=Re(u),d=await kI(e,{parent:h,name:r,cid:i.cid,size:i.size,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold,hashAlg:s.hashAlg,cidVersion:s.cidVersion});l.cid=d.cid;const f=await OI(e,c,s);await LI(e,f,s)}))()},LA=async(e,t,n,r)=>{n.exists?PA(`Overwriting file ${n.cid} offset ${r.offset} length ${r.length}`):PA(`Writing file offset ${r.offset} length ${r.length}`);const s=[];if(r.offset>0)if(n.unixfs){if(PA(`Writing first ${r.offset} bytes of original file`),s.push((()=>n.content({offset:0,length:r.offset}))),n.unixfs.fileSize()<r.offset){const e=r.offset-n.unixfs.fileSize();PA(`Writing zeros for extra ${e} bytes`),s.push(BA(e))}}else PA(`Writing zeros for first ${r.offset} bytes`),s.push(BA(r.offset));s.push(xA(t,r.length));const i=UA(MA(s),(e=>{if(n.unixfs&&!r.truncate){const t=n.unixfs.fileSize();if(t>e)return PA(`Writing last ${t-e} of ${t} bytes from original file starting at offset ${e}`),n.content({offset:e});PA("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}));let o,a;void 0!==r.mode&&null!==r.mode?o=G(r.mode):n&&n.unixfs&&(o=n.unixfs.mode),null!=r.mtime?a=Y(r.mtime):n&&n.unixfs&&(a=n.unixfs.mtime);const c=await e.hashers.getHasher(r.hashAlg),l=await To(cg([{content:i,mode:o,mtime:a}],e.repo.blocks,{progress:r.progress,hasher:c,cidVersion:r.cidVersion,strategy:r.strategy,rawLeaves:r.rawLeaves,reduceSingleLeafToSelf:r.reduceSingleLeafToSelf,leafType:r.leafType}));if(!l)throw B(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return PA(`Wrote ${l.cid}`),{cid:l.cid,size:l.size}},xA=(e,t)=>async function*(){let n=0;for await(const r of e){if(n+=r.length,n>t)return void(yield r.subarray(0,t-n));yield r}},BA=(e,t=Js)=>{const n=new Uint8Array(t);async function*r(){while(1)yield n}return xA(r(),e)},MA=async function*(e){for(let t=0;t<e.length;t++)yield*e[t]()},UA=async function*(e,t){let n=0;for await(const r of e)n+=r.length,yield r;for await(const r of t(n))n+=r.length,yield r},FA=e=>{const t={cid:e.cid,name:e.name,type:"directory"===e.type?"directory":"file",size:e.size};return"file"!==e.type&&"directory"!==e.type||(t.mode=e.unixfs.mode,t.mtime=e.unixfs.mtime),t};function jA(e){async function*t(t,n={}){const r=await eI(e,t,n),s=await ny(r.mfsPath,e.repo.blocks);"directory"!==s.type?yield FA(s):yield*_f(s.content(n),FA)}return qs(t)}const VA={stat:sI},zA={chmod:fA,cp:KI,flush:yA,mkdir:FI,mv:bA,rm:rA,touch:SA},$A={write:OA,read:AA,ls:jA},KA=({options:e,mfs:t,operations:n,lock:r})=>{Object.keys(n).forEach((s=>{t[s]=r(n[s](e))}))},HA={repoOwner:!0,repo:null};function qA(e){const{repoOwner:t}=Object.assign({},HA||{},e),n=Yk(t),r=e=>n.readLock(e),s=e=>n.writeLock(e),i={};return KA({options:e,mfs:i,operations:VA,lock:r}),KA({options:e,mfs:i,operations:zA,lock:s}),Object.keys($A).forEach((t=>{i[t]=$A[t](e)})),i}function WA({repo:e,preload:t,hashers:n,options:r}){const s=qA({repo:e,repoOwner:!1!==r.repoOwner,hashers:n}),i=e=>{const n=(...n)=>{const r=n.filter((e=>Ps(e)||ks(e)));if(r.length){const e=n[n.length-1];e&&!1!==e.preload&&r.forEach((e=>t(e)))}return e(...n)};return n};return{...s,chmod:s.chmod,cp:i(s.cp),mkdir:s.mkdir,stat:i(s.stat),rm:s.rm,read:i(s.read),touch:s.touch,write:s.write,mv:i(s.mv),flush:s.flush,ls:i((async function*(...e){for await(const t of s.ls(...e))yield{...t,size:t.size||0}}))}}function GA({keychain:e}){const t=(t,n)=>e.exportKey(t,n);return qs(t)}const YA="Ed25519",QA=2048;function XA({keychain:e}){const t=(t,n={type:YA,size:QA})=>e.createKey(t,n.type||YA,n.size||QA);return qs(t)}function JA({keychain:e}){const t=(t,n,r)=>e.importKey(t,n,r);return qs(t)}function ZA({keychain:e}){const t=t=>e.findKeyByName(t);return qs(t)}function eT({keychain:e}){const t=()=>e.listKeys();return qs(t)}function tT({keychain:e}){const t=async(t,n)=>{const r=await e.renameKey(t,n);return{was:t,now:r.name,id:r.id,overwrite:!1}};return qs(t)}function nT({keychain:e}){const t=t=>e.removeKey(t);return qs(t)}class rT{constructor({keychain:e}){this.gen=XA({keychain:e}),this.list=eT({keychain:e}),this.rm=nT({keychain:e}),this.rename=tT({keychain:e}),this.export=GA({keychain:e}),this.import=JA({keychain:e}),this.info=ZA({keychain:e})}}function sT({repo:e,preload:t}){async function n(n,r={}){!1!==r.preload&&t(n);const s=await e.blocks.get(n,r);return Re(s)}return qs(n)}function iT({repo:e,preload:t}){const n=sT({repo:e,preload:t});async function r(e,t={}){const r=await n(e,t);return r.Data||new Uint8Array(0)}return qs(r)}function oT(e,t=[]){for(const r in e){const s=e[r];if("/"===r&&1===Object.keys(e).length)try{t.push({Name:"",Tsize:0,Hash:X.k0.parse(s)});continue}catch(n){}const i=X.k0.asCID(s);i?t.push({Name:"",Tsize:0,Hash:i}):(Array.isArray(s)&&oT(s,t),s&&"object"===typeof s&&oT(s,t))}return t}function aT({repo:e,codecs:t}){async function n(n,r={}){const s=await t.getCodec(n.code),i=await e.blocks.get(n,r),o=s.decode(i);switch(n.code){case Xt:return[];case Ae:return o.Links;case Ce.code:case Xe:return oT(o);default:throw new Error(`Cannot resolve links from codec ${n.code}`)}}return qs(n)}function cT({repo:e,preload:t}){async function n(n={}){let r;if(n.template){if("unixfs-dir"!==n.template)throw new Error("unknown template");r=new Q({type:"directory"}).marshal()}const s=Te({Data:r,Links:[]}),i=await Gt.digest(s),o=X.k0.createV0(i);return await e.blocks.put(o,s,{signal:n.signal}),!1!==n.preload&&t(o),o}return qs(n)}function lT({repo:e,preload:t}){async function n(n,r={}){const s=await e.gcLock.readLock();try{const i=Te(n),o=await Gt.digest(i),a=X.k0.createV1(Ae,o);return await e.blocks.put(a,i,{signal:r.signal}),!1!==r.preload&&t(a),r.pin&&await e.pins.pinRecursively(a,{signal:r.signal}),a}finally{s()}}return qs(n)}function uT({repo:e,preload:t}){const n=sT({repo:e,preload:t});async function r(e,t={}){const r=await n(e,t),s=Te(r),i=s.length,o=r.Links.reduce(((e,t)=>e+(t.Tsize||0)),0);return{Hash:e,NumLinks:r.Links.length,BlockSize:i,LinksSize:i-(r.Data||[]).length,DataSize:(r.Data||[]).length,CumulativeSize:i+o}}return qs(r)}function hT({repo:e,preload:t}){const n=sT({repo:e,preload:t}),r=lT({repo:e,preload:t});async function s(e,t,s={}){const i=await n(e,s);return r({...i,Links:i.Links.concat([t])},s)}return qs(s)}function dT({repo:e,preload:t}){const n=sT({repo:e,preload:t}),r=lT({repo:e,preload:t});async function s(e,t,s={}){const i=await n(e,s),o=Xn([i.Data||[],t]);return r({...i,Data:o},s)}return qs(s)}function fT({repo:e,preload:t}){const n=sT({repo:e,preload:t}),r=lT({repo:e,preload:t});async function s(e,t,s={}){const i=await n(e,s),o=("string"===typeof t?t:t.Name)||"";return i.Links=i.Links.filter((e=>e.Name!==o)),r(i,s)}return qs(s)}function pT({repo:e,preload:t}){const n=sT({repo:e,preload:t}),r=lT({repo:e,preload:t});async function s(e,t,s={}){const i=await n(e,s);return r({...i,Data:t},s)}return qs(s)}class gT{constructor({repo:e,preload:t}){this.addLink=hT({repo:e,preload:t}),this.appendData=dT({repo:e,preload:t}),this.rmLink=fT({repo:e,preload:t}),this.setData=pT({repo:e,preload:t})}}class yT{constructor({repo:e,codecs:t,preload:n}){this.data=iT({repo:e,preload:n}),this.get=sT({repo:e,preload:n}),this.links=aT({repo:e,codecs:t}),this.new=cT({repo:e,preload:n}),this.put=lT({repo:e,preload:n}),this.stat=uT({repo:e,preload:n}),this.patch=new gT({repo:e,preload:n})}}const mT=x("ipfs:repo:gc");function wT({repo:e,hashers:t}){async function*n(n={}){const r=Date.now();let s;try{s=await Xk({repo:e,hashers:t},n),await e.pins.pinRecursively(s),yield*e.gc()}finally{s&&await e.pins.unpin(s)}mT(`Complete (${Date.now()-r}ms)`)}return qs(n)}function bT({repo:e}){async function t(t={}){const n=await e.stat();return{numObjects:BigInt(n.numObjects.toString()),repoSize:BigInt(n.repoSize.toString()),repoPath:n.repoPath,version:`${n.version}`,storageMax:BigInt(n.storageMax.toString())}}return qs(t)}const vT=12;function _T({repo:e}){async function t(t={}){try{await e._checkInitialized(t)}catch(rb){const t=[/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some((t=>t.test(rb.message)));if(t)return vT;throw rb}return e.version.get()}return qs(t)}class ET{constructor({repo:e,hashers:t}){this.gc=wT({repo:e,hashers:t}),this.stat=bT({repo:e}),this.version=_T({repo:e}),this.setApiAddr=t=>e.apiAddr.set(t)}}function ST(e,t){return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0}}function kT({network:e}){const t=async function*(t={}){const{libp2p:n}=await e.use(t);if(!t.poll)return void(yield ST(n,t));const r=t.interval||1e3;let s,i=-1;try{if(i="string"===typeof r?Ks(r)||-1:r,!i||i<0)throw new Error("invalid duration")}catch(rb){throw B(rb,"ERR_INVALID_POLL_INTERVAL")}try{while(1)yield ST(n,t),await new Promise((e=>{s=setTimeout(e,i)}))}finally{clearTimeout(s)}};return qs(t)}class IT{constructor({repo:e,network:t}){this.repo=bT({repo:e}),this.bw=kT({network:t}),this.bitswap=of({network:t})}}var AT=TT;function TT(e,t,n){if(!e)return n;var r,s;if(Array.isArray(t)&&(r=t.slice(0)),"string"==typeof t&&(r=t.split(".")),"symbol"==typeof t&&(r=[t]),!Array.isArray(r))throw new Error("props arg must be an array, a string or a symbol");while(r.length){if(s=r.shift(),!e)return n;if(e=e[s],void 0===e)return n}return e}async function RT(e){let t=0;for await(const n of e)t++;return t}const CT=T("ipfs:repo:migrator:migration-8");function PT(e){return e.child?PT(e.child):e}function NT(e){try{const t=C.base32.decode(`b${e.toString().toLowerCase().slice(1)}`),n=X.k0.decode(t).multihash.bytes,r=C.base32.encode(n).slice(1).toUpperCase();return new Bs(`/${r}`,!1)}catch(rb){return e}}function OT(e){try{const t=C.base32.decode(`b${e.toString().toLowerCase().slice(1)}`),n=At.Jx(t),r=C.base32.encode(X.k0.createV1(Xt,n).bytes).slice(1);return new Bs(`/${r.toUpperCase()}`,!1)}catch{return e}}async function DT(e,t,n){const r=e.blocks;await r.open();const s=PT(r),i=await RT(s.queryKeys({filters:[e=>{const t=n(e);return t.toString()!==e.toString()}]}));try{let e=0;for await(const r of s.query({})){const o=n(r.key);o.toString()!==r.key.toString()&&(e+=1,CT(`Migrating Block from ${r.key} to ${o}`,await s.has(r.key)),await s.delete(r.key),await s.put(o,r.value),t(e/i*100,`Migrated Block from ${r.key} to ${o}`))}}finally{await r.close()}}const LT={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(e,t=(()=>{}))=>DT(e,t,NT),revert:(e,t=(()=>{}))=>DT(e,t,OT)},xT=M.Reader,BT=M.Writer,MT=(M.util,M.roots["default"]||(M.roots["default"]={})),UT=MT.ipfs=(()=>{const e={};return e.pin=function(){const e={};return e.Set=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.version=0,e.prototype.fanout=0,e.prototype.seed=0,e.encode=function(e,t){return t||(t=BT.create()),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(8).uint32(e.version),null!=e.fanout&&Object.hasOwnProperty.call(e,"fanout")&&t.uint32(16).uint32(e.fanout),null!=e.seed&&Object.hasOwnProperty.call(e,"seed")&&t.uint32(29).fixed32(e.seed),t},e.decode=function(e,t){e instanceof xT||(e=xT.create(e));var n=void 0===t?e.len:e.pos+t,r=new MT.ipfs.pin.Set;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.version=e.uint32();break;case 2:r.fanout=e.uint32();break;case 3:r.seed=e.fixed32();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof MT.ipfs.pin.Set)return e;var t=new MT.ipfs.pin.Set;return null!=e.version&&(t.version=e.version>>>0),null!=e.fanout&&(t.fanout=e.fanout>>>0),null!=e.seed&&(t.seed=e.seed>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.version=0,n.fanout=0,n.seed=0),null!=e.version&&e.hasOwnProperty("version")&&(n.version=e.version),null!=e.fanout&&e.hasOwnProperty("fanout")&&(n.fanout=e.fanout),null!=e.seed&&e.hasOwnProperty("seed")&&(n.seed=e.seed),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e}(),e}(),e})();var FT=n(1173);const jT=new Bs("/local/pins"),VT=256,zT=8192,$T=X.k0.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),KT={direct:"direct",recursive:"recursive"};function HT(e){return new Bs(`/${C.base32.encode(e.multihash.bytes).toUpperCase().substring(1)}`)}function qT(e,t){for(let n=0;n<e.byteLength;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0}const WT=UT.pin.Set;function GT(e){const t=e.Data;if(!t)throw new Error("No data present");const n=Qn.decode(t),r=Qn.decode.bytes??0;if(r<=0)throw new Error("Invalid Set header length");if(r+n>t.length)throw new Error("Impossibly large set header length");const s=t.slice(r,n+r),i=WT.toObject(WT.decode(s),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(1!==i.version)throw new Error(`Unsupported Set version: ${i.version}`);if(i.fanout>e.Links.length)throw new Error("Impossibly large fanout");return{header:i,data:t.slice(n+r)}}function YT(e,t){const n=new Uint8Array(4),r=new DataView(n.buffer);r.setUint32(0,e,!0);const s=An(t.toString()),i=Xn([n,s],n.byteLength+s.byteLength);return FT(Fn(i))}async function*QT(e,t){const n=GT(t);let r=0;for(const s of t.Links){if(r<n.header.fanout){const t=s.Hash;if(!$T.equals(t)){const n=await e.get(t),r=Re(n);yield*QT(e,r)}}else yield s.Hash;r++}}async function*XT(e,t,n){const r=t.Links.find((e=>e.Name===n));if(!r)throw new Error("No link found with name "+n);const s=await e.get(r.Hash),i=Re(s);yield*QT(e,i)}function JT(e,t){return n(t,0);async function n(t,r){const s=WT.encode({version:1,fanout:VT,seed:r}).finish(),i=Qn.encode(s.length),o=Xn([i,s]),a=[];for(let e=0;e<VT;e++)a.push({Name:"",Tsize:1,Hash:$T});if(t.length<=zT){const e=t.map((e=>({link:{Name:"",Tsize:1,Hash:e.key},data:e.data||new Uint8Array}))).sort(((e,t)=>qT(e.link.Hash.bytes,t.link.Hash.bytes))),n=a.concat(e.map((e=>e.link))),r=Xn([o,...e.map((e=>e.data))]);return{Data:r,Links:n}}{const e=t.reduce(((e,t)=>{const n=YT(r,t.key)%VT;return e[n]=n in e?e[n].concat([t]):[t],e}),[]);let s=0;for(const t of e){const e=await n(t,r+1);await c(e,s),s++}return{Data:o,Links:a}}async function c(t,n){const r=Te(t),s=await Gt.digest(r),i=X.k0.createV0(s);await e.put(i,r);const o=t.Links.reduce(((e,t)=>e+(t.Tsize||0)),0)+r.length;a[n]={Name:"",Tsize:o,Hash:i}}}}async function ZT(e,t,n){const r=await JT(e,n.map((e=>({key:e})))),s=Te(r),i=await Gt.digest(s),o=X.k0.createV0(i);await e.put(o,s);const a=r.Links.reduce(((e,t)=>e+t.Tsize),0)+s.length;return{Name:t,Tsize:a,Hash:o}}async function eR(e,t,n,r){if(!await t.has(jT))return;const s=await t.get(jT),i=X.k0.decode(s),o=await e.get(i),a=Re(o);let c=0;const l=await RT(XT(e,a,KT.recursive))+await RT(XT(e,a,KT.direct));for await(const u of XT(e,a,KT.recursive)){c++;const e={depth:1/0};0!==u.version&&(e.version=u.version),u.code!==Ae&&(e.codec=u.code),await n.put(HT(u),Ne.cv(e)),r(c/l*100,`Migrated recursive pin ${u}`)}for await(const u of XT(e,a,KT.direct)){c++;const e={depth:0};0!==u.version&&(e.version=u.version),u.code!==Ae&&(e.codec=u.code),await n.put(HT(u),Ne.cv(e)),r(c/l*100,`Migrated direct pin ${u}`)}await e.delete(i),await t.delete(jT)}async function tR(e,t,n,r){const s=[],i=[];let o=0;const a=await RT(n.queryKeys({}));for await(const{key:d,value:f}of n.query({})){o++;const e=Ne.Jx(f),t=X.k0.create(e.version||0,e.codec||Ae,At.Jx(C.base32.decode("b"+d.toString().toLowerCase().split("/").pop())));0===e.depth?(r(o/a*100,`Reverted direct pin ${t}`),i.push(t)):(r(o/a*100,`Reverted recursive pin ${t}`),s.push(t))}r(100,"Updating pin root");const c={Links:[await ZT(e,KT.direct,i),await ZT(e,KT.recursive,s)]},l=Te(c),u=await Gt.digest(l),h=X.k0.createV0(u);await e.put(h,l),await t.put(jT,h.bytes)}async function nR(e,t,n){const r=e.blocks,s=e.datastore,i=e.pins;await r.open(),await s.open(),await i.open();try{await n(r,s,i,t)}finally{await i.close(),await s.close(),await r.close()}}const rR={version:9,description:"Migrates pins to datastore",migrate:(e,t=(()=>{}))=>nR(e,t,eR),revert:(e,t=(()=>{}))=>nR(e,t,tR)},sR=new Bs("/config"),iR=new Bs("/version");function oR(e){let t=e;while(t.db||t.child)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}async function aR(e,t,n){const r=await t(e);if(r)return r;const s=oR(n);return!!s&&new Promise(((t,n)=>{const r=s.store("readonly").get(e.toString());r.transaction.onabort=()=>{n(r.transaction.error)},r.transaction.oncomplete=()=>{t(Boolean(r.result))}}))}async function cR(e,t,n,r){if(await n(e))return t(e);const s=oR(r);if(!s)throw Ko();return new Promise(((t,n)=>{const r=s.store("readonly").get(e.toString());r.transaction.onabort=()=>{n(r.transaction.error)},r.transaction.oncomplete=()=>{if(r.result)return t(r.result);n(Ko())}}))}function lR(e){const t=e.get.bind(e),n=e.has.bind(e);return e.get=r=>cR(r,t,n,e),e.has=t=>aR(t,n,e),e}function uR(e){return{...e,root:lR(e.root),datastore:lR(e.datastore),pins:lR(e.pins),keys:lR(e.keys)}}async function hR(e,t,n=(()=>{})){const r=oR(t);if(!r)return void n(`${e} did not need an upgrade`);n(`Upgrading ${e}`);const s=(e,t)=>[{type:"del",key:e},{type:"put",key:An(e),value:t}];await yR(r,s)}async function dR(e,t,n=(()=>{})){const r=oR(t);if(!r)return void n(`${e} did not need a downgrade`);n(`Downgrading ${e}`);const s=(e,t)=>[{type:"del",key:e},{type:"put",key:Fn(e),value:t}];await yR(r,s)}function fR(e){return e.child?fR(e.child):e}async function pR(e,t,n){const r=Object.entries(e).map((([e,t])=>({key:e,backend:fR(t)}))).filter((({key:e,backend:t})=>"LevelDatastore"===t.constructor.name)).map((({key:e,backend:t})=>({name:e,store:t})));t(0,`Migrating ${r.length} dbs`);let s=0;const i=e=>{t(Math.round(s/r.length*100),e)};for(const{name:o,store:a}of r){await a.open();try{await n(o,a,i)}finally{s++,await a.close()}}t(100,`Migrated ${r.length} dbs`)}const gR={version:10,description:"Migrates datastore-level keys to binary",migrate:(e,t=(()=>{}))=>pR(e,t,hR),revert:(e,t=(()=>{}))=>pR(e,t,dR)};function yR(e,t){function n(t,n){const r=e.store("readwrite"),s=r.transaction;let i,o=0;function a(){const e=t[o++],n=e.key;let c;try{c="del"===e.type?r.delete(n):r.put(e.value,n)}catch(rb){return i=rb,void s.abort()}o<t.length&&(c.onsuccess=a)}s.onabort=()=>n(i||s.error||new Error("aborted by user")),s.oncomplete=()=>n(),a()}return new Promise(((r,s)=>{const i=e.iterator(),o=e=>e;function a(){const e=(e,o,c)=>{if(e||void 0===o){const e=e=>{e?s(e):r()};i.end(e)}else n(t(o,c),a)};i.next(e)}i._deserializeKey=i._deserializeValue=o,a()}))}const mR=new Bs("/local/filesroot");async function wR(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo datastore"),await e.root.open(),await e.datastore.open(),await e.root.has(mR)){const t=await e.root.get(mR);await e.datastore.put(mR,t),await e.root.delete(mR)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo datastore")}async function bR(e,t=(()=>{})){if(t(100,"Migrating MFS root to repo root datastore"),await e.root.open(),await e.datastore.open(),await e.datastore.has(mR)){const t=await e.datastore.get(mR);await e.root.put(mR,t),await e.datastore.delete(mR)}await e.datastore.close(),await e.root.close(),t(100,"Stored MFS root in repo root datastore")}const vR={version:11,description:"Store mfs root in the datastore",migrate:wR,revert:bR},_R=M.Reader,ER=M.Writer,SR=M.util,kR=M.roots["default"]||(M.roots["default"]={}),IR=kR.Protocols=(()=>{function e(e){if(this.protocols=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.protocols=SR.emptyArray,e.encode=function(e,t){if(t||(t=ER.create()),null!=e.protocols&&e.protocols.length)for(var n=0;n<e.protocols.length;++n)t.uint32(10).string(e.protocols[n]);return t},e.decode=function(e,t){e instanceof _R||(e=_R.create(e));var n=void 0===t?e.len:e.pos+t,r=new kR.Protocols;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.protocols&&r.protocols.length||(r.protocols=[]),r.protocols.push(e.string());break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof kR.Protocols)return e;var t=new kR.Protocols;if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Protocols.protocols: array expected");t.protocols=[];for(var n=0;n<e.protocols.length;++n)t.protocols[n]=String(e.protocols[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.protocols=[]),e.protocols&&e.protocols.length){n.protocols=[];for(var r=0;r<e.protocols.length;++r)n.protocols[r]=e.protocols[r]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),AR=M.Reader,TR=M.Writer,RR=M.util,CR=M.roots["default"]||(M.roots["default"]={}),PR=CR.Addresses=(()=>{function e(e){if(this.addrs=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.addrs=RR.emptyArray,e.prototype.certifiedRecord=null,e.encode=function(e,t){if(t||(t=TR.create()),null!=e.addrs&&e.addrs.length)for(var n=0;n<e.addrs.length;++n)CR.Addresses.Address.encode(e.addrs[n],t.uint32(10).fork()).ldelim();return null!=e.certifiedRecord&&Object.hasOwnProperty.call(e,"certifiedRecord")&&CR.Addresses.CertifiedRecord.encode(e.certifiedRecord,t.uint32(18).fork()).ldelim(),t},e.decode=function(e,t){e instanceof AR||(e=AR.create(e));var n=void 0===t?e.len:e.pos+t,r=new CR.Addresses;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.addrs&&r.addrs.length||(r.addrs=[]),r.addrs.push(CR.Addresses.Address.decode(e,e.uint32()));break;case 2:r.certifiedRecord=CR.Addresses.CertifiedRecord.decode(e,e.uint32());break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof CR.Addresses)return e;var t=new CR.Addresses;if(e.addrs){if(!Array.isArray(e.addrs))throw TypeError(".Addresses.addrs: array expected");t.addrs=[];for(var n=0;n<e.addrs.length;++n){if("object"!==typeof e.addrs[n])throw TypeError(".Addresses.addrs: object expected");t.addrs[n]=CR.Addresses.Address.fromObject(e.addrs[n])}}if(null!=e.certifiedRecord){if("object"!==typeof e.certifiedRecord)throw TypeError(".Addresses.certifiedRecord: object expected");t.certifiedRecord=CR.Addresses.CertifiedRecord.fromObject(e.certifiedRecord)}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.addrs=[]),t.defaults&&(n.certifiedRecord=null),e.addrs&&e.addrs.length){n.addrs=[];for(var r=0;r<e.addrs.length;++r)n.addrs[r]=CR.Addresses.Address.toObject(e.addrs[r],t)}return null!=e.certifiedRecord&&e.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=CR.Addresses.CertifiedRecord.toObject(e.certifiedRecord,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.Address=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.multiaddr=RR.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:RR.oneOfGetter(t=["isCertified"]),set:RR.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=TR.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof AR||(e=AR.create(e));var n=void 0===t?e.len:e.pos+t,r=new CR.Addresses.Address;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.multiaddr=e.bytes();break;case 2:r.isCertified=e.bool();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof CR.Addresses.Address)return e;var t=new CR.Addresses.Address;return null!=e.multiaddr&&("string"===typeof e.multiaddr?RR.base64.decode(e.multiaddr,t.multiaddr=RR.newBuffer(RR.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.multiaddr="":(n.multiaddr=[],t.bytes!==Array&&(n.multiaddr=RR.newBuffer(n.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(n.multiaddr=t.bytes===String?RR.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(n.isCertified=e.isCertified,t.oneofs&&(n._isCertified="isCertified")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e}(),e.CertifiedRecord=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=RR.Long?RR.Long.fromBits(0,0,!0):0,e.prototype.raw=RR.newBuffer([]),e.encode=function(e,t){return t||(t=TR.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.raw&&Object.hasOwnProperty.call(e,"raw")&&t.uint32(18).bytes(e.raw),t},e.decode=function(e,t){e instanceof AR||(e=AR.create(e));var n=void 0===t?e.len:e.pos+t,r=new CR.Addresses.CertifiedRecord;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.seq=e.uint64();break;case 2:r.raw=e.bytes();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof CR.Addresses.CertifiedRecord)return e;var t=new CR.Addresses.CertifiedRecord;return null!=e.seq&&(RR.Long?(t.seq=RR.Long.fromValue(e.seq)).unsigned=!0:"string"===typeof e.seq?t.seq=parseInt(e.seq,10):"number"===typeof e.seq?t.seq=e.seq:"object"===typeof e.seq&&(t.seq=new RR.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),null!=e.raw&&("string"===typeof e.raw?RR.base64.decode(e.raw,t.raw=RR.newBuffer(RR.base64.length(e.raw)),0):e.raw.length&&(t.raw=e.raw)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(RR.Long){var r=new RR.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;t.bytes===String?n.raw="":(n.raw=[],t.bytes!==Array&&(n.raw=RR.newBuffer(n.raw)))}return null!=e.seq&&e.hasOwnProperty("seq")&&("number"===typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?RR.Long.prototype.toString.call(e.seq):t.longs===Number?new RR.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),null!=e.raw&&e.hasOwnProperty("raw")&&(n.raw=t.bytes===String?RR.base64.encode(e.raw,0,e.raw.length):t.bytes===Array?Array.prototype.slice.call(e.raw):e.raw),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e}(),e})(),NR=M.Reader,OR=M.Writer,DR=M.util,LR=M.roots["default"]||(M.roots["default"]={}),xR=LR.Peer=(()=>{function e(e){if(this.addresses=[],this.protocols=[],this.metadata=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.addresses=DR.emptyArray,e.prototype.protocols=DR.emptyArray,e.prototype.metadata=DR.emptyArray,e.prototype.pubKey=null,e.prototype.peerRecordEnvelope=null,Object.defineProperty(e.prototype,"_pubKey",{get:DR.oneOfGetter(t=["pubKey"]),set:DR.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_peerRecordEnvelope",{get:DR.oneOfGetter(t=["peerRecordEnvelope"]),set:DR.oneOfSetter(t)}),e.encode=function(e,t){if(t||(t=OR.create()),null!=e.addresses&&e.addresses.length)for(var n=0;n<e.addresses.length;++n)LR.Address.encode(e.addresses[n],t.uint32(10).fork()).ldelim();if(null!=e.protocols&&e.protocols.length)for(n=0;n<e.protocols.length;++n)t.uint32(18).string(e.protocols[n]);if(null!=e.metadata&&e.metadata.length)for(n=0;n<e.metadata.length;++n)LR.Metadata.encode(e.metadata[n],t.uint32(26).fork()).ldelim();return null!=e.pubKey&&Object.hasOwnProperty.call(e,"pubKey")&&t.uint32(34).bytes(e.pubKey),null!=e.peerRecordEnvelope&&Object.hasOwnProperty.call(e,"peerRecordEnvelope")&&t.uint32(42).bytes(e.peerRecordEnvelope),t},e.decode=function(e,t){e instanceof NR||(e=NR.create(e));var n=void 0===t?e.len:e.pos+t,r=new LR.Peer;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.addresses&&r.addresses.length||(r.addresses=[]),r.addresses.push(LR.Address.decode(e,e.uint32()));break;case 2:r.protocols&&r.protocols.length||(r.protocols=[]),r.protocols.push(e.string());break;case 3:r.metadata&&r.metadata.length||(r.metadata=[]),r.metadata.push(LR.Metadata.decode(e,e.uint32()));break;case 4:r.pubKey=e.bytes();break;case 5:r.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof LR.Peer)return e;var t=new LR.Peer;if(e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".Peer.addresses: array expected");t.addresses=[];for(var n=0;n<e.addresses.length;++n){if("object"!==typeof e.addresses[n])throw TypeError(".Peer.addresses: object expected");t.addresses[n]=LR.Address.fromObject(e.addresses[n])}}if(e.protocols){if(!Array.isArray(e.protocols))throw TypeError(".Peer.protocols: array expected");t.protocols=[];for(n=0;n<e.protocols.length;++n)t.protocols[n]=String(e.protocols[n])}if(e.metadata){if(!Array.isArray(e.metadata))throw TypeError(".Peer.metadata: array expected");t.metadata=[];for(n=0;n<e.metadata.length;++n){if("object"!==typeof e.metadata[n])throw TypeError(".Peer.metadata: object expected");t.metadata[n]=LR.Metadata.fromObject(e.metadata[n])}}return null!=e.pubKey&&("string"===typeof e.pubKey?DR.base64.decode(e.pubKey,t.pubKey=DR.newBuffer(DR.base64.length(e.pubKey)),0):e.pubKey.length&&(t.pubKey=e.pubKey)),null!=e.peerRecordEnvelope&&("string"===typeof e.peerRecordEnvelope?DR.base64.decode(e.peerRecordEnvelope,t.peerRecordEnvelope=DR.newBuffer(DR.base64.length(e.peerRecordEnvelope)),0):e.peerRecordEnvelope.length&&(t.peerRecordEnvelope=e.peerRecordEnvelope)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.addresses=[],n.protocols=[],n.metadata=[]),e.addresses&&e.addresses.length){n.addresses=[];for(var r=0;r<e.addresses.length;++r)n.addresses[r]=LR.Address.toObject(e.addresses[r],t)}if(e.protocols&&e.protocols.length){n.protocols=[];for(r=0;r<e.protocols.length;++r)n.protocols[r]=e.protocols[r]}if(e.metadata&&e.metadata.length){n.metadata=[];for(r=0;r<e.metadata.length;++r)n.metadata[r]=LR.Metadata.toObject(e.metadata[r],t)}return null!=e.pubKey&&e.hasOwnProperty("pubKey")&&(n.pubKey=t.bytes===String?DR.base64.encode(e.pubKey,0,e.pubKey.length):t.bytes===Array?Array.prototype.slice.call(e.pubKey):e.pubKey,t.oneofs&&(n._pubKey="pubKey")),null!=e.peerRecordEnvelope&&e.hasOwnProperty("peerRecordEnvelope")&&(n.peerRecordEnvelope=t.bytes===String?DR.base64.encode(e.peerRecordEnvelope,0,e.peerRecordEnvelope.length):t.bytes===Array?Array.prototype.slice.call(e.peerRecordEnvelope):e.peerRecordEnvelope,t.oneofs&&(n._peerRecordEnvelope="peerRecordEnvelope")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),BR=(LR.Address=(()=>{function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}let t;return e.prototype.multiaddr=DR.newBuffer([]),e.prototype.isCertified=null,Object.defineProperty(e.prototype,"_isCertified",{get:DR.oneOfGetter(t=["isCertified"]),set:DR.oneOfSetter(t)}),e.encode=function(e,t){return t||(t=OR.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),null!=e.isCertified&&Object.hasOwnProperty.call(e,"isCertified")&&t.uint32(16).bool(e.isCertified),t},e.decode=function(e,t){e instanceof NR||(e=NR.create(e));var n=void 0===t?e.len:e.pos+t,r=new LR.Address;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.multiaddr=e.bytes();break;case 2:r.isCertified=e.bool();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof LR.Address)return e;var t=new LR.Address;return null!=e.multiaddr&&("string"===typeof e.multiaddr?DR.base64.decode(e.multiaddr,t.multiaddr=DR.newBuffer(DR.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),null!=e.isCertified&&(t.isCertified=Boolean(e.isCertified)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.multiaddr="":(n.multiaddr=[],t.bytes!==Array&&(n.multiaddr=DR.newBuffer(n.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(n.multiaddr=t.bytes===String?DR.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),null!=e.isCertified&&e.hasOwnProperty("isCertified")&&(n.isCertified=e.isCertified,t.oneofs&&(n._isCertified="isCertified")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),LR.Metadata=(()=>{function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value=DR.newBuffer([]),e.encode=function(e,t){return t||(t=OR.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).bytes(e.value),t},e.decode=function(e,t){e instanceof NR||(e=NR.create(e));var n=void 0===t?e.len:e.pos+t,r=new LR.Metadata;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.key=e.string();break;case 2:r.value=e.bytes();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof LR.Metadata)return e;var t=new LR.Metadata;return null!=e.key&&(t.key=String(e.key)),null!=e.value&&("string"===typeof e.value?DR.base64.decode(e.value,t.value=DR.newBuffer(DR.base64.length(e.value)),0):e.value.length&&(t.value=e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.key="",t.bytes===String?n.value="":(n.value=[],t.bytes!==Array&&(n.value=DR.newBuffer(n.value)))),null!=e.key&&e.hasOwnProperty("key")&&(n.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.bytes===String?DR.base64.encode(e.value,0,e.value.length):t.bytes===Array?Array.prototype.slice.call(e.value):e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),M.Reader),MR=M.Writer,UR=M.util,FR=M.roots["default"]||(M.roots["default"]={}),jR=FR.Envelope=(()=>{function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.publicKey=UR.newBuffer([]),e.prototype.payloadType=UR.newBuffer([]),e.prototype.payload=UR.newBuffer([]),e.prototype.signature=UR.newBuffer([]),e.encode=function(e,t){return t||(t=MR.create()),null!=e.publicKey&&Object.hasOwnProperty.call(e,"publicKey")&&t.uint32(10).bytes(e.publicKey),null!=e.payloadType&&Object.hasOwnProperty.call(e,"payloadType")&&t.uint32(18).bytes(e.payloadType),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(26).bytes(e.payload),null!=e.signature&&Object.hasOwnProperty.call(e,"signature")&&t.uint32(42).bytes(e.signature),t},e.decode=function(e,t){e instanceof BR||(e=BR.create(e));var n=void 0===t?e.len:e.pos+t,r=new FR.Envelope;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.publicKey=e.bytes();break;case 2:r.payloadType=e.bytes();break;case 3:r.payload=e.bytes();break;case 5:r.signature=e.bytes();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof FR.Envelope)return e;var t=new FR.Envelope;return null!=e.publicKey&&("string"===typeof e.publicKey?UR.base64.decode(e.publicKey,t.publicKey=UR.newBuffer(UR.base64.length(e.publicKey)),0):e.publicKey.length&&(t.publicKey=e.publicKey)),null!=e.payloadType&&("string"===typeof e.payloadType?UR.base64.decode(e.payloadType,t.payloadType=UR.newBuffer(UR.base64.length(e.payloadType)),0):e.payloadType.length&&(t.payloadType=e.payloadType)),null!=e.payload&&("string"===typeof e.payload?UR.base64.decode(e.payload,t.payload=UR.newBuffer(UR.base64.length(e.payload)),0):e.payload.length&&(t.payload=e.payload)),null!=e.signature&&("string"===typeof e.signature?UR.base64.decode(e.signature,t.signature=UR.newBuffer(UR.base64.length(e.signature)),0):e.signature.length&&(t.signature=e.signature)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.publicKey="":(n.publicKey=[],t.bytes!==Array&&(n.publicKey=UR.newBuffer(n.publicKey))),t.bytes===String?n.payloadType="":(n.payloadType=[],t.bytes!==Array&&(n.payloadType=UR.newBuffer(n.payloadType))),t.bytes===String?n.payload="":(n.payload=[],t.bytes!==Array&&(n.payload=UR.newBuffer(n.payload))),t.bytes===String?n.signature="":(n.signature=[],t.bytes!==Array&&(n.signature=UR.newBuffer(n.signature)))),null!=e.publicKey&&e.hasOwnProperty("publicKey")&&(n.publicKey=t.bytes===String?UR.base64.encode(e.publicKey,0,e.publicKey.length):t.bytes===Array?Array.prototype.slice.call(e.publicKey):e.publicKey),null!=e.payloadType&&e.hasOwnProperty("payloadType")&&(n.payloadType=t.bytes===String?UR.base64.encode(e.payloadType,0,e.payloadType.length):t.bytes===Array?Array.prototype.slice.call(e.payloadType):e.payloadType),null!=e.payload&&e.hasOwnProperty("payload")&&(n.payload=t.bytes===String?UR.base64.encode(e.payload,0,e.payload.length):t.bytes===Array?Array.prototype.slice.call(e.payload):e.payload),null!=e.signature&&e.hasOwnProperty("signature")&&(n.signature=t.bytes===String?UR.base64.encode(e.signature,0,e.signature.length):t.bytes===Array?Array.prototype.slice.call(e.signature):e.signature),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e})(),VR=M.Reader,zR=M.Writer,$R=M.util,KR=M.roots["default"]||(M.roots["default"]={}),HR=KR.PeerRecord=(()=>{function e(e){if(this.addresses=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.peerId=$R.newBuffer([]),e.prototype.seq=$R.Long?$R.Long.fromBits(0,0,!0):0,e.prototype.addresses=$R.emptyArray,e.encode=function(e,t){if(t||(t=zR.create()),null!=e.peerId&&Object.hasOwnProperty.call(e,"peerId")&&t.uint32(10).bytes(e.peerId),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(16).uint64(e.seq),null!=e.addresses&&e.addresses.length)for(var n=0;n<e.addresses.length;++n)KR.PeerRecord.AddressInfo.encode(e.addresses[n],t.uint32(26).fork()).ldelim();return t},e.decode=function(e,t){e instanceof VR||(e=VR.create(e));var n=void 0===t?e.len:e.pos+t,r=new KR.PeerRecord;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.peerId=e.bytes();break;case 2:r.seq=e.uint64();break;case 3:r.addresses&&r.addresses.length||(r.addresses=[]),r.addresses.push(KR.PeerRecord.AddressInfo.decode(e,e.uint32()));break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof KR.PeerRecord)return e;var t=new KR.PeerRecord;if(null!=e.peerId&&("string"===typeof e.peerId?$R.base64.decode(e.peerId,t.peerId=$R.newBuffer($R.base64.length(e.peerId)),0):e.peerId.length&&(t.peerId=e.peerId)),null!=e.seq&&($R.Long?(t.seq=$R.Long.fromValue(e.seq)).unsigned=!0:"string"===typeof e.seq?t.seq=parseInt(e.seq,10):"number"===typeof e.seq?t.seq=e.seq:"object"===typeof e.seq&&(t.seq=new $R.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0))),e.addresses){if(!Array.isArray(e.addresses))throw TypeError(".PeerRecord.addresses: array expected");t.addresses=[];for(var n=0;n<e.addresses.length;++n){if("object"!==typeof e.addresses[n])throw TypeError(".PeerRecord.addresses: object expected");t.addresses[n]=KR.PeerRecord.AddressInfo.fromObject(e.addresses[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.addresses=[]),t.defaults)if(t.bytes===String?n.peerId="":(n.peerId=[],t.bytes!==Array&&(n.peerId=$R.newBuffer(n.peerId))),$R.Long){var r=new $R.Long(0,0,!0);n.seq=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.seq=t.longs===String?"0":0;if(null!=e.peerId&&e.hasOwnProperty("peerId")&&(n.peerId=t.bytes===String?$R.base64.encode(e.peerId,0,e.peerId.length):t.bytes===Array?Array.prototype.slice.call(e.peerId):e.peerId),null!=e.seq&&e.hasOwnProperty("seq")&&("number"===typeof e.seq?n.seq=t.longs===String?String(e.seq):e.seq:n.seq=t.longs===String?$R.Long.prototype.toString.call(e.seq):t.longs===Number?new $R.LongBits(e.seq.low>>>0,e.seq.high>>>0).toNumber(!0):e.seq),e.addresses&&e.addresses.length){n.addresses=[];for(var s=0;s<e.addresses.length;++s)n.addresses[s]=KR.PeerRecord.AddressInfo.toObject(e.addresses[s],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.AddressInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.multiaddr=$R.newBuffer([]),e.encode=function(e,t){return t||(t=zR.create()),null!=e.multiaddr&&Object.hasOwnProperty.call(e,"multiaddr")&&t.uint32(10).bytes(e.multiaddr),t},e.decode=function(e,t){e instanceof VR||(e=VR.create(e));var n=void 0===t?e.len:e.pos+t,r=new KR.PeerRecord.AddressInfo;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.multiaddr=e.bytes();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof KR.PeerRecord.AddressInfo)return e;var t=new KR.PeerRecord.AddressInfo;return null!=e.multiaddr&&("string"===typeof e.multiaddr?$R.base64.decode(e.multiaddr,t.multiaddr=$R.newBuffer($R.base64.length(e.multiaddr)),0):e.multiaddr.length&&(t.multiaddr=e.multiaddr)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.multiaddr="":(n.multiaddr=[],t.bytes!==Array&&(n.multiaddr=$R.newBuffer(n.multiaddr)))),null!=e.multiaddr&&e.hasOwnProperty("multiaddr")&&(n.multiaddr=t.bytes===String?$R.base64.encode(e.multiaddr,0,e.multiaddr.length):t.bytes===Array?Array.prototype.slice.call(e.multiaddr):e.multiaddr),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e}(),e})();async function qR(e,t=(()=>{})){t(0,"Storing each peerstore key under a single datastore key"),await e.datastore.open();const n={},r=[];for await(const{key:s,value:i}of e.datastore.query({prefix:"/peers"})){r.push(s);const e=s.toString(),[,t,o,a,c]=e.split("/");if("peers"===t&&(["protos","addrs","metadata","keys"].includes(o)&&a))if(n[a]=n[a]||{addresses:[],protocols:[],metadata:[]},"protos"===o){const e=IR.decode(i);n[a].protocols=e.protocols.sort()}else if("addrs"===o){const e=PR.decode(i);n[a].addresses=e.addrs.sort(((e,t)=>Hr(e.multiaddr).toString().localeCompare(Hr(t.multiaddr).toString()))),e.certifiedRecord&&e.certifiedRecord.raw&&(n[a].peerRecordEnvelope=e.certifiedRecord.raw)}else"metadata"===o?n[a].metadata.push({key:c,value:i}):"keys"===o&&(n[a].pubKey=i)}t(33,"Read peer data from store");for(const s of r)await e.datastore.delete(s);t(66,"Removed existing peer data from store");for(const s of Object.keys(n)){const t=n[s];t.metadata=t.metadata.sort(((e,t)=>e.key.localeCompare(t.key)));const r=xR.encode(t).finish();await e.datastore.put(new Bs(`/peers/${s}`),r)}await e.datastore.close(),t(100,"Stored each peerstore key under a single datastore key")}async function WR(e,t=(()=>{})){t(0,"Storing each peerstore key under a multiple datastore keys"),await e.datastore.open();const n={},r=[];for await(const{key:s,value:i}of e.datastore.query({prefix:"/peers"})){r.push(s);const e=s.toString(),[,,t]=e.split("/");n[t]=xR.decode(i)}t(33,"Read peer data from store");for(const s of r)await e.datastore.delete(s);t(66,"Removed existing peer data from store");for(const[s,i]of Object.entries(n)){if(i.protocols&&i.protocols.length>0&&await e.datastore.put(new Bs(`/peers/protos/${s}`),IR.encode({protocols:i.protocols}).finish()),i.addresses&&i.addresses.length>0){const t=i.peerRecordEnvelope;let n;if(t){const e=jR.decode(t),r=HR.decode(e.payload);n={raw:t,seq:r.seq}}await e.datastore.put(new Bs(`/peers/addrs/${s}`),PR.encode({addrs:i.addresses,certifiedRecord:n}).finish())}if(i.metadata&&i.metadata.length>0)for(const{key:t,value:n}of i.metadata)await e.datastore.put(new Bs(`/peers/metadata/${s}/${t}`),n);i.pubKey&&await e.datastore.put(new Bs(`/peers/keys/${s}`),i.pubKey)}await e.datastore.close(),t(100,"Stored each peerstore key under multiple datastore keys")}M.util.Long=void 0,M.configure();const GR={version:12,description:"Store each peerstore peer under a single datastore key",migrate:qR,revert:WR},YR={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};var QR=[Object.assign({version:1},YR),Object.assign({version:2},YR),Object.assign({version:3},YR),Object.assign({version:4},YR),Object.assign({version:5},YR),Object.assign({version:6},YR),Object.assign({version:7},YR),LT,rR,gR,vR,GR];class XR extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=XR.code,this.message=e}}XR.code="ERR_NON_REVERSIBLE_MIGRATION";class JR extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=JR.code,this.message=e}}JR.code="ERR_NOT_INITIALIZED_REPO";class ZR extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=ZR.code,this.message=e}}ZR.code="ERR_REQUIRED_PARAMETER";class eC extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=eC.code,this.message=e}}eC.code="ERR_INVALID_VALUE";class tC extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=tC.code,this.message=e}}tC.code="ERR_MISSING_REPO_OPTIONS";const nC=T("ipfs:repo:migrator:repo:init");async function rC(e){if(!e)throw new tC("Please pass repo options when trying to open a repo");const t=e.root;try{await t.open();const e=await t.has(iR),n=await t.has(sR);return!(!e||!n)||(nC(`Version entry present: ${e}`),nC(`Config entry present: ${n}`),!1)}catch(n){return nC("While checking if repo is initialized error was thrown: "+n.message),!1}finally{if(void 0!==t)try{await t.close()}catch{}}}async function sC(e){if(!await rC(e))throw new JR("Repo is not initialized!");const t=e.root;await t.open();try{return parseInt(Fn(await t.get(iR)))}finally{await t.close()}}async function iC(e,t){if(!t)throw new tC("Please pass repo options when trying to open a repo");const n=t.root;await n.open(),await n.put(iR,An(String(e))),await n.close()}const oC=T("ipfs:repo:migrator");function aC(e){return e=e||QR,Array.isArray(e)&&0!==e.length?e[e.length-1].version:0}async function cC(e,t,n,r,s={}){const i=s.ignoreLock??!1,o=s.onProgress,a=s.isDryRun??!1,c=s.migrations??QR;if(!e)throw new hC.RequiredParameterError("Path argument is required!");if(!n)throw new hC.RequiredParameterError("repoOptions argument is required!");if(!r)throw new hC.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(r)||r<=0)throw new hC.InvalidValueError("Version has to be positive integer!");t=uR(t);const l=await sC(t);if(l===r)return void oC("Nothing to migrate.");if(l>r)throw new hC.InvalidValueError(`Current repo's version (${l}) is higher then toVersion (${r}), you probably wanted to revert it?`);let u;uC(c,l,r),a||i||(u=await n.repoLock.lock(e));try{for(const e of c){if(void 0!==r&&e.version>r)break;if(!(e.version<=l)){oC(`Migrating version ${e.version}`);try{if(!a){let n=()=>{};o&&(n=(t,n)=>o(e.version,t.toFixed(2),n)),await e.migrate(t,n)}}catch(h){const n=e.version-1;throw oC(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${n}`),await iC(n,t),new Error(`During migration to version ${e.version} exception was raised: ${h.stack||h.message||h}`)}oC(`Migrating to version ${e.version} finished`)}}a||await iC(r||aC(c),t),oC("Repo successfully migrated",void 0!==r?`to version ${r}!`:"to latest version!")}finally{a||i||!u||await u.close()}}async function lC(e,t,n,r,s={}){const i=s.ignoreLock??!1,o=s.onProgress,a=s.isDryRun??!1,c=s.migrations??QR;if(!e)throw new hC.RequiredParameterError("Path argument is required!");if(!n)throw new hC.RequiredParameterError("repoOptions argument is required!");if(!r)throw new hC.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(r)||r<=0)throw new hC.InvalidValueError("Version has to be positive integer!");t=uR(t);const l=await sC(t);if(l===r)return void oC("Nothing to revert.");if(l<r)throw new hC.InvalidValueError(`Current repo's version (${l}) is lower then toVersion (${r}), you probably wanted to migrate it?`);let u;uC(c,r,l,!0),a||i||(u=await n.repoLock.lock(e)),oC(`Reverting from version ${l} to ${r}`);try{const e=c.slice().reverse();for(const n of e){if(n.version<=r)break;if(!(n.version>l)){oC(`Reverting migration version ${n.version}`);try{if(!a){let e=()=>{};o&&(e=(e,t)=>o(n.version,e.toFixed(2),t)),await n.revert(t,e)}}catch(h){const e=n.version;throw oC(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${e}`),await iC(e,t),h.message=`During reversion to version ${n.version} exception was raised: ${h.message}`,h}oC(`Reverting to version ${n.version} finished`)}}a||await iC(r,t),oC(`All migrations successfully reverted to version ${r}!`)}finally{a||i||!u||await u.close()}}function uC(e,t,n,r=!1){let s=0;for(const i of e){if(i.version>n)break;if(i.version>t){if(r&&!i.revert)throw new hC.NonReversibleMigrationError(`It is not possible to revert to version ${t} because migration version ${i.version} is not reversible. Cancelling reversion.`);s++}}if(s!==n-t)throw new hC.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${t} to ${n}`)}const hC=_;var dC=n(6827);class fC extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=fC.code}}fC.code="ERR_LOCK_EXISTS";class pC extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=pC.code}}pC.code="ERR_NOT_FOUND";class gC extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=gC.code}}gC.code="ERR_INVALID_REPO_VERSION";const yC="ERR_REPO_NOT_INITIALIZED",mC="ERR_REPO_ALREADY_OPEN",wC="ERR_REPO_ALREADY_CLOSED";async function bC(e,t,n){const r=await t(e);if(r)return r;const s=_C(n);return!!s&&new Promise(((t,n)=>{const r=s.store("readonly").get(e.toString());r.transaction.onabort=()=>{n(r.transaction.error)},r.transaction.oncomplete=()=>{t(Boolean(r.result))}}))}async function vC(e,t,n,r){if(await n(e))return t(e);const s=_C(r);if(!s)throw new pC;return new Promise(((t,n)=>{const r=s.store("readonly").get(e.toString());r.transaction.onabort=()=>{n(r.transaction.error)},r.transaction.oncomplete=()=>{if(r.result)return t(r.result);n(new pC)}}))}function _C(e){let t=e;while(t.db||t.child)if(t=t.db||t.child,"level-js"===t.type||"Level"===t.constructor.name)return t}const EC=T("ipfs:repo:version"),SC=new Bs("version");function kC(e){return{async exists(){return bC(SC,e.has.bind(e),e)},async get(){const t=await vC(SC,e.get.bind(e),e.has.bind(e),e);return parseInt(Fn(t),10)},set(t){return e.put(SC,An(String(t)))},async check(e){const t=await this.get();EC("comparing version: %s and %s",t,e);const n=6===t&&7===e||6===e&&7===t;return t===e||n}}}const IC=Yi["default"]?Yi["default"]:Yi,AC=new Bs("config");function TC(e){const t=new IC({concurrency:1}),n={async getAll(t={}){const n=await vC(AC,e.get.bind(e),e.has.bind(e),e);return JSON.parse(Fn(n))},async get(e,t={}){if(null==e)throw new pC(`Key ${e} does not exist in config`);const n=await this.getAll(t),r=AT(n,e);if(void 0===r)throw new pC(`Key ${e} does not exist in config`);return r},set(e,n,s={}){if("string"!==typeof e&&!(e instanceof String))throw B(new Error("Invalid key type: "+typeof e),"ERR_INVALID_KEY");if(void 0===n||n instanceof Uint8Array)throw B(new Error("Invalid value type: "+typeof n),"ERR_INVALID_VALUE");return t.add((()=>r({key:e,value:n},s.signal)))},replace(e,n={}){if(!e||e instanceof Uint8Array)throw B(new Error("Invalid value type: "+typeof e),"ERR_INVALID_VALUE");return t.add((()=>r({key:void 0,value:e},n.signal)))},async exists(){return bC(AC,e.has.bind(e),e)}};return n;async function r(e,t){if(t&&t.aborted)return;const r=e.key,i=e.value;if(r){const e=await n.getAll();return"object"===typeof e&&null!==e&&sS(e,r,i),s(e)}return s(i)}function s(t){const n=An(JSON.stringify(t,null,2));return e.put(AC,n)}}function RC(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function CC(e,t={}){if(!RC(e)&&!Array.isArray(e))throw new TypeError("Expected a plain object or array");const{deep:n,compare:r}=t,s=[],i=[],o=e=>{const t=s.indexOf(e);if(-1!==t)return i[t];const n=[];return s.push(e),i.push(n),n.push(...e.map((e=>Array.isArray(e)?o(e):RC(e)?a(e):e))),n},a=e=>{const t=s.indexOf(e);if(-1!==t)return i[t];const c={},l=Object.keys(e).sort(r);s.push(e),i.push(c);for(const r of l){const t=e[r];let s;s=n&&Array.isArray(t)?o(t):n&&RC(t)?a(t):t,Object.defineProperty(c,r,{...Object.getOwnPropertyDescriptor(e,r),value:s})}return c};return Array.isArray(e)?n?o(e):e.slice():a(e)}const PC=new Bs("datastore_spec");function NC(e){return{exists(){return e.has(PC)},async get(){const t=await e.get(PC);return JSON.parse(Fn(t))},async set(t){return e.put(PC,An(JSON.stringify(CC(t,{deep:!0}))))}}}const OC=new Bs("api");function DC(e){return{async get(){const t=await e.get(OC);return t&&t.toString()},set(t){return e.put(OC,An(t.toString()))},delete(){return e.delete(OC)}}}n(4633);function LC(e){return{open(){return e.open()},close(){return e.close()},query(t,n){return e.query(t,n)},queryKeys(t,n){return e.queryKeys(t,n)},async get(t,n){const r=xC(t);return r.isIdentity?Promise.resolve(r.digest):e.get(t,n)},async*getMany(e,t){for await(const n of e)yield this.get(n,t)},async put(t,n,r){const{isIdentity:s}=xC(t);s||await e.put(t,n,r)},async*putMany(t,n){const r=Xh({objectMode:!0}),s=globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout;s((async()=>{try{await Hh(e.putMany(async function*(){for await(const{key:e,value:n}of t)xC(e).isIdentity||(yield{key:e,value:n}),r.push({key:e,value:n})}())),r.end()}catch(rb){r.end(rb)}})),yield*r},has(t,n){const{isIdentity:r}=xC(t);return r?Promise.resolve(!0):e.has(t,n)},delete(t,n){const{isIdentity:r}=xC(t);return r?Promise.resolve():e.delete(t,n)},deleteMany(t,n){return e.deleteMany(qh(t,(e=>!xC(e).isIdentity)),n)},batch(){const t=e.batch();return{put(e,n){const{isIdentity:r}=xC(e);r||t.put(e,n)},delete(e){const{isIdentity:n}=xC(e);n||t.delete(e)},commit:e=>t.commit(e)}}}}function xC(e){const t=X.k0.asCID(e);if(null==t)throw B(new Error("Not a valid cid"),"ERR_INVALID_CID");return t.multihash.code!==Nt.code?{isIdentity:!1}:{isIdentity:!0,digest:t.multihash.digest}}const BC=T("ipfs:repo:lock:memory"),MC="repo.lock",UC={};async function FC(e){const t=e+"/"+MC;if(BC("locking %s",t),!0===UC[t])throw new fC(`Lock already being held for file: ${t}`);UC[t]=!0;const n={async close(){UC[t]&&delete UC[t]}};return n}async function jC(e){const t=e+"/"+MC;return BC(`checking lock: ${t}`),Boolean(UC[t])}const VC={lock:FC,locked:jC};var zC={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:VC},$C={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};function KC(e){const t=Pe.k0.asCID(e);if(null==t)throw B(new Error("Not a valid cid"),"ERR_INVALID_CID");const n=C.base32.encode(t.multihash.bytes);return new Bs("/"+n.slice(1).toUpperCase(),!1)}function HC(e){return At.Jx(C.base32.decode(`b${e.toString().toLowerCase().substring(1)}`))}const qC=T("ipfs:repo:utils:walk-dag");async function*WC(e,t,n,r){try{const s=await t.get(e,r),i=await n(e.code),o=wS({bytes:s,cid:e,codec:i});for(const[,e]of o.links())yield e,yield*WC(e,t,n,r)}catch(rb){throw qC("Could not walk DAG for CID",e.toString(),rb),rb}}class GC extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"===typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"===typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"===typeof t.expiry&&t.expiry<=Date.now()&&("function"===typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){const n=this._deleteIfExpired(e,t);if(!1===n)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){const r=this._deleteIfExpired(t,n);!1===r&&(yield e)}}for(const e of this.cache){const[t,n]=e,r=this._deleteIfExpired(t,n);!1===r&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const r="number"===typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:r}):this._set(e,{value:t,expiry:r})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e,r=this._deleteIfExpired(t,n);!1===r&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){const e=this._deleteIfExpired(t,n);!1===e&&(yield[t,n.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[r,s]=n,i=this._deleteIfExpired(r,s);!1===i&&(yield[r,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[r,s]=n;if(!this.cache.has(r)){const e=this._deleteIfExpired(r,s);!1===e&&(yield[r,s.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,r]of this.entriesAscending())e.call(t,r,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}const YC=2048;function QC(e){const t=`Invalid type '${e}', must be one of {direct, indirect, recursive, all}`;return B(new Error(t),"ERR_INVALID_PIN_TYPE")}class XC{constructor({pinstore:e,blockstore:t,loadCodec:n}){this.pinstore=e,this.blockstore=t,this.loadCodec=n,this.log=T("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);const n={depth:0};return 0!==e.version&&(n.version=e.version),e.code!==Ae&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),this.pinstore.put(KC(e),Ne.cv(n))}unpin(e,t){return this.pinstore.delete(KC(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);const n={depth:1/0};0!==e.version&&(n.version=e.version),e.code!==Ae&&(n.codec=e.code),t.metadata&&(n.metadata=t.metadata),await this.pinstore.put(KC(e),Ne.cv(n))}async*directKeys(e){for await(const t of this.pinstore.query({filters:[e=>{const t=Ne.Jx(e.value);return 0===t.depth}]})){const e=Ne.Jx(t.value),n=e.version||0,r=null!=e.codec?e.codec:Ae,s=HC(t.key);yield{cid:X.k0.create(n,r,s),metadata:e.metadata}}}async*recursiveKeys(e){for await(const t of this.pinstore.query({filters:[e=>{const t=Ne.Jx(e.value);return t.depth===1/0}]})){const e=Ne.Jx(t.value),n=e.version||0,r=null!=e.codec?e.codec:Ae,s=HC(t.key);yield{cid:X.k0.create(n,r,s),metadata:e.metadata}}}async*indirectKeys(e){for await(const{cid:t}of this.recursiveKeys())for await(const n of WC(t,this.blockstore,this.loadCodec,e)){const e=[Lo.recursive],t=await this.isPinnedWithType(n,e);t.pinned||(yield n)}}async isPinnedWithType(e,t,n){Array.isArray(t)||(t=[t]);const r=t.includes(Lo.all),s=t.includes(Lo.direct),i=t.includes(Lo.recursive),o=t.includes(Lo.indirect);if(i||s||r){const n=await QS(this.pinstore.query({prefix:KC(e).toString(),filters:[e=>{if(r)return!0;const n=Ne.Jx(e.value);return t.includes(0===n.depth?Lo.direct:Lo.recursive)}],limit:1}));if(n){const t=Ne.Jx(n.value);return{cid:e,pinned:!0,reason:0===t.depth?Lo.direct:Lo.recursive,metadata:t.metadata}}}const a=this;async function*c(e,t){for await(const{cid:n}of t)for await(const t of WC(n,a.blockstore,a.loadCodec))if(t.equals(e))return void(yield n)}if(r||o){const t=await QS(c(e,this.recursiveKeys()));if(t)return{cid:e,pinned:!0,reason:Lo.indirect,parent:t}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t={}){const n=new GC({maxSize:t.cidCacheMaxSize??YC}),r=async(e,t)=>{if(n.has(e.toString()))return;n.set(e.toString(),!0);const s=await this.blockstore.get(e,t),i=await this.loadCodec(e.code),o=wS({bytes:s,cid:e,codec:i});await Promise.all([...o.links()].map((([,e])=>r(e,t))))};await r(e,t)}static checkPinType(e){if("string"!==typeof e||!Object.keys(Lo).includes(e))throw QC(e);return!0}}function JC(e,t){return{open(){return t.open()},close(){return t.close()},query(e,n){return t.query(e,n)},queryKeys(e,n){return t.queryKeys(e,n)},async get(e,n){return t.get(e,n)},async*getMany(e,n){yield*t.getMany(e,n)},async put(e,n,r){await t.put(e,n,r)},async*putMany(e,n){yield*t.putMany(e,n)},has(e,n){return t.has(e,n)},async delete(n,r){return await ZC(n,e),t.delete(n,r)},deleteMany(n,r){return t.deleteMany(_f(n,(async t=>(await ZC(t,e),t))),r)},batch(){return t.batch()}}}async function ZC(e,t){const{pinned:n,reason:r}=await t.isPinnedWithType(e,Lo.all);if(n)throw B(new Error(`pinned: ${r}`),"ERR_BLOCK_PINNED")}async function*eP(e,t=1){for await(const n of Vf(e,t)){const e=n.map((async e=>await e().then((e=>({ok:!0,value:e})),(e=>({ok:!1,err:e})))));for(let t=0;t<e.length;t++){const n=await e[t];if(!n.ok)throw n.err;yield n.value}}}const tP=T("ipfs:repo:gc"),nP=Ko().code,rP=256,sP=new Bs("/local/filesroot");function iP({gcLock:e,pins:t,blockstore:n,root:r,loadCodec:s}){async function*i(){const i=Date.now();tP("Creating set of marked blocks");const o=await e.writeLock();try{const e=await oP({pins:t,blockstore:n,root:r,loadCodec:s}),a=n.queryKeys({});yield*aP({blockstore:n},e,a),tP(`Complete (${Date.now()-i}ms)`)}finally{o()}}return i}async function oP({pins:e,blockstore:t,loadCodec:n,root:r}){const s=async function*(){let e;try{e=await r.get(sP)}catch(rb){if(rb.code===nP)return void tP("No blocks in MFS");throw rb}const s=X.k0.decode(e);yield s,yield*WC(s,t,n)}(),i=ad(_f(e.recursiveKeys(),(({cid:e})=>e)),e.indirectKeys(),_f(e.directKeys(),(({cid:e})=>e)),s),o=new Set;for await(const a of ad(i,s))o.add(C.base32.encode(a.multihash.bytes));return o}async function*aP({blockstore:e},t,n){let r=0,s=0;const i=async n=>async function(){r++;try{const r=C.base32.encode(n.multihash.bytes);if(t.has(r))return null;try{await e.delete(n),s++}catch(rb){return{err:new Error(`Could not delete block with CID ${n}: ${rb.message}`)}}return{cid:n}}catch(rb){const t=`Could delete block with CID ${n}`;return tP(t,rb),{err:new Error(t+`: ${rb.message}`)}}};yield*dd(eP(_f(n,i),rP),(e=>qh(e,Boolean))),tP(`Marked set has ${t.size} unique blocks. Blockstore has ${r} blocks. Deleted ${s} blocks.`)}const cP=T("ipfs:repo"),lP=Number.MAX_SAFE_INTEGER,uP="repoAutoMigrate";class hP{constructor(e,t,n,r){if("string"!==typeof e)throw new Error("missing repo path");if("function"!==typeof t)throw new Error("missing codec loader");this.options=I(zC,r),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;const s=n.blocks,i=n.pins;this.pins=new XC({pinstore:i,blockstore:s,loadCodec:t});const o=JC(this.pins,s);this.blocks=LC(o),this.version=kC(this.root),this.config=TC(this.root),this.spec=NC(this.root),this.apiAddr=DC(this.root),this.gcLock=Wk({name:e,singleProcess:!1!==this.options.repoOwner}),this.gc=iP({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){cP("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(pP(e)),await this.spec.set(gP(e)),await this.version.set(vT)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(rb){return!1}}async open(){if(!this.closed)throw B(new Error("repo is already open"),mC);cP("opening at: %s",this.path);try{await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),cP("acquired repo.lock");const e=await this.version.check(vT);if(!e){if(!await this._isAutoMigrationEnabled())throw new gC("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");await this._migrate(vT,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys})}cP("creating datastore"),await this.datastore.open(),cP("creating blocks"),await this.blocks.open(),cP("creating keystore"),await this.keys.open(),cP("creating pins"),await this.pins.pinstore.open(),this.closed=!1,cP("all opened")}catch(rb){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(e){cP("error removing lock",e)}throw rb}}async _openRoot(){try{await this.root.open()}catch(rb){if("Already open"!==rb.message)throw rb}}async _openLock(){const e=await this.options.repoLock.lock(this.path);if("function"!==typeof e.close)throw B(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){let e;cP("init check");try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(rb){if("ERR_NOT_FOUND"===rb.code)throw B(new Error("repo is not initialized yet"),yC,{path:this.path});throw rb}if(!e)throw B(new Error("repo is not initialized yet"),yC,{path:this.path})}async close(){if(this.closed)throw B(new Error("repo is already closed"),wC);cP("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(rb){if(rb.code!==yC&&!rb.message.startsWith("ENOENT"))throw rb}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map((e=>e&&e.close()))),cP("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[e,t,n,r,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),dP(this.datastore),dP(this.keys)]),i=t.size+r+s;return{repoPath:this.path,storageMax:e,version:n,numObjects:t.count,repoSize:i}}throw B(new Error("repo is not initialized yet"),yC,{path:this.path})}async _isAutoMigrationEnabled(){if(void 0!==this.options.autoMigrate)return this.options.autoMigrate;let e;try{e=await this.config.get(uP)}catch(t){if(t.code!==pC.code)throw t;e=!0}return e}async _migrate(e,t){const n=await this.version.get();return n>e?(cP(`reverting to version ${e}`),lC(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(cP(`migrating to version ${e}`),cC(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const e=await this.config.get("Datastore.StorageMax");return BigInt(dC(e))}catch(rb){return BigInt(lP)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(const{key:n,value:r}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(r.byteLength),t+=BigInt(n.bytes.byteLength);return{count:e,size:t}}}async function dP(e){let t=BigInt(0);for await(const n of e.query({}))t+=BigInt(n.value.byteLength),t+=BigInt(n.key.uint8Array().byteLength);return t}function fP(e,t,n,r){return new hP(e,t,n,r)}function pP(e){return e.Datastore=Object.assign({},$C,AT(e,"datastore")),e}function gP(e){const t={...$C.Spec,...AT(e,"Datastore.Spec")};return{type:t.type,mounts:t.mounts.map((e=>({mountpoint:e.mountpoint,type:e.child.type,path:e.child.path,shardFunc:e.child.shardFunc})))}}async function*yP(e,t){const n=await $h(e);yield*n.sort(t)}var mP=n(5739);class wP extends Gh{constructor(e,t={}){super(),this.db="string"===typeof e?new mP.Level(e,{...t,keyEncoding:"utf8",valueEncoding:"view"}):e,this.opts={createIfMissing:!0,compression:!1,...t}}async open(){try{await this.db.open(this.opts)}catch(rb){throw Vo(rb)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(rb){throw $o(rb)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(rb){if(rb.notFound)throw Ko(rb);throw $o(rb)}return t}async has(e){try{await this.db.get(e.toString())}catch(rb){if(rb.notFound)return!1;throw rb}return!0}async delete(e){try{await this.db.del(e.toString())}catch(rb){throw zo(rb)}}close(){return this.db&&this.db.close()}batch(){const e=[];return{put:(t,n)=>{e.push({type:"put",key:t.toString(),value:n})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>qh(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>yP(e,t)),t));const{offset:n,limit:r}=e;if(n){let e=0;t=qh(t,(()=>e++>=n))}return r&&(t=Wh(t,r)),t}queryKeys(e){let t=_f(this._query({values:!1,prefix:e.prefix}),(({key:e})=>e));Array.isArray(e.filters)&&(t=e.filters.reduce(((e,t)=>qh(e,t)),t)),Array.isArray(e.orders)&&(t=e.orders.reduce(((e,t)=>yP(e,t)),t));const{offset:n,limit:r}=e;if(n){let e=0;t=qh(t,(()=>e++>=n))}return r&&(t=Wh(t,r)),t}_query(e){const t={keys:!0,keyEncoding:"buffer",values:e.values};if(null!=e.prefix){const n=e.prefix.toString();t.gte=n,t.lt=n+"ÿ"}const n=this.db.iterator(t);if(n[Symbol.asyncIterator])return bP(n);if(null!=n.next&&null!=n.end)return vP(n);throw new Error("Level returned incompatible iterator")}}async function*bP(e){for await(const[t,n]of e)yield{key:new Bs(t,!1),value:n};await e.close()}function vP(e){return{[Symbol.asyncIterator](){return{next:()=>new Promise(((t,n)=>{e.next(((r,s,i)=>r?n(r):null==s?e.end((e=>{if(e)return n(e);t({done:!0,value:void 0})})):void t({done:!1,value:{key:new Bs(s,!1),value:i}})))})),return:()=>new Promise(((t,n)=>{e.end((e=>{if(e)return n(e);t({done:!0,value:void 0})}))}))}}}}const _P=(e,t)=>async function*(){const n=await $h(e);yield*n.sort(t)}();class EP{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(const{key:n,value:r}of e)await this.put(n,r,t),yield{key:n,value:r}}async*getMany(e,t={}){for await(const n of e)yield this.get(n,t)}async*deleteMany(e,t={}){for await(const n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(t,n){e.push({key:t,value:n})},delete(e){t.push(e)},commit:async n=>{await Hh(this.putMany(e,n)),e=[],await Hh(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(null!=e.prefix&&(n=qh(n,(t=>t.key.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>qh(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>_P(e,t)),n)),null!=e.offset){let t=0;n=qh(n,(()=>t++>=(e.offset||0)))}return null!=e.limit&&(n=Wh(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix&&(n=qh(n,(t=>t.toString().startsWith(e.prefix||"")))),Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>qh(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>_P(e,t)),n)),null!=e.offset){let t=0;n=qh(n,(()=>t++>=e.offset))}return null!=e.limit&&(n=Wh(n,e.limit)),n}}function SP(e){const t=X.k0.asCID(e);if(!t)throw B(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Bs("/"+C.base32.encode(t.multihash.bytes).slice(1).toUpperCase(),!1)}function kP(e){return X.k0.createV1(Xt,At.Jx(C.base32.decode("b"+e.toString().slice(1).toLowerCase())))}function IP(e){const t=e.substring(0,1);if("/"===t)return IP(e.substring(1));let n,r;n="b"===t.toLowerCase()?e=>C.base32.decode(e.toLowerCase()).subarray(2):"c"===t.toLowerCase()?e=>C.base32pad.decode(e.toLowerCase()).subarray(2):"z"===t?e=>R.base58btc.decode(e).subarray(2):"Q"===t?e=>R.base58btc.decode("z"+e):e=>C.base32.decode("b"+e.toLowerCase()).subarray(2);for(let i=1;i<e.length;i++)try{r=n(e.substring(0,i))}catch(rb){if("Unexpected end of data"!==rb.message)throw rb}let s="/C";return r&&(s=`/${C.base32.encode(r).slice(1,-1).toUpperCase()||"C"}`),s}function AP(e){return{...e,prefix:e.prefix?IP(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e({key:kP(t.key),value:t.value}))):void 0,orders:e.orders?e.orders.map((e=>(t,n)=>e({key:kP(t.key),value:t.value},{key:kP(n.key),value:n.value}))):void 0}}function TP(e){return{...e,prefix:e.prefix?IP(e.prefix):void 0,filters:e.filters?e.filters.map((e=>t=>e(kP(t)))):void 0,orders:e.orders?e.orders.map((e=>(t,n)=>e(kP(t),kP(n)))):void 0}}class RP extends EP{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(const{key:n,value:r}of this.child.query(AP(e),t))yield{key:kP(n),value:r}}async*queryKeys(e,t){for await(const n of this.child.queryKeys(TP(e),t))yield kP(n)}async get(e,t){return this.child.get(SP(e),t)}async*getMany(e,t){for await(const n of e)yield this.get(n,t)}async put(e,t,n){await this.child.put(SP(e),t,n)}async*putMany(e,t){const n=Xh({objectMode:!0}),r=globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout;r((async()=>{try{const r=this.child;await Hh(this.child.putMany(async function*(){for await(const s of e){const e=SP(s.key),i=await r.has(e,t);i||(yield{key:e,value:s.value}),n.push(s)}}())),n.end()}catch(rb){n.end(rb)}})),yield*n}has(e,t){return this.child.has(SP(e),t)}delete(e,t){return this.child.delete(SP(e),t)}deleteMany(e,t){const n=Xh({objectMode:!0});return Hh(this.child.deleteMany(async function*(){for await(const t of e)yield SP(t),n.push(t);n.end()}(),t)).catch((e=>{n.end(e)})),n}}function CP(e,t,n){const r=n.path||"ipfs";return fP(r,(e=>t.getCodec(e)),{root:new wP(r,{prefix:"",version:2}),blocks:new RP(new wP(`${r}/blocks`,{prefix:"",version:2})),datastore:new wP(`${r}/datastore`,{prefix:"",version:2}),keys:new wP(`${r}/keys`,{prefix:"",version:2}),pins:new wP(`${r}/pins`,{prefix:"",version:2})},{autoMigrate:n.autoMigrate,onMigrationProgress:n.onMigrationProgress||e,repoLock:VC})}const PP={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var NP;function OP(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,n){e[t]=n}}:{get(t){return e.get(t)},set(t,n){e.set(t,n)}}}(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.publicKey&&e.publicKey.byteLength>0)&&(t.uint32(10),t.bytes(e.publicKey)),(!0===n.writeDefaults||null!=e.payloadType&&e.payloadType.byteLength>0)&&(t.uint32(18),t.bytes(e.payloadType)),(!0===n.writeDefaults||null!=e.payload&&e.payload.byteLength>0)&&(t.uint32(26),t.bytes(e.payload)),(!0===n.writeDefaults||null!=e.signature&&e.signature.byteLength>0)&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(NP||(NP={}));const DP=4294967296;class LP{constructor(e=0,t=0){this.hi=e,this.lo=t}toBigInt(e){if(!0===e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){const e=-(1&this.lo),t=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new LP(n,t)}zzEncode(){const e=this.hi>>31,t=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new LP(t,n)}toBytes(e,t=0){const n=OP(e);while(this.hi>0)n.set(t++,127&this.lo|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;while(this.lo>127)n.set(t++,127&this.lo|128),this.lo=this.lo>>>7;n.set(t++,this.lo)}static fromBigInt(e){if(0n===e)return new LP;const t=e<0;t&&(e=-e);let n=0|Number(e>>32n),r=0|Number(e-(BigInt(n)<<32n));return t&&(n=~n>>>0,r=~r>>>0,++r>DP&&(r=0,++n>DP&&(n=0))),new LP(n,r)}static fromNumber(e){if(0===e)return new LP;const t=e<0;t&&(e=-e);let n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new LP(r,n)}static fromBytes(e,t=0){const n=OP(e),r=new LP;let s=0;if(e.length-t>4){for(;s<4;++s)if(r.lo=(r.lo|(127&n.get(t))<<7*s)>>>0,n.get(t++)<128)return r;if(r.lo=(r.lo|(127&n.get(t))<<28)>>>0,r.hi=(r.hi|(127&n.get(t))>>4)>>>0,n.get(t++)<128)return r;s=0}else for(;s<4;++s){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(r.lo=(r.lo|(127&n.get(t))<<7*s)>>>0,n.get(t++)<128)return r}if(e.length-t>4){for(;s<5;++s)if(r.hi=(r.hi|(127&n.get(t))<<7*s+3)>>>0,n.get(t++)<128)return r}else if(t<e.byteLength)for(;s<5;++s){if(t>=e.length)throw RangeError(`index out of range: ${t} > ${e.length}`);if(r.hi=(r.hi|(127&n.get(t))<<7*s+3)>>>0,n.get(t++)<128)return r}throw RangeError("invalid varint encoding")}}const xP=Math.pow(2,7),BP=Math.pow(2,14),MP=Math.pow(2,21),UP=Math.pow(2,28),FP=Math.pow(2,35),jP=Math.pow(2,42),VP=Math.pow(2,49),zP=Math.pow(2,56),$P=Math.pow(2,63),KP={encodingLength(e){return e<xP?1:e<BP?2:e<MP?3:e<UP?4:e<FP?5:e<jP?6:e<VP?7:e<zP?8:e<$P?9:10},encode(e,t,n=0){if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return null==t&&(t=vn(KP.encodingLength(e))),LP.fromNumber(e).toBytes(t,n),t},decode(e,t=0){return LP.fromBytes(e,t).toNumber(!0)}};class HP{constructor(e){const{peerId:t,payloadType:n,payload:r,signature:s}=e;this.peerId=t,this.payloadType=n,this.payload=r,this.signature=s}marshal(){if(null==this.peerId.publicKey)throw new Error("Missing public key");return null==this.marshaled&&(this.marshaled=NP.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return Pr(this.marshal(),e.marshal())}async validate(e){const t=qP(e,this.payloadType,this.payload);if(null==this.peerId.publicKey)throw new Error("Missing public key");const n=Fu(this.peerId.publicKey);return await n.verify(t.subarray(),this.signature)}}HP.createFromProtobuf=async e=>{const t=NP.decode(e),n=await ko(t.publicKey);return new HP({peerId:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})},HP.seal=async(e,t)=>{if(null==t.privateKey)throw new Error("Missing private key");const n=e.domain,r=e.codec,s=e.marshal(),i=qP(n,r,s),o=await Vu(t.privateKey),a=await o.sign(i.subarray());return new HP({peerId:t,payloadType:r,payload:s,signature:a})},HP.openAndCertify=async(e,t)=>{const n=await HP.createFromProtobuf(e),r=await n.validate(t);if(!r)throw B(new Error("envelope signature is not valid for the given domain"),PP.ERR_SIGNATURE_NOT_VALID);return n};const qP=(e,t,n)=>{const r=An(e),s=KP.encode(r.byteLength),i=KP.encode(t.length),o=KP.encode(n.length);return new wp(s,r,i,t,o,n)};function WP(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}var GP;(function(e){let t,n;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.multiaddr&&e.multiaddr.byteLength>0)&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.multiaddr=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=da(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),(!0===r.writeDefaults||null!=t.peerId&&t.peerId.byteLength>0)&&(n.uint32(10),n.bytes(t.peerId)),!0!==r.writeDefaults&&0n===t.seq||(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const s of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(s,n,{writeDefaults:!0});!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={peerId:new Uint8Array(0),seq:0n,addresses:[]},s=null==n?t.len:t.pos+n;while(t.pos<s){const n=t.uint32();switch(n>>>3){case 1:r.peerId=t.bytes();break;case 2:r.seq=t.uint64();break;case 3:r.addresses.push(e.AddressInfo.codec().decode(t,t.uint32()));break;default:t.skipType(7&n);break}}return r}))),n),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(GP||(GP={}));const YP="libp2p-peer-record",QP=Uint8Array.from([3,1]);class XP{constructor(e){this.domain=XP.DOMAIN,this.codec=XP.CODEC;const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=n??[],this.seqNumber=r??BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=GP.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof XP&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!WP(this.multiaddrs,e.multiaddrs)))}}XP.createFromProtobuf=e=>{const t=GP.decode(e),n=Eo(t.peerId),r=(t.addresses??[]).map((e=>Hr(e.multiaddr))),s=t.seq;return new XP({peerId:n,multiaddrs:r,seqNumber:s})},XP.DOMAIN=YP,XP.CODEC=QP;const JP=Symbol.for("@libp2p/topology");function ZP(e){return null!=e&&Boolean(e[JP])}const eN=()=>{};class tN{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??eN,this.onDisconnect=e.onDisconnect??eN}get[Symbol.toStringTag](){return JP.toString()}get[JP](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}}function nN(e){return new tN(e)}var rN,sN=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class iN extends EventTarget{constructor(){super(...arguments),rN.set(this,new Map)}listenerCount(e){const t=sN(this,rN,"f").get(e);return null==t?0:t.length}addEventListener(e,t,n){super.addEventListener(e,t,n);let r=sN(this,rN,"f").get(e);null==r&&(r=[],sN(this,rN,"f").set(e,r)),r.push({callback:t,once:(!0!==n&&!1!==n&&n?.once)??!1})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),t??null,n);let r=sN(this,rN,"f").get(e);null!=r&&(r=r.filter((({callback:e})=>e!==t)),sN(this,rN,"f").set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=sN(this,rN,"f").get(e.type);return null==n||(n=n.filter((({once:e})=>!e)),sN(this,rN,"f").set(e.type,n)),t}safeDispatchEvent(e,t){return this.dispatchEvent(new aN(e,t))}}rN=new WeakMap;class oN extends Event{constructor(e,t){super(e,t),this.detail=t?.detail}}const aN=globalThis.CustomEvent??oN;class cN{constructor(e,t,n){this.gossip=e,this.msgs=new Map,this.history=[],this.notValidatedCount=0,this.msgIdToStrFn=n;for(let r=0;r<t;r++)this.history[r]=[]}get size(){return this.msgs.size}put(e,t,n=!1){const{msgIdStr:r}=e;return!this.msgs.has(r)&&(this.msgs.set(r,{message:t,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:t.topic}),n||this.notValidatedCount++,!0)}observeDuplicate(e,t){const n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(t)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,t){const n=this.msgs.get(e);if(!n)return null;const r=(n.iwantCounts.get(t)??0)+1;return n.iwantCounts.set(t,r),{msg:n.message,count:r}}getGossipIDs(e){const t=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach((n=>{const r=this.msgs.get(n.msgIdStr);if(r&&r.validated&&e.has(n.topic)){let e=t.get(n.topic);e||(e=[],t.set(n.topic,e)),e.push(n.msgId)}}));return t}validate(e){const t=this.msgs.get(e);if(!t)return null;t.validated||this.notValidatedCount--;const{message:n,originatingPeers:r}=t;return t.validated=!0,t.originatingPeers=new Set,{message:n,originatingPeers:r}}shift(){const e=this.history[this.history.length-1];e.forEach((e=>{const t=this.msgs.get(e.msgIdStr);t&&(this.msgs.delete(e.msgIdStr),t.validated||this.notValidatedCount--)})),this.history.pop(),this.history.unshift([])}remove(e){const t=this.msgs.get(e);return t?(this.msgs.delete(e),t):null}}var lN=n(4482);const{RPC:uN}=lN,hN=1e3,dN=60*hN,fN="/floodsub/1.0.0",pN="/meshsub/1.0.0",gN="/meshsub/1.1.0",yN=6,mN=4,wN=12,bN=4,vN=2,_N=5,EN=3,SN=6,kN=.25,IN=3,AN=100,TN=hN,RN=dN,CN=16,PN=dN,NN=15,ON=300,DN=hN,LN=60,xN=2,BN=10*hN,MN=5e3,UN=10,FN=3*hN,jN=2*dN,VN=12e4,zN="ERR_TOPIC_VALIDATOR_REJECT",$N="ERR_TOPIC_VALIDATOR_IGNORE",KN=0,HN=128,qN=1e3,WN=1e3;function GN(e){if(e.length<=1)return e;const t=()=>Math.floor(Math.random()*Math.floor(e.length));for(let n=0;n<e.length;n++){const r=t(),s=e[n];e[n]=e[r],e[r]=s}return e}function YN(e){return Fn(e,"base64")}const QN="StrictSign",XN="StrictNoSign";var JN,ZN,eO,tO,nO,rO;function sO(e){switch(e){case JN.Ignore:return tO.Ignore;case JN.Reject:return tO.Reject}}async function iO(e,t){switch(e){case QN:{if(!t)throw Error("Must provide PeerId");if(null==t.privateKey)throw Error("Cannot sign message, no private key present");if(null==t.publicKey)throw Error("Cannot sign message, no public key present");const e=await Vu(t.privateKey);return{type:eO.Signing,author:t,key:t.publicKey,privateKey:e}}case XN:return{type:eO.Anonymous};default:throw new Error(`Unknown signature policy "${e}"`)}}(function(e){e["Accept"]="accept",e["Ignore"]="ignore",e["Reject"]="reject"})(JN||(JN={})),function(e){e["StrictSign"]="StrictSign",e["StrictNoSign"]="StrictNoSign"}(ZN||(ZN={})),function(e){e[e["Signing"]=0]="Signing",e[e["Anonymous"]=1]="Anonymous"}(eO||(eO={})),function(e){e["Error"]="error",e["Ignore"]="ignore",e["Reject"]="reject",e["Blacklisted"]="blacklisted"}(tO||(tO={})),function(e){e["InvalidSignature"]="invalid_signature",e["InvalidSeqno"]="invalid_seqno",e["InvalidPeerId"]="invalid_peerid",e["SignaturePresent"]="signature_present",e["SeqnoPresent"]="seqno_present",e["FromPresent"]="from_present",e["TransformFailed"]="transform_failed"}(nO||(nO={})),function(e){e["duplicate"]="duplicate",e["invalid"]="invalid",e["valid"]="valid"}(rO||(rO={}));const oO="ERR_INVALID_PEER_SCORE_PARAMS",aO={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:36e5},cO={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function lO(e={}){return{...aO,...e,topics:e.topics?Object.entries(e.topics).reduce(((e,[t,n])=>(e[t]=uO(n),e)),{}):{}}}function uO(e={}){return{...cO,...e}}function hO(e){for(const[n,r]of Object.entries(e.topics))try{dO(r)}catch(t){throw new ao(`invalid score parameters for topic ${n}: ${t.message}`,oO)}if(e.topicScoreCap<0)throw new ao("invalid topic score cap; must be positive (or 0 for no cap)",oO);if(null===e.appSpecificScore||void 0===e.appSpecificScore)throw new ao("missing application specific score function",oO);if(e.IPColocationFactorWeight>0)throw new ao("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",oO);if(0!==e.IPColocationFactorWeight&&e.IPColocationFactorThreshold<1)throw new ao("invalid IPColocationFactorThreshold; must be at least 1",oO);if(e.behaviourPenaltyWeight>0)throw new ao("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",oO);if(0!==e.behaviourPenaltyWeight&&(e.behaviourPenaltyDecay<=0||e.behaviourPenaltyDecay>=1))throw new ao("invalid BehaviourPenaltyDecay; must be between 0 and 1",oO);if(e.decayInterval<1e3)throw new ao("invalid DecayInterval; must be at least 1s",oO);if(e.decayToZero<=0||e.decayToZero>=1)throw new ao("invalid DecayToZero; must be between 0 and 1",oO)}function dO(e){if(e.topicWeight<0)throw new ao("invalid topic weight; must be >= 0",oO);if(0===e.timeInMeshQuantum)throw new ao("invalid TimeInMeshQuantum; must be non zero",oO);if(e.timeInMeshWeight<0)throw new ao("invalid TimeInMeshWeight; must be positive (or 0 to disable)",oO);if(0!==e.timeInMeshWeight&&e.timeInMeshQuantum<=0)throw new ao("invalid TimeInMeshQuantum; must be positive",oO);if(0!==e.timeInMeshWeight&&e.timeInMeshCap<=0)throw new ao("invalid TimeInMeshCap; must be positive",oO);if(e.firstMessageDeliveriesWeight<0)throw new ao("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",oO);if(0!==e.firstMessageDeliveriesWeight&&(e.firstMessageDeliveriesDecay<=0||e.firstMessageDeliveriesDecay>=1))throw new ao("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",oO);if(0!==e.firstMessageDeliveriesWeight&&e.firstMessageDeliveriesCap<=0)throw new ao("invalid FirstMessageDeliveriesCap; must be positive",oO);if(e.meshMessageDeliveriesWeight>0)throw new ao("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",oO);if(0!==e.meshMessageDeliveriesWeight&&(e.meshMessageDeliveriesDecay<=0||e.meshMessageDeliveriesDecay>=1))throw new ao("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",oO);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesCap<=0)throw new ao("invalid MeshMessageDeliveriesCap; must be positive",oO);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesThreshold<=0)throw new ao("invalid MeshMessageDeliveriesThreshold; must be positive",oO);if(e.meshMessageDeliveriesWindow<0)throw new ao("invalid MeshMessageDeliveriesWindow; must be non-negative",oO);if(0!==e.meshMessageDeliveriesWeight&&e.meshMessageDeliveriesActivation<1e3)throw new ao("invalid MeshMessageDeliveriesActivation; must be at least 1s",oO);if(e.meshFailurePenaltyWeight>0)throw new ao("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",oO);if(0!==e.meshFailurePenaltyWeight&&(e.meshFailurePenaltyDecay<=0||e.meshFailurePenaltyDecay>=1))throw new ao("invalid MeshFailurePenaltyDecay; must be between 0 and 1",oO);if(e.invalidMessageDeliveriesWeight>0)throw new ao("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",oO);if(e.invalidMessageDeliveriesDecay<=0||e.invalidMessageDeliveriesDecay>=1)throw new ao("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",oO)}const fO={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function pO(e={}){return{...fO,...e}}function gO(e,t,n,r){let s=0;Object.entries(t.topics).forEach((([e,t])=>{const r=n.topics[e];if(void 0===r)return;let i=0;if(t.inMesh){let e=t.meshTime/r.timeInMeshQuantum;e>r.timeInMeshCap&&(e=r.timeInMeshCap),i+=e*r.timeInMeshWeight}let o=t.firstMessageDeliveries;if(o>r.firstMessageDeliveriesCap&&(o=r.firstMessageDeliveriesCap),i+=o*r.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<r.meshMessageDeliveriesThreshold){const e=r.meshMessageDeliveriesThreshold-t.meshMessageDeliveries,n=e*e;i+=n*r.meshMessageDeliveriesWeight}const a=t.meshFailurePenalty;i+=a*r.meshFailurePenaltyWeight;const c=t.invalidMessageDeliveries*t.invalidMessageDeliveries;i+=c*r.invalidMessageDeliveriesWeight,s+=i*r.topicWeight})),n.topicScoreCap>0&&s>n.topicScoreCap&&(s=n.topicScoreCap);const i=n.appSpecificScore(e);if(s+=i*n.appSpecificWeight,t.knownIPs.forEach((e=>{if(n.IPColocationFactorWhitelist.has(e))return;const t=r.get(e),i=t?t.size:0;if(i>n.IPColocationFactorThreshold){const e=i-n.IPColocationFactorThreshold,t=e*e;s+=t*n.IPColocationFactorWeight}})),t.behaviourPenalty>n.behaviourPenaltyThreshold){const e=t.behaviourPenalty-n.behaviourPenaltyThreshold,r=e*e;s+=r*n.behaviourPenaltyWeight}return s}var yO,mO=n(482);(function(e){e[e["unknown"]=0]="unknown",e[e["valid"]=1]="valid",e[e["invalid"]=2]="invalid",e[e["ignored"]=3]="ignored"})(yO||(yO={}));class wO{constructor(){this.records=new Map,this.queue=new mO}ensureRecord(e){let t=this.records.get(e);if(t)return t;t={status:yO.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,t);const n={msgId:e,expire:Date.now()+VN};return this.queue.push(n),t}gc(){const e=Date.now();let t=this.queue.peekFront();while(t&&t.expire<e)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}function bO(e,t,n=(()=>!0)){const r=new Set;if(t<=0)return r;for(const s of e){if(r.size>=t)break;n(s)&&(r.add(s),e.delete(s))}return r}function vO(e,t){return bO(e,t,(()=>!0))}class _O extends Map{constructor(e){super(),this.getDefault=e}getOrDefault(e){let t=super.get(e);return void 0===t&&(t=this.getDefault(),this.set(e,t)),t}}const EO=x("libp2p:gossipsub:score");class SO{constructor(e,t,n){this.params=e,this.metrics=t,this.peerStats=new Map,this.peerIPs=new _O((()=>new Set)),this.scoreCache=new Map,this.deliveryRecords=new wO,hO(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??gO}get size(){return this.peerStats.size}start(){this._backgroundInterval?EO("Peer score already running"):(this._backgroundInterval=setInterval((()=>this.background()),this.params.decayInterval),EO("started"))}stop(){this._backgroundInterval?(clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),EO("stopped")):EO("Peer score already stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map((([e,t])=>[e,t])))}refreshScores(){const e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach(((n,r)=>{n.connected?(Object.entries(n.topics).forEach((([n,r])=>{const s=this.params.topics[n];void 0!==s&&(r.firstMessageDeliveries*=s.firstMessageDeliveriesDecay,r.firstMessageDeliveries<t&&(r.firstMessageDeliveries=0),r.meshMessageDeliveries*=s.meshMessageDeliveriesDecay,r.meshMessageDeliveries<t&&(r.meshMessageDeliveries=0),r.meshFailurePenalty*=s.meshFailurePenaltyDecay,r.meshFailurePenalty<t&&(r.meshFailurePenalty=0),r.invalidMessageDeliveries*=s.invalidMessageDeliveriesDecay,r.invalidMessageDeliveries<t&&(r.invalidMessageDeliveries=0),r.inMesh&&(r.meshTime=e-r.graftTime,r.meshTime>s.meshMessageDeliveriesActivation&&(r.meshMessageDeliveriesActive=!0)))})),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<t&&(n.behaviourPenalty=0)):e>n.expire&&(this.removeIPsForPeer(r,n.knownIPs),this.peerStats.delete(r),this.scoreCache.delete(r))}))}score(e){this.metrics?.scoreFnCalls.inc();const t=this.peerStats.get(e);if(!t)return 0;const n=Date.now(),r=this.scoreCache.get(e);if(r&&r.cacheUntil>n)return r.score;this.metrics?.scoreFnRuns.inc();const s=this.computeScore(e,t,this.params,this.peerIPs),i=n+this.scoreCacheValidityMs;return r?(this.metrics?.scoreCachedDelta.observe(Math.abs(s-r.score)),r.score=s,r.cacheUntil=i):this.scoreCache.set(e,{score:s,cacheUntil:i}),s}addPenalty(e,t,n){const r=this.peerStats.get(e);r&&(r.behaviourPenalty+=t,this.metrics?.onScorePenalty(n))}addPeer(e){const t={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,t)}addIP(e,t){const n=this.peerStats.get(e);n&&n.knownIPs.add(t),this.peerIPs.getOrDefault(t).add(e)}removeIP(e,t){const n=this.peerStats.get(e);n&&n.knownIPs.delete(t);const r=this.peerIPs.get(t);r&&(r.delete(e),0===r.size&&this.peerIPs.delete(t))}removePeer(e){const t=this.peerStats.get(e);if(t){if(this.score(e)>0)return this.removeIPsForPeer(e,t.knownIPs),void this.peerStats.delete(e);Object.entries(t.topics).forEach((([e,t])=>{t.firstMessageDeliveries=0;const n=this.params.topics[e].meshMessageDeliveriesThreshold;if(t.inMesh&&t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<n){const e=n-t.meshMessageDeliveries;t.meshFailurePenalty+=e*e}t.inMesh=!1,t.meshMessageDeliveriesActive=!1})),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){const n=this.peerStats.get(e);if(n){const e=this.getPtopicStats(n,t);e&&(e.inMesh=!0,e.graftTime=Date.now(),e.meshTime=0,e.meshMessageDeliveriesActive=!1)}}prune(e,t){const n=this.peerStats.get(e);if(n){const e=this.getPtopicStats(n,t);if(e){const n=this.params.topics[t].meshMessageDeliveriesThreshold;if(e.meshMessageDeliveriesActive&&e.meshMessageDeliveries<n){const t=n-e.meshMessageDeliveries;e.meshFailurePenalty+=t*t}e.meshMessageDeliveriesActive=!1,e.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,t,n){this.markFirstMessageDelivery(e,n);const r=this.deliveryRecords.ensureRecord(t),s=Date.now();r.status===yO.unknown?(r.status=yO.valid,r.validated=s,r.peers.forEach((t=>{t!==e.toString()&&this.markDuplicateMessageDelivery(t,n)}))):EO("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,s-r.firstSeen,yO[r.status])}rejectInvalidMessage(e,t){this.markInvalidMessageDelivery(e,t)}rejectMessage(e,t,n,r){switch(r){case tO.Error:return void this.markInvalidMessageDelivery(e,n);case tO.Blacklisted:return}const s=this.deliveryRecords.ensureRecord(t);if(s.status===yO.unknown){if(r===tO.Ignore)return s.status=yO.ignored,void s.peers.clear();s.status=yO.invalid,this.markInvalidMessageDelivery(e,n),s.peers.forEach((e=>{this.markInvalidMessageDelivery(e,n)})),s.peers.clear()}else EO("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-s.firstSeen,yO[s.status])}duplicateMessage(e,t,n){const r=this.deliveryRecords.ensureRecord(t);if(!r.peers.has(e))switch(r.status){case yO.unknown:r.peers.add(e);break;case yO.valid:r.peers.add(e),this.markDuplicateMessageDelivery(e,n,r.validated);break;case yO.invalid:this.markInvalidMessageDelivery(e,n);break;case yO.ignored:break}}markInvalidMessageDelivery(e,t){const n=this.peerStats.get(e);if(n){const e=this.getPtopicStats(n,t);e&&(e.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,t){const n=this.peerStats.get(e);if(n){const e=this.getPtopicStats(n,t);if(e){let n=this.params.topics[t].firstMessageDeliveriesCap;e.firstMessageDeliveries=Math.min(n,e.firstMessageDeliveries+1),e.inMesh&&(n=this.params.topics[t].meshMessageDeliveriesCap,e.meshMessageDeliveries=Math.min(n,e.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,t,n){const r=this.peerStats.get(e);if(r){const e=void 0!==n?Date.now():0,s=this.getPtopicStats(r,t);if(s&&s.inMesh){const r=this.params.topics[t];if(void 0!==n){const s=e-n,i=s>r.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(t,s,i),i)return}const i=r.meshMessageDeliveriesCap;s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1)}}}removeIPsForPeer(e,t){for(const n of t){const t=this.peerIPs.get(n);t&&(t.delete(e),0===t.size&&this.peerIPs.delete(n))}}getPtopicStats(e,t){let n=e.topics[t];return void 0!==n?n:void 0!==this.params.topics[t]?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[t]=n,n):null}}class kO{constructor(e,t,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=t,this.metrics=n,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,t){const n=Math.floor(Math.random()*t.length),r=t[n],s=this.msgIdToStrFn(r);let i=this.promises.get(s);i||(i=new Map,this.promises.set(s,i));const o=Date.now();i.has(e)||(i.set(e,o+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(s)||this.requestMsByMsg.set(s,o)))}getBrokenPromises(){const e=Date.now(),t=new Map;let n=0;return this.promises.forEach(((r,s)=>{r.forEach(((s,i)=>{s<e&&(t.set(i,(t.get(i)??0)+1),r.delete(i),n++)})),r.size||this.promises.delete(s)})),this.metrics?.iwantPromiseBroken.inc(n),t}deliverMessage(e,t=!1){this.trackMessage(e);const n=this.promises.get(e);n&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),t&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(n.size)))}rejectMessage(e,t){switch(this.trackMessage(e),t){case tO.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){const e=Date.now()-this.requestMsByMsgExpire;let t=0;for(const[n,r]of this.requestMsByMsg.entries()){if(!(r<e))break;this.requestMsByMsg.delete(n),t++}this.metrics?.iwantMessagePruned.inc(t)}trackMessage(e){if(this.metrics){const t=this.requestMsByMsg.get(e);void 0!==t&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-t)/1e3),this.requestMsByMsg.delete(e))}}}class IO{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,t){return!!this.entries.has(e)||(this.entries.set(e,{value:t,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){const e=Date.now();for(const[t,n]of this.entries.entries()){if(!(n.validUntilMs<e))break;this.entries.delete(t)}}has(e){return this.entries.has(e)}get(e){const t=this.entries.get(e);return t&&t.validUntilMs>=Date.now()?t.value:void 0}clear(){this.entries.clear()}}var AO,TO,RO,CO,PO,NO;function OO(e,t,n){return{protocolsEnabled:e.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:e.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:e.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:e.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:e.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:e.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:e.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:e.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:e.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:e.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:e.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:e.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:e.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:e.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:e.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:e.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:e.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:e.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:e.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:e.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:e.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:e.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:e.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:e.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:e.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:e.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:e.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:e.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:e.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:e.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:e.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:e.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:e.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:e.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:e.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:e.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:e.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:e.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:e.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:e.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*n.maxMeshMessageDeliveriesWindowSec,.5*n.maxMeshMessageDeliveriesWindowSec,1*n.maxMeshMessageDeliveriesWindowSec,2*n.maxMeshMessageDeliveriesWindowSec,4*n.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:e.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:e.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:e.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:e.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:e.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:e.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:e.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:e.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:e.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:e.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*n.behaviourPenaltyThreshold,.5*n.behaviourPenaltyThreshold,1*n.behaviourPenaltyThreshold,2*n.behaviourPenaltyThreshold,4*n.behaviourPenaltyThreshold]}),ihaveRcvIgnored:e.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:e.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:e.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:e.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:e.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:e.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:e.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:e.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:e.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:e.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:e.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:e.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*n.gossipPromiseExpireSec,1*n.gossipPromiseExpireSec,2*n.gossipPromiseExpireSec,4*n.gossipPromiseExpireSec]}),cacheSize:e.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:e.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:e.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:e.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:e.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:t,toTopic(e){return this.topicStrToLabel.get(e)??e},onJoin(e){this.topicSubscriptionStatus.set({topicStr:e},1),this.meshPeerCounts.set({topicStr:e},0)},onLeave(e){this.topicSubscriptionStatus.set({topicStr:e},0),this.meshPeerCounts.set({topicStr:e},0)},onAddToMesh(e,t,n){const r=this.toTopic(e);this.meshPeerInclusionEvents.inc({topic:r,reason:t},n)},onRemoveFromMesh(e,t,n){const r=this.toTopic(e);this.meshPeerChurnEvents.inc({topic:r,reason:t},n)},onReportValidationMcacheHit(e){this.asyncValidationMcacheHit.inc({hit:e?"hit":"miss"})},onReportValidation(e,t){const n=this.toTopic(e);this.asyncValidationResult.inc({topic:n,acceptance:t})},onScorePenalty(e){this.scoringPenalties.inc({penalty:e},1)},onIhaveRcv(e,t,n){const r=this.toTopic(e);this.ihaveRcvMsgids.inc({topic:r},t),this.ihaveRcvNotSeenMsgids.inc({topic:r},n)},onIwantRcv(e,t){for(const[n,r]of e){const e=this.toTopic(n);this.iwantRcvMsgids.inc({topic:e},r)}this.iwantRcvDonthaveMsgids.inc(t)},onForwardMsg(e,t){const n=this.toTopic(e);this.msgForwardCount.inc({topic:n},1),this.msgForwardPeers.inc({topic:n},t)},onPublishMsg(e,t,n,r){const s=this.toTopic(e);this.msgPublishCount.inc({topic:s},1),this.msgPublishBytes.inc({topic:s},n*r),this.msgPublishPeers.inc({topic:s},n),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"direct"},t.direct),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"floodsub"},t.floodsub),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"mesh"},t.mesh),this.msgPublishPeersByGroup.inc({topic:s,peerGroup:"fanout"},t.fanout)},onMsgRecvPreValidation(e){const t=this.toTopic(e);this.msgReceivedPreValidation.inc({topic:t},1)},onMsgRecvResult(e,t){const n=this.toTopic(e);this.msgReceivedStatus.inc({topic:n,status:t})},onMsgRecvInvalid(e,t){const n=this.toTopic(e),r=t.reason===tO.Error?t.error:t.reason;this.msgReceivedInvalid.inc({topic:n,error:r},1)},onDuplicateMsgDelivery(e,t,n){if(this.duplicateMsgDeliveryDelay.observe(t/1e3),n){const t=this.toTopic(e);this.duplicateMsgLateDelivery.inc({topic:t},1)}},onRpcRecv(e,t){this.rpcRecvBytes.inc(t),this.rpcRecvCount.inc(1),e.subscriptions&&this.rpcRecvSubscription.inc(e.subscriptions.length),e.messages&&this.rpcRecvMessage.inc(e.messages.length),e.control&&(this.rpcRecvControl.inc(1),e.control.ihave&&this.rpcRecvIHave.inc(e.control.ihave.length),e.control.iwant&&this.rpcRecvIWant.inc(e.control.iwant.length),e.control.graft&&this.rpcRecvGraft.inc(e.control.graft.length),e.control.prune&&this.rpcRecvPrune.inc(e.control.prune.length))},onRpcSent(e,t){if(this.rpcSentBytes.inc(t),this.rpcSentCount.inc(1),e.subscriptions&&this.rpcSentSubscription.inc(e.subscriptions.length),e.messages&&this.rpcSentMessage.inc(e.messages.length),e.control){const t=e.control.ihave?.length??0,n=e.control.iwant?.length??0,r=e.control.graft?.length??0,s=e.control.prune?.length??0;t>0&&this.rpcSentIHave.inc(t),n>0&&this.rpcSentIWant.inc(n),r>0&&this.rpcSentGraft.inc(r),s>0&&this.rpcSentPrune.inc(s),(t>0||n>0||r>0||s>0)&&this.rpcSentControl.inc(1)}},registerScores(e,t){let n=0,r=0,s=0,i=0;for(const o of e)o>=t.graylistThreshold&&n++,o>=t.publishThreshold&&r++,o>=t.gossipThreshold&&s++,o>=0&&i++;this.peersByScoreThreshold.set({threshold:NO.graylist},n),this.peersByScoreThreshold.set({threshold:NO.publish},r),this.peersByScoreThreshold.set({threshold:NO.gossip},s),this.peersByScoreThreshold.set({threshold:NO.mesh},i),this.score.set(e)},registerScoreWeights(e){for(const[t,n]of e.byTopic)this.scoreWeights.set({topic:t,p:"p1"},n.p1w),this.scoreWeights.set({topic:t,p:"p2"},n.p2w),this.scoreWeights.set({topic:t,p:"p3"},n.p3w),this.scoreWeights.set({topic:t,p:"p3b"},n.p3bw),this.scoreWeights.set({topic:t,p:"p4"},n.p4w);this.scoreWeights.set({p:"p5"},e.p5w),this.scoreWeights.set({p:"p6"},e.p6w),this.scoreWeights.set({p:"p7"},e.p7w)},registerScorePerMesh(e,t){const n=new Map;e.forEach(((e,t)=>{const r=this.topicStrToLabel.get(t)??"unknown";let s=n.get(r);s||(s=new Set,n.set(r,s)),e.forEach((e=>s?.add(e)))}));for(const[r,s]of n){const e=[];s.forEach((n=>{e.push(t.get(n)??0)})),this.scorePerMesh.set({topic:r},e)}}}}(function(e){e["forward"]="forward",e["publish"]="publish"})(AO||(AO={})),function(e){e["Fanout"]="fanout",e["Random"]="random",e["Subscribed"]="subscribed",e["Outbound"]="outbound",e["NotEnough"]="not_enough",e["Opportunistic"]="opportunistic"}(TO||(TO={})),function(e){e["Dc"]="disconnected",e["BadScore"]="bad_score",e["Prune"]="prune",e["Unsub"]="unsubscribed",e["Excess"]="excess"}(RO||(RO={})),function(e){e["GraftBackoff"]="graft_backoff",e["BrokenPromise"]="broken_promise",e["MessageDeficit"]="message_deficit",e["IPColocation"]="IP_colocation"}(CO||(CO={})),function(e){e["LowScore"]="low_score",e["MaxIhave"]="max_ihave",e["MaxIasked"]="max_iasked"}(PO||(PO={})),function(e){e["graylist"]="graylist",e["publish"]="publish",e["gossip"]="gossip",e["mesh"]="mesh"}(NO||(NO={}));n(22);var DO=n(2515);const LO={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function xO(e,t,n,r,s){if("sha1"!==s&&"sha2-256"!==s&&"sha2-512"!==s){const e=Object.keys(LO).join(" / ");throw new ao(`Hash '${s}' is unknown or not supported. Must be ${e}`,"ERR_UNSUPPORTED_HASH_TYPE")}const i=LO[s],o=DO(e,t,n,r,i);return ga.encode64(o,null)}const BO=An("libp2p-pubsub:");async function MO(e,t,n,r){switch(e.type){case eO.Signing:{const s={from:e.author.toBytes(),data:r,seqno:Bc(8),topic:t,signature:void 0,key:void 0},i=Xn([BO,uN.Message.encode(s).finish()]);s.signature=await e.privateKey.sign(i),s.key=e.key;const o={type:"signed",from:e.author,data:n,sequenceNumber:BigInt(`0x${Fn(s.seqno,"base16")}`),topic:t,signature:s.signature,key:s.key};return{raw:s,msg:o}}case eO.Anonymous:return{raw:{from:void 0,data:r,seqno:void 0,topic:t,signature:void 0,key:void 0},msg:{type:"unsigned",data:n,topic:t}}}}async function UO(e,t){switch(e){case XN:return null!=t.signature?{valid:!1,error:nO.SignaturePresent}:null!=t.seqno?{valid:!1,error:nO.SeqnoPresent}:null!=t.key?{valid:!1,error:nO.FromPresent}:{valid:!0,message:{type:"unsigned",topic:t.topic,data:t.data??new Uint8Array(0)}};case QN:{if(null==t.seqno)return{valid:!1,error:nO.InvalidSeqno};if(8!==t.seqno.length)return{valid:!1,error:nO.InvalidSeqno};if(null==t.signature)return{valid:!1,error:nO.InvalidSignature};if(null==t.from)return{valid:!1,error:nO.InvalidPeerId};let e,r;try{e=Eo(t.from)}catch(n){return{valid:!1,error:nO.InvalidPeerId}}if(t.key){if(r=Fu(t.key),void 0!==e.publicKey&&!Pr(r.bytes,e.publicKey))return{valid:!1,error:nO.InvalidPeerId}}else{if(null==e.publicKey)return{valid:!1,error:nO.InvalidPeerId};r=Fu(e.publicKey)}const s={from:t.from,data:t.data,seqno:t.seqno,topic:t.topic,signature:void 0,key:void 0},i=Xn([BO,uN.Message.encode(s).finish()]);return await r.verify(i,t.signature)?{valid:!0,message:{type:"signed",from:e,data:t.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${Fn(t.seqno,"base16")}`),topic:t.topic,signature:t.signature,key:t.key??ju(r)}}:{valid:!1,error:nO.InvalidSignature}}}}const FO=(e,t)=>{const n=An(t.toString(16).padStart(16,"0"),"base16"),r=new Uint8Array(e.length+n.length);return r.set(e,0),r.set(n,e.length),r};function jO(e){if("signed"!==e.type)throw new Error("expected signed message type");if(null==e.sequenceNumber)throw Error("missing seqno field");return FO(e.from.toBytes(),e.sequenceNumber)}async function VO(e){return await Gt.encode(e.data)}function zO(e,t,n,r,s){let i=0;const o=new Map;if(Object.entries(t.topics).forEach((([e,t])=>{const r=s.get(e)??"unknown",a=n.topics[e];if(void 0===a)return;let c=o.get(r);c||(c={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(r,c));let l=0,u=0,h=0,d=0,f=0;if(t.inMesh){const e=Math.max(t.meshTime/a.timeInMeshQuantum,a.timeInMeshCap);l+=e*a.timeInMeshWeight}let p=t.firstMessageDeliveries;if(p>a.firstMessageDeliveriesCap&&(p=a.firstMessageDeliveriesCap),u+=p*a.firstMessageDeliveriesWeight,t.meshMessageDeliveriesActive&&t.meshMessageDeliveries<a.meshMessageDeliveriesThreshold){const e=a.meshMessageDeliveriesThreshold-t.meshMessageDeliveries,n=e*e;h+=n*a.meshMessageDeliveriesWeight}const g=t.meshFailurePenalty;d+=g*a.meshFailurePenaltyWeight;const y=t.invalidMessageDeliveries*t.invalidMessageDeliveries;f+=y*a.invalidMessageDeliveriesWeight,i+=(l+u+h+d+f)*a.topicWeight,c.p1w+=l,c.p2w+=u,c.p3w+=h,c.p3bw+=d,c.p4w+=f})),n.topicScoreCap>0&&i>n.topicScoreCap){i=n.topicScoreCap;const e=n.topicScoreCap/i;for(const t of o.values())t.p1w*=e,t.p2w*=e,t.p3w*=e,t.p3bw*=e,t.p4w*=e}let a=0,c=0,l=0;const u=n.appSpecificScore(e);a+=u*n.appSpecificWeight,t.knownIPs.forEach((e=>{if(n.IPColocationFactorWhitelist.has(e))return;const t=r.get(e),s=t?t.size:0;if(s>n.IPColocationFactorThreshold){const e=s-n.IPColocationFactorThreshold,t=e*e;c+=t*n.IPColocationFactorWeight}}));const h=t.behaviourPenalty*t.behaviourPenalty;return l+=h*n.behaviourPenaltyWeight,i+=a+c+l,{byTopic:o,p5w:a,p6w:c,p7w:l,score:i}}function $O(e,t,n,r,s){const i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const o of e){const e=t.get(o);if(e){const t=zO(o,e,n,r,s);for(const[e,n]of t.byTopic){let t=i.byTopic.get(e);t||(t={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(e,t)),t.p1w.push(n.p1w),t.p2w.push(n.p2w),t.p3w.push(n.p3w),t.p3bw.push(n.p3bw),t.p4w.push(n.p4w)}i.p5w.push(t.p5w),i.p6w.push(t.p6w),i.p7w.push(t.p7w),i.score.push(t.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}class KO extends Error{constructor(e,t){super(e??"The operation was aborted"),this.type="aborted",this.code=t??"ABORT_ERR"}}function HO(e){if(null!=e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}function qO(e,t,n){const r=n??{},s=HO(e);async function*i(){let n;const i=()=>{null!=n&&n()};t.addEventListener("abort",i);while(1){let o;try{if(t.aborted){const{abortMessage:e,abortCode:t}=r;throw new KO(e,t)}const e=new Promise(((e,t)=>{n=()=>{const{abortMessage:e,abortCode:n}=r;t(new KO(e,n))}}));o=await Promise.race([e,s.next()]),n=null}catch(rb){t.removeEventListener("abort",i);const o="aborted"===rb.type&&t.aborted;if(o&&null!=r.onAbort&&await r.onAbort(e),"function"===typeof s.return)try{const e=s.return();e instanceof Promise&&e.catch((e=>{null!=r.onReturnError&&r.onReturnError(e)}))}catch(rb){null!=r.onReturnError&&r.onReturnError(rb)}if(o&&!0===r.returnOnAbort)return;throw rb}if(!0===o.done)break;yield o.value}t.removeEventListener("abort",i)}return i()}function WO(e,t,n){return r=>e(qO(r,t,n))}function GO(e,t,n){return{sink:WO(e.sink,t,{...n,onAbort:void 0}),source:qO(e.source,t,n)}}function YO(e){return null!=globalThis?.Buffer?.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}const QO=e=>{const t=KP.encodingLength(e),n=YO(t);return KP.encode(e,n),QO.bytes=t,n};function XO(e){e=e??{};const t=e.lengthEncoder??QO,n=async function*(e){for await(const n of e){const e=t(n.byteLength);e instanceof Uint8Array?yield e:yield*e,n instanceof Uint8Array?yield n:yield*n}};return n}QO.bytes=0,XO.single=(e,t)=>{t=t??{};const n=t.lengthEncoder??QO;return new wp(n(e.byteLength),e)};const JO=8,ZO=4194304;var eD;(function(e){e[e["LENGTH"]=0]="LENGTH",e[e["DATA"]=1]="DATA"})(eD||(eD={}));const tD=e=>{const t=KP.decode(e);return tD.bytes=KP.encodingLength(t),t};function nD(e){const t=async function*(t){const n=new wp;let r=eD.LENGTH,s=-1;const i=e?.lengthDecoder??tD,o=e?.maxLengthLength??JO,a=e?.maxDataLength??ZO;for await(const c of t){n.append(c);while(n.byteLength>0){if(r===eD.LENGTH)try{if(s=i(n),s<0)throw B(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>a)throw B(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const t=i.bytes;n.consume(t),null!=e?.onLength&&e.onLength(s),r=eD.DATA}catch(rb){if(rb instanceof RangeError){if(n.byteLength>o)throw B(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw rb}if(r===eD.DATA){if(n.byteLength<s)break;const t=n.sublist(0,s);n.consume(s),null!=e?.onData&&e.onData(t),yield t,r=eD.LENGTH}}}if(n.byteLength>0)throw B(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")};return t}tD.bytes=0,nD.fromReader=(e,t)=>{let n=1;const r=async function*(){while(1)try{const{done:t,value:r}=await e.next(n);if(!0===t)return;null!=r&&(yield r)}catch(rb){if("ERR_UNDER_READ"===rb.code)return{done:!0,value:null};throw rb}finally{n=1}}(),s=e=>{n=e};return nD({...t??{},onLength:s})(r)};class rD{constructor(e,t,n){this.rawStream=e,this.pushable=Xh({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=n.maxBufferSize??1/0,dd(qO(this.pushable,this.closeController.signal,{returnOnAbort:!0}),XO(),this.rawStream).catch(t)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}}class sD{constructor(e,t={}){this.rawStream=e,this.closeController=new AbortController,this.source=qO(dd(this.rawStream,nD(t)),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}}var iD=n(5797);const oD={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function aD(e,t){t={...t};const n=iD.Reader.create(e),r=e.length,s=void 0===r?n.len:n.pos+r,i={};while(n.pos<s){const e=n.uint32();switch(e>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.length<t.maxSubscriptions?i.subscriptions.push(cD(n,n.uint32())):n.skipType(7&e);break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.length<t.maxMessages?i.messages.push(lD(n,n.uint32())):n.skipType(7&e);break;case 3:i.control=uD(n,n.uint32(),t);break;default:n.skipType(7&e);break}}return i}function cD(e,t){const n=void 0===t?e.len:e.pos+t,r={};while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.subscribe=e.bool();break;case 2:r.topic=e.string();break;default:e.skipType(7&t);break}}return r}function lD(e,t){const n=void 0===t?e.len:e.pos+t,r={};while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.from=e.bytes();break;case 2:r.data=e.bytes();break;case 3:r.seqno=e.bytes();break;case 4:r.topic=e.string();break;case 5:r.signature=e.bytes();break;case 6:r.key=e.bytes();break;default:e.skipType(7&t);break}}if(!r.topic)throw Error("missing required 'topic'");return r}function uD(e,t,n){const r=void 0===t?e.len:e.pos+t,s={};while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:s.ihave&&s.ihave.length||(s.ihave=[]),s.ihave.length<n.maxControlMessages?s.ihave.push(hD(e,e.uint32(),n)):e.skipType(7&t);break;case 2:s.iwant&&s.iwant.length||(s.iwant=[]),s.iwant.length<n.maxControlMessages?s.iwant.push(dD(e,e.uint32(),n)):e.skipType(7&t);break;case 3:s.graft&&s.graft.length||(s.graft=[]),s.graft.length<n.maxControlMessages?s.graft.push(fD(e,e.uint32())):e.skipType(7&t);break;case 4:s.prune&&s.prune.length||(s.prune=[]),s.prune.length<n.maxControlMessages?s.prune.push(pD(e,e.uint32(),n)):e.skipType(7&t);break;default:e.skipType(7&t);break}}return s}function hD(e,t,n){const r=void 0===t?e.len:e.pos+t,s={};while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:s.topicID=e.string();break;case 2:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),n.maxIhaveMessageIDs-- >0?s.messageIDs.push(e.bytes()):e.skipType(7&t);break;default:e.skipType(7&t);break}}return s}function dD(e,t,n){const r=void 0===t?e.len:e.pos+t,s={};while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),n.maxIwantMessageIDs-- >0?s.messageIDs.push(e.bytes()):e.skipType(7&t);break;default:e.skipType(7&t);break}}return s}function fD(e,t){const n=void 0===t?e.len:e.pos+t,r={};while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.topicID=e.string();break;default:e.skipType(7&t);break}}return r}function pD(e,t,n){const r=void 0===t?e.len:e.pos+t,s={};while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:s.topicID=e.string();break;case 2:s.peers&&s.peers.length||(s.peers=[]),n.maxPeerInfos-- >0?s.peers.push(gD(e,e.uint32())):e.skipType(7&t);break;case 3:s.backoff=e.uint64();break;default:e.skipType(7&t);break}}return s}function gD(e,t){const n=void 0===t?e.len:e.pos+t,r={};while(e.pos<n){const t=e.uint32();switch(t>>>3){case 1:r.peerID=e.bytes();break;case 2:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&t);break}}return r}var yD;function mD(e){for(const t of e.tuples())switch(t[0]){case yD.ip4:case yD.ip6:return Jn(t[0],t[1])}return null}(function(e){e[e["ip4"]=4]="ip4",e[e["ip6"]=41]="ip6"})(yD||(yD={}));var wD;(function(e){e[e["started"]=0]="started",e[e["stopped"]=1]="stopped"})(wD||(wD={}));class bD extends iN{constructor(e,t={}){super(),this.multicodecs=[gN,pN],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=Xh({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.directPeerInitial=null,this.status={code:wD.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{const e=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch((e=>{this.log("Error running heartbeat",e)})).finally((()=>{if(null!=e&&e(),this.status.code===wD.started){clearTimeout(this.status.heartbeatTimeout);let e=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;e<.25*this.opts.heartbeatInterval&&(e+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,e)}}))};const n={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:yN,Dlo:mN,Dhi:wN,Dscore:bN,Dout:vN,Dlazy:SN,heartbeatInterval:TN,fanoutTTL:RN,mcacheLength:_N,mcacheGossip:EN,seenTTL:jN,gossipsubIWantFollowupMs:FN,prunePeers:CN,pruneBackoff:PN,graftFloodThreshold:BN,opportunisticGraftPeers:xN,opportunisticGraftTicks:LN,directConnectTicks:ON,...t,scoreParams:lO(t.scoreParams),scoreThresholds:pO(t.scoreThresholds)};if(this.components=e,this.decodeRpcLimits=n.decodeRpcLimits??oD,this.globalSignaturePolicy=n.globalSignaturePolicy??QN,n.fallbackToFloodsub&&this.multicodecs.push(fN),this.log=x(n.debugName??"libp2p:gossipsub"),this.opts=n,this.direct=new Set(n.directPeers.map((e=>e.id.toString()))),this.seenCache=new IO({validityMs:n.seenTTL}),this.publishedMessageIds=new IO({validityMs:n.seenTTL}),t.msgIdFn)this.msgIdFn=t.msgIdFn;else switch(this.globalSignaturePolicy){case QN:this.msgIdFn=jO;break;case XN:this.msgIdFn=VO;break}if(t.fastMsgIdFn&&(this.fastMsgIdFn=t.fastMsgIdFn,this.fastMsgIdCache=new IO({validityMs:n.seenTTL})),this.msgIdToStrFn=t.msgIdToStrFn??YN,this.mcache=t.messageCache||new cN(n.mcacheGossip,n.mcacheLength,this.msgIdToStrFn),t.dataTransform&&(this.dataTransform=t.dataTransform),t.metricsRegister){if(!t.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");const e=Math.max(...Object.values(n.scoreParams.topics).map((e=>e.meshMessageDeliveriesWindow)),WN),r=OO(t.metricsRegister,t.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:n.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:e/1e3});r.mcacheSize.addCollect((()=>this.onScrapeMetrics(r)));for(const t of this.multicodecs)r.protocolsEnabled.set({protocol:t},1);this.metrics=r}else this.metrics=null;this.gossipTracer=new kO(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new SO(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:n.heartbeatInterval}),this.maxInboundStreams=t.maxInboundStreams,this.maxOutboundStreams=t.maxOutboundStreams,this.allowedTopics=n.allowedTopics?new Set(n.allowedTopics):null}getPeers(){return[...this.peers.keys()].map((e=>_o(e)))}isStarted(){return this.status.code===wD.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await iO(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=Xh({objectMode:!0}),dd(this.outboundInflightQueue,(async e=>{for await(const{peerId:t,connection:n}of e)await this.createOutboundStream(t,n)})).catch((e=>this.log.error("outbound inflight queue error",e))),await Promise.all(this.opts.directPeers.map((async e=>{await this.components.peerStore.addressBook.add(e.id,e.addrs)})));const e=this.components.registrar;await Promise.all(this.multicodecs.map((t=>e.handle(t,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))));const t=nN({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),n=await Promise.all(this.multicodecs.map((n=>e.register(n,t)))),r=setTimeout(this.runHeartbeat,AN);this.status={code:wD.started,registrarTopologyIds:n,heartbeatTimeout:r,hearbeatStartMs:Date.now()+AN},this.score.start(),this.directPeerInitial=setTimeout((()=>{Promise.resolve().then((async()=>{await Promise.all(Array.from(this.direct).map((async e=>await this.connect(e))))})).catch((e=>{this.log(e)}))}),DN),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==wD.started)return;const{registrarTopologyIds:e}=this.status;this.status={code:wD.stopped};const t=this.components.registrar;e.forEach((e=>t.unregister(e))),this.outboundInflightQueue.end();for(const n of this.streamsOutbound.values())n.close();this.streamsOutbound.clear();for(const n of this.streamsInbound.values())n.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:t}){if(!this.isStarted())return;const n=t.remotePeer;this.addPeer(n,t.stat.direction,t.remoteAddr),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:t})}onPeerConnected(e,t){this.metrics?.newConnectionCount.inc({status:t.stat.status}),this.isStarted()&&"OPEN"===t.stat.status&&(this.addPeer(e,t.stat.direction,t.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:t}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,t){if(!this.isStarted())return;const n=e.toString();if(this.peers.has(n)&&!this.streamsOutbound.has(n))try{const r=new rD(await t.newStream(this.multicodecs),(e=>this.log.error("outbound pipe error",e)),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(n,r);const s=r.protocol;s===fN&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:s},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(r){this.log.error("createOutboundStream error",r)}}async createInboundStream(e,t){if(!this.isStarted())return;const n=e.toString();if(!this.peers.has(n))return;const r=this.streamsInbound.get(n);void 0!==r&&(this.log("replacing existing inbound steam %s",n),r.close()),this.log("create inbound stream %s",n);const s=new sD(t,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(n,s),this.pipePeerReadStream(e,s.source).catch((e=>this.log(e)))}addPeer(e,t,n){const r=e.toString();if(!this.peers.has(r)){this.log("new peer %p",e),this.peers.add(r),this.score.addPeer(r);const s=mD(n);null!==s?this.score.addIP(r,s):this.log("Added peer has no IP in current address %s %s",r,n.toString()),this.outbound.has(r)||this.outbound.set(r,"outbound"===t)}}removePeer(e){const t=e.toString();if(!this.peers.has(t))return;this.log("delete peer %p",e),this.peers.delete(t);const n=this.streamsOutbound.get(t),r=this.streamsInbound.get(t);n&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close(),r?.close(),this.streamsOutbound.delete(t),this.streamsInbound.delete(t);for(const s of this.topics.values())s.delete(t);for(const[s,i]of this.mesh)!0===i.delete(t)&&this.metrics?.onRemoveFromMesh(s,RO.Dc,1);for(const s of this.fanout.values())s.delete(t);this.floodsubPeers.delete(t),this.gossip.delete(t),this.control.delete(t),this.outbound.delete(t),this.score.removePeer(t),this.acceptFromWhitelist.delete(t)}get started(){return this.status.code===wD.started}getMeshPeers(e){const t=this.mesh.get(e);return t?Array.from(t):[]}getSubscribers(e){const t=this.topics.get(e);return(t?Array.from(t):[]).map((e=>_o(e)))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,t){try{await dd(t,(async t=>{for await(const r of t)try{const t=r.subarray(),n=aD(t,this.decodeRpcLimits);this.metrics?.onRpcRecv(n,t.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,n):this.handleReceivedRpc(e,n).catch((e=>this.log(e)))}catch(n){this.log(n)}}))}catch(rb){this.handlePeerReadStreamError(rb,e)}}handlePeerReadStreamError(e,t){this.log.error(e),this.onPeerDisconnected(t)}async handleReceivedRpc(e,t){if(!this.acceptFrom(e.toString()))return this.log("received message from unacceptable peer %p",e),void this.metrics?.rpcRecvNotAccepted.inc();if(this.log("rpc from %p",e),t.subscriptions&&t.subscriptions.length>0){const n=[];t.subscriptions.forEach((t=>{const r=t.topic,s=!0===t.subscribe;if(null!=r){if(this.allowedTopics&&!this.allowedTopics.has(r))return;this.handleReceivedSubscription(e,r,s),n.push({topic:r,subscribe:s})}})),this.dispatchEvent(new aN("subscription-change",{detail:{peerId:e,subscriptions:n}}))}if(t.messages)for(const n of t.messages){if(this.allowedTopics&&!this.allowedTopics.has(n.topic))continue;const t=this.handleReceivedMessage(e,n).catch((e=>this.log(e)));this.opts.awaitRpcMessageHandler&&await t}t.control&&await this.handleControlMessage(e.toString(),t.control)}handleReceivedSubscription(e,t,n){this.log("subscription update from %p topic %s",e,t);let r=this.topics.get(t);null==r&&(r=new Set,this.topics.set(t,r)),n?r.add(e.toString()):r.delete(e.toString())}async handleReceivedMessage(e,t){this.metrics?.onMsgRecvPreValidation(t.topic);const n=await this.validateReceivedMessage(e,t);switch(this.metrics?.onMsgRecvResult(t.topic,n.code),n.code){case rO.duplicate:return this.score.duplicateMessage(e.toString(),n.msgIdStr,t.topic),this.gossipTracer.deliverMessage(n.msgIdStr,!0),void this.mcache.observeDuplicate(n.msgIdStr,e.toString());case rO.invalid:if(n.msgIdStr){const r=n.msgIdStr;this.score.rejectMessage(e.toString(),r,t.topic,n.reason),this.gossipTracer.rejectMessage(r,n.reason)}else this.score.rejectInvalidMessage(e.toString(),t.topic);return void this.metrics?.onMsgRecvInvalid(t.topic,n);case rO.valid:if(this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,t,!this.opts.asyncValidation),this.subscriptions.has(t.topic)){const t=this.components.peerId.equals(e);t&&!this.opts.emitSelf||(super.dispatchEvent(new aN("gossipsub:message",{detail:{propagationSource:e,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new aN("message",{detail:n.msg})))}this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,t,e.toString())}}async validateReceivedMessage(e,t){const n=this.fastMsgIdFn?.(t),r=void 0!==n?this.fastMsgIdCache?.get(n):void 0;if(r)return{code:rO.duplicate,msgIdStr:r};const s=await UO(this.globalSignaturePolicy,t);if(!s.valid)return{code:rO.invalid,reason:tO.Error,error:s.error};const i=s.message;try{this.dataTransform&&(i.data=this.dataTransform.inboundTransform(t.topic,i.data))}catch(u){return this.log("Invalid message, transform failed",u),{code:rO.invalid,reason:tO.Error,error:nO.TransformFailed}}const o=await this.msgIdFn(i),a=this.msgIdToStrFn(o),c={msgId:o,msgIdStr:a};if(void 0!==n&&this.fastMsgIdCache){const e=this.fastMsgIdCache.put(n,a);e&&this.metrics?.fastMsgIdCacheCollision.inc()}if(this.seenCache.has(a))return{code:rO.duplicate,msgIdStr:a};this.seenCache.put(a);const l=this.topicValidators.get(t.topic);if(null!=l){let t;try{t=await l(e,i)}catch(u){const e=u.code;e===$N&&(t=JN.Ignore),t=e===zN?JN.Reject:JN.Ignore}if(t!==JN.Accept)return{code:rO.invalid,reason:sO(t),msgIdStr:a}}return{code:rO.valid,messageId:c,msg:i}}getScore(e){return this.score.score(e)}sendSubscriptions(e,t,n){this.sendRpc(e,{subscriptions:t.map((e=>({topic:e,subscribe:n})))})}async handleControlMessage(e,t){if(void 0===t)return;const n=t.ihave?this.handleIHave(e,t.ihave):[],r=t.iwant?this.handleIWant(e,t.iwant):[],s=t.graft?await this.handleGraft(e,t.graft):[];t.prune&&await this.handlePrune(e,t.prune),(n.length||r.length||s.length)&&this.sendRpc(e,{messages:r,control:{iwant:n,prune:s}})}acceptFrom(e){if(this.direct.has(e))return!0;const t=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<HN&&n.acceptUntil>=t)return n.messagesAccepted+=1,!0;const r=this.score.score(e);return r>=KN?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:t+qN}):this.acceptFromWhitelist.delete(e),r>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,t){if(!t.length)return[];const n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:PO.LowScore}),[];const r=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,r),r>UN)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,r),this.metrics?.ihaveRcvIgnored.inc({reason:PO.MaxIhave}),[];const s=this.iasked.get(e)??0;if(s>=MN)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:PO.MaxIasked}),[];const i=new Map;if(t.forEach((({topicID:e,messageIDs:t})=>{if(!e||!t||!this.mesh.has(e))return;let n=0;t.forEach((e=>{const t=this.msgIdToStrFn(e);this.seenCache.has(t)||(i.set(t,e),n++)})),this.metrics?.onIhaveRcv(e,t.length,n)})),!i.size)return[];let o=i.size;o+s>MN&&(o=MN-s),this.log("IHAVE: Asking for %d out of %d messages from %s",o,i.size,e);let a=Array.from(i.values());return GN(a),a=a.slice(0,o),this.iasked.set(e,s+o),this.gossipTracer.addPromise(e,a),[{messageIDs:a}]}handleIWant(e,t){if(!t.length)return[];const n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];const r=new Map,s=new Map;let i=0;return t.forEach((({messageIDs:t})=>{t&&t.forEach((t=>{const n=this.msgIdToStrFn(t),o=this.mcache.getWithIWantCount(n,e);null!=o?(s.set(o.msg.topic,1+(s.get(o.msg.topic)??0)),o.count>IN?this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,t):r.set(n,o.msg)):i++}))})),this.metrics?.onIwantRcv(s,i),r.size?(this.log("IWANT: Sending %d messages to %s",r.size,e),Array.from(r.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,t){const n=[],r=this.score.score(e),s=Date.now();let i=this.opts.doPX;return t.forEach((({topicID:t})=>{if(!t)return;const o=this.mesh.get(t);if(!o)return void(i=!1);if(o.has(e))return;if(this.direct.has(e))return this.log("GRAFT: ignoring request from direct peer %s",e),n.push(t),void(i=!1);const a=this.backoff.get(t)?.get(e);if("number"===typeof a&&s<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,CO.GraftBackoff),i=!1;const r=a+this.opts.graftFloodThreshold-this.opts.pruneBackoff;return s<r&&this.score.addPenalty(e,1,CO.GraftBackoff),this.addBackoff(e,t),void n.push(t)}return r<0?(this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,r,t),n.push(t),i=!1,void this.addBackoff(e,t)):o.size>=this.opts.Dhi&&!this.outbound.get(e)?(n.push(t),void this.addBackoff(e,t)):(this.log("GRAFT: Add mesh link from %s in %s",e,t),this.score.graft(e,t),o.add(e),void this.metrics?.onAddToMesh(t,TO.Subscribed,1))})),n.length?await Promise.all(n.map((t=>this.makePrune(e,t,i)))):[]}async handlePrune(e,t){const n=this.score.score(e);for(const{topicID:r,backoff:s,peers:i}of t){if(null==r)continue;const t=this.mesh.get(r);if(!t)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,r),this.score.prune(e,r),t.has(e)&&(t.delete(e),this.metrics?.onRemoveFromMesh(r,RO.Unsub,1)),"number"===typeof s&&s>0?this.doAddBackoff(e,r,1e3*s):this.addBackoff(e,r),i&&i.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,r);continue}await this.pxConnect(i)}}}addBackoff(e,t){this.doAddBackoff(e,t,this.opts.pruneBackoff)}doAddBackoff(e,t,n){let r=this.backoff.get(t);r||(r=new Map,this.backoff.set(t,r));const s=Date.now()+n,i=r.get(e)??0;i<s&&r.set(e,s)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach(((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e,CO.BrokenPromise)}))}clearBackoff(){if(this.heartbeatTicks%NN!==0)return;const e=Date.now();this.backoff.forEach(((t,n)=>{t.forEach(((n,r)=>{n<e&&t.delete(r)})),0===t.size&&this.backoff.delete(n)}))}async directConnect(){const e=[];this.direct.forEach((t=>{this.streamsOutbound.has(t)||e.push(t)})),await Promise.all(e.map((async e=>await this.connect(e))))}async pxConnect(e){e.length>this.opts.prunePeers&&(GN(e),e=e.slice(0,this.opts.prunePeers));const t=[];await Promise.all(e.map((async e=>{if(!e.peerID)return;const n=Eo(e.peerID).toString();if(!this.peers.has(n))if(e.signedPeerRecord)try{const r=await HP.openAndCertify(e.signedPeerRecord,"libp2p-peer-record"),s=r.peerId;if(!r.peerId.equals(n))return void this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",s,n);if(!await this.components.peerStore.addressBook.consumePeerRecord(r))return void this.log("bogus peer record obtained through px: could not add peer record to address book");t.push(n)}catch(r){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}else t.push(n)}))),t.length&&await Promise.all(t.map((async e=>await this.connect(e))))}async connect(e){this.log("Initiating connection with %s",e);const t=_o(e),n=await this.components.connectionManager.openConnection(t);for(const r of this.multicodecs)for(const e of this.components.registrar.getTopologies(r))e.onConnect(t,n)}subscribe(e){if(this.status.code!==wD.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(const t of this.peers.keys())this.sendSubscriptions(t,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==wD.started)throw new Error("Pubsub is not started");const t=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,t),t)for(const n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e)}join(e){if(this.status.code!==wD.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);const t=new Set,n=this.fanout.get(e);if(n&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),n.forEach((e=>{!this.direct.has(e)&&this.score.score(e)>=0&&t.add(e)})),this.metrics?.onAddToMesh(e,TO.Fanout,t.size)),t.size<this.opts.D){const n=t.size,r=this.getRandomGossipPeers(e,this.opts.D,(e=>!t.has(e)&&!this.direct.has(e)&&this.score.score(e)>=0));r.forEach((e=>{t.add(e)})),this.metrics?.onAddToMesh(e,TO.Random,t.size-n)}this.mesh.set(e,t),t.forEach((t=>{this.log("JOIN: Add mesh link to %s in %s",t,e),this.sendGraft(t,e)}))}leave(e){if(this.status.code!==wD.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);const t=this.mesh.get(e);t&&(Promise.all(Array.from(t).map((async t=>(this.log("LEAVE: Remove mesh link to %s in %s",t,e),await this.sendPrune(t,e))))).catch((e=>{this.log("Error sending prunes to mesh peers",e)})),this.mesh.delete(e))}selectPeersToForward(e,t,n){const r=new Set,s=this.topics.get(e);s&&(this.direct.forEach((e=>{s.has(e)&&t!==e&&!n?.has(e)&&r.add(e)})),this.floodsubPeers.forEach((e=>{s.has(e)&&t!==e&&!n?.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&r.add(e)})));const i=this.mesh.get(e);return i&&i.size>0&&i.forEach((e=>{t===e||n?.has(e)||r.add(e)})),r}selectPeersToPublish(e){const t=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},r=this.topics.get(e);if(r)if(this.opts.floodPublish)r.forEach((e=>{this.direct.has(e)?(t.add(e),n.direct++):this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),n.floodsub++)}));else{this.direct.forEach((e=>{r.has(e)&&(t.add(e),n.direct++)})),this.floodsubPeers.forEach((e=>{r.has(e)&&this.score.score(e)>=this.opts.scoreThresholds.publishThreshold&&(t.add(e),n.floodsub++)}));const s=this.mesh.get(e);if(s&&s.size>0)s.forEach((e=>{t.add(e),n.mesh++}));else{const r=this.fanout.get(e);if(r&&r.size>0)r.forEach((e=>{t.add(e),n.fanout++}));else{const r=this.getRandomGossipPeers(e,this.opts.D,(e=>this.score.score(e)>=this.opts.scoreThresholds.publishThreshold));r.size>0&&(this.fanout.set(e,r),r.forEach((e=>{t.add(e),n.fanout++})))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:t,tosendCount:n}}forwardMessage(e,t,n,r){n&&this.score.deliverMessage(n,e,t.topic);const s=this.selectPeersToForward(t.topic,n,r);s.forEach((e=>{this.sendRpc(e,{messages:[t]})})),this.metrics?.onForwardMsg(t.topic,s.size)}async publish(e,t,n){const r=this.dataTransform?this.dataTransform.outboundTransform(e,t):t;if(null==this.publishConfig)throw Error("PublishError.Uninitialized");const{raw:s,msg:i}=await MO(this.publishConfig,e,t,r),o=await this.msgIdFn(i),a=this.msgIdToStrFn(o);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");const{tosend:c,tosendCount:l}=this.selectPeersToPublish(e),u=!0===this.opts.emitSelf&&this.subscriptions.has(e),h=n?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(0===c.size&&!h&&!u)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:o,msgIdStr:a},s,!0),this.publishedMessageIds.put(a);for(const d of c){const e=this.sendRpc(d,{messages:[s]});e||c.delete(d)}return this.metrics?.onPublishMsg(e,l,c.size,null!=s.data?s.data.length:0),u&&(c.add(this.components.peerId.toString()),super.dispatchEvent(new aN("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:a,msg:i}})),super.dispatchEvent(new aN("message",{detail:i}))),{recipients:Array.from(c.values()).map((e=>_o(e)))}}reportMessageValidationResult(e,t,n){if(n===JN.Accept){const r=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(null!==r),null!=r){const{message:s,originatingPeers:i}=r;this.score.deliverMessage(t.toString(),e,s.topic),this.forwardMessage(e,r.message,t.toString(),i),this.metrics?.onReportValidation(s.topic,n)}}else{const r=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(null!==r),r){const s=sO(n),{message:i,originatingPeers:o}=r;this.score.rejectMessage(t.toString(),e,i.topic,s);for(const t of o)this.score.rejectMessage(t,e,i.topic,s);this.metrics?.onReportValidation(i.topic,n)}}}sendGraft(e,t){const n=[{topicID:t}];this.sendRpc(e,{control:{graft:n}})}async sendPrune(e,t){const n=[await this.makePrune(e,t,this.opts.doPX)];this.sendRpc(e,{control:{prune:n}})}sendRpc(e,t){const n=this.streamsOutbound.get(e);if(!n)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;const r=this.control.get(e);r&&(this.piggybackControl(e,t,r),this.control.delete(e));const s=this.gossip.get(e);s&&(this.piggybackGossip(e,t,s),this.gossip.delete(e));const i=uN.encode(t).finish();try{n.push(i)}catch(o){return this.log.error(`Cannot send rpc to ${e}`,o),r&&this.control.set(e,r),s&&this.gossip.set(e,s),!1}return this.metrics?.onRpcSent(t,i.length),!0}piggybackControl(e,t,n){if(n.graft){t.control||(t.control={}),t.control.graft||(t.control.graft=[]);for(const r of n.graft)r.topicID&&this.mesh.get(r.topicID)?.has(e)&&t.control.graft.push(r)}if(n.prune){t.control||(t.control={}),t.control.prune||(t.control.prune=[]);for(const r of n.prune)r.topicID&&!this.mesh.get(r.topicID)?.has(e)&&t.control.prune.push(r)}}piggybackGossip(e,t,n){t.control||(t.control={}),t.control.ihave=n}async sendGraftPrune(e,t,n){const r=this.opts.doPX;for(const[s,i]of e){const e=i.map((e=>({topicID:e})));let o=[];const a=t.get(s);a&&(o=await Promise.all(a.map((async e=>await this.makePrune(s,e,r&&!n.get(s))))),t.delete(s)),this.sendRpc(s,{control:{graft:e,prune:o}})}for(const[s,i]of t){const e=await Promise.all(i.map((async e=>await this.makePrune(s,e,r&&!n.get(s)))));this.sendRpc(s,{control:{prune:e}})}}emitGossip(e){const t=this.mcache.getGossipIDs(new Set(e.keys()));for(const[n,r]of e)this.doEmitGossip(n,r,t.get(n)??[])}doEmitGossip(e,t,n){if(!n.length)return;if(GN(n),n.length>MN&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!t.size)return;let r=this.opts.Dlazy;const s=kN*t.size;let i=t;s>r&&(r=s),r>i.size?r=i.size:i=GN(Array.from(i)).slice(0,r),i.forEach((t=>{let r=n;n.length>MN&&(r=GN(r.slice()).slice(0,MN)),this.pushGossip(t,{topicID:e,messageIDs:r})}))}flush(){for(const[e,t]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,{control:{ihave:t}});for(const[e,t]of this.control.entries())this.control.delete(e),this.sendRpc(e,{control:{graft:t.graft,prune:t.prune}})}pushGossip(e,t){this.log("Add gossip to %s",e);const n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(t))}async makePrune(e,t,n){if(this.score.prune(e,t),this.streamsOutbound.get(e).protocol===pN)return{topicID:t,peers:[]};const r=this.opts.pruneBackoff/1e3;if(!n)return{topicID:t,peers:[],backoff:r};const s=this.getRandomGossipPeers(t,this.opts.prunePeers,(t=>t!==e&&this.score.score(t)>=0)),i=await Promise.all(Array.from(s).map((async e=>{const t=_o(e);return{peerID:t.toBytes(),signedPeerRecord:await this.components.peerStore.addressBook.getRawEnvelope(t)}})));return{topicID:t,peers:i,backoff:r}}async heartbeat(){const{D:e,Dlo:t,Dhi:n,Dscore:r,Dout:s,fanoutTTL:i}=this.opts;this.heartbeatTicks++;const o=new Map,a=e=>{let t=o.get(e);return void 0===t&&(t=this.score.score(e),o.set(e,t)),t},c=new Map,l=new Map,u=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const h=new Map;this.mesh.forEach(((i,o)=>{const d=this.topics.get(o),f=new Set,p=new Set;if(h.set(o,p),d){const e=GN(Array.from(d)),t=this.backoff.get(o);for(const n of e){const e=this.streamsOutbound.get(n);if(e&&this.multicodecs.includes(e.protocol)&&!i.has(n)&&!this.direct.has(n)){const e=a(n);t&&t.has(n)||!(e>=0)||f.add(n),e>=this.opts.scoreThresholds.gossipThreshold&&p.add(n)}}}const g=(e,t)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",e,o),this.addBackoff(e,o),i.delete(e),a(e)>=this.opts.scoreThresholds.gossipThreshold&&p.add(e),this.metrics?.onRemoveFromMesh(o,t,1);const n=l.get(e);n?n.push(o):l.set(e,[o])},y=(e,t)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",e,o),this.score.graft(e,o),i.add(e),p.delete(e),this.metrics?.onAddToMesh(o,t,1);const n=c.get(e);n?n.push(o):c.set(e,[o])};if(i.forEach((e=>{const t=a(e);t<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",e,t,o),g(e,RO.BadScore),u.set(e,!0))})),i.size<t){const t=e-i.size,n=vO(f,t);n.forEach((e=>{y(e,TO.NotEnough)}))}if(i.size>n){let t=Array.from(i);t.sort(((e,t)=>a(t)-a(e))),t=t.slice(0,r).concat(GN(t.slice(r)));let n=0;if(t.slice(0,e).forEach((e=>{this.outbound.get(e)&&n++})),n<s){const r=e=>{const n=t[e];for(let r=e;r>0;r--)t[r]=t[r-1];t[0]=n};if(n>0){let s=n;for(let n=1;n<e&&s>0;n++)this.outbound.get(t[n])&&(r(n),s--)}let s=e-n;for(let n=e;n<t.length&&s>0;n++)this.outbound.get(t[n])&&(r(n),s--)}t.slice(e).forEach((e=>{g(e,RO.Excess)}))}if(i.size>=t){let e=0;if(i.forEach((t=>{this.outbound.get(t)&&e++})),e<s){const t=s-e,n=bO(f,t,(e=>!0===this.outbound.get(e)));n.forEach((e=>{y(e,TO.Outbound)}))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&i.size>1){const e=Array.from(i).sort(((e,t)=>a(e)-a(t))),t=Math.floor(i.size/2),n=a(e[t]);if(n<this.opts.scoreThresholds.opportunisticGraftThreshold){const e=this.opts.opportunisticGraftPeers,t=bO(f,e,(e=>a(e)>n));for(const n of t)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",n,o),y(n,TO.Opportunistic)}}}));const d=Date.now();this.fanoutLastpub.forEach(((e,t)=>{e+i<d&&(this.fanout.delete(t),this.fanoutLastpub.delete(t))})),this.fanout.forEach(((t,n)=>{const r=this.topics.get(n);t.forEach((e=>{(!r.has(e)||a(e)<this.opts.scoreThresholds.publishThreshold)&&t.delete(e)}));const s=this.topics.get(n),i=[],o=new Set;if(h.set(n,o),s){const e=GN(Array.from(s));for(const n of e){const e=this.streamsOutbound.get(n);if(e&&this.multicodecs.includes(e.protocol)&&!t.has(n)&&!this.direct.has(n)){const e=a(n);e>=this.opts.scoreThresholds.publishThreshold&&i.push(n),e>=this.opts.scoreThresholds.gossipThreshold&&o.add(n)}}}if(t.size<e){const n=e-t.size;i.slice(0,n).forEach((e=>{t.add(e),o?.delete(e)}))}})),this.emitGossip(h),await this.sendGraftPrune(c,l,u),this.flush(),this.mcache.shift(),this.dispatchEvent(new aN("gossipsub:heartbeat"))}getRandomGossipPeers(e,t,n=(()=>!0)){const r=this.topics.get(e);if(!r)return new Set;let s=[];return r.forEach((e=>{const t=this.streamsOutbound.get(e);t&&this.multicodecs.includes(t.protocol)&&n(e)&&s.push(e)})),s=GN(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let t=0;for(const i of this.backoff.values())t+=i.size;e.cacheSize.set({cache:"backoff"},t);for(const[i,o]of this.topics)e.topicPeersCount.set({topicStr:i},o.size);for(const[i,o]of this.mesh)e.meshPeerCounts.set({topicStr:i},o.size);const n=[],r=new Map;e.behaviourPenalty.reset();for(const i of this.peers.keys()){const t=this.score.score(i);n.push(t),r.set(i,t),e.behaviourPenalty.observe(this.score.peerStats.get(i)?.behaviourPenalty??0)}e.registerScores(n,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,r);const s=$O(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(s)}}function vD(e={}){return t=>new bD(t,e)}bD.multicodec=gN;const _D=()=>({gossipsub:vD({fallbackToFloodsub:!0,emitSelf:!0,maxInboundStreams:64,maxOutboundStreams:128})}),ED=x("libp2p-delegated-peer-routing"),SD=3e4,kD=4;var ID,AD;(function(e){e[e["SENDING_QUERY"]=0]="SENDING_QUERY",e[e["PEER_RESPONSE"]=1]="PEER_RESPONSE",e[e["FINAL_PEER"]=2]="FINAL_PEER",e[e["QUERY_ERROR"]=3]="QUERY_ERROR",e[e["PROVIDER"]=4]="PROVIDER",e[e["VALUE"]=5]="VALUE",e[e["ADDING_PEER"]=6]="ADDING_PEER",e[e["DIALING_PEER"]=7]="DIALING_PEER"})(ID||(ID={})),function(e){e[e["PUT_VALUE"]=0]="PUT_VALUE",e[e["GET_VALUE"]=1]="GET_VALUE",e[e["ADD_PROVIDER"]=2]="ADD_PROVIDER",e[e["GET_PROVIDERS"]=3]="GET_PROVIDERS",e[e["FIND_NODE"]=4]="FIND_NODE",e[e["PING"]=5]="PING"}(AD||(AD={}));class TD{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Yi({concurrency:kD});const{protocol:t,host:n,port:r}=e.getEndpointConfig();ED(`enabled DelegatedPeerRouting via ${t}://${n}:${r}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,t={}){ED("findPeer starts: %p",e),t.timeout=t.timeout??SD,t.signal=js([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const n=wf(),r=wf();this.httpQueue.add((async()=>(n.resolve(),await r.promise)));try{await n.promise;for await(const n of this.client.dht.findPeer(e,t))if("FINAL_PEER"===n.name){const e={id:n.peer.id,multiaddrs:n.peer.multiaddrs,protocols:[]};return e}}catch(rb){throw ED.error("findPeer errored: %o",rb),rb}finally{r.resolve(),ED("findPeer finished: %p",e)}throw B(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(e,t={}){let n;const r=X.k0.asCID(e);n=null!=r?r:Eo(e),ED("getClosestPeers starts: %s",n),t.timeout=t.timeout??SD,t.signal=js([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const s=wf(),i=wf();this.httpQueue.add((async()=>(s.resolve(),await i.promise)));try{await s.promise;for await(const e of this.client.dht.query(n,t))"PEER_RESPONSE"===e.name&&(yield*e.closer.map((e=>({id:e.id,multiaddrs:e.multiaddrs,protocols:[]}))))}catch(rb){throw ED.error("getClosestPeers errored:",rb),rb}finally{i.resolve(),ED("getClosestPeers finished: %b",e)}}}function RD(e){return()=>new TD(e)}const CD=x("libp2p:delegated-content-routing"),PD=3e4,ND=4,OD=2;var DD,LD;(function(e){e[e["SENDING_QUERY"]=0]="SENDING_QUERY",e[e["PEER_RESPONSE"]=1]="PEER_RESPONSE",e[e["FINAL_PEER"]=2]="FINAL_PEER",e[e["QUERY_ERROR"]=3]="QUERY_ERROR",e[e["PROVIDER"]=4]="PROVIDER",e[e["VALUE"]=5]="VALUE",e[e["ADDING_PEER"]=6]="ADDING_PEER",e[e["DIALING_PEER"]=7]="DIALING_PEER"})(DD||(DD={})),function(e){e[e["PUT_VALUE"]=0]="PUT_VALUE",e[e["GET_VALUE"]=1]="GET_VALUE",e[e["ADD_PROVIDER"]=2]="ADD_PROVIDER",e[e["GET_PROVIDERS"]=3]="GET_PROVIDERS",e[e["FIND_NODE"]=4]="FIND_NODE",e[e["PING"]=5]="PING"}(LD||(LD={}));class xD{constructor(e){if(null==e)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Yi({concurrency:ND}),this.httpQueueRefs=new Yi({concurrency:OD});const{protocol:t,host:n,port:r}=e.getEndpointConfig();CD(`enabled DelegatedContentRouting via ${t}://${n}:${r}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,t={}){CD("findProviders starts: %c",e),t.timeout=t.timeout??PD,t.signal=js([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const n=wf(),r=wf();this.httpQueue.add((async()=>(n.resolve(),await r.promise)));try{await n.promise;for await(const n of this.client.dht.findProvs(e,t))"PROVIDER"===n.name&&(yield*n.providers.map((e=>{const t={id:e.id,protocols:[],multiaddrs:e.multiaddrs};return t})))}catch(rb){throw CD.error("findProviders errored:",rb),rb}finally{r.resolve(),CD("findProviders finished: %c",e)}}async provide(e,t={}){CD("provide starts: %c",e),t.timeout=t.timeout??PD,t.signal=js([this.abortController.signal].concat(null!=t.signal?[t.signal]:[])),await this.httpQueueRefs.add((async()=>{await this.client.block.stat(e,t),await Hh(this.client.dht.provide(e,t))})),CD("provide finished: %c",e)}async put(e,t,n={}){CD("put value start: %b",e),n.timeout=n.timeout??PD,n.signal=js([this.abortController.signal].concat(null!=n.signal?[n.signal]:[])),await this.httpQueue.add((async()=>{await Hh(this.client.dht.put(e,t,n))})),CD("put value finished: %b",e)}async get(e,t={}){CD("get value start: %b",e),t.timeout=t.timeout??PD,t.signal=js([this.abortController.signal].concat(null!=t.signal?[t.signal]:[]));const n=await this.httpQueue.add((async()=>{for await(const n of this.client.dht.get(e,t))if("VALUE"===n.name)return CD("get value finished: %b",e),n.value;throw B(new Error("Not found"),"ERR_NOT_FOUND")}));if(void 0===n)throw B(new Error("Not found"),"ERR_NOT_FOUND");return n}}function BD(e){return()=>new xD(e)}const MD=e=>Promise.reject(new Error(`No base found for "${e}"`));class UD{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||MD;for(const t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];const t=await this._loadBase(e);return null==this._basesByName[t.name]&&null==this._basesByPrefix[t.prefix]&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}}const FD=e=>Promise.reject(new Error(`No codec found for "${e}"`));class jD{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||FD;for(const t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const t="string"===typeof e?this._codecsByName:this._codecsByCode;if(t[e])return t[e];const n=await this._loadCodec(e);return null==t[e]&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}}const VD=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class zD{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||VD;for(const t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const t="string"===typeof e?this._hashersByName:this._hashersByCode;if(t[e])return t[e];const n=await this._loadHasher(e);return null==t[e]&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}}function $D(e){try{e=fk(Hr(e))}catch(rb){}return e=e.toString(),e}var KD=()=>{};const HD=x("ipfs-http-client:lib:error-handler"),qD=I.bind({ignoreUndefined:!0}),WD=A.isBrowser||A.isWebWorker?location.protocol:"http",GD=A.isBrowser||A.isWebWorker?location.hostname:"localhost",YD=A.isBrowser||A.isWebWorker?location.port:"5001",QD=(e={})=>{let t,n,r={};if("string"===typeof e||$r(e))t=new URL($D(e));else if(e instanceof URL)t=e;else if("string"===typeof e.url||$r(e.url))t=new URL($D(e.url)),r=e;else if(e.url instanceof URL)t=e.url,r=e;else{r=e||{};const n=(r.protocol||WD).replace(":",""),s=(r.host||GD).split(":")[0],i=r.port||YD;t=new URL(`${n}://${s}:${i}`)}if(r.apiPath?t.pathname=r.apiPath:"/"!==t.pathname&&void 0!==t.pathname||(t.pathname="api/v0"),A.isNode){const e=KD(t);n=r.agent||new e({keepAlive:!0,maxSockets:6})}return{...r,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:n}},XD=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const n=await e.json();HD(n),t=n.Message||n.message}else t=await e.text()}catch(rb){HD("Failed to parse error response",rb),t=rb.message}let n=new Qi.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(n=new Qi.TimeoutError),t&&t.includes("context deadline exceeded")&&(n=new Qi.TimeoutError)),t&&t.includes("request timed out")&&(n=new Qi.TimeoutError),t&&(n.message=t),n},JD=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,ZD=e=>e.replace(JD,(function(e){return"-"+e.toLowerCase()})),eL=e=>"string"===typeof e?Ks(e):e;class tL extends Qi{constructor(e={}){const t=QD(e);super({timeout:eL(t.timeout||0)||void 0,headers:t.headers,base:`${t.url}`,handleError:XD,transformSearchParams:e=>{const t=new URLSearchParams;for(const[n,r]of e)"undefined"!==r&&"null"!==r&&"signal"!==n&&t.append(ZD(n),r),"timeout"!==n||isNaN(r)||t.append(ZD(n),r);return t},agent:t.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const n=this.fetch;this.fetch=(e,r={})=>("string"!==typeof e||e.startsWith("/")||(e=`${t.url}/${e}`),n.call(this,e,qD(r,{method:"POST"})))}}Qi.HTTPError;const nL=e=>t=>e(new tL(t),t);function rL(e){if(null!=e)return"string"===typeof e?e:e.toString(8).padStart(4,"0")}function sL(e){if(null==e)return;let t;if(null!=e.secs&&(t={secs:e.secs,nsecs:e.nsecs}),null!=e.Seconds&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const n=e.getTime(),r=Math.floor(n/1e3);t={secs:r,nsecs:1e3*(n-1e3*r)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t&&null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw B(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function iL({arg:e,searchParams:t,hashAlg:n,mtime:r,mode:s,...i}={}){t&&(i={...i,...t}),n&&(i.hash=n),null!=r&&(r=sL(r),i.mtime=r.secs,i.mtimeNsecs=r.nsecs),null!=s&&(i.mode=rL(s)),i.timeout&&!isNaN(i.timeout)&&(i.timeout=`${i.timeout}ms`),void 0===e||null===e?e=[]:Array.isArray(e)||(e=[e]);const o=new URLSearchParams(i);return e.forEach((e=>o.append("arg",e))),o}const oL=nL((e=>{async function t(t={}){const n=await(await e.post("bitswap/wantlist",{signal:t.signal,searchParams:iL(t),headers:t.headers})).json();return(n.Keys||[]).map((e=>X.k0.parse(e["/"])))}return t})),aL=nL((e=>{async function t(t,n={}){const r=await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:iL({...n,peer:t.toString()}),headers:n.headers})).json();return(r.Keys||[]).map((e=>X.k0.parse(e["/"])))}return t})),cL=nL((e=>{async function t(t={}){const n=await e.post("bitswap/stat",{searchParams:iL(t),signal:t.signal,headers:t.headers});return lL(await n.json())}return t}));function lL(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map((e=>X.k0.parse(e["/"]))),peers:(e.Peers||[]).map((e=>_o(e))),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const uL=nL((e=>{async function t(t,n={}){const r=await e.post("bitswap/unwant",{signal:n.signal,searchParams:iL({arg:t.toString(),...n}),headers:n.headers});return r.json()}return t}));function hL(e){return{wantlist:oL(e),wantlistForPeer:aL(e),unwant:uL(e),stat:cL(e)}}const dL=nL((e=>{async function t(t,n={}){const r=await e.post("block/get",{signal:n.signal,searchParams:iL({arg:t.toString(),...n}),headers:n.headers});return new Uint8Array(await r.arrayBuffer())}return t}));async function fL(e){if(Pf(e))return new Blob([e]);if("string"===typeof e||e instanceof String)return new Blob([e.toString()]);if(Nf(e))return e;if(Df(e)&&(e=Tf(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=Cf(e),{value:n,done:r}=await t.peek();if(r)return pL(t);if(t.push(n),Number.isInteger(n))return new Blob([Uint8Array.from(await $h(t))]);if(Pf(n)||"string"===typeof n||n instanceof String)return pL(t)}throw B(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function pL(e){const t=[];for await(const n of e)t.push(n);return new Blob(t)}function gL(e){return lg(e,fL,!0)}function yL(e){if(null!=e)return"string"===typeof e?e:e.toString(8).padStart(4,"0")}async function mL(e,t,n={}){const r=[],s=new FormData;let i=0,o=0;for await(const{content:a,path:c,mode:l,mtime:u}of gL(e)){let e="";const t=a?"file":"dir";i>0&&(e=`-${i}`);let n=t+e;const h=[];if(null!==l&&void 0!==l&&h.push(`mode=${yL(l)}`),null!=u){const{secs:e,nsecs:t}=u;h.push(`mtime=${e}`),null!=t&&h.push(`mtime-nsecs=${t}`)}if(h.length&&(n=`${n}?${h.join("&")}`),a){s.set(n,a,null!=c?encodeURIComponent(c):void 0);const e=o+a.size;r.push({name:c,start:o,end:e}),o=e}else{if(null==c)throw new Error("path or content or both must be set");s.set(n,new File([""],encodeURIComponent(c),{type:"application/x-directory"}))}i++}return{total:o,parts:r,headers:n,body:s}}function wL(e){return e.filter(Boolean)}function bL(...e){return(0,js.anySignal)(wL(e))}const vL=nL((e=>{async function t(n,r={}){const s=new AbortController,i=bL(s.signal,r.signal);let o;try{const t=await e.post("block/put",{signal:i,searchParams:iL(r),...await mL([n],s,r.headers)});o=await t.json()}catch(rb){if("dag-pb"===r.format)return t(n,{...r,format:"protobuf"});if("dag-cbor"===r.format)return t(n,{...r,format:"cbor"});throw rb}return X.k0.parse(o.Key)}return t})),_L=nL((e=>{async function*t(t,n={}){Array.isArray(t)||(t=[t]);const r=await e.post("block/rm",{signal:n.signal,searchParams:iL({arg:t.map((e=>e.toString())),"stream-channels":!0,...n}),headers:n.headers});for await(const e of r.ndjson())yield EL(e)}return t}));function EL(e){const t={cid:X.k0.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const SL=nL((e=>{async function t(t,n={}){const r=await e.post("block/stat",{signal:n.signal,searchParams:iL({arg:t.toString(),...n}),headers:n.headers}),s=await r.json();return{cid:X.k0.parse(s.Key),size:s.Size}}return t}));function kL(e){return{get:dL(e),put:vL(e),rm:_L(e),stat:SL(e)}}const IL=nL((e=>{async function t(t,n={}){const r=await e.post("bootstrap/add",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),{Peers:s}=await r.json();return{Peers:s.map((e=>Hr(e)))}}return t})),AL=nL((e=>{async function t(t={}){const n=await e.post("bootstrap/rm",{signal:t.signal,searchParams:iL({...t,all:!0}),headers:t.headers}),{Peers:r}=await n.json();return{Peers:r.map((e=>Hr(e)))}}return t})),TL=nL((e=>{async function t(t={}){const n=await e.post("bootstrap/list",{signal:t.signal,searchParams:iL(t),headers:t.headers}),{Peers:r}=await n.json();return{Peers:r.map((e=>Hr(e)))}}return t})),RL=nL((e=>{async function t(t={}){const n=await e.post("bootstrap/add",{signal:t.signal,searchParams:iL({...t,default:!0}),headers:t.headers}),{Peers:r}=await n.json();return{Peers:r.map((e=>Hr(e)))}}return t})),CL=nL((e=>{async function t(t,n={}){const r=await e.post("bootstrap/rm",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),{Peers:s}=await r.json();return{Peers:s.map((e=>Hr(e)))}}return t}));function PL(e){return{add:IL(e),clear:AL(e),list:TL(e),reset:RL(e),rm:CL(e)}}const NL=nL((e=>{async function t(t,n={}){const r=await e.post("config/profile/apply",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.json();return{original:s.OldCfg,updated:s.NewCfg}}return t}));function OL(e){if(null==e)return e;const t=/^[A-Z]+$/,n={};return Object.keys(e).reduce(((n,r)=>(t.test(r)?n[r.toLowerCase()]=e[r]:t.test(r[0])?n[r[0].toLowerCase()+r.slice(1)]=e[r]:n[r]=e[r],n)),n)}const DL=nL((e=>{async function t(t={}){const n=await e.post("config/profile/list",{signal:t.signal,searchParams:iL(t),headers:t.headers}),r=await n.json();return r.map((e=>OL(e)))}return t}));function LL(e){return{apply:NL(e),list:DL(e)}}const xL=nL((e=>{const t=async(t,n={})=>{if(!t)throw new Error("key argument is required");const r=await e.post("config",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.json();return s.Value};return t})),BL=nL((e=>{const t=async(t={})=>{const n=await e.post("config/show",{signal:t.signal,searchParams:iL({...t}),headers:t.headers}),r=await n.json();return r};return t})),ML=nL((e=>{const t=async(t,n={})=>{const r=new AbortController,s=bL(r.signal,n.signal),i=await e.post("config/replace",{signal:s,searchParams:iL(n),...await mL([An(JSON.stringify(t))],r,n.headers)});await i.text()};return t})),UL=nL((e=>{const t=async(t,n,r={})=>{if("string"!==typeof t)throw new Error("Invalid key type");const s={...r,...FL(t,n)},i=await e.post("config",{signal:r.signal,searchParams:iL(s),headers:r.headers});await i.text()};return t})),FL=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function jL(e){return{getAll:BL(e),get:xL(e),set:UL(e),replace:ML(e),profiles:LL(e)}}const VL=nL((e=>{async function*t(t,n={}){const r=await e.post("dag/export",{signal:n.signal,searchParams:iL({arg:t.toString()}),headers:n.headers});yield*r.iterator()}return t}));async function*zL(e,t,n,r,s){const i=async e=>{const t=await n.getCodec(e.code),i=await r(e,s);return t.decode(i)},o=t.split("/").filter(Boolean);let a=await i(e),c=e;while(o.length){const e=o.shift();if(!e)throw B(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,e))throw B(new Error(`no link named "${e}" under ${c}`),"ERR_NO_LINK");a=a[e],yield{value:a,remainderPath:o.join("/")};const n=X.k0.asCID(a);n&&(c=n,a=await i(a))}yield{value:a,remainderPath:""}}const $L=(e,t)=>{const n=nL(((t,n)=>{const r=dL(n),s=async(t,n={})=>{if(n.path){const s=n.localResolve?await QS(zL(t,n.path,e,r,n)):await To(zL(t,n.path,e,r,n)),i=s;if(!i)throw B(new Error("Not found"),"ERR_NOT_FOUND");return i}const s=await e.getCodec(t.code),i=await r(t,n),o=s.decode(i);return{value:o,remainderPath:""}};return s}));return n(t)},KL=nL((e=>{async function*t(t,n={}){const r=new AbortController,s=bL(r.signal,n.signal),{headers:i,body:o}=await mL(t,r,n.headers),a=await e.post("dag/import",{signal:s,headers:i,body:o,searchParams:iL({"pin-roots":n.pinRoots})});for await(const{Root:e}of a.ndjson())if(void 0!==e){const{Cid:{"/":t},PinErrorMsg:n}=e;yield{root:{cid:X.k0.parse(t),pinErrorMsg:n}}}}return t})),HL=(e,t)=>{const n=nL((t=>{const n=async(n,r={})=>{const s={storeCodec:"dag-cbor",hashAlg:"sha2-256",...r};let i;if(s.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");i=n}else{const t=await e.getCodec(s.storeCodec);i=t.encode(n),s.inputCodec=s.storeCodec}const o=new AbortController,a=bL(o.signal,s.signal),c=await t.post("dag/put",{timeout:s.timeout,signal:a,searchParams:iL(s),...await mL([i],o,s.headers)}),l=await c.json();return X.k0.parse(l.Cid["/"])};return n}));return n(t)},qL=nL((e=>{const t=async(t,n={})=>{const r=await e.post("dag/resolve",{signal:n.signal,searchParams:iL({arg:`${t}${n.path?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers}),s=await r.json();return{cid:X.k0.parse(s.Cid["/"]),remainderPath:s.RemPath}};return t}));function WL(e,t){return{export:VL(t),get:$L(e,t),import:KL(t),put:HL(e,t),resolve:qL(t)}}const GL=0,YL=1,QL=2,XL=3,JL=4,ZL=5,ex=6,tx=7,nx=e=>{if(e.Type===GL)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===YL)return{from:_o(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:_o(e),multiaddrs:t.map((e=>Hr(e))),protocols:[]}))),providers:(e.Responses||[]).map((({ID:e,Addrs:t})=>({id:_o(e),multiaddrs:t.map((e=>Hr(e))),protocols:[]})))};if(e.Type===QL){let t={id:e.ID??_o(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:_o(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map((e=>Hr(e))),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(e.Type===XL)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===JL)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map((({ID:e,Addrs:t})=>({id:_o(e),multiaddrs:t.map((e=>Hr(e))),protocols:[]})))};if(e.Type===ZL)return{name:"VALUE",type:e.Type,value:An(e.Extra,"base64pad")};if(e.Type===ex){const t=e.Responses.map((({ID:e})=>_o(e)));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(e.Type===tx)return{name:"DIALING_PEER",type:e.Type,peer:_o(e.ID)};throw new Error("Unknown DHT event type")},rx=nL((e=>{async function*t(t,n={}){const r=await e.post("dht/findpeer",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers});for await(const e of r.ndjson())yield nx(e)}return t})),sx=nL((e=>{async function*t(t,n={}){const r=await e.post("dht/findprovs",{signal:n.signal,searchParams:iL({arg:t.toString(),...n}),headers:n.headers});for await(const e of r.ndjson())yield nx(e)}return t})),ix=nL((e=>{async function*t(t,n={}){const r=await e.post("dht/get",{signal:n.signal,searchParams:iL({arg:t instanceof Uint8Array?Fn(t):t.toString(),...n}),headers:n.headers});for await(const e of r.ndjson())yield nx(e)}return t})),ox=nL((e=>{async function*t(t,n={recursive:!1}){const r=Array.isArray(t)?t:[t],s=await e.post("dht/provide",{signal:n.signal,searchParams:iL({arg:r.map((e=>e.toString())),...n}),headers:n.headers});for await(const e of s.ndjson())yield nx(e)}return t})),ax=nL((e=>{async function*t(t,n,r={}){const s=new AbortController,i=bL(s.signal,r.signal),o=await e.post("dht/put",{signal:i,searchParams:iL({arg:t instanceof Uint8Array?Fn(t):t.toString(),...r}),...await mL([n],s,r.headers)});for await(const e of o.ndjson())yield nx(e)}return t})),cx=nL((e=>{async function*t(t,n={}){const r=await e.post("dht/query",{signal:n.signal,searchParams:iL({arg:t.toString(),...n}),headers:n.headers});for await(const e of r.ndjson())yield nx(e)}return t}));function lx(e){return{findPeer:rx(e),findProvs:sx(e),get:ix(e),provide:ox(e),put:ax(e),query:cx(e)}}const ux=nL((e=>{async function t(t={}){const n=await e.post("diag/cmds",{signal:t.signal,searchParams:iL(t),headers:t.headers});return n.json()}return t})),hx=nL((e=>{async function t(t={}){const n=await e.post("diag/net",{signal:t.signal,searchParams:iL(t),headers:t.headers});return n.json()}return t})),dx=nL((e=>{async function t(t={}){const n=await e.post("diag/sys",{signal:t.signal,searchParams:iL(t),headers:t.headers});return n.json()}return t}));function fx(e){return{cmds:ux(e),net:hx(e),sys:dx(e)}}const px=nL((e=>{async function t(t,n,r={}){const s=await e.post("files/chmod",{signal:r.signal,searchParams:iL({arg:t,mode:n,...r}),headers:r.headers});await s.text()}return t})),gx=nL((e=>{async function t(t,n,r={}){const s=Array.isArray(t)?t:[t],i=await e.post("files/cp",{signal:r.signal,searchParams:iL({arg:s.concat(n).map((e=>X.k0.asCID(e)?`/ipfs/${e}`:e)),...r}),headers:r.headers});await i.text()}return t})),yx=nL((e=>{async function t(t,n={}){if(!t||"string"!==typeof t)throw new Error("ipfs.files.flush requires a path");const r=await e.post("files/flush",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.json();return X.k0.parse(s.Cid)}return t}));function mx(e){const t=OL(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const wx=nL((e=>{async function*t(t,n={}){if(!t)throw new Error("ipfs.files.ls requires a path");const r=await e.post("files/ls",{signal:n.signal,searchParams:iL({arg:X.k0.asCID(t)?`/ipfs/${t}`:t,long:!0,...n,stream:!0}),headers:n.headers});for await(const e of r.ndjson())if("Entries"in e)for(const t of e.Entries||[])yield bx(mx(t));else yield bx(mx(e))}return t}));function bx(e){return e.hash&&(e.cid=X.k0.parse(e.hash)),delete e.hash,e.type=1===e.type?"directory":"file",e}const vx=nL((e=>{async function t(t,n={}){const r=await e.post("files/mkdir",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers});await r.text()}return t})),_x=nL((e=>{async function t(t,n,r={}){Array.isArray(t)||(t=[t]);const s=await e.post("files/mv",{signal:r.signal,searchParams:iL({arg:t.concat(n),...r}),headers:r.headers});await s.text()}return t}));var Ex=n(7966);const Sx=nL((e=>{async function*t(t,n={}){const r=await e.post("files/read",{signal:n.signal,searchParams:iL({arg:t,count:n.length,...n}),headers:n.headers});yield*Ex(r.body)}return t})),kx=nL((e=>{async function t(t,n={}){const r=await e.post("files/rm",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.text();if(""!==s){const e=new Qi.HTTPError(r);throw e.message=s,e}}return t})),Ix=nL((e=>{async function t(t,n={}){const r=await e.post("files/stat",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.json();return s.WithLocality=s.WithLocality||!1,Ax(mx(s))}return t}));function Ax(e){return e.cid=X.k0.parse(e.hash),delete e.hash,e}const Tx=nL((e=>{async function t(t,n={}){const r=await e.post("files/touch",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers});await r.text()}return t})),Rx=nL((e=>{async function t(t,n,r={}){const s=new AbortController,i=bL(s.signal,r.signal),o=await e.post("files/write",{signal:i,searchParams:iL({arg:t,streamChannels:!0,count:r.length,...r}),...await mL([{content:n,path:"arg",mode:rL(r.mode),mtime:sL(r.mtime)}],s,r.headers)});await o.text()}return t}));function Cx(e){return{chmod:px(e),cp:gx(e),flush:yx(e),ls:wx(e),mkdir:vx(e),mv:_x(e),read:Sx(e),rm:kx(e),stat:Ix(e),touch:Tx(e),write:Rx(e)}}const Px=nL((e=>{const t=async(e,t,n={})=>{throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return t})),Nx=nL((e=>{async function t(t,n){const r=n??{type:"Ed25519"},s=await e.post("key/gen",{signal:r.signal,searchParams:iL({arg:t,...r}),headers:r.headers}),i=await s.json();return OL(i)}return t})),Ox=nL((e=>{async function t(t,n,r,s={}){const i=await e.post("key/import",{signal:s.signal,searchParams:iL({arg:t,pem:n,password:r,...s}),headers:s.headers}),o=await i.json();return OL(o)}return t})),Dx=nL((e=>{const t=async(e,t={})=>{throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return t})),Lx=nL((e=>{async function t(t={}){const n=await e.post("key/list",{signal:t.signal,searchParams:iL(t),headers:t.headers}),r=await n.json();return(r.Keys||[]).map((e=>OL(e)))}return t})),xx=nL((e=>{async function t(t,n,r={}){const s=await e.post("key/rename",{signal:r.signal,searchParams:iL({arg:[t,n],...r}),headers:r.headers});return OL(await s.json())}return t})),Bx=nL((e=>{async function t(t,n={}){const r=await e.post("key/rm",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.json();return OL(s.Keys[0])}return t}));function Mx(e){return{export:Px(e),gen:Nx(e),import:Ox(e),info:Dx(e),list:Lx(e),rename:xx(e),rm:Bx(e)}}const Ux=nL((e=>{async function t(t,n,r={}){const s=await e.post("log/level",{signal:r.signal,searchParams:iL({arg:[t,n],...r}),headers:r.headers});return OL(await s.json())}return t})),Fx=nL((e=>{async function t(t={}){const n=await e.post("log/ls",{signal:t.signal,searchParams:iL(t),headers:t.headers}),r=await n.json();return r.Strings}return t})),jx=nL((e=>{async function*t(t={}){const n=await e.post("log/tail",{signal:t.signal,searchParams:iL(t),headers:t.headers});yield*n.ndjson()}return t}));function Vx(e){return{level:Ux(e),ls:Fx(e),tail:jx(e)}}const zx=nL((e=>{async function t(t,n={}){const r=await e.post("name/publish",{signal:n.signal,searchParams:iL({arg:`${t}`,...n}),headers:n.headers});return OL(await r.json())}return t})),$x=nL((e=>{async function*t(t,n={}){const r=await e.post("name/resolve",{signal:n.signal,searchParams:iL({arg:t,stream:!0,...n}),headers:n.headers});for await(const e of r.ndjson())yield e.Path}return t})),Kx=nL((e=>{async function t(t,n={}){const r=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers});return OL(await r.json())}return t})),Hx=nL((e=>{async function t(t={}){const n=await e.post("name/pubsub/state",{signal:t.signal,searchParams:iL(t),headers:t.headers});return OL(await n.json())}return t})),qx=nL((e=>{async function t(t={}){const n=await e.post("name/pubsub/subs",{signal:t.signal,searchParams:iL(t),headers:t.headers}),r=await n.json();return r.Strings||[]}return t}));function Wx(e){return{cancel:Kx(e),state:Hx(e),subs:qx(e)}}function Gx(e){return{publish:zx(e),resolve:$x(e),pubsub:Wx(e)}}const Yx=nL((e=>{async function t(t,n={}){const r=await e.post("object/data",{signal:n.signal,searchParams:iL({arg:`${t instanceof Uint8Array?X.k0.decode(t):t}`,...n}),headers:n.headers}),s=await r.arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return t})),Qx=nL((e=>{async function t(t,n={}){const r=await e.post("object/get",{signal:n.signal,searchParams:iL({arg:`${t instanceof Uint8Array?X.k0.decode(t):t}`,dataEncoding:"base64",...n}),headers:n.headers}),s=await r.json();return{Data:An(s.Data,"base64pad"),Links:(s.Links||[]).map((e=>({Name:e.Name,Hash:X.k0.parse(e.Hash),Tsize:e.Size})))}}return t})),Xx=nL((e=>{async function t(t,n={}){const r=await e.post("object/links",{signal:n.signal,searchParams:iL({arg:`${t instanceof Uint8Array?X.k0.decode(t):t}`,...n}),headers:n.headers}),s=await r.json();return(s.Links||[]).map((e=>({Name:e.Name,Tsize:e.Size,Hash:X.k0.parse(e.Hash)})))}return t})),Jx=nL((e=>{async function t(t={}){const n=await e.post("object/new",{signal:t.signal,searchParams:iL({arg:t.template,...t}),headers:t.headers}),{Hash:r}=await n.json();return X.k0.parse(r)}return t})),Zx=(e,t)=>{const n=nL((n=>{const r=HL(e,t);async function s(e,t={}){return r(e,{...t,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return s}));return n(t)},eB=nL((e=>{async function t(t,n={}){const r=await e.post("object/stat",{signal:n.signal,searchParams:iL({arg:`${t}`,...n}),headers:n.headers}),s=await r.json();return{...s,Hash:X.k0.parse(s.Hash)}}return t})),tB=nL((e=>{async function t(t,n,r={}){const s=await e.post("object/patch/add-link",{signal:r.signal,searchParams:iL({arg:[`${t}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...r}),headers:r.headers}),{Hash:i}=await s.json();return X.k0.parse(i)}return t})),nB=nL((e=>{async function t(t,n,r={}){const s=new AbortController,i=bL(s.signal,r.signal),o=await e.post("object/patch/append-data",{signal:i,searchParams:iL({arg:`${t}`,...r}),...await mL([n],s,r.headers)}),{Hash:a}=await o.json();return X.k0.parse(a)}return t})),rB=nL((e=>{async function t(t,n,r={}){const s=await e.post("object/patch/rm-link",{signal:r.signal,searchParams:iL({arg:[`${t}`,n.Name||n.name||null],...r}),headers:r.headers}),{Hash:i}=await s.json();return X.k0.parse(i)}return t})),sB=nL((e=>{async function t(t,n,r={}){const s=new AbortController,i=bL(s.signal,r.signal),o=await e.post("object/patch/set-data",{signal:i,searchParams:iL({arg:[`${t}`],...r}),...await mL([n],s,r.headers)}),{Hash:a}=await o.json();return X.k0.parse(a)}return t}));function iB(e){return{addLink:tB(e),appendData:nB(e),rmLink:rB(e),setData:sB(e)}}function oB(e,t){return{data:Yx(t),get:Qx(t),links:Xx(t),new:Jx(t),put:Zx(e,t),stat:eB(t),patch:iB(t)}}const aB=nL((e=>{async function*t(t,n={}){for await(const{path:r,recursive:s,metadata:i}of Oo(t)){const t=await e.post("pin/add",{signal:n.signal,searchParams:iL({...n,arg:r,recursive:s,metadata:i?JSON.stringify(i):void 0,stream:!0}),headers:n.headers});for await(const e of t.ndjson())if(e.Pins)for(const t of e.Pins)yield X.k0.parse(t);else yield X.k0.parse(e)}}return t}));function cB(e){const t=aB(e);return nL((()=>{async function e(e,n={}){return To(t([{path:e,...n}],n))}return e}))(e)}function lB(e,t,n){const r={type:e,cid:X.k0.parse(t)};return n&&(r.metadata=n),r}const uB=nL((e=>{async function*t(t={}){let n=[];t.paths&&(n=Array.isArray(t.paths)?t.paths:[t.paths]);const r=await e.post("pin/ls",{signal:t.signal,searchParams:iL({...t,arg:n.map((e=>`${e}`)),stream:!0}),headers:t.headers});for await(const e of r.ndjson()){if(e.Keys){for(const t of Object.keys(e.Keys))yield lB(e.Keys[t].Type,t,e.Keys[t].Metadata);return}yield lB(e.Type,e.Cid,e.Metadata)}}return t})),hB=nL((e=>{async function*t(t,n={}){for await(const{path:r,recursive:s}of Oo(t)){const t=new URLSearchParams(n.searchParams);t.append("arg",`${r}`),null!=s&&t.set("recursive",String(s));const i=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:iL({...n,arg:`${r}`,recursive:s})});for await(const e of i.ndjson())e.Pins?yield*e.Pins.map((e=>X.k0.parse(e))):yield X.k0.parse(e)}}return t})),dB=e=>{const t=hB(e);return nL((()=>{async function e(e,n={}){return To(t([{path:e,...n}],n))}return e}))(e)},fB=({Name:e,Status:t,Cid:n})=>({cid:X.k0.parse(n),name:e,status:t}),pB=e=>{if("string"===typeof e&&""!==e)return e;throw new TypeError("service name must be passed")},gB=e=>{if(X.k0.asCID(e))return e.toString();throw new TypeError("CID instance expected instead of "+typeof e)},yB=({service:e,cid:t,name:n,status:r,all:s})=>{const i=iL({service:pB(e),name:n,force:!!s||void 0});if(t)for(const o of t)i.append("cid",gB(o));if(r)for(const o of r)i.append("status",o);return i},mB=({cid:e,service:t,background:n,name:r,origins:s})=>{const i=iL({arg:gB(e),service:pB(t),name:r,background:!!n||void 0});if(s)for(const o of s)i.append("origin",o.toString());return i};function wB(e){async function t(t,{timeout:n,signal:r,headers:s,...i}){const o=await e.post("pin/remote/add",{timeout:n,signal:r,headers:s,searchParams:mB({cid:t,...i})});return fB(await o.json())}return t}function bB(e){async function*t({timeout:t,signal:n,headers:r,...s}){const i=await e.post("pin/remote/ls",{timeout:t,signal:n,headers:r,searchParams:yB(s)});for await(const e of i.ndjson())yield fB(e)}return t}function vB(e){async function t({timeout:t,signal:n,headers:r,...s}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:r,searchParams:yB({...s,all:!1})})}return t}function _B(e){async function t({timeout:t,signal:n,headers:r,...s}){await e.post("pin/remote/rm",{timeout:t,signal:n,headers:r,searchParams:yB({...s,all:!0})})}return t}function EB(e){const t=String(e);if("undefined"===t)throw Error("endpoint is required");return"/"===t[t.length-1]?t.slice(0,-1):t}function SB(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:kB(e.Stat)}}}function kB(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:n,Queued:r,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:r,pinning:t,pinned:n,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function IB(e){async function t(t,n){const{endpoint:r,key:s,headers:i,timeout:o,signal:a}=n;await e.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:iL({arg:[t,EB(r),s]}),headers:i})}return t}function AB(e){async function t(t={}){const{stat:n,headers:r,timeout:s,signal:i}=t,o=await e.post("pin/remote/service/ls",{timeout:s,signal:i,headers:r,searchParams:!0===n?iL({stat:n}):void 0}),{RemoteServices:a}=await o.json();return a.map(SB)}return t}function TB(e){async function t(t,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:iL({arg:t})})}return t}function RB(e){const t=new tL(e);return{add:IB(t),ls:AB(t),rm:TB(t)}}function CB(e){const t=new tL(e);return{add:wB(t),ls:bB(t),rm:vB(t),rmAll:_B(t),service:RB(e)}}function PB(e){return{addAll:aB(e),add:cB(e),ls:uB(e),rmAll:hB(e),rm:dB(e),remote:CB(e)}}const NB=e=>Array.isArray(e)?e.map(OB):e,OB=e=>Fn(DB(e)),DB=e=>D.decode(e),LB=e=>BigInt(`0x${Fn(D.decode(e),"base16")}`),xB=e=>D.encode(An(e)),BB=nL((e=>{async function t(t={}){const{Strings:n}=await(await e.post("pubsub/ls",{signal:t.signal,searchParams:iL(t),headers:t.headers})).json();return NB(n)||[]}return t})),MB=nL((e=>{async function t(t,n={}){const r=await e.post("pubsub/peers",{signal:n.signal,searchParams:iL({arg:xB(t),...n}),headers:n.headers}),{Strings:s}=await r.json();return s||[]}return t})),UB=nL((e=>{async function t(t,n,r={}){const s=iL({arg:xB(t),...r}),i=new AbortController,o=bL(i.signal,r.signal),a=await e.post("pubsub/pub",{signal:o,searchParams:s,...await mL([n],i,r.headers)});await a.text()}return t})),FB=x("ipfs-http-client:pubsub:subscribe"),jB=(e,t)=>nL((e=>{async function n(n,r,s={}){let i,o;s.signal=t.subscribe(n,r,s.signal);const a=new Promise(((e,t)=>{i=e,o=t})),c=setTimeout((()=>i()),1e3);return e.post("pubsub/sub",{signal:s.signal,searchParams:iL({arg:xB(n),...s}),headers:s.headers}).catch((e=>{t.unsubscribe(n,r),o(e)})).then((e=>{clearTimeout(c),e&&(VB(e,{onMessage:e=>{r&&("function"!==typeof r?"function"===typeof r.handleEvent&&r.handleEvent(e):r(e))},onEnd:()=>t.unsubscribe(n,r),onError:s.onError}),i())})),a}return n}))(e);async function VB(e,{onMessage:t,onEnd:n,onError:r}){r=r||FB;try{for await(const n of e.ndjson())try{if(!n.from)continue;null!=n.from&&null!=n.seqno?t({type:"signed",from:_o(n.from),data:DB(n.data),sequenceNumber:LB(n.seqno),topic:OB(n.topicIDs[0]),key:DB(n.key??"u"),signature:DB(n.signature??"u")}):t({type:"unsigned",data:DB(n.data),topic:OB(n.topicIDs[0])})}catch(rb){rb.message=`Failed to parse pubsub message: ${rb.message}`,r(rb,!1,n)}}catch(rb){zB(rb)||r(rb,!0)}finally{n()}}const zB=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return"AbortError"===e.name}},$B=(e,t)=>{async function n(e,n){t.unsubscribe(e,n)}return n};class KB{constructor(){this._subs=new Map}subscribe(e,t,n){const r=this._subs.get(e)||[];if(r.find((e=>e.handler===t)))throw new Error(`Already subscribed to ${e} with this handler`);const s=new AbortController;return this._subs.set(e,[{handler:t,controller:s}].concat(r)),n&&n.addEventListener("abort",(()=>this.unsubscribe(e,t))),s.signal}unsubscribe(e,t){const n=this._subs.get(e)||[];let r;t?(this._subs.set(e,n.filter((e=>e.handler!==t))),r=n.filter((e=>e.handler===t))):(this._subs.set(e,[]),r=n),(this._subs.get(e)||[]).length||this._subs.delete(e),r.forEach((e=>e.controller.abort()))}}function HB(e){const t=new KB;return{ls:BB(e),peers:MB(e),publish:UB(e),subscribe:jB(e,t),unsubscribe:$B(e,t)}}const qB=nL((e=>{async function*t(t={}){const n=await e.post("refs/local",{signal:t.signal,transform:OL,searchParams:iL(t),headers:t.headers});yield*n.ndjson()}return t})),WB=nL(((e,t)=>{const n=async function*(t,n={}){const r=Array.isArray(t)?t:[t],s=await e.post("refs",{signal:n.signal,searchParams:iL({arg:r.map((e=>`${e instanceof Uint8Array?X.k0.decode(e):e}`)),...n}),headers:n.headers,transform:OL});yield*s.ndjson()};return Object.assign(n,{local:qB(t)})})),GB=nL((e=>{async function*t(t={}){const n=await e.post("repo/gc",{signal:t.signal,searchParams:iL(t),headers:t.headers,transform:e=>({err:e.Error?new Error(e.Error):null,cid:(e.Key||{})["/"]?X.k0.parse(e.Key["/"]):null})});yield*n.ndjson()}return t})),YB=nL((e=>{async function t(t={}){const n=await e.post("repo/stat",{signal:t.signal,searchParams:iL(t),headers:t.headers}),r=await n.json();return{numObjects:BigInt(r.NumObjects),repoSize:BigInt(r.RepoSize),repoPath:r.RepoPath,version:r.Version,storageMax:BigInt(r.StorageMax)}}return t})),QB=nL((e=>{async function t(t={}){const n=await(await e.post("repo/version",{signal:t.signal,searchParams:iL(t),headers:t.headers})).json();return n.Version}return t}));function XB(e){return{gc:GB(e),stat:YB(e),version:QB(e)}}const JB=nL((e=>{async function*t(t={}){const n=await e.post("stats/bw",{signal:t.signal,searchParams:iL(t),headers:t.headers,transform:e=>({totalIn:BigInt(e.TotalIn),totalOut:BigInt(e.TotalOut),rateIn:parseFloat(e.RateIn),rateOut:parseFloat(e.RateOut)})});yield*n.ndjson()}return t}));function ZB(e){return{bitswap:cL(e),repo:YB(e),bw:JB(e)}}const eM=nL((e=>{async function t(t={}){const n=await e.post("swarm/addrs",{signal:t.signal,searchParams:iL(t),headers:t.headers}),{Addrs:r}=await n.json();return Object.keys(r).map((e=>({id:_o(e),addrs:(r[e]||[]).map((e=>Hr(e)))})))}return t})),tM=nL((e=>{async function t(t,n={}){const r=await e.post("swarm/connect",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),{Strings:s}=await r.json();return s||[]}return t})),nM=nL((e=>{async function t(t,n={}){const r=await e.post("swarm/disconnect",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),{Strings:s}=await r.json();return s||[]}return t})),rM=nL((e=>{async function t(t={}){const n=await e.post("swarm/addrs/local",{signal:t.signal,searchParams:iL(t),headers:t.headers}),{Strings:r}=await n.json();return(r||[]).map((e=>Hr(e)))}return t})),sM=nL((e=>{async function t(t={}){const n=await e.post("swarm/peers",{signal:t.signal,searchParams:iL(t),headers:t.headers}),{Peers:r}=await n.json();return(r||[]).map((e=>({addr:Hr(e.Addr),peer:_o(e.Peer),muxer:e.Muxer,latency:e.Latency,streams:e.Streams,direction:null==e.Direction?void 0:0===e.Direction?"inbound":"outbound"})))}return t}));function iM(e){return{addrs:eM(e),connect:tM(e),disconnect:nM(e),localAddrs:rM(e),peers:sM(e)}}const oM=nL((e=>{async function*t(t,n={}){const r=new AbortController,s=bL(r.signal,n.signal),{headers:i,body:o,total:a,parts:c}=await mL(t,r,n.headers),[l,u]="function"===typeof n.progress?aM(a,c,n.progress):[void 0,void 0],h=await e.post("add",{searchParams:iL({"stream-channels":!0,...n,progress:Boolean(l)}),onUploadProgress:u,signal:s,headers:i,body:o});for await(let e of h.ndjson())e=OL(e),void 0!==e.hash?yield lM(e):l&&l(e.bytes||0,e.name)}return t})),aM=(e,t,n)=>t?[void 0,cM(e,t,n)]:[n,void 0],cM=(e,t,n)=>{let r=0;const s=t.length;return({loaded:i,total:o})=>{const a=Math.floor(i/o*e);while(r<s){const{start:e,end:s,name:i}=t[r];if(a<s){n(a-e,i);break}n(s-e,i),r+=1}}};function lM({name:e,hash:t,size:n,mode:r,mtime:s,mtimeNsecs:i}){const o={path:e,cid:X.k0.parse(t),size:parseInt(n)};return null!=r&&(o.mode=parseInt(r,8)),null!=s&&(o.mtime={secs:s,nsecs:i||0}),o}function uM(e){const t=oM(e);return nL((()=>{async function e(e,n={}){return await To(t(Ff(e),n))}return e}))(e)}const hM=nL((e=>{async function*t(t,n={}){const r=await e.post("cat",{signal:n.signal,searchParams:iL({arg:t.toString(),...n}),headers:n.headers});yield*r.iterator()}return t})),dM=nL((e=>{const t=async(t={})=>{const n=await e.post("commands",{signal:t.signal,searchParams:iL(t),headers:t.headers});return n.json()};return t})),fM=nL((e=>{const t=async(t,n={})=>{const r=await e.post("dns",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),s=await r.json();return s.Path};return t})),pM=nL((e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}})),gM=nL((e=>{async function*t(t,n={}){const r={arg:`${t instanceof Uint8Array?X.k0.decode(t):t}`,...n};r.compressionLevel&&(r["compression-level"]=r.compressionLevel,delete r.compressionLevel);const s=await e.post("get",{signal:n.signal,searchParams:iL(r),headers:n.headers});yield*s.iterator()}return t})),yM=nL((e=>{async function t(t={}){const n=await e.post("id",{signal:t.signal,searchParams:iL({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers}),r=await n.json(),s={...OL(r)};return s.id=_o(s.id),s.addresses&&(s.addresses=s.addresses.map((e=>Hr(e)))),s}return t})),mM=e=>{const t=yM(e);async function n(e={}){const n=await t(e);return Boolean(n&&n.addresses&&n.addresses.length)}return n},wM=nL(((e,t)=>{async function*n(n,r={}){const s=`${n instanceof Uint8Array?X.k0.decode(n):n}`;async function i(e){let n=e.Hash;if(n.includes("/")){const e=n.startsWith("/ipfs/")?n:`/ipfs/${n}`,r=await Ix(t)(e);n=r.cid}else n=X.k0.parse(n);const r={name:e.Name,path:s+(e.Name?`/${e.Name}`:""),size:e.Size,cid:n,type:bM(e)};return e.Mode&&(r.mode=parseInt(e.Mode,8)),void 0!==e.Mtime&&null!==e.Mtime&&(r.mtime={secs:e.Mtime},void 0!==e.MtimeNsecs&&null!==e.MtimeNsecs&&(r.mtime.nsecs=e.MtimeNsecs)),r}const o=await e.post("ls",{signal:r.signal,searchParams:iL({arg:s,...r}),headers:r.headers});for await(let e of o.ndjson()){if(e=e.Objects,!e)throw new Error("expected .Objects in results");if(e=e[0],!e)throw new Error("expected one array in results.Objects");const t=e.Links;if(!Array.isArray(t))throw new Error("expected one array in results.Objects[0].Links");if(!t.length)return void(yield i(e));yield*t.map(i)}}return n}));function bM(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const vM=nL((e=>{async function t(t={}){const n=await e.post("dns",{signal:t.signal,searchParams:iL(t),headers:t.headers});return OL(await n.json())}return t})),_M=nL((e=>{async function*t(t,n={}){const r=await e.post("ping",{signal:n.signal,searchParams:iL({arg:`${t}`,...n}),headers:n.headers,transform:OL});yield*r.ndjson()}return t})),EM=nL((e=>{async function t(t,n={}){const r=await e.post("resolve",{signal:n.signal,searchParams:iL({arg:t,...n}),headers:n.headers}),{Path:s}=await r.json();return s}return t})),SM=nL((e=>{const t=async(e={})=>{throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};return t})),kM=nL((e=>{async function t(t={}){const n=await e.post("shutdown",{signal:t.signal,searchParams:iL(t),headers:t.headers});await n.text()}return t})),IM=nL((e=>{async function t(t={}){const n=await e.post("version",{signal:t.signal,searchParams:iL(t),headers:t.headers});return{...OL(await n.json()),"ipfs-http-client":"1.0.0"}}return t}));n(3897),n(8624);function AM(e={}){const t={name:Nt.name,code:Nt.code,encode:e=>e,decode:e=>e},n=Object.values(an);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach((e=>n.push(e)));const r=new UD({bases:n,loadBase:e.ipld&&e.ipld.loadBase}),a=Object.values(ln);[s,Ce,i,o,t].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>a.push(e)));const c=new jD({codecs:a,loadCodec:e.ipld&&e.ipld.loadCodec}),l=Object.values(cn);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach((e=>l.push(e)));const u=new zD({hashers:l,loadHasher:e.ipld&&e.ipld.loadHasher}),h={add:uM(e),addAll:oM(e),bitswap:hL(e),block:kL(e),bootstrap:PL(e),cat:hM(e),commands:dM(e),config:jL(e),dag:WL(c,e),dht:lx(e),diag:fx(e),dns:fM(e),files:Cx(e),get:gM(e),getEndpointConfig:pM(e),id:yM(e),isOnline:mM(e),key:Mx(e),log:Vx(e),ls:wM(e),mount:vM(e),name:Gx(e),object:oB(c,e),pin:PB(e),ping:_M(e),pubsub:HB(e),refs:WB(e),repo:XB(e),resolve:EM(e),start:SM(e),stats:ZB(e),stop:kM(e),swarm:iM(e),version:IM(e),bases:r,codecs:c,hashers:u};return h}const TM=421,RM=290,CM=2e3,PM=Object.create(null);PM["open"]="0",PM["close"]="1",PM["ping"]="2",PM["pong"]="3",PM["message"]="4",PM["upgrade"]="5",PM["noop"]="6";const NM=Object.create(null);Object.keys(PM).forEach((e=>{NM[PM[e]]=e}));const OM={type:"error",data:"parser error"},DM="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),LM="function"===typeof ArrayBuffer,xM=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,BM=({type:e,data:t},n,r)=>DM&&t instanceof Blob?n?r(t):MM(t,r):LM&&(t instanceof ArrayBuffer||xM(t))?n?r(t):MM(new Blob([t]),r):r(PM[e]+(t||"")),MM=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};var UM=BM;const FM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",jM="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let LQ=0;LQ<FM.length;LQ++)jM[FM.charCodeAt(LQ)]=LQ;const VM=e=>{let t,n,r,s,i,o=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);const l=new ArrayBuffer(o),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=jM[e.charCodeAt(t)],r=jM[e.charCodeAt(t+1)],s=jM[e.charCodeAt(t+2)],i=jM[e.charCodeAt(t+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|s>>2,u[c++]=(3&s)<<6|63&i;return l},zM="function"===typeof ArrayBuffer,$M=(e,t)=>{if("string"!==typeof e)return{type:"message",data:HM(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:KM(e.substring(1),t)};const r=NM[n];return r?e.length>1?{type:NM[n],data:e.substring(1)}:{type:NM[n]}:OM},KM=(e,t)=>{if(zM){const n=VM(e);return HM(n,t)}return{base64:!0,data:e}},HM=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}};var qM=$M;const WM=String.fromCharCode(30),GM=(e,t)=>{const n=e.length,r=new Array(n);let s=0;e.forEach(((e,i)=>{UM(e,!1,(e=>{r[i]=e,++s===n&&t(r.join(WM))}))}))},YM=(e,t)=>{const n=e.split(WM),r=[];for(let s=0;s<n.length;s++){const e=qM(n[s],t);if(r.push(e),"error"===e.type)break}return r},QM=4;function XM(e){if(e)return JM(e)}function JM(e){for(var t in XM.prototype)e[t]=XM.prototype[t];return e}XM.prototype.on=XM.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},XM.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},XM.prototype.off=XM.prototype.removeListener=XM.prototype.removeAllListeners=XM.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var s=0;s<r.length;s++)if(n=r[s],n===t||n.fn===t){r.splice(s,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},XM.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);r=0;for(var s=n.length;r<s;++r)n[r].apply(this,t)}return this},XM.prototype.emitReserved=XM.prototype.emit,XM.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},XM.prototype.hasListeners=function(e){return!!this.listeners(e).length};const ZM=(()=>"undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")())();function eU(e,...t){return t.reduce(((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t)),{})}const tU=ZM.setTimeout,nU=ZM.clearTimeout;function rU(e,t){t.useNativeTimers?(e.setTimeoutFn=tU.bind(ZM),e.clearTimeoutFn=nU.bind(ZM)):(e.setTimeoutFn=ZM.setTimeout.bind(ZM),e.clearTimeoutFn=ZM.clearTimeout.bind(ZM))}const sU=1.33;function iU(e){return"string"===typeof e?oU(e):Math.ceil((e.byteLength||e.size)*sU)}function oU(e){let t=0,n=0;for(let r=0,s=e.length;r<s;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}class aU extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class cU extends XM{constructor(e){super(),this.writable=!1,rU(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new aU(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=qM(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}}const lU="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),uU=64,hU={};let dU,fU=0,pU=0;function gU(e){let t="";do{t=lU[e%uU]+t,e=Math.floor(e/uU)}while(e>0);return t}function yU(){const e=gU(+new Date);return e!==dU?(fU=0,dU=e):e+"."+gU(fU++)}for(;pU<uU;pU++)hU[lU[pU]]=pU;function mU(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function wU(e){let t={},n=e.split("&");for(let r=0,s=n.length;r<s;r++){let e=n[r].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}let bU=!1;try{bU="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(rb){}const vU=bU;function _U(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||vU))return new XMLHttpRequest}catch(n){}if(!t)try{return new(ZM[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function EU(){}const SU=function(){const e=new _U({xdomain:!1});return null!=e.responseType}();class kU extends cU{constructor(e){if(super(e),this.polling=!1,"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=SU&&!t}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)};YM(e,this.socket.binaryType).forEach(t),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,GM(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=yU()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const r=mU(e),s=-1!==this.opts.hostname.indexOf(":");return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new IU(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}class IU extends XM{constructor(e,t){super(),rU(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=eU(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new _U(e);try{t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(n){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(n){}try{t.setRequestHeader("Accept","*/*")}catch(n){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),t.onreadystatechange=()=>{4===t.readyState&&(200===t.status||1223===t.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"===typeof t.status?t.status:0)}),0))},t.send(this.data)}catch(n){return void this.setTimeoutFn((()=>{this.onError(n)}),0)}"undefined"!==typeof document&&(this.index=IU.requestsCount++,IU.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=EU,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete IU.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(IU.requestsCount=0,IU.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",AU);else if("function"===typeof addEventListener){const e="onpagehide"in ZM?"pagehide":"unload";addEventListener(e,AU,!1)}function AU(){for(let e in IU.requests)IU.requests.hasOwnProperty(e)&&IU.requests[e].abort()}const TU=(()=>{const e="function"===typeof Promise&&"function"===typeof Promise.resolve;return e?e=>Promise.resolve().then(e):(e,t)=>t(e,0)})(),RU=ZM.WebSocket||ZM.MozWebSocket,CU=!0,PU="arraybuffer",NU="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class OU extends cU{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=NU?{}:eU(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=CU&&!NU?t?new RU(e,t):new RU(e):new RU(e,t,n)}catch(rb){return this.emitReserved("error",rb)}this.ws.binaryType=this.socket.binaryType||PU,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;UM(n,this.supportsBinary,(e=>{const t={};if(!CU&&(n.options&&(t.compress=n.options.compress),this.opts.perMessageDeflate)){const n="string"===typeof e?Buffer.byteLength(e):e.length;n<this.opts.perMessageDeflate.threshold&&(t.compress=!1)}try{CU?this.ws.send(e):this.ws.send(e,t)}catch(s){}r&&TU((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=yU()),this.supportsBinary||(e.b64=1);const r=mU(e),s=-1!==this.opts.hostname.indexOf(":");return t+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}check(){return!!RU}}const DU={websocket:OU,polling:kU},LU=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,xU=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function BU(e){const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let s=LU.exec(e||""),i={},o=14;while(o--)i[xU[o]]=s[o]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=MU(i,i["path"]),i.queryKey=UU(i,i["query"]),i}function MU(e,t){const n=/\/{2,9}/g,r=t.replace(n,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}function UU(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}class FU extends XM{constructor(e,t={}){super(),this.writeBuffer=[],e&&"object"===typeof e&&(t=e,e=null),e?(e=BU(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=BU(t.host).host),rU(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=wU(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"===typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=QM,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new DU[e](n)}open(){let e;if(this.opts.rememberUpgrade&&FU.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(t){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(e){let t=this.createTransport(e),n=!1;FU.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",(e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;FU.priorWebsocketSuccess="websocket"===t.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())}))}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}})))};function s(){n||(n=!0,l(),t.close(),t=null)}const i=e=>{const n=new Error("probe error: "+e);n.transport=t.name,s(),this.emitReserved("upgradeError",n)};function o(){i("transport closed")}function a(){i("socket closed")}function c(e){t&&e.name!==t.name&&s()}const l=()=>{t.removeListener("open",r),t.removeListener("error",i),t.removeListener("close",o),this.off("close",a),this.off("upgrading",c)};t.once("open",r),t.once("error",i),t.once("close",o),this.once("close",a),this.once("upgrading",c),t.open()}onOpen(){if(this.readyState="open",FU.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){const e=this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!e)return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const e=this.writeBuffer[n].data;if(e&&(t+=iU(e)),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;n=n||{},n.compress=!1!==n.compress;const s={type:e,data:t,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():e()})):this.upgrading?n():e()),this}onError(e){FU.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}FU.protocol=QM;FU.protocol;function jU(e,t="",n){let r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=BU(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=-1!==r.host.indexOf(":"),i=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}const VU="function"===typeof ArrayBuffer,zU=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,$U=Object.prototype.toString,KU="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===$U.call(Blob),HU="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===$U.call(File);function qU(e){return VU&&(e instanceof ArrayBuffer||zU(e))||KU&&e instanceof Blob||HU&&e instanceof File}function WU(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(WU(e[t]))return!0;return!1}if(qU(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return WU(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&WU(e[n]))return!0;return!1}function GU(e){const t=[],n=e.data,r=e;return r.data=YU(n,t),r.attachments=t.length,{packet:r,buffers:t}}function YU(e,t){if(!e)return e;if(qU(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=YU(e[r],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=YU(e[r],t));return n}return e}function QU(e,t){return e.data=XU(e.data,t),delete e.attachments,e}function XU(e,t){if(!e)return e;if(e&&!0===e._placeholder){const n="number"===typeof e.num&&e.num>=0&&e.num<t.length;if(n)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=XU(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=XU(e[n],t));return e}const JU=5;var ZU;(function(e){e[e["CONNECT"]=0]="CONNECT",e[e["DISCONNECT"]=1]="DISCONNECT",e[e["EVENT"]=2]="EVENT",e[e["ACK"]=3]="ACK",e[e["CONNECT_ERROR"]=4]="CONNECT_ERROR",e[e["BINARY_EVENT"]=5]="BINARY_EVENT",e[e["BINARY_ACK"]=6]="BINARY_ACK"})(ZU||(ZU={}));class eF{constructor(e){this.replacer=e}encode(e){return e.type!==ZU.EVENT&&e.type!==ZU.ACK||!WU(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===ZU.EVENT?ZU.BINARY_EVENT:ZU.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==ZU.BINARY_EVENT&&e.type!==ZU.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=GU(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}class tF extends XM{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===ZU.BINARY_EVENT;n||t.type===ZU.BINARY_ACK?(t.type=n?ZU.EVENT:ZU.ACK,this.reconstructor=new nF(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!qU(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===ZU[n.type])throw new Error("unknown packet type "+n.type);if(n.type===ZU.BINARY_EVENT||n.type===ZU.BINARY_ACK){const r=t+1;while("-"!==e.charAt(++t)&&t!=e.length);const s=e.substring(r,t);if(s!=Number(s)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(s)}if("/"===e.charAt(t+1)){const r=t+1;while(++t){const n=e.charAt(t);if(","===n)break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;while(++t){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!tF.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}static isPayloadValid(e,t){switch(e){case ZU.CONNECT:return"object"===typeof t;case ZU.DISCONNECT:return void 0===t;case ZU.CONNECT_ERROR:return"string"===typeof t||"object"===typeof t;case ZU.EVENT:case ZU.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case ZU.ACK:case ZU.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class nF{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=QU(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function rF(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const sF=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class iF extends XM{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[rF(e,"open",this.onopen.bind(this)),rF(e,"packet",this.onpacket.bind(this)),rF(e,"error",this.onerror.bind(this)),rF(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io["_reconnecting"]||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(sF.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:ZU.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"===typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,s=this.flags.volatile&&(!r||!this.connected);return s||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const s=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(s),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((r,s)=>{t.push(((e,t)=>n?e?s(e):r(t):r(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"===typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...r)=>{if(n!==this._queue[0])return;const s=null!==e;return s?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()})),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:ZU.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){const t=e.nsp===this.nsp;if(t)switch(e.type){case ZU.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ZU.EVENT:case ZU.BINARY_EVENT:this.onevent(e);break;case ZU.ACK:case ZU.BINARY_ACK:this.onack(e);break;case ZU.DISCONNECT:this.ondisconnect();break;case ZU.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t);break}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:ZU.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io["_destroy"](this)}disconnect(){return this.connected&&this.packet({type:ZU.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function oF(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}oF.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},oF.prototype.reset=function(){this.attempts=0},oF.prototype.setMin=function(e){this.ms=e},oF.prototype.setMax=function(e){this.max=e},oF.prototype.setJitter=function(e){this.jitter=e};class aF extends XM{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,rU(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new oF({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const r=t.parser||E;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new FU(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=rF(t,"open",(function(){n.onopen(),e&&e()})),s=rF(t,"error",(t=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",t),e?e(t):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const e=this._timeout;0===e&&r();const n=this.setTimeoutFn((()=>{r(),t.close(),t.emit("error",new Error("timeout"))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(rF(e,"ping",this.onping.bind(this)),rF(e,"data",this.ondata.bind(this)),rF(e,"error",this.onerror.bind(this)),rF(e,"close",this.onclose.bind(this)),rF(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){TU((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new iF(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){const e=this.nsps[n];if(e.active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()})))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const cF={};function lF(e,t){"object"===typeof e&&(t=e,e=void 0),t=t||{};const n=jU(e,t.path||"/socket.io"),r=n.source,s=n.id,i=n.path,o=cF[s]&&i in cF[s]["nsps"],a=t.forceNew||t["force new connection"]||!1===t.multiplex||o;let c;return a?c=new aF(r,t):(cF[s]||(cF[s]=new aF(r,t)),c=cF[s]),n.query&&!t.query&&(t.query=n.queryKey),c.socket(n.path,t)}Object.assign(lF,{Manager:aF,Socket:iF,io:lF,connect:lF});var uF=n(1809);const hF=65536,dF=5e3;class fF{constructor(e,t){this.label=e.label,this.open=wf(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=t.log,"number"===typeof this.channel.bufferedAmountLowThreshold&&(this.channel.bufferedAmountLowThreshold=hF),e.addEventListener("message",(e=>{t.onMessage(e)})),e.addEventListener("bufferedamountlow",(()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()})),e.addEventListener("open",(()=>{this.open.resolve(),t.onOpen()})),e.addEventListener("close",(()=>{t.onClose()})),e.addEventListener("error",(n=>{if("Transport channel closed"===n.error?.message)return this.close();t.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,n.error?.message,n.error?.errorDetail);const r=n.error instanceof Error?n.error:new Error(`datachannel error: ${n.error?.message} ${n.error?.errorDetail}`);t.onError(B(r,"ERR_DATA_CHANNEL"))}));let n=!1;this.closingInterval=setInterval((()=>{"closing"===e.readyState?(n&&t.onClose(),n=!0):n=!1}),dF)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>hF&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=wf())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}}var pF=n(8592);const gF={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function yF(){if("undefined"===typeof globalThis)throw B(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");const e={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(null==e.RTCPeerConnection)throw B(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return e}class mF extends iN{constructor(e){super(),this.id=e.id??Fn(uF(4),"hex").slice(0,7),this.log=x(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??yF(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},gF,e.peerConnectionConfig)),this.closed=!1,this.connected=wf(),this.source=Xh(),this.sink=async e=>{if(await this.connected.promise,null==this.channel)throw B(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(const t of e)await this.channel.send(t);await this.close()}}handleDataChannelEvent(e){const t=e.channel;null!=t?this.channel=new fF(t,{log:this.log,onMessage:e=>{this.source.push(new Uint8Array(e.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new aN("ready"))},onClose:()=>{this.close().catch((e=>{this.log("error closing connection after channel close",e)}))},onError:e=>{this.close(e).catch((e=>{this.log("error closing connection after channel error",e)}))}}):this.close(B(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch((e=>{this.log("Error closing after event channel was found to be null",e)}))}async close(e){if(this.closed=!0,null==e&&null!=this.channel)while(this.channel.bufferedAmount>0)await pF(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new aN("close"))}}class wF extends iN{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",(()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch((e=>{this.log.error("could not renegotiate %o",e)}))}))}async handleSignal(e){return this.log('incoming signal "%s"',e.type),"offer"===e.type?await this.handleOffer(e):"answer"===e.type?await this.handleAnswer(e):"candidate"===e.type?await this.handleCandidate(e):"renegotiate"===e.type?await this.handleRenegotiate(e):"goodbye"===e.type?await this.handleGoodye(e):void this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){const t=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(t)}catch(rb){if(null!=t.address&&!t.address.endsWith(".local"))throw B(rb,"ERR_ADD_ICE_CANDIDATE");this.log("ignoring unsupported ICE candidate.")}}}const bF=x("libp2p:webrtc-peer:receiver");class vF extends mF{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new _F({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",(e=>this.dispatchEvent(new aN("signal",{detail:e.detail})))),this.peerConnection.addEventListener("datachannel",(e=>{this.handleDataChannelEvent(e)}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class _F extends wF{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){bF.trace("renegotiate"),this.dispatchEvent(new aN("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(const n of this.iceCandidates)await this.handleCandidate(n);this.iceCandidates=[];const t=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(t),bF.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new aN("signal",{detail:this.peerConnection.localDescription??t}))}async handleCandidate(e){null!=this.peerConnection.remoteDescription&&null!=this.peerConnection.remoteDescription.type?await super.handleCandidate(e):this.iceCandidates.push(e)}}class EF extends Error{constructor(e){super(e),this.name="TimeoutError"}}class SF extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const kF=e=>void 0===globalThis.DOMException?new SF(e):new DOMException(e),IF=e=>{const t=void 0===e.reason?kF("This operation was aborted."):e.reason;return t instanceof Error?t:kF(t)};function AF(e,t,n,r){let s;const i=new Promise(((i,o)=>{if("number"!==typeof t||1!==Math.sign(t))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t!==Number.POSITIVE_INFINITY){if(r={customTimers:{setTimeout:setTimeout,clearTimeout:clearTimeout},...r},r.signal){const{signal:e}=r;e.aborted&&o(IF(e)),e.addEventListener("abort",(()=>{o(IF(e))}))}s=r.customTimers.setTimeout.call(void 0,(()=>{if("function"===typeof n){try{i(n())}catch(a){o(a)}return}const r="string"===typeof n?n:`Promise timed out after ${t} milliseconds`,s=n instanceof Error?n:new EF(r);"function"===typeof e.cancel&&e.cancel(),o(s)}),t),(async()=>{try{i(await e)}catch(t){o(t)}finally{r.customTimers.clearTimeout.call(void 0,s)}})()}else i(e)}));return i.clear=()=>{clearTimeout(s),s=void 0},i}const TF=e=>{const t=e.on||e.addListener||e.addEventListener,n=e.off||e.removeListener||e.removeEventListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function RF(e,t,n){let r;const s=new Promise(((s,i)=>{if(n={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...n},!(n.count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");const o=[t].flat(),a=[],{addListener:c,removeListener:l}=TF(e),u=(...e)=>{const t=n.multiArgs?e:e[0];n.filter&&!n.filter(t)||(a.push(t),n.count===a.length&&(r(),s(a)))},h=e=>{r(),i(e)};r=()=>{for(const e of o)l(e,u);for(const e of n.rejectionEvents)l(e,h)};for(const e of o)c(e,u);for(const e of n.rejectionEvents)c(e,h);n.resolveImmediately&&s(a)}));if(s.cancel=r,"number"===typeof n.timeout){const e=AF(s,n.timeout);return e.cancel=r,e}return s}function CF(e,t,n){"function"===typeof n&&(n={filter:n}),n={...n,count:1,resolveImmediately:!1};const r=RF(e,t,n),s=r.then((e=>e[0]));return s.cancel=r.cancel,s}const PF=x("libp2p:webrtc-peer:initator"),NF=1e3;class OF extends mF{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??Fn(uF(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new DF({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",(e=>{this.dispatchEvent(new aN("signal",{detail:e.detail}))}))}handleSignal(e){this.handshake.handleSignal(e).catch((t=>{this.log("error handling signal %o %o",e,t)}))}}class DF extends wF{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",(e=>{if(null==e.candidate)return;const t={type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}};PF.trace("create candidate",t),this.dispatchEvent(new aN("signal",{detail:t})),this.dispatchEvent(new aN("ice-candidate"))}))}async handleRenegotiate(){if("negotiating"===this.status)return void this.log("already negotiating, queueing");this.status="negotiating";const e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await CF(this,"ice-candidate"),await pF(NF),PF.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new aN("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){PF.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}}const LF=x("libp2p:webrtc-star:socket");function xF(e,t){const{sink:n,source:r}=e,s={remoteAddr:t.remoteAddr,async sink(e){null!=t.signal&&(e=qO(e,t.signal));try{await n(e)}catch(rb){"aborted"!==rb.type&&LF.error(rb)}},source:null!=t.signal?qO(r,t.signal):r,timeline:{open:Date.now()},async close(){if(e.closed)return;const t=Date.now(),n=setTimeout((()=>{if(null!=s.remoteAddr){const{host:e,port:n}=s.remoteAddr.toOptions();LF("timeout closing socket to %s:%s after %dms, destroying it manually",e,n,Date.now()-t)}e.closed||e.close().catch((e=>{LF.error("could not close socket",e)}))}),CM);try{await e.close()}finally{clearTimeout(n)}}};return e.addEventListener("close",(()=>{null==s.timeline.close&&(s.timeline.close=Date.now())}),{once:!0}),s}function BF(e){const t=e.toString().split("/"),n=e.protos()[1].name,r=e.protos()[2].name,s=e.stringTuples()[1][1];if("tcp"!==n||"ws"!==r&&"wss"!==r)throw new Error(`invalid multiaddr: ${e.toString()}`);if(!zr(e))return`http://${t[2]}:${t[4]}`;if("ws"===r)return`http://${t[2]}${null==s||"80"===s?"":`:${s}`}`;if("wss"===r)return`https://${t[2]}${null==s||"443"===s?"":`:${s}`}`;throw new Error("invalid multiaddr: "+e.toString())}function MF(e){const t="/libp2p-webrtc-star";if(e.startsWith(t)){e=e.substring(t.length,e.length);let n=Hr(e);const r=n.stringTuples().filter((e=>421===e[0]))[0];if(null==r[1])throw new Error("invalid multiaddr: "+e);n=n.decapsulate("p2p"),n=n.encapsulate("/p2p-webrtc-star"),n=n.encapsulate(`/p2p/${r[1]}`),e=n.toString()}return e}const UF=x("libp2p:webrtc-star:listener"),FF={transports:["websocket"],path:"/socket.io-next/"};class jF extends iN{constructor(e,t,n,r,s){super(),this.signallingAddr=t,this.socket=lF(e,FF),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=n,this.handler=r,this.channelOptions=s,this.handleWsHandshake=this.handleWsHandshake.bind(this);let i=!1;this.socket.on("connect_error",(e=>{i&&"TransportError"===e.type||this.dispatchEvent(new aN("error",{detail:e}))})),this.socket.on("error",(e=>{this.dispatchEvent(new aN("error",{detail:e}))})),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",(e=>{this.dispatchEvent(new aN("peer",{detail:e}))})),this.socket.on("connect",(()=>{this.socket.emit("ss-join",this.signallingAddr.toString()),i&&this.dispatchEvent(new aN("reconnect"))})),this.socket.once("connect",(()=>{i=!0,this.dispatchEvent(new aN("listening"))})),this.socket.on("disconnect",(()=>{this.dispatchEvent(new aN("disconnect"))}))}_createChannel(e,t,n){const r={...this.channelOptions},s=new vF(r),i=e=>{const t=e.detail;UF.error("incoming connection errored",t)};return s.addEventListener("error",i),s.addEventListener("close",(()=>{s.removeEventListener("error",i)}),{once:!0}),s.addEventListener("signal",(r=>{const s=r.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:t,dstMultiaddr:n,answer:!0,signal:s})})),s.addEventListener("ready",(()=>{const t=xF(s,{remoteAddr:this.signallingAddr});UF("new inbound connection %s",t.remoteAddr);try{this.upgrader.upgradeInbound(t).then((n=>{UF("inbound connection %s upgraded",t.remoteAddr),this.connections.push(t);const r=()=>{this.connections=this.connections.filter((e=>e!==t)),this.channels.delete(e),this.pendingSignals.delete(e)};s.addEventListener("close",r,{once:!0}),this.dispatchEvent(new aN("connection",{detail:n})),this.handler(n)})).catch((e=>{UF.error("inbound connection failed to upgrade",e),t.close().catch((e=>{UF.error("inbound connection failed to close after failing to upgrade",e)}))}))}catch(rb){UF.error("inbound connection failed to upgrade",rb),t.close().catch((e=>{UF.error("inbound connection failed to close after failing to upgrade",e)}))}}),{once:!0}),s}handleWsHandshake(e){if(UF('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),!0===e.answer||null!=e.err||null==e.intentId)return;const t=e.intentId;let n=this.pendingSignals.get(t);null==n&&(n=[],this.pendingSignals.set(t,n)),n.push(e);let r=this.channels.get(t);if(null==r){if("offer"!==e.signal.type)return void UF("handshake is not an offer and channel does not exist, buffering until we receive an offer");UF("creating new channel to handle offer handshake"),r=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(t,r)}else UF("channel already exists, using it to handle handshake");while(n.length>0){const e=n.shift();null!=e?.signal&&r.handleSignal(e.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map((async e=>await e.close())),...Array.from(this.channels.values()).map((async e=>await e.close()))]),this.dispatchEvent(new aN("close"))}}class VF extends iN{constructor(e,t,n,r,s){super(),this.upgrader=e,this.handler=t,this.peerId=n,this.transport=r,this.options=s}async listen(e){if(null!=this.listeningAddr)throw B(new Error("listener already in use"),"ERR_ALREADY_LISTENING");const t=wf();let n;this.listeningAddr=e,n=e.protoCodes().includes(TM)?e:e.encapsulate(`/p2p/${this.peerId.toString()}`);const r=this.signallingUrl=BF(e);UF("connecting to signalling server on: %s",this.signallingUrl);const s=new jF(this.signallingUrl,n,this.upgrader,this.handler,this.options.channelOptions);return s.addEventListener("error",(e=>{const n=e.detail;UF("error connecting to signalling server %o",n),s.close().catch((e=>{UF.error("error closing server after error",e)})),t.reject(n)})),s.addEventListener("listening",(()=>{UF("connected to signalling server"),this.dispatchEvent(new aN("listening")),t.resolve()})),s.addEventListener("peer",(e=>{this.transport.peerDiscovered(e.detail)})),s.addEventListener("connection",(t=>{const n=t.detail;if(null==n.remoteAddr)try{n.remoteAddr=e.decapsulateCode(TM).encapsulate(`/p2p/${n.remotePeer.toString()}`)}catch(rb){UF.error("could not determine remote address",rb)}this.dispatchEvent(new aN("connection",{detail:n}))})),s.addEventListener("disconnect",(()=>{this.transport.sigServers.delete(r)})),s.addEventListener("reconnect",(()=>{this.transport.sigServers.set(r,s)})),this.transport.sigServers.set(this.signallingUrl,s),await t.promise}async close(){if(null!=this.signallingUrl){const e=this.transport.sigServers.get(this.signallingUrl);null!=e&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new aN("close")),this.listeningAddr=void 0}getAddrs(){return null!=this.listeningAddr?[this.listeningAddr]:[]}}function zF(e,t,n,r,s){return new VF(e,t,n,r,s)}const $F=Symbol.for("@libp2p/transport");var KF;(function(e){e[e["FATAL_ALL"]=0]="FATAL_ALL",e[e["NO_FATAL"]=1]="NO_FATAL"})(KF||(KF={}));const HF=Symbol.for("@libp2p/peer-discovery");const qF="RTCPeerConnection"in globalThis,WF=x("libp2p:webrtc-star"),GF=()=>{};class YF extends iN{constructor(){super(...arguments),this.started=!1}get[HF](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return!!this.isStarted()&&super.dispatchEvent(e)}}class QF{constructor(e){null!=e?.wrtc&&(this.wrtc=e.wrtc),this.sigServers=new Map,this._discovery=new YF,this.discovery=()=>this._discovery,this.peerDiscovered=this.peerDiscovered.bind(this)}get[$F](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}async dial(e,t){const n=await this._connect(e,t),r=xF(n,{remoteAddr:e,signal:t.signal});WF("new outbound connection %s",r.remoteAddr);const s=await t.upgrader.upgradeOutbound(r);return WF("outbound connection %s upgraded",r.remoteAddr),s}async _connect(e,t){if(!0===t.signal?.aborted)throw new KO;const n={...t.channelOptions??{}};null!=this.wrtc&&(n.wrtc=this.wrtc);const r=e.toOptions(),s=Fn(uF(36),"hex");return await new Promise(((i,o)=>{const a=this.sigServers.get(BF(e));if(null==a?.socket)return o(B(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let c=!1;WF("dialing %s:%s",r.host,r.port);const l=new OF(n),u=e=>{const t=e.detail;if(!c){const e=`connection error ${r.host}:${r.port}: ${t.message}`;WF.error(e),f(t)}},h=()=>{c=!0,WF("connection opened %s:%s",r.host,r.port),f()},d=()=>{WF.error("connection aborted %s:%s",r.host,r.port),l.close().finally((()=>{f(new KO)}))},f=e=>{l.removeEventListener("ready",h),t.signal?.removeEventListener("abort",d),null==e?i(l):o(e)};l.addEventListener("ready",h,{once:!0}),l.addEventListener("close",(()=>{l.removeEventListener("error",u)})),t.signal?.addEventListener("abort",d),l.addEventListener("signal",(t=>{const n=t.detail;a.socket.emit("ss-handshake",{intentId:s,srcMultiaddr:a.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:n})})),a.socket.on("ws-handshake",(e=>{e.intentId===s&&null!=e.err&&l.close().finally((()=>{o(B(new Error(e.err),"ERR_SIGNALLING_FAILED"))})),e.intentId!==s||null==e.answer||l.closed||l.handleSignal(e.signal)}))}))}createListener(e){if(!qF&&null==this.wrtc)throw B(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");if(e.channelOptions=e.channelOptions??{},null!=this.wrtc&&(e.channelOptions.wrtc=this.wrtc),null==this.peerId)throw B(new Error("PeerId not set"),"ERR_MISSING_PEER_ID");return zF(e.upgrader,e.handler??GF,this.peerId,this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter((e=>!e.protoCodes().includes(RM)&&is.matches(e)))}peerDiscovered(e){WF("peer discovered: %s",e),e=MF(e);const t=Hr(e),n=t.getPeerId();if(null==n)return;const r=_o(n);this._discovery.dispatchEvent(new aN("peer",{detail:{id:r,multiaddrs:[t],protocols:[]}}))}}function XF(e={}){const t=new QF(e);return{transport:e=>(t.peerId=e.peerId,t),discovery:t.discovery}}function JF(){const e=XF(),t={transports:[e.transport],peerDiscovery:[e.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1}};return t}function ZF(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}var ej,tj;async function*nj(e,t){yield*_f(e,(async e=>(await t.addressBook.add(e.id,e.multiaddrs),e)))}function rj(e){const t=new Set;return qh(e,(e=>!t.has(e.id.toString())&&(t.add(e.id.toString()),!0)))}async function*sj(e,t=1){let n=0;for await(const r of e)n++,yield r;if(n<t)throw B(new Error("not found"),"NOT_FOUND")}(function(e){e["NOT_STARTED_YET"]="The libp2p node is not started yet",e["DHT_DISABLED"]="DHT is not available",e["PUBSUB_DISABLED"]="PubSub is not available",e["CONN_ENCRYPTION_REQUIRED"]="At least one connection encryption module is required",e["ERR_TRANSPORTS_REQUIRED"]="At least one transport module is required",e["ERR_PROTECTOR_REQUIRED"]="Private network is enforced, but no protector was provided",e["NOT_FOUND"]="Not found"})(ej||(ej={})),function(e){e["DHT_DISABLED"]="ERR_DHT_DISABLED",e["ERR_PUBSUB_DISABLED"]="ERR_PUBSUB_DISABLED",e["PUBSUB_NOT_STARTED"]="ERR_PUBSUB_NOT_STARTED",e["DHT_NOT_STARTED"]="ERR_DHT_NOT_STARTED",e["CONN_ENCRYPTION_REQUIRED"]="ERR_CONN_ENCRYPTION_REQUIRED",e["ERR_TRANSPORTS_REQUIRED"]="ERR_TRANSPORTS_REQUIRED",e["ERR_PROTECTOR_REQUIRED"]="ERR_PROTECTOR_REQUIRED",e["ERR_PEER_DIAL_INTERCEPTED"]="ERR_PEER_DIAL_INTERCEPTED",e["ERR_CONNECTION_INTERCEPTED"]="ERR_CONNECTION_INTERCEPTED",e["ERR_INVALID_PROTOCOLS_FOR_STREAM"]="ERR_INVALID_PROTOCOLS_FOR_STREAM",e["ERR_CONNECTION_ENDED"]="ERR_CONNECTION_ENDED",e["ERR_CONNECTION_FAILED"]="ERR_CONNECTION_FAILED",e["ERR_NODE_NOT_STARTED"]="ERR_NODE_NOT_STARTED",e["ERR_ALREADY_ABORTED"]="ERR_ALREADY_ABORTED",e["ERR_TOO_MANY_ADDRESSES"]="ERR_TOO_MANY_ADDRESSES",e["ERR_NO_VALID_ADDRESSES"]="ERR_NO_VALID_ADDRESSES",e["ERR_RELAYED_DIAL"]="ERR_RELAYED_DIAL",e["ERR_DIALED_SELF"]="ERR_DIALED_SELF",e["ERR_DISCOVERED_SELF"]="ERR_DISCOVERED_SELF",e["ERR_DUPLICATE_TRANSPORT"]="ERR_DUPLICATE_TRANSPORT",e["ERR_ENCRYPTION_FAILED"]="ERR_ENCRYPTION_FAILED",e["ERR_HOP_REQUEST_FAILED"]="ERR_HOP_REQUEST_FAILED",e["ERR_INVALID_KEY"]="ERR_INVALID_KEY",e["ERR_INVALID_MESSAGE"]="ERR_INVALID_MESSAGE",e["ERR_INVALID_PARAMETERS"]="ERR_INVALID_PARAMETERS",e["ERR_INVALID_PEER"]="ERR_INVALID_PEER",e["ERR_MUXER_UNAVAILABLE"]="ERR_MUXER_UNAVAILABLE",e["ERR_NOT_FOUND"]="ERR_NOT_FOUND",e["ERR_TIMEOUT"]="ERR_TIMEOUT",e["ERR_TRANSPORT_UNAVAILABLE"]="ERR_TRANSPORT_UNAVAILABLE",e["ERR_TRANSPORT_DIAL_FAILED"]="ERR_TRANSPORT_DIAL_FAILED",e["ERR_UNSUPPORTED_PROTOCOL"]="ERR_UNSUPPORTED_PROTOCOL",e["ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED"]="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",e["ERR_INVALID_MULTIADDR"]="ERR_INVALID_MULTIADDR",e["ERR_SIGNATURE_NOT_VALID"]="ERR_SIGNATURE_NOT_VALID",e["ERR_FIND_SELF"]="ERR_FIND_SELF",e["ERR_NO_ROUTERS_AVAILABLE"]="ERR_NO_ROUTERS_AVAILABLE",e["ERR_CONNECTION_NOT_MULTIPLEXED"]="ERR_CONNECTION_NOT_MULTIPLEXED",e["ERR_NO_DIAL_TOKENS"]="ERR_NO_DIAL_TOKENS",e["ERR_KEYCHAIN_REQUIRED"]="ERR_KEYCHAIN_REQUIRED",e["ERR_INVALID_CMS"]="ERR_INVALID_CMS",e["ERR_MISSING_KEYS"]="ERR_MISSING_KEYS",e["ERR_NO_KEY"]="ERR_NO_KEY",e["ERR_INVALID_KEY_NAME"]="ERR_INVALID_KEY_NAME",e["ERR_INVALID_KEY_TYPE"]="ERR_INVALID_KEY_TYPE",e["ERR_KEY_ALREADY_EXISTS"]="ERR_KEY_ALREADY_EXISTS",e["ERR_INVALID_KEY_SIZE"]="ERR_INVALID_KEY_SIZE",e["ERR_KEY_NOT_FOUND"]="ERR_KEY_NOT_FOUND",e["ERR_OLD_KEY_NAME_INVALID"]="ERR_OLD_KEY_NAME_INVALID",e["ERR_NEW_KEY_NAME_INVALID"]="ERR_NEW_KEY_NAME_INVALID",e["ERR_PASSWORD_REQUIRED"]="ERR_PASSWORD_REQUIRED",e["ERR_PEM_REQUIRED"]="ERR_PEM_REQUIRED",e["ERR_CANNOT_READ_KEY"]="ERR_CANNOT_READ_KEY",e["ERR_MISSING_PRIVATE_KEY"]="ERR_MISSING_PRIVATE_KEY",e["ERR_MISSING_PUBLIC_KEY"]="ERR_MISSING_PUBLIC_KEY",e["ERR_INVALID_OLD_PASS_TYPE"]="ERR_INVALID_OLD_PASS_TYPE",e["ERR_INVALID_NEW_PASS_TYPE"]="ERR_INVALID_NEW_PASS_TYPE",e["ERR_INVALID_PASS_LENGTH"]="ERR_INVALID_PASS_LENGTH",e["ERR_NOT_IMPLEMENTED"]="ERR_NOT_IMPLEMENTED",e["ERR_WRONG_PING_ACK"]="ERR_WRONG_PING_ACK",e["ERR_INVALID_RECORD"]="ERR_INVALID_RECORD",e["ERR_ALREADY_SUCCEEDED"]="ERR_ALREADY_SUCCEEDED",e["ERR_NO_HANDLER_FOR_PROTOCOL"]="ERR_NO_HANDLER_FOR_PROTOCOL",e["ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"]="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",e["ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS"]="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",e["ERR_CONNECTION_DENIED"]="ERR_CONNECTION_DENIED"}(tj||(tj={}));var ij=n(2407),oj=n(3793);const aj=x("libp2p:peer-routing");class cj{constructor(e,t){this.components=e,this.routers=t.routers??[],this.refreshManagerInit=t.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||0===this.routers.length||null!=this.timeoutId||!1===this.refreshManagerInit.enabled||(this.timeoutId=(0,ij.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(null==this.abortController)try{this.abortController=new Tn.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(0,oj.setMaxListeners)?.(1/0,this.abortController.signal)}catch{}await Hh(this.getClosestPeers(this.components.peerId.toBytes(),{signal:this.abortController.signal}))}catch(rb){aj.error(rb)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,ij.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(e,t){if(0===this.routers.length)throw B(new Error("No peer routers available"),tj.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.peerId.toString())throw B(new Error("Should not try to find self"),tj.ERR_FIND_SELF);const n=await dd(ad(...this.routers.map((n=>async function*(){try{yield await n.findPeer(e,t)}catch(rb){aj.error(rb)}}()))),(e=>qh(e,Boolean)),(e=>nj(e,this.components.peerStore)),(async e=>await QS(e)));if(null!=n)return n;throw B(new Error(ej.NOT_FOUND),tj.ERR_NOT_FOUND)}async*getClosestPeers(e,t){if(0===this.routers.length)throw B(new Error("No peer routers available"),tj.ERR_NO_ROUTERS_AVAILABLE);yield*dd(ad(...this.routers.map((n=>n.getClosestPeers(e,t)))),(e=>nj(e,this.components.peerStore)),(e=>rj(e)),(e=>sj(e)))}}class lj{constructor(e,t){this.routers=t.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,t={}){if(0===this.routers.length)throw B(new Error("No content this.routers available"),tj.ERR_NO_ROUTERS_AVAILABLE);yield*dd(ad(...this.routers.map((n=>n.findProviders(e,t)))),(e=>nj(e,this.components.peerStore)),(e=>rj(e)),(e=>sj(e)))}async provide(e,t={}){if(0===this.routers.length)throw B(new Error("No content routers available"),tj.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map((async n=>await n.provide(e,t))))}async put(e,t,n){if(!this.isStarted())throw B(new Error(ej.NOT_STARTED_YET),tj.DHT_NOT_STARTED);const r=this.components.dht;null!=r&&await Hh(r.put(e,t,n))}async get(e,t){if(!this.isStarted())throw B(new Error(ej.NOT_STARTED_YET),tj.DHT_NOT_STARTED);const n=this.components.dht;if(null!=n)for await(const r of n.get(e,t))if("VALUE"===r.name)return r.value;throw B(new Error(ej.NOT_FOUND),tj.ERR_NOT_FOUND)}async*getMany(e,t,n){if(!this.isStarted())throw B(new Error(ej.NOT_STARTED_YET),tj.DHT_NOT_STARTED);if(null==t||0===t)return;let r=0;const s=this.components.dht;if(null!=s)for await(const i of s.get(e,n))if("VALUE"===i.name&&(yield{from:i.from,val:i.value},r++,r===t))break;if(0===r)throw B(new Error(ej.NOT_FOUND),tj.ERR_NOT_FOUND)}}const uj=e=>e;class hj extends iN{constructor(e,t){super();const{listen:n=[],announce:r=[]}=t;this.components=e,this.listen=n.map((e=>e.toString())),this.announce=new Set(r.map((e=>e.toString()))),this.observed=new Set,this.announceFilter=t.announceFilter??uj}getListenAddrs(){return Array.from(this.listen).map((e=>Hr(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>Hr(e)))}getObservedAddrs(){return Array.from(this.observed).map((e=>Hr(e)))}confirmObservedAddr(e){}removeObservedAddr(e){}addObservedAddr(e){let t=Hr(e);const n=t.getPeerId();if(null!=n){const e=_o(n);e.equals(this.components.peerId)&&(t=t.decapsulate(Hr(`/p2p/${this.components.peerId.toString()}`)))}const r=t.toString();this.observed.has(r)||(this.observed.add(r),this.dispatchEvent(new aN("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map((e=>e.toString()));0===e.length&&(e=this.components.transportManager.getAddrs().map((e=>e.toString()))),e=e.concat(this.getObservedAddrs().map((e=>e.toString())));const t=new Set(e);return this.announceFilter(Array.from(t).map((e=>Hr(e)))).map((e=>!0===e.protos().pop()?.path||e.getPeerId()===this.components.peerId.toString()?e:e.encapsulate(`/p2p/${this.components.peerId.toString()}`)))}}const dj=x("libp2p:connection-manager:latency-monitor:visibility-change-emitter");class fj extends iN{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",null!=globalThis.document&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",t="visibilitychange";"undefined"!==typeof globalThis.document.hidden?(e="hidden",t="visibilitychange"):"undefined"!==typeof globalThis.document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):"undefined"!==typeof globalThis.document.msHidden?(e="msHidden",t="msvisibilitychange"):"undefined"!==typeof globalThis.document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=t}_addVisibilityChangeListener(){"undefined"===typeof globalThis.document.addEventListener||"undefined"===typeof document[this.hidden]?dj("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(void 0!==this.hidden&&void 0!==document[this.hidden])return null==document[this.hidden]}_handleVisibilityChange(){const e=!1===globalThis.document[this.hidden];dj(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new aN("visibilityChange",{detail:e}))}}const pj=x("libp2p:connection-manager:latency-monitor");class gj extends iN{constructor(e={}){super();const{latencyCheckIntervalMs:t,dataEmitIntervalMs:n,asyncTestFn:r,latencyRandomPercentage:s}=e;this.latencyCheckIntervalMs=t??500,this.latencyRandomPercentage=s??10,this.latencyCheckMultiply=this.latencyRandomPercentage/100*2*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=null===n||0===n?void 0:n??5e3,pj("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),null!=this.dataEmitIntervalMs?pj("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):pj("Not emitting summaries"),this.asyncTestFn=r,null!=globalThis.process?.hrtime?(pj("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{const t=this.now(e);return 1e3*t[0]+t[1]/1e6}):"undefined"!==typeof window&&null!=window.performance?.now?(pj("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(pj("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this.latencyData=this.initLatencyData()}start(){yj()&&(this.visibilityChangeEmitter=new fj,this.visibilityChangeEmitter.addEventListener("visibilityChange",(e=>{const{detail:t}=e;t?this._startTimers():(this._emitSummary(),this._stopTimers())}))),!0===this.visibilityChangeEmitter?.isVisible()&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){null==this.checkLatencyID&&(this.checkLatency(),null!=this.dataEmitIntervalMs&&(this.emitIntervalID=setInterval((()=>this._emitSummary()),this.dataEmitIntervalMs),"function"===typeof this.emitIntervalID.unref&&this.emitIntervalID.unref()))}_stopTimers(){null!=this.checkLatencyID&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),null!=this.emitIntervalID&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){const e=this.getSummary();e.events>0&&this.dispatchEvent(new aN("data",{detail:e}))}getSummary(){const e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),pj.trace("Summary: %O",e),e}checkLatency(){const e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,t={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},n=()=>{if(null==this.checkLatencyID)return;const e=this.getDeltaMS(t.startTime)-t.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,e),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,e),this.latencyData.totalMs+=e,pj.trace("MS: %s Data: %O",e,this.latencyData)};pj.trace("localData: %O",t),this.checkLatencyID=setTimeout((()=>{null!=this.asyncTestFn?(t.deltaOffset=0,t.startTime=this.now(),this.asyncTestFn(n)):(t.deltaOffset-=1,n())}),t.deltaOffset),"function"===typeof this.checkLatencyID.unref&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}}function yj(){return"undefined"!==typeof globalThis.window}const mj="OPEN",wj="CLOSING",bj="CLOSED";function vj(e,t){const n={[Symbol.iterator]:()=>n,next:()=>{const n=e.next(),r=n.value;if(!0===n.done||null==r){const e={done:!0,value:void 0};return e}return{done:!1,value:t(r)}}};return n}class _j{constructor(e){if(this.map=new Map,null!=e)for(const[t,n]of e.entries())this.map.set(t.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return vj(this.map.entries(),(e=>[_o(e[0]),e[1]]))}forEach(e){this.map.forEach(((t,n)=>{e(t,_o(n),this)}))}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),t)}keys(){return vj(this.map.keys(),(e=>_o(e)))}values(){return this.map.values()}get size(){return this.map.size}}class Ej{constructor(e){if(this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return vj(this.set.entries(),(e=>{const t=_o(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const n=_o(t);e(n,n,this)}))}has(e){return this.set.has(e.toString())}values(){return vj(this.set.values(),(e=>_o(e)))}intersection(e){const t=new Ej;for(const n of e)this.has(n)&&t.add(n);return t}difference(e){const t=new Ej;for(const n of this)e.has(n)||t.add(n);return t}union(e){const t=new Ej;for(const n of e)t.add(n);for(const n of this)t.add(n);return t}}class Sj{constructor(e){if(this.list=[],null!=e)for(const t of e)this.list.push(t.toString())}[Symbol.iterator](){return mapIterable(this.list.entries(),(e=>peerIdFromString(e[1])))}concat(e){const t=new Sj(this);for(const n of e)t.push(n);return t}entries(){return mapIterable(this.list.entries(),(e=>[e[0],peerIdFromString(e[1])]))}every(e){return this.list.every(((t,n)=>e(peerIdFromString(t),n,this)))}filter(e){const t=new Sj;return this.list.forEach(((n,r)=>{const s=peerIdFromString(n);e(s,r,this)&&t.push(s)})),t}find(e){const t=this.list.find(((t,n)=>e(peerIdFromString(t),n,this)));if(null!=t)return peerIdFromString(t)}findIndex(e){return this.list.findIndex(((t,n)=>e(peerIdFromString(t),n,this)))}forEach(e){this.list.forEach(((t,n)=>{e(peerIdFromString(t),n,this)}))}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){const e=this.list.pop();if(null!=e)return peerIdFromString(e)}push(...e){for(const t of e)this.list.push(t.toString())}shift(){const e=this.list.shift();if(null!=e)return peerIdFromString(e)}unshift(...e){let t=this.list.length;for(let n=e.length-1;n>-1;n--)this.list.unshift(e[n].toString());return t}get length(){return this.list.length}}const kj="keep-alive";var Ij=n(5024);function Aj(e){if(lo(e))return{peerId:e};if($r(e)){const t=e.getPeerId();return{multiaddr:e,peerId:null==t?void 0:_o(t)}}throw B(new Error(`${e} is not a PeerId or a Multiaddr`),tj.ERR_INVALID_MULTIADDR)}const Tj=x("libp2p:connection-manager"),Rj={maxConnections:1/0,minConnections:0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,inboundConnectionThreshold:5,maxIncomingPendingConnections:10},Cj=6e4;class Pj extends iN{constructor(e,t){if(super(),this.opts=I.call({ignoreUndefined:!0},Rj,t),this.opts.maxConnections<this.opts.minConnections)throw B(new Error("Connection Manager maxConnections must be greater than minConnections"),tj.ERR_INVALID_PARAMETERS);Tj("options: %o",this.opts),this.components=e,this.connections=new Map,this.started=!1,null!=t.maxEventLoopDelay&&t.maxEventLoopDelay>0&&t.maxEventLoopDelay!==1/0&&(this.latencyMonitor=new gj({latencyCheckIntervalMs:t.pollInterval,dataEmitIntervalMs:t.pollInterval}));try{(0,oj.setMaxListeners)?.(1/0,this)}catch{}this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.startupReconnectTimeout=t.startupReconnectTimeout??Cj,this.dialTimeout=t.dialTimeout??3e4,this.allow=(t.allow??[]).map((e=>Hr(e))),this.deny=(t.deny??[]).map((e=>Hr(e))),this.inboundConnectionRateLimiter=new Ij.RateLimiterMemory({points:this.opts.inboundConnectionThreshold,duration:1}),this.incomingPendingConnections=0}isStarted(){return this.started}async start(){this.components.metrics?.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,outbound:0};for(const t of this.connections.values())for(const n of t)"inbound"===n.stat.direction?e.inbound++:e.outbound++;return e}}),this.components.metrics?.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const t of this.connections.values())for(const n of t)for(const t of n.streams){const n=`${t.stat.direction} ${t.stat.protocol??"unnegotiated"}`;e[n]=(e[n]??0)+1}return e}}),this.components.metrics?.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const n of this.connections.values())for(const t of n){const n={};for(const e of t.streams){const t=`${e.stat.direction} ${e.stat.protocol??"unnegotiated"}`;n[t]=(n[t]??0)+1}for(const[t,r]of Object.entries(n))e[t]=e[t]??[],e[t].push(r)}const t={};for(let[n,r]of Object.entries(e)){r=r.sort(((e,t)=>e-t));const e=Math.floor(.9*r.length);t[n]=r[e]}return t}}),this.latencyMonitor?.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor?.addEventListener("data",this._onLatencyMeasure),this.started=!0,Tj("started")}async afterStart(){this.components.upgrader.addEventListener("connection",this.onConnect),this.components.upgrader.addEventListener("connectionEnd",this.onDisconnect),Promise.resolve().then((async()=>{const e=[];for(const t of await this.components.peerStore.all()){const n=await this.components.peerStore.getTags(t.id),r=n.filter((e=>e.name===kj)).length>0;r&&e.push(t.id)}this.connectOnStartupController?.clear(),this.connectOnStartupController=new Tn.TimeoutController(this.startupReconnectTimeout);try{(0,oj.setMaxListeners)?.(1/0,this.connectOnStartupController.signal)}catch{}await Promise.all(e.map((async e=>{await this.openConnection(e,{signal:this.connectOnStartupController?.signal}).catch((e=>{Tj.error(e)}))})))})).catch((e=>{Tj.error(e)})).finally((()=>{this.connectOnStartupController?.clear()}))}async beforeStop(){this.connectOnStartupController?.abort(),this.components.upgrader.removeEventListener("connection",this.onConnect),this.components.upgrader.removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.latencyMonitor?.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor?.stop(),this.started=!1,await this._close(),Tj("stopped")}async _close(){const e=[];for(const t of this.connections.values())for(const n of t)e.push((async()=>{try{await n.close()}catch(rb){Tj.error(rb)}})());Tj("closing %d connections",e.length),await Promise.all(e),this.connections.clear()}onConnect(e){this._onConnect(e).catch((e=>{Tj.error(e)}))}async _onConnect(e){const{detail:t}=e;if(!this.started)return void await t.close();const n=t.remotePeer,r=n.toString(),s=this.connections.get(r);null!=s?s.push(t):this.connections.set(r,[t]),null!=n.publicKey&&await this.components.peerStore.keyBook.set(n,n.publicKey);const i=this.getConnections().length,o=i-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",i,o),this.dispatchEvent(new aN("peer:connect",{detail:t}))}onDisconnect(e){const{detail:t}=e;if(!this.started)return;const n=t.remotePeer.toString();let r=this.connections.get(n);null!=r&&r.length>1?(r=r.filter((e=>e.id!==t.id)),this.connections.set(n,r)):null!=r&&(this.connections.delete(n),this.dispatchEvent(new aN("peer:disconnect",{detail:t})))}getConnections(e){if(null!=e)return this.connections.get(e.toString())??[];let t=[];for(const n of this.connections.values())t=t.concat(n);return t}async openConnection(e,t={}){const{peerId:n,multiaddr:r}=Aj(e);if(null==n&&null==r)throw B(new TypeError("Can only open connections to PeerIds or Multiaddrs"),tj.ERR_INVALID_PARAMETERS);if(null!=n){Tj("dial to",n);const e=this.getConnections(n);if(e.length>0)return Tj("had an existing connection to %p",n),e[0]}let s;if(null==t?.signal){s=new Tn.TimeoutController(this.dialTimeout),t.signal=s.signal;try{(0,oj.setMaxListeners)?.(1/0,s.signal)}catch{}}try{const n=await this.components.dialer.dial(e,t);let r=this.connections.get(n.remotePeer.toString());null==r&&(r=[],this.connections.set(n.remotePeer.toString(),r));let i=!1;for(const e of r)e.id===n.id&&(i=!0);return i||r.push(n),n}finally{null!=s&&s.clear()}}async closeConnections(e){const t=this.connections.get(e.toString())??[];await Promise.all(t.map((async e=>await e.close())))}getAll(e){if(!lo(e))throw B(new Error("peerId must be an instance of peer-id"),tj.ERR_INVALID_PARAMETERS);const t=e.toString(),n=this.connections.get(t);return null!=n?n.filter((e=>e.stat.status===mj)):[]}_onLatencyMeasure(e){const{detail:t}=e;this._checkMaxLimit("maxEventLoopDelay",t.avgMs,1).catch((e=>{Tj.error(e)}))}async _checkMaxLimit(e,t,n=1){const r=this.opts[e];null!=r?(Tj.trace("checking limit of %s. current value: %d of %d",e,t,r),t>r&&(Tj("%s: limit exceeded: %p, %d/%d, pruning %d connection(s)",this.components.peerId,e,t,r,n),await this._pruneConnections(n))):Tj.trace("limit %s was not set so it cannot be applied",e)}async _pruneConnections(e){const t=this.getConnections(),n=new _j;for(const i of t){const e=i.remotePeer;if(n.has(e))continue;const t=await this.components.peerStore.getTags(e);n.set(e,t.reduce(((e,t)=>e+t.value),0))}const r=t.sort(((e,t)=>{const r=n.get(e.remotePeer)??0,s=n.get(t.remotePeer)??0;if(r>s)return 1;if(r<s)return-1;const i=e.stat.timeline.open,o=t.stat.timeline.open;return i<o?1:i>o?-1:0})),s=[];for(const i of r)if(Tj("too many connections open - closing a connection to %p",i.remotePeer),s.push(i),s.length===e)break;await Promise.all(s.map((async e=>{try{await e.close()}catch(rb){Tj.error(rb)}this.onDisconnect(new aN("connectionEnd",{detail:e}))})))}async acceptIncomingConnection(e){const t=this.deny.some((t=>e.remoteAddr.toString().startsWith(t.toString())));if(t)return Tj("connection from %s refused - connection remote address was in deny list",e.remoteAddr),!1;const n=this.allow.some((t=>e.remoteAddr.toString().startsWith(t.toString())));if(n)return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.opts.maxIncomingPendingConnections)return Tj("connection from %s refused - incomingPendingConnections exceeded by peer %s",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const t=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(t,1)}catch{return Tj("connection from %s refused - inboundConnectionThreshold exceeded by host %s",t,e.remoteAddr),!1}}return this.getConnections().length<this.opts.maxConnections?(this.incomingPendingConnections++,!0):(Tj("connection from %s refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}}var Nj=n(3057);const Oj=x("libp2p:connection-manager:auto-dialler"),Dj={enabled:!0,minConnections:0,autoDialInterval:1e4};class Lj{constructor(e,t){this.components=e,this.options=I.call({ignoreUndefined:!0},Dj,t),this.running=!1,this._autoDial=this._autoDial.bind(this),Oj("options: %j",this.options)}isStarted(){return this.running}async start(){this.options.enabled?(this.running=!0,this._autoDial().catch((e=>{Oj.error("could start autodial",e)})),Oj("started")):Oj("not enabled")}async stop(){this.options.enabled?(this.running=!1,null!=this.autoDialTimeout&&this.autoDialTimeout.clear(),Oj("stopped")):Oj("not enabled")}async _autoDial(){null!=this.autoDialTimeout&&this.autoDialTimeout.clear();const e=this.options.minConnections;if(this.components.connectionManager.getConnections().length>=e)return void(this.autoDialTimeout=Nj(this._autoDial,this.options.autoDialInterval));const t=await this.components.peerStore.all(),n=await dd(t.sort((()=>Math.random()>.5?1:-1)),(e=>qh(e,(e=>!e.id.equals(this.components.peerId)))),(e=>yP(e,((e,t)=>t.protocols.length>e.protocols.length||null!=t.id.publicKey&&null==e.id.publicKey?1:-1))),(async e=>await $h(e)));for(let r=0;this.running&&r<n.length&&this.components.connectionManager.getConnections().length<e;r++){if(!this.running)return;const e=n[r];if(0===this.components.connectionManager.getConnections(e.id).length){Oj("connecting to a peerStore stored peer %p",e.id);try{await this.components.connectionManager.openConnection(e.id)}catch(rb){Oj.error("could not connect to peerStore stored peer",rb)}}}this.running&&(this.autoDialTimeout=Nj(this._autoDial,this.options.autoDialInterval))}}var xj;(function(e){let t,n,r,s,i,o;(function(e){e["SUCCESS"]="SUCCESS",e["HOP_SRC_ADDR_TOO_LONG"]="HOP_SRC_ADDR_TOO_LONG",e["HOP_DST_ADDR_TOO_LONG"]="HOP_DST_ADDR_TOO_LONG",e["HOP_SRC_MULTIADDR_INVALID"]="HOP_SRC_MULTIADDR_INVALID",e["HOP_DST_MULTIADDR_INVALID"]="HOP_DST_MULTIADDR_INVALID",e["HOP_NO_CONN_TO_DST"]="HOP_NO_CONN_TO_DST",e["HOP_CANT_DIAL_DST"]="HOP_CANT_DIAL_DST",e["HOP_CANT_OPEN_DST_STREAM"]="HOP_CANT_OPEN_DST_STREAM",e["HOP_CANT_SPEAK_RELAY"]="HOP_CANT_SPEAK_RELAY",e["HOP_CANT_RELAY_TO_SELF"]="HOP_CANT_RELAY_TO_SELF",e["STOP_SRC_ADDR_TOO_LONG"]="STOP_SRC_ADDR_TOO_LONG",e["STOP_DST_ADDR_TOO_LONG"]="STOP_DST_ADDR_TOO_LONG",e["STOP_SRC_MULTIADDR_INVALID"]="STOP_SRC_MULTIADDR_INVALID",e["STOP_DST_MULTIADDR_INVALID"]="STOP_DST_MULTIADDR_INVALID",e["STOP_RELAY_REFUSED"]="STOP_RELAY_REFUSED",e["MALFORMED_MESSAGE"]="MALFORMED_MESSAGE"})(t=e.Status||(e.Status={})),function(e){e[e["SUCCESS"]=100]="SUCCESS",e[e["HOP_SRC_ADDR_TOO_LONG"]=220]="HOP_SRC_ADDR_TOO_LONG",e[e["HOP_DST_ADDR_TOO_LONG"]=221]="HOP_DST_ADDR_TOO_LONG",e[e["HOP_SRC_MULTIADDR_INVALID"]=250]="HOP_SRC_MULTIADDR_INVALID",e[e["HOP_DST_MULTIADDR_INVALID"]=251]="HOP_DST_MULTIADDR_INVALID",e[e["HOP_NO_CONN_TO_DST"]=260]="HOP_NO_CONN_TO_DST",e[e["HOP_CANT_DIAL_DST"]=261]="HOP_CANT_DIAL_DST",e[e["HOP_CANT_OPEN_DST_STREAM"]=262]="HOP_CANT_OPEN_DST_STREAM",e[e["HOP_CANT_SPEAK_RELAY"]=270]="HOP_CANT_SPEAK_RELAY",e[e["HOP_CANT_RELAY_TO_SELF"]=280]="HOP_CANT_RELAY_TO_SELF",e[e["STOP_SRC_ADDR_TOO_LONG"]=320]="STOP_SRC_ADDR_TOO_LONG",e[e["STOP_DST_ADDR_TOO_LONG"]=321]="STOP_DST_ADDR_TOO_LONG",e[e["STOP_SRC_MULTIADDR_INVALID"]=350]="STOP_SRC_MULTIADDR_INVALID",e[e["STOP_DST_MULTIADDR_INVALID"]=351]="STOP_DST_MULTIADDR_INVALID",e[e["STOP_RELAY_REFUSED"]=390]="STOP_RELAY_REFUSED",e[e["MALFORMED_MESSAGE"]=400]="MALFORMED_MESSAGE"}(n||(n={})),function(e){e.codec=()=>ha(n)}(t=e.Status||(e.Status={})),function(e){e["HOP"]="HOP",e["STOP"]="STOP",e["STATUS"]="STATUS",e["CAN_HOP"]="CAN_HOP"}(r=e.Type||(e.Type={})),function(e){e[e["HOP"]=1]="HOP",e[e["STOP"]=2]="STOP",e[e["STATUS"]=3]="STATUS",e[e["CAN_HOP"]=4]="CAN_HOP"}(s||(s={})),function(e){e.codec=()=>ha(s)}(r=e.Type||(e.Type={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.addrs)for(const r of e.addrs)t.uint32(18),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:new Uint8Array(0),addrs:[]},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.addrs.push(e.bytes());break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(i=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=da(((t,n,r={})=>{!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.Type.codec().encode(t.type,n)),null!=t.srcPeer&&(n.uint32(18),e.Peer.codec().encode(t.srcPeer,n,{writeDefaults:!1})),null!=t.dstPeer&&(n.uint32(26),e.Peer.codec().encode(t.dstPeer,n,{writeDefaults:!1})),null!=t.code&&(n.uint32(32),e.Status.codec().encode(t.code,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={},s=null==n?t.len:t.pos+n;while(t.pos<s){const n=t.uint32();switch(n>>>3){case 1:r.type=e.Type.codec().decode(t);break;case 2:r.srcPeer=e.Peer.codec().decode(t,t.uint32());break;case 3:r.dstPeer=e.Peer.codec().decode(t,t.uint32());break;case 4:r.code=e.Status.codec().decode(t);break;default:t.skipType(7&n);break}}return r}))),o),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(xj||(xj={}));const Bj=x("libp2p:stream:converter");function Mj(e,t={}){const{stream:n,remoteAddr:r}=e,{sink:s,source:i}=n,o=async function*(){for await(const e of i)yield*e}(),a={async sink(e){null!=t.signal&&(e=qO(e,t.signal));try{await s(e),await c()}catch(rb){"aborted"!==rb.type&&Bj(rb)}},source:null!=t.signal?qO(o,t.signal):o,remoteAddr:r,timeline:{open:Date.now(),close:void 0},async close(){await s(async function*(){yield new Uint8Array(0)}()),await c()}};async function c(){return null==a.timeline.close&&(a.timeline.close=Date.now()),await Promise.resolve()}return a}const Uj="/libp2p/circuit/relay/0.1.0";function Fj(e){const t=new Map;async function n(n){const r=n.toString().split("/p2p-circuit").find((e=>""!==e)),i=Hr(r),o=i.getPeerId();if(null==o)throw new Error("Could not determine relay peer from multiaddr");const a=_o(o);await e.peerStore.addressBook.add(a,[i]);const c=await e.connectionManager.openConnection(a),l=c.remoteAddr.encapsulate("/p2p-circuit");t.set(c.remotePeer.toString(),l),s.dispatchEvent(new aN("listening"))}function r(){const e=[];for(const n of t.values())e.push(n);return e}const s=Object.assign(new iN,{close:async()=>await Promise.resolve(),listen:n,getAddrs:r});return e.connectionManager.addEventListener("peer:disconnect",(e=>{const{detail:n}=e,r=t.delete(n.remotePeer.toString());r&&s.dispatchEvent(new aN("close"))})),s}function jj(e,t){e.write({type:xj.Type.STATUS,code:t})}function Vj(e,t){try{null!=e.dstPeer?.addrs&&e.dstPeer.addrs.forEach((e=>Hr(e)))}catch(rb){throw jj(t,e.type===xj.Type.HOP?xj.Status.HOP_DST_MULTIADDR_INVALID:xj.Status.STOP_DST_MULTIADDR_INVALID),rb}try{null!=e.srcPeer?.addrs&&e.srcPeer.addrs.forEach((e=>Hr(e)))}catch(rb){throw jj(t,e.type===xj.Type.HOP?xj.Status.HOP_SRC_MULTIADDR_INVALID:xj.Status.STOP_SRC_MULTIADDR_INVALID),rb}}function zj(e){const t=Xh(),n=iy(e.source),r=wf();let s;const i=e.sink(async function*(){yield*t;const e=await r.promise;yield*e}());i.catch((e=>{s=e}));const o={sink:async e=>null!=s?await Promise.reject(s):(r.resolve(e),await i),source:n};return{reader:n,writer:t,stream:o,rest:()=>t.end(),write:t.push,read:async()=>{const e=await n.next();if(null!=e.value)return e.value}}}const $j=x("libp2p:circuit:stream-handler");class Kj{constructor(e){const{stream:t,maxLength:n=4096}=e;this.stream=t,this.shake=zj(this.stream),this.decoder=nD.fromReader(this.shake.reader,{maxDataLength:n})}async read(){const e=await this.decoder.next();if(null!=e.value){const t=xj.decode(e.value);return $j("read message type",t.type),t}$j("read received no value, closing stream"),this.close()}write(e){$j("write message type %s",e.type),this.shake.write(XO.single(xj.encode(e)))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){$j("closing the stream"),this.rest().sink([]).catch((e=>{$j.error(e)}))}}const Hj=x("libp2p:circuit:stop");function qj(e){const{connection:t,request:n,streamHandler:r}=e;try{Vj(n,r)}catch(rb){return void Hj.error("invalid stop request via peer %p %o",t.remotePeer,rb)}return Hj("stop request is valid"),r.write({type:xj.Type.STATUS,code:xj.Status.SUCCESS}),r.rest()}async function Wj(e){const{connection:t,request:n,signal:r}=e,s=await t.newStream(Uj,{signal:r});Hj("starting stop request to %p",t.remotePeer);const i=new Kj({stream:s});i.write(n);const o=await i.read();if(null!=o){if(o.code===xj.Status.SUCCESS)return Hj("stop request to %p was successful",t.remotePeer),i.rest();Hj("stop request failed with code %d",o.code),i.close()}else i.close()}const Gj=x("libp2p:circuit:hop");async function Yj(e){const{connection:t,request:n,streamHandler:r,circuit:s,connectionManager:i}=e;if(!s.hopEnabled())return Gj("HOP request received but we are not acting as a relay"),r.end({type:xj.Type.STATUS,code:xj.Status.HOP_CANT_SPEAK_RELAY});try{Vj(n,r)}catch(rb){return void Gj.error("invalid hop request via peer %p %o",t.remotePeer,rb)}if(null==n.dstPeer)return void Gj("HOP request received but we do not receive a dstPeer");const o=Eo(n.dstPeer.id),a=i.getConnections(o);if(0===a.length&&!s.hopActive())return Gj("HOP request received but we are not connected to the destination peer"),r.end({type:xj.Type.STATUS,code:xj.Status.HOP_NO_CONN_TO_DST});if(0===a.length)return Gj("did not have connection to remote peer"),r.end({type:xj.Type.STATUS,code:xj.Status.HOP_NO_CONN_TO_DST});const c={type:xj.Type.STOP,dstPeer:n.dstPeer,srcPeer:n.srcPeer};let l;try{Gj("performing STOP request");const e=await Wj({connection:a[0],request:c});if(null==e)throw new Error("Could not stop");l=e}catch(rb){return void Gj.error(rb)}Gj("hop request from %p is valid",t.remotePeer),r.write({type:xj.Type.STATUS,code:xj.Status.SUCCESS});const u=r.rest();return Gj("creating related connections"),await dd(u,l,u)}async function Qj(e){const{connection:t,request:n,signal:r}=e,s=await t.newStream(Uj,{signal:r}),i=new Kj({stream:s});i.write(n);const o=await i.read();if(null==o)throw B(new Error("HOP request had no response"),tj.ERR_HOP_REQUEST_FAILED);if(o.code===xj.Status.SUCCESS)return Gj("hop request was successful"),i.rest();throw Gj("hop request failed with code %d, closing stream",o.code),i.close(),B(new Error(`HOP request failed with code "${o.code??"unknown"}"`),tj.ERR_HOP_REQUEST_FAILED)}async function Xj(e){const{connection:t,signal:n}=e,r=await t.newStream(Uj,{signal:n}),s=new Kj({stream:r});s.write({type:xj.Type.CAN_HOP});const i=await s.read();return await s.close(),null!=i&&i.code===xj.Status.SUCCESS}function Jj(e){const{connection:t,streamHandler:n,circuit:r}=e,s=r.hopEnabled();Gj("can hop (%s) request from %p",s,t.remotePeer),n.end({type:xj.Type.STATUS,code:s?xj.Status.SUCCESS:xj.Status.HOP_CANT_SPEAK_RELAY})}const Zj=x("libp2p:circuit");class eV{constructor(e,t){this._init=t,this.components=e,this._started=!1}isStarted(){return this._started}async start(){this._started||(this._started=!0,await this.components.registrar.handle(Uj,(e=>{this._onProtocol(e).catch((e=>{Zj.error(e)}))}),{...this._init}).catch((e=>{Zj.error(e)})))}async stop(){await this.components.registrar.unhandle(Uj)}hopEnabled(){return!0}hopActive(){return!0}get[$F](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(e){const{connection:t,stream:n}=e,r=new Tn.TimeoutController(this._init.hop.timeout);try{(0,oj.setMaxListeners)?.(1/0,r.signal)}catch{}try{const e=GO(n,r.signal),s=new Kj({stream:{...n,...e}}),i=await s.read();if(null==i)return Zj("request was invalid, could not read from stream"),s.write({type:xj.Type.STATUS,code:xj.Status.MALFORMED_MESSAGE}),void s.close();let o;switch(i.type){case xj.Type.CAN_HOP:Zj("received CAN_HOP request from %p",t.remotePeer),await Jj({circuit:this,connection:t,streamHandler:s});break;case xj.Type.HOP:Zj("received HOP request from %p",t.remotePeer),await Yj({connection:t,request:i,streamHandler:s,circuit:this,connectionManager:this.components.connectionManager});break;case xj.Type.STOP:Zj("received STOP request from %p",t.remotePeer),o=await qj({connection:t,request:i,streamHandler:s});break;default:return Zj("Request of type %s not supported",i.type),s.write({type:xj.Type.STATUS,code:xj.Status.MALFORMED_MESSAGE}),void s.close()}if(null!=o){const e=t.remoteAddr.encapsulate("/p2p-circuit").encapsulate(Hr(i.dstPeer?.addrs[0])),n=Hr(i.srcPeer?.addrs[0]),r=Mj({stream:o,remoteAddr:e,localAddr:n}),s=i.type===xj.Type.HOP?"relay":"inbound";Zj("new %s connection %s",s,r.remoteAddr);const a=await this.components.upgrader.upgradeInbound(r);Zj("%s connection %s upgraded",s,r.remoteAddr),null!=this.handler&&this.handler(a)}}finally{r.clear()}}async dial(e,t={}){const n=e.toString().split("/p2p-circuit"),r=Hr(n[0]),s=Hr(n[n.length-1]),i=r.getPeerId(),o=s.getPeerId();if(null==i||null==o){const e="Circuit relay dial failed as addresses did not have peer id";throw Zj.error(e),B(new Error(e),tj.ERR_RELAYED_DIAL)}const a=_o(i),c=_o(o);let l=!1;const u=this.components.connectionManager.getConnections(a);let h=u[0];null==h&&(await this.components.peerStore.addressBook.add(a,[r]),h=await this.components.connectionManager.openConnection(a,t),l=!0);try{const n=await Qj({...t,connection:h,request:{type:xj.Type.HOP,srcPeer:{id:this.components.peerId.toBytes(),addrs:this.components.addressManager.getAddresses().map((e=>e.bytes))},dstPeer:{id:c.toBytes(),addrs:[Hr(s).bytes]}}}),i=r.encapsulate(`/p2p-circuit/p2p/${this.components.peerId.toString()}`),o=Mj({stream:n,remoteAddr:e,localAddr:i});return Zj("new outbound connection %s",o.remoteAddr),await this.components.upgrader.upgradeOutbound(o)}catch(rb){throw Zj.error("Circuit relay dial failed",rb),l&&await h.close(),rb}}createListener(e){return this.handler=e.handler,Fj({connectionManager:this.components.connectionManager,peerStore:this.components.peerStore})}filter(e){return e=Array.isArray(e)?e:[e],e.filter((e=>hs.matches(e)))}}async function tV(e){const t=(new TextEncoder).encode(e),n=await Gt.digest(t);return X.k0.createV0(n)}const nV=6e4,rV=15*nV,sV=30*nV,iV=290,oV="hop_relay",aV="true",cV="/libp2p/relay";var lV=n(98);const uV="[a-fA-F\\d:]",hV=e=>e&&e.includeBoundaries?`(?:(?<=\\s|^)(?=${uV})|(?<=${uV})(?=\\s|$))`:"",dV="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",fV="[a-fA-F\\d]{1,4}",pV=`\n(?:\n(?:${fV}:){7}(?:${fV}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${fV}:){6}(?:${dV}|:${fV}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${fV}:){5}(?::${dV}|(?::${fV}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${fV}:){4}(?:(?::${fV}){0,1}:${dV}|(?::${fV}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${fV}:){3}(?:(?::${fV}){0,2}:${dV}|(?::${fV}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${fV}:){2}(?:(?::${fV}){0,3}:${dV}|(?::${fV}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${fV}:){1}(?:(?::${fV}){0,4}:${dV}|(?::${fV}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${fV}){0,5}:${dV}|(?::${fV}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),gV=new RegExp(`(?:^${dV}$)|(?:^${pV}$)`),yV=new RegExp(`^${dV}$`),mV=new RegExp(`^${pV}$`),wV=e=>e&&e.exact?gV:new RegExp(`(?:${hV(e)}${dV}${hV(e)})|(?:${hV(e)}${pV}${hV(e)})`,"g");wV.v4=e=>e&&e.exact?yV:new RegExp(`${hV(e)}${dV}${hV(e)}`,"g"),wV.v6=e=>e&&e.exact?mV:new RegExp(`${hV(e)}${pV}${hV(e)}`,"g");var bV=wV,vV=n(9564);const{isValid:_V,parse:EV}=vV,SV=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],kV=SV.map((e=>new lV.Netmask(e)));function IV(e){for(let t of kV)if(t.contains(e))return!0;return!1}function AV(e){return/^::$/.test(e)||/^::1$/.test(e)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}var TV=e=>{if(_V(e)){const t=EV(e);if("ipv4"===t.kind())return IV(t.toNormalizedString());if("ipv6"===t.kind())return AV(e)}else if(Un(e)&&bV.v6().test(e))return AV(e)},RV=TV;function CV(e){const{address:t}=e.nodeAddress();return Boolean(RV(t))}function PV(e,t){const n=CV(e.multiaddr),r=CV(t.multiaddr);return n&&!r?1:!n&&r||e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}const NV=x("libp2p:auto-relay"),OV=()=>{};class DV{constructor(e,t){this.components=e,this.addressSorter=t.addressSorter??PV,this.maxListeners=t.maxListeners??1,this.listenRelays=new Set,this.onError=t.onError??OV,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.peerStore.addEventListener("change:protocols",(e=>{this._onProtocolChange(e).catch((e=>{NV.error(e)}))})),this.components.connectionManager.addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(e){const{peerId:t,protocols:n}=e.detail,r=t.toString(),s=n.find((e=>e===Uj));if(null!=s){if(!this.listenRelays.has(r))try{const e=this.components.connectionManager.getConnections(t);if(0===e.length)return;const n=e[0];if(n.remoteAddr.protoCodes().includes(iV))return void NV(`relayed connection to ${r} will not be used to hop on`);const s=await Xj({connection:n});s&&(await this.components.peerStore.metadataBook.setValue(t,oV,An(aV)),await this._addListenRelay(n,r))}catch(rb){this.onError(rb)}}else this.listenRelays.has(r)&&await this._removeListenRelay(r)}_onPeerDisconnected(e){const t=e.detail,n=t.remotePeer,r=n.toString();this.listenRelays.has(r)&&this._removeListenRelay(r).catch((e=>{NV.error(e)}))}async _addListenRelay(e,t){try{if(this.listenRelays.size>=this.maxListeners)return;const n=await dd(await this.components.peerStore.addressBook.get(e.remotePeer),(e=>yP(e,this.addressSorter)),(async e=>await $h(e))),r=await Promise.all(n.map((async t=>{try{let n=t.multiaddr;return null==n.getPeerId()&&(n=n.encapsulate(`/p2p/${e.remotePeer.toString()}`)),n=n.encapsulate("/p2p-circuit"),await this.components.transportManager.listen([n]),!0}catch(rb){NV.error("error listening on circuit address",rb),this.onError(rb)}return!1})));r.includes(!0)&&this.listenRelays.add(t)}catch(rb){this.onError(rb),this.listenRelays.delete(t)}}async _removeListenRelay(e){this.listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this.listenRelays.size>=this.maxListeners)return;const t=[],n=await this.components.peerStore.all();for(const{id:r,metadata:s}of n){const n=r.toString();if(this.listenRelays.has(n))continue;if(e.includes(n))continue;const i=s.get(oV);if(null==i||Fn(i)!==aV)continue;const o=this.components.connectionManager.getConnections(r);if(0!==o.length){if(await this._addListenRelay(o[0],n),this.listenRelays.size>=this.maxListeners)return}else t.push(r)}for(const r of t)if(await this._tryToListenOnRelay(r),this.listenRelays.size>=this.maxListeners)return;try{const e=await tV(cV);for await(const t of this.components.contentRouting.findProviders(e)){if(0===t.multiaddrs.length)continue;const e=t.id;if(!e.equals(this.components.peerId)&&(await this.components.peerStore.addressBook.add(e,t.multiaddrs),await this._tryToListenOnRelay(e),this.listenRelays.size>=this.maxListeners))return}}catch(rb){this.onError(rb)}}async _tryToListenOnRelay(e){try{const t=await this.components.connectionManager.openConnection(e);await this._addListenRelay(t,e.toString())}catch(rb){NV.error("Could not use %p as relay",e,rb),this.onError(rb,`could not connect and listen on known hop relay ${e.toString()}`)}}}const LV=x("libp2p:relay");class xV{constructor(e,t){this.components=e,this.autoRelay=!1!==t.autoRelay?.enabled?new DV(e,{addressSorter:t.addressSorter,...t.autoRelay}):void 0,this.started=!1,this.init=t,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){!1!==this.init.hop.enabled&&!1!==this.init.advertise.enabled&&(this.timeout=(0,ij.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){null!=this.timeout&&(0,ij.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{const e=await tV(cV);await this.components.contentRouting.provide(e)}catch(rb){rb.code===tj.ERR_NO_ROUTERS_AVAILABLE?(LV.error("a content router, such as a DHT, must be provided in order to advertise the relay service",rb),await this.stop()):LV.error(rb)}}}var BV=n(4840);n(7323),n(8410);const MV=fa.pki,UV=(e,t)=>{const n=MV.rsa.setPublicKey(t.n,t.e),r=MV.createCertificate();r.publicKey=n,r.serialNumber="01",r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.validity.notAfter.setFullYear(r.validity.notBefore.getFullYear()+10);const s=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:e.id}];return r.setSubject(s),r.setIssuer(s),r.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),r.sign(t),r};async function FV(e,t){const n=e.map(t),r=await Promise.all(n),s=r.findIndex((e=>e));return e[s]}const jV=x("libp2p:keychain:cms"),VV=new WeakMap;class zV{constructor(e,t){if(null==e)throw B(new Error("keychain is required"),tj.ERR_KEYCHAIN_REQUIRED);this.keychain=e,VV.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw B(new Error("Plain data must be a Uint8Array"),tj.ERR_INVALID_PARAMETERS);const n=await this.keychain.findKeyByName(e),r=await this.keychain.getPrivateKey(e),s=VV.get(this);if(null==s)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const i=s.dek,o=fa.pki.decryptRsaPrivateKey(r,i),a=await UV(n,o),c=fa.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=fa.util.createBuffer(t),c.encrypt();const l=fa.asn1.toDer(c.toAsn1()).getBytes();return An(l,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw B(new Error("CMS data is required"),tj.ERR_INVALID_PARAMETERS);let t;try{const n=fa.util.createBuffer(Fn(e,"ascii")),r=fa.asn1.fromDer(n);t=fa.pkcs7.messageFromAsn1(r)}catch(rb){throw jV.error(rb),B(new Error("Invalid CMS"),tj.ERR_INVALID_CMS)}const n=t.recipients.filter((e=>e.issuer.find((e=>"O"===e.shortName&&"ipfs"===e.value)))).filter((e=>e.issuer.find((e=>"CN"===e.shortName)))).map((e=>({recipient:e,keyId:e.issuer.find((e=>"CN"===e.shortName)).value}))),r=await FV(n,(async e=>{try{const t=await this.keychain.findKeyById(e.keyId);if(null!=t)return!0}catch(rb){return!1}return!1}));if(null==r){const e=n.map((e=>e.keyId));throw B(new Error(`Decryption needs one of the key(s): ${e.join(", ")}`),tj.ERR_MISSING_KEYS,{missingKeys:e})}const s=await this.keychain.findKeyById(r.keyId);if(null==s)throw B(new Error("No key available to decrypto"),tj.ERR_NO_KEY);const i=await this.keychain.getPrivateKey(s.name),o=VV.get(this);if(null==o)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const a=o.dek,c=fa.pki.decryptRsaPrivateKey(i,a);return t.decrypt(r.recipient,c),An(t.content.getBytes(),"ascii")}}const $V=x("libp2p:keychain"),KV="/pkcs8/",HV="/info/",qV=new WeakMap,WV={minKeyLength:14,minSaltLength:16,minIterationCount:1e3},GV={dek:{keyLength:64,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function YV(e){return null!=e&&("string"===typeof e&&(e===BV(e.trim())&&e.length>0))}async function QV(){const e=200,t=1e3,n=Math.random()*(t-e)+e;await new Promise((e=>setTimeout(e,n)))}function XV(e){return new Bs(KV+e)}function JV(e){return new Bs(HV+e)}class ZV{constructor(e,t){if(this.components=e,this.init=I(GV,t),null!=this.init.pass&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(null!=this.init.dek?.keyLength&&this.init.dek.keyLength<WV.minKeyLength)throw new Error(`dek.keyLength must be least ${WV.minKeyLength} bytes`);if(null!=this.init.dek?.salt?.length&&this.init.dek.salt.length<WV.minSaltLength)throw new Error(`dek.saltLength must be least ${WV.minSaltLength} bytes`);if(null!=this.init.dek?.iterationCount&&this.init.dek.iterationCount<WV.minIterationCount)throw new Error(`dek.iterationCount must be least ${WV.minIterationCount}`);const n=null!=this.init.pass&&null!=this.init.dek?.salt?xO(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";qV.set(this,{dek:n}),this.started=!1}isStarted(){return this.started}async start(){const e=JV("self");await this.components.datastore.has(e)||await this.importPeer("self",this.components.peerId),this.started=!0}stop(){this.started=!1}get cms(){const e=qV.get(this);if(null==e)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const t=e.dek;return new zV(this,t)}static generateOptions(){const e=Object.assign({},GV),t=3*Math.ceil(WV.minSaltLength/3);return e.dek.salt=Fn(Bc(t),"base64"),e}static get options(){return GV}async createKey(e,t,n=2048){if(!YV(e)||"self"===e)throw await QV(),B(new Error("Invalid key name"),tj.ERR_INVALID_KEY_NAME);if("string"!==typeof t)throw await QV(),B(new Error("Invalid key type"),tj.ERR_INVALID_KEY_TYPE);const r=XV(e),s=await this.components.datastore.has(r);if(s)throw await QV(),B(new Error("Key name already exists"),tj.ERR_KEY_ALREADY_EXISTS);switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)throw await QV(),B(new Error("Invalid RSA key size"),tj.ERR_INVALID_KEY_SIZE);break;default:break}let i;try{const s=await Uu(t,n),o=await s.id(),a=qV.get(this);if(null==a)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const c=a.dek,l=await s.export(c);i={name:e,id:o};const u=this.components.datastore.batch();u.put(r,An(l)),u.put(JV(e),An(JSON.stringify(i))),await u.commit()}catch(rb){throw await QV(),rb}return i}async listKeys(){const e={prefix:HV},t=[];for await(const n of this.components.datastore.query(e))t.push(JSON.parse(Fn(n.value)));return t}async findKeyById(e){try{const t=await this.listKeys();return t.find((t=>t.id===e))}catch(rb){throw await QV(),rb}}async findKeyByName(e){if(!YV(e))throw await QV(),B(new Error(`Invalid key name '${e}'`),tj.ERR_INVALID_KEY_NAME);const t=JV(e);try{const e=await this.components.datastore.get(t);return JSON.parse(Fn(e))}catch(rb){throw await QV(),$V.error(rb),B(new Error(`Key '${e}' does not exist.`),tj.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!YV(e)||"self"===e)throw await QV(),B(new Error(`Invalid key name '${e}'`),tj.ERR_INVALID_KEY_NAME);const t=XV(e),n=await this.findKeyByName(e),r=this.components.datastore.batch();return r.delete(t),r.delete(JV(e)),await r.commit(),n}async renameKey(e,t){if(!YV(e)||"self"===e)throw await QV(),B(new Error(`Invalid old key name '${e}'`),tj.ERR_OLD_KEY_NAME_INVALID);if(!YV(t)||"self"===t)throw await QV(),B(new Error(`Invalid new key name '${t}'`),tj.ERR_NEW_KEY_NAME_INVALID);const n=XV(e),r=XV(t),s=JV(e),i=JV(t),o=await this.components.datastore.has(r);if(o)throw await QV(),B(new Error(`Key '${t}' already exists`),tj.ERR_KEY_ALREADY_EXISTS);try{const e=await this.components.datastore.get(n),o=await this.components.datastore.get(s),a=JSON.parse(Fn(o));a.name=t;const c=this.components.datastore.batch();return c.put(r,e),c.put(i,An(JSON.stringify(a))),c.delete(n),c.delete(s),await c.commit(),a}catch(rb){throw await QV(),rb}}async exportKey(e,t){if(!YV(e))throw await QV(),B(new Error(`Invalid key name '${e}'`),tj.ERR_INVALID_KEY_NAME);if(null==t)throw await QV(),B(new Error("Password is required"),tj.ERR_PASSWORD_REQUIRED);const n=XV(e);try{const e=await this.components.datastore.get(n),r=Fn(e),s=qV.get(this);if(null==s)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const i=s.dek,o=await $u(r,i);return await o.export(t)}catch(rb){throw await QV(),rb}}async exportPeerId(e){const t="temporary-password",n=await this.exportKey(e,t),r=await $u(n,t);return await ko(r.public.bytes,r.bytes)}async importKey(e,t,n){if(!YV(e)||"self"===e)throw await QV(),B(new Error(`Invalid key name '${e}'`),tj.ERR_INVALID_KEY_NAME);if(null==t)throw await QV(),B(new Error("PEM encoded key is required"),tj.ERR_PEM_REQUIRED);const r=XV(e),s=await this.components.datastore.has(r);if(s)throw await QV(),B(new Error(`Key '${e}' already exists`),tj.ERR_KEY_ALREADY_EXISTS);let i,o;try{i=await $u(t,n)}catch(rb){throw await QV(),B(new Error("Cannot read the key, most likely the password is wrong"),tj.ERR_CANNOT_READ_KEY)}try{o=await i.id();const e=qV.get(this);if(null==e)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const n=e.dek;t=await i.export(n)}catch(rb){throw await QV(),rb}const a={name:e,id:o},c=this.components.datastore.batch();return c.put(r,An(t)),c.put(JV(e),An(JSON.stringify(a))),await c.commit(),a}async importPeer(e,t){try{if(!YV(e))throw B(new Error(`Invalid key name '${e}'`),tj.ERR_INVALID_KEY_NAME);if(null==t)throw B(new Error("PeerId is required"),tj.ERR_MISSING_PRIVATE_KEY);if(null==t.privateKey)throw B(new Error("PeerId.privKey is required"),tj.ERR_MISSING_PRIVATE_KEY);const n=await Vu(t.privateKey),r=XV(e),s=await this.components.datastore.has(r);if(s)throw await QV(),B(new Error(`Key '${e}' already exists`),tj.ERR_KEY_ALREADY_EXISTS);const i=qV.get(this);if(null==i)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const o=i.dek,a=await n.export(o),c={name:e,id:t.toString()},l=this.components.datastore.batch();return l.put(r,An(a)),l.put(JV(e),An(JSON.stringify(c))),await l.commit(),c}catch(rb){throw await QV(),rb}}async getPrivateKey(e){if(!YV(e))throw await QV(),B(new Error(`Invalid key name '${e}'`),tj.ERR_INVALID_KEY_NAME);try{const t=XV(e),n=await this.components.datastore.get(t);return Fn(n)}catch(rb){throw await QV(),$V.error(rb),B(new Error(`Key '${e}' does not exist.`),tj.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,t){if("string"!==typeof e)throw await QV(),B(new Error(`Invalid old pass type '${typeof e}'`),tj.ERR_INVALID_OLD_PASS_TYPE);if("string"!==typeof t)throw await QV(),B(new Error(`Invalid new pass type '${typeof t}'`),tj.ERR_INVALID_NEW_PASS_TYPE);if(t.length<20)throw await QV(),B(new Error(`Invalid pass length ${t.length}`),tj.ERR_INVALID_PASS_LENGTH);$V("recreating keychain");const n=qV.get(this);if(null==n)throw B(new Error("dek missing"),tj.ERR_INVALID_PARAMETERS);const r=n.dek;this.init.pass=t;const s=null!=t&&null!=this.init.dek?.salt?xO(t,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";qV.set(this,{dek:s});const i=await this.listKeys();for(const o of i){const e=await this.components.datastore.get(XV(o.name)),t=Fn(e),n=await $u(t,r),i=s.toString(),a=await n.export(i),c=this.components.datastore.batch(),l={name:o.name,id:o.id};c.put(XV(o.name),An(a)),c.put(JV(o.name),An(JSON.stringify(l))),await c.commit()}$V("keychain reconstructed")}}async function ez(e){try{const t=await e;return{status:"fulfilled",value:t,isFulfilled:!0,isRejected:!1}}catch(t){return{status:"rejected",reason:t,isFulfilled:!1,isRejected:!0}}}function tz(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nz(e,t,n){tz(e,t),t.set(e,n)}function rz(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function sz(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function iz(e,t,n){var r=sz(e,t,"set");return rz(e,r,n),n}function oz(e,t){return t.get?t.get.call(e):t.value}function az(e,t){var n=sz(e,t,"get");return oz(e,n)}let cz;class lz{constructor(e){Rn(this,"value",void 0),Rn(this,"next",void 0),this.value=e}}var uz=new WeakMap,hz=new WeakMap,dz=new WeakMap;cz=Symbol.iterator;class fz{constructor(){nz(this,uz,{writable:!0,value:void 0}),nz(this,hz,{writable:!0,value:void 0}),nz(this,dz,{writable:!0,value:void 0}),this.clear()}enqueue(e){var t;const n=new lz(e);az(this,uz)?(az(this,hz).next=n,iz(this,hz,n)):(iz(this,uz,n),iz(this,hz,n)),iz(this,dz,(t=az(this,dz),t++,t))}dequeue(){var e;const t=az(this,uz);if(t)return iz(this,uz,az(this,uz).next),iz(this,dz,(e=az(this,dz),e--,e)),t.value}clear(){iz(this,uz,void 0),iz(this,hz,void 0),iz(this,dz,0)}get size(){return az(this,dz)}*[cz](){let e=az(this,uz);while(e)yield e.value,e=e.next}}function pz(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new fz;let n=0;const r=()=>{n--,t.size>0&&t.dequeue()()},s=async(e,t,s)=>{n++;const i=(async()=>e(...s))();t(i);try{await i}catch{}r()},i=(r,i,o)=>{t.enqueue(s.bind(void 0,r,i,o)),(async()=>{await Promise.resolve(),n<e&&t.size>0&&t.dequeue()()})()},o=(e,...t)=>new Promise((n=>{i(e,n,t)}));return Object.defineProperties(o,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),o}async function gz(e,t={}){const{concurrency:n=Number.POSITIVE_INFINITY}=t,r=pz(n);return Promise.all(e.map((e=>e&&"function"===typeof e.then?ez(e):ez("function"===typeof e?r((()=>e())):Promise.resolve(e)))))}class yz extends Map{constructor(e){super();const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function mz(e){const{name:t,metrics:n}=e;let r;return r=null!=n?new yz({name:t,metrics:n}):new Map,r}const wz=x("libp2p:transports");class bz extends iN{constructor(e,t={}){super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=mz({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=t.faultTolerance??KF.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw B(new Error("Transport must have a valid tag"),tj.ERR_INVALID_KEY);if(this.transports.has(t))throw B(new Error("There is already a transport with this tag"),tj.ERR_DUPLICATE_TRANSPORT);wz("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}async start(){const e=this.components.addressManager.getListenAddrs();await this.listen(e),this.started=!0}async stop(){const e=[];for(const[t,n]of this.listeners){wz("closing listeners for %s",t);while(n.length>0){const t=n.pop();null!=t&&e.push(t.close())}}await Promise.all(e),wz("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){const n=this.transportForMultiaddr(e);if(null==n)throw B(new Error(`No transport available for address ${String(e)}`),tj.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...t,upgrader:this.components.upgrader})}catch(rb){throw null==rb.code&&(rb.code=tj.ERR_TRANSPORT_DIAL_FAILED),rb}}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(const t of this.transports.values()){const n=t.filter([e]);if(n.length>0)return t}}async listen(e){if(null==e||0===e.length)return void wz("no addresses were provided for listening, this node is dial only");const t=[];for(const[n,r]of this.transports.entries()){const s=r.filter(e),i=[];for(const e of s){wz("creating listener for %s on %s",n,e);const t=r.createListener({upgrader:this.components.upgrader});let s=this.listeners.get(n);null==s&&(s=[],this.listeners.set(n,s)),s.push(t),t.addEventListener("listening",(()=>{this.dispatchEvent(new aN("listener:listening",{detail:t}))})),t.addEventListener("close",(()=>{this.dispatchEvent(new aN("listener:close",{detail:t}))})),i.push(t.listen(e))}if(0===i.length){t.push(n);continue}const o=await gz(i),a=o.find((e=>e.isFulfilled));if(null==a&&this.faultTolerance!==KF.NO_FATAL)throw B(new Error(`Transport (${n}) could not listen on any available address`),tj.ERR_NO_VALID_ADDRESSES)}if(t.length===this.transports.size){const e=`no valid addresses were provided for transports [${t.join(", ")}]`;if(this.faultTolerance===KF.FATAL_ALL)throw B(new Error(e),tj.ERR_NO_VALID_ADDRESSES);wz(`libp2p in dial mode only: ${e}`)}}async remove(e){wz("removing %s",e);for(const t of this.listeners.get(e)??[])await t.close();this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}const vz="/multistream/1.0.0",_z=1024,Ez=x("libp2p:mss"),Sz=An("\n");function kz(e){const t=new wp(e,Sz);return XO.single(t)}function Iz(e,t,n={}){const r=kz(t);!0===n.writeBytes?e.push(r.subarray()):e.push(r)}function Az(e,t,n={}){const r=new wp;for(const s of t)r.append(kz(s));!0===n.writeBytes?e.push(r.subarray()):e.push(r)}async function Tz(e,t){let n=1;const r={[Symbol.asyncIterator]:()=>r,next:async()=>await e.next(n)};let s=r;null!=t?.signal&&(s=qO(r,t.signal));const i=e=>{n=e},o=await dd(s,nD({onLength:i,maxDataLength:_z}),(async e=>await QS(e)));if(null==o||0===o.length)throw B(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(o.get(o.byteLength-1)!==Sz[0])throw Ez.error("Invalid mss message - missing newline - %s",o.subarray()),B(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.sublist(0,-1)}async function Rz(e,t){const n=await Tz(e,t);return Fn(n.subarray())}const Cz=x("libp2p:mss:select");async function Pz(e,t,n={}){t=Array.isArray(t)?[...t]:[t];const{reader:r,writer:s,rest:i,stream:o}=zj(e),a=t.shift();if(null==a)throw new Error("At least one protocol must be specified");Cz('select: write ["%s", "%s"]',vz,a);const c=An(vz),l=An(a);Az(s,[c,l],n);let u=await Rz(r,n);if(Cz('select: read "%s"',u),u===vz&&(u=await Rz(r,n),Cz('select: read "%s"',u)),u===a)return i(),{stream:o,protocol:a};for(const h of t){Cz('select: write "%s"',h),Iz(s,An(h),n);const e=await Rz(r,n);if(Cz('select: read "%s" for "%s"',e,h),e===h)return i(),{stream:o,protocol:h}}throw i(),B(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}const Nz=x("libp2p:mss:handle");async function Oz(e,t,n){t=Array.isArray(t)?t:[t];const{writer:r,reader:s,rest:i,stream:o}=zj(e);while(1){const e=await Rz(s,n);if(Nz('read "%s"',e),e!==vz){if(t.includes(e))return Iz(r,An(e),n),Nz('respond with "%s" for "%s"',e,e),i(),{stream:o,protocol:e};"ls"!==e?(Iz(r,An("na"),n),Nz('respond with "na" for "%s"',e)):(Iz(r,new wp(...t.map((e=>kz(An(e))))),n),Nz('respond with "%s" for %s',t,e))}else Nz('respond with "%s" for "%s"',vz,e),Iz(r,An(vz),n)}}const Dz=Symbol.for("@libp2p/connection");const Lz=x("libp2p:connection");class xz{constructor(e){const{remoteAddr:t,remotePeer:n,newStream:r,close:s,getStreams:i,stat:o}=e;this.id=`${parseInt(String(1e9*Math.random())).toString(36)}${Date.now()}`,this.remoteAddr=t,this.remotePeer=n,this.stat={...o,status:mj},this._newStream=r,this._close=s,this._getStreams=i,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[Dz](){return!0}get streams(){return this._getStreams()}async newStream(e,t){if(this.stat.status===wj)throw B(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===bj)throw B(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);const n=await this._newStream(e,t);return n.stat.direction="outbound",n}addStream(e){e.stat.direction="inbound"}removeStream(e){}async close(){if(this.stat.status!==bj&&!this._closing){this.stat.status=wj;try{this.streams.forEach((e=>e.close()))}catch(rb){Lz.error(rb)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=bj}}}function Bz(e){return new xz(e)}const Mz=x("libp2p:registrar"),Uz=32,Fz=64;class jz{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this._onConnect=this._onConnect.bind(this),this.components.connectionManager.addEventListener("peer:disconnect",this._onDisconnect),this.components.connectionManager.addEventListener("peer:connect",this._onConnect),this.components.peerStore.addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){return Array.from(new Set([...this.topologies.keys(),...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw B(new Error(`No handler registered for protocol ${e}`),tj.ERR_NO_HANDLER_FOR_PROTOCOL);return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,n){if(this.handlers.has(e))throw B(new Error(`Handler already registered for protocol ${e}`),tj.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const r=I.bind({ignoreUndefined:!0})({maxInboundStreams:Uz,maxOutboundStreams:Fz},n);this.handlers.set(e,{handler:t,options:r}),await this.components.peerStore.protoBook.add(this.components.peerId,[e])}async unhandle(e){const t=Array.isArray(e)?e:[e];t.forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.protoBook.remove(this.components.peerId,t)}async register(e,t){if(!ZP(t))throw Mz.error("topology must be an instance of interfaces/topology"),B(new Error("topology must be an instance of interfaces/topology"),tj.ERR_INVALID_PARAMETERS);const n=`${(1e9*Math.random()).toString(36)}${Date.now()}`;let r=this.topologies.get(e);return null==r&&(r=new Map,this.topologies.set(e,r)),r.set(n,t),await t.setRegistrar(this),n}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.protoBook.get(t.remotePeer).then((e=>{for(const n of e){const e=this.topologies.get(n);if(null!=e)for(const n of e.values())n.onDisconnect(t.remotePeer)}})).catch((e=>{Mz.error(e)}))}_onConnect(e){const t=e.detail;this.components.peerStore.protoBook.get(t.remotePeer).then((e=>{for(const n of e){const e=this.topologies.get(n);if(null!=e)for(const n of e.values())n.onConnect(t.remotePeer,t)}})).catch((e=>{Mz.error(e)}))}_onProtocolChange(e){const{peerId:t,protocols:n,oldProtocols:r}=e.detail,s=r.filter((e=>!n.includes(e))),i=n.filter((e=>!r.includes(e)));for(const o of s){const e=this.topologies.get(o);if(null!=e)for(const n of e.values())n.onDisconnect(t)}for(const o of i){const e=this.topologies.get(o);if(null!=e)for(const n of e.values()){const e=this.components.connectionManager.getConnections(t)[0];null!=e&&n.onConnect(t,e)}}}}const Vz=x("libp2p:upgrader");function zz(e,t){try{const{options:n}=t.getHandler(e);return n.maxInboundStreams}catch(rb){if(rb.code!==tj.ERR_NO_HANDLER_FOR_PROTOCOL)throw rb}return Uz}function $z(e,t){try{const{options:n}=t.getHandler(e);return n.maxOutboundStreams}catch(rb){if(rb.code!==tj.ERR_NO_HANDLER_FOR_PROTOCOL)throw rb}return Fz}function Kz(e,t,n){let r=0;return n.streams.forEach((n=>{n.stat.direction===t&&n.stat.protocol===e&&r++})),r}class Hz extends iN{constructor(e,t){super(),this.components=e,this.connectionEncryption=new Map,t.connectionEncryption.forEach((e=>{this.connectionEncryption.set(e.protocol,e)})),this.muxers=new Map,t.muxers.forEach((e=>{this.muxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=t.inboundUpgradeTimeout}async upgradeInbound(e,t){const n=await this.components.connectionManager.acceptIncomingConnection(e);if(!n)throw B(new Error("connection denied"),tj.ERR_CONNECTION_DENIED);let r,s,i,o,a;const c=new Tn.TimeoutController(this.inboundUpgradeTimeout);try{(0,oj.setMaxListeners)?.(1/0,c.signal)}catch{}try{const n=GO(e,c.signal);if(e.source=n.source,e.sink=n.sink,await this.components.connectionGater.denyInboundConnection(e))throw B(new Error("The multiaddr connection is blocked by gater.acceptConnection"),tj.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(e),Vz("starting the inbound connection upgrade");let l=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(Vz("protecting the inbound connection"),l=await t.protect(e))}try{if(r=l,!0!==t?.skipEncryption){if(({conn:r,remotePeer:s,protocol:a}=await this._encryptInbound(l)),await this.components.connectionGater.denyInboundEncryptedConnection(s,{...l,...r}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),tj.ERR_CONNECTION_INTERCEPTED)}else{const t=e.remoteAddr.getPeerId();if(null==t)throw B(new Error("inbound connection that skipped encryption must have a peer id"),tj.ERR_INVALID_MULTIADDR);const n=_o(t);a="native",s=n}if(i=r,null!=t?.muxerFactory)o=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexInbound({...l,...r},this.muxers);o=e.muxerFactory,i=e.stream}}catch(rb){throw Vz.error("Failed to upgrade inbound connection",rb),rb}if(await this.components.connectionGater.denyInboundUpgradedConnection(s,{...l,...r}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),tj.ERR_CONNECTION_INTERCEPTED);return Vz("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:a,direction:"inbound",maConn:e,upgradedConn:i,muxerFactory:o,remotePeer:s})}finally{this.components.connectionManager.afterUpgradeInbound(),c.clear()}}async upgradeOutbound(e,t){const n=e.remoteAddr.getPeerId();let r,s,i,o,a,c;if(null!=n&&(r=_o(n),await this.components.connectionGater.denyOutboundConnection(r,e)))throw B(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),tj.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(e),Vz("Starting the outbound connection upgrade");let l=e;if(!0!==t?.skipProtection){const t=this.components.connectionProtector;null!=t&&(l=await t.protect(e))}try{if(s=l,!0!==t?.skipEncryption){if(({conn:s,remotePeer:i,protocol:a}=await this._encryptOutbound(l,r)),await this.components.connectionGater.denyOutboundEncryptedConnection(i,{...l,...s}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),tj.ERR_CONNECTION_INTERCEPTED)}else{if(null==r)throw B(new Error("Encryption was skipped but no peer id was passed"),tj.ERR_INVALID_PEER);a="native",i=r}if(o=s,null!=t?.muxerFactory)c=t.muxerFactory;else if(this.muxers.size>0){const e=await this._multiplexOutbound({...l,...s},this.muxers);c=e.muxerFactory,o=e.stream}}catch(rb){throw Vz.error("Failed to upgrade outbound connection",rb),await e.close(rb),rb}if(await this.components.connectionGater.denyOutboundUpgradedConnection(i,{...l,...s}))throw B(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),tj.ERR_CONNECTION_INTERCEPTED);return Vz("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,muxerFactory:c,remotePeer:i})}_createConnection(e){const{cryptoProtocol:t,direction:n,maConn:r,upgradedConn:s,remotePeer:i,muxerFactory:o}=e;let a,c,l;null!=o&&(a=o.createStreamMuxer({direction:n,onIncomingStream:e=>{null!=l&&Promise.resolve().then((async()=>{const t=this.components.registrar.getProtocols(),{stream:r,protocol:s}=await Oz(e,t);if(Vz("%s: incoming stream opened on %s",n,s),null==l)return;const o=zz(s,this.components.registrar),a=Kz(s,"inbound",l);a!==o?(e.source=r.source,e.sink=r.sink,e.stat.protocol=s,this.components.peerStore.protoBook.add(i,[s]).catch((e=>Vz.error(e))),l.addStream(e),this.components.metrics?.trackProtocolStream(e,l),this._onStream({connection:l,stream:e,protocol:s})):e.abort(B(new Error(`Too many inbound protocol streams for protocol "${s}" - limit ${o}`),tj.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS))})).catch((t=>{Vz.error(t),null==e.stat.timeline.close&&e.close()}))},onStreamEnd:e=>{l?.removeStream(e.id)}}),c=async(e,t={})=>{if(null==a)throw B(new Error("Stream is not multiplexed"),tj.ERR_MUXER_UNAVAILABLE);Vz("%s: starting new stream on %s",n,e);const r=await a.newStream();let s;try{if(null==t.signal){Vz("No abort signal was passed while trying to negotiate protocols %s falling back to default timeout",e),s=new Tn.TimeoutController(3e4),t.signal=s.signal;try{(0,oj.setMaxListeners)?.(1/0,s.signal)}catch{}}const{stream:n,protocol:o}=await Pz(r,e,t),a=$z(o,this.components.registrar),c=Kz(o,"outbound",l);if(c===a){const e=B(new Error(`Too many outbound protocol streams for protocol "${o}" - limit ${a}`),tj.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw r.abort(e),e}return this.components.peerStore.protoBook.add(i,[o]).catch((e=>Vz.error(e))),r.source=n.source,r.sink=n.sink,r.stat.protocol=o,this.components.metrics?.trackProtocolStream(r,l),r}catch(rb){if(Vz.error("could not create new stream",rb),null==r.stat.timeline.close&&r.close(),null!=rb.code)throw rb;throw B(rb,tj.ERR_UNSUPPORTED_PROTOCOL)}finally{null!=s&&s.clear()}},Promise.all([a.sink(s.source),s.sink(a.source)]).catch((e=>{Vz.error(e)})));const u=r.timeline;r.timeline=new Proxy(u,{set:(...e)=>(null!=l&&"close"===e[1]&&null!=e[2]&&null==u.close&&(async()=>{try{"OPEN"===l.stat.status&&await l.close()}catch(rb){Vz.error(rb)}finally{this.dispatchEvent(new aN("connectionEnd",{detail:l}))}})().catch((e=>{Vz.error(e)})),Reflect.set(...e))}),r.timeline.upgraded=Date.now();const h=()=>{throw B(new Error("connection is not multiplexed"),tj.ERR_CONNECTION_NOT_MULTIPLEXED)};return l=Bz({remoteAddr:r.remoteAddr,remotePeer:i,stat:{status:"OPEN",direction:n,timeline:r.timeline,multiplexer:a?.protocol,encryption:t},newStream:c??h,getStreams:()=>null!=a?a.streams:h(),close:async()=>{await r.close(),null!=a&&a.close()}}),this.dispatchEvent(new aN("connection",{detail:l})),l}_onStream(e){const{connection:t,stream:n,protocol:r}=e,{handler:s}=this.components.registrar.getHandler(r);s({connection:t,stream:n})}async _encryptInbound(e){const t=Array.from(this.connectionEncryption.keys());Vz("handling inbound crypto protocol selection",t);try{const{stream:n,protocol:r}=await Oz(e,t,{writeBytes:!0}),s=this.connectionEncryption.get(r);if(null==s)throw new Error(`no crypto module found for ${r}`);return Vz("encrypting inbound connection..."),{...await s.secureInbound(this.components.peerId,n),protocol:r}}catch(rb){throw B(rb,tj.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t){const n=Array.from(this.connectionEncryption.keys());Vz("selecting outbound crypto protocol",n);try{const{stream:r,protocol:s}=await Pz(e,n,{writeBytes:!0}),i=this.connectionEncryption.get(s);if(null==i)throw new Error(`no crypto module found for ${s}`);return Vz("encrypting outbound connection to %p",t),{...await i.secureOutbound(this.components.peerId,r,t),protocol:s}}catch(rb){throw B(rb,tj.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){const n=Array.from(t.keys());Vz("outbound selecting muxer %s",n);try{const{stream:r,protocol:s}=await Pz(e,n,{writeBytes:!0});Vz("%s selected as muxer protocol",s);const i=t.get(s);return{stream:r,muxerFactory:i}}catch(rb){throw Vz.error("error multiplexing outbound stream",rb),B(rb,tj.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){const n=Array.from(t.keys());Vz("inbound handling muxers %s",n);try{const{stream:r,protocol:s}=await Oz(e,n,{writeBytes:!0}),i=t.get(s);return{stream:r,muxerFactory:i}}catch(rb){throw Vz.error("error multiplexing inbound stream",rb),B(rb,tj.ERR_MUXER_UNAVAILABLE)}}}var qz;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={listenAddrs:[],protocols:[]},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 5:n.protocolVersion=e.string();break;case 6:n.agentVersion=e.string();break;case 1:n.publicKey=e.bytes();break;case 2:n.listenAddrs.push(e.bytes());break;case 4:n.observedAddr=e.bytes();break;case 3:n.protocols.push(e.string());break;case 8:n.signedPeerRecord=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(qz||(qz={}));const Wz="0.0.0",Gz="libp2p",Yz=`js-libp2p/${Wz}`,Qz="0.1.0",Xz="id",Jz="id/push",Zz="1.0.0",e$="1.0.0",t$=x("libp2p:identify"),n$=8192;class r${constructor(e,t){this.components=e,this.started=!1,this.init=t,this.identifyProtocolStr=`/${t.protocolPrefix}/${Xz}/${Zz}`,this.identifyPushProtocolStr=`/${t.protocolPrefix}/${Jz}/${e$}`,this.host={protocolVersion:`${t.protocolPrefix}/${Qz}`,...t.host},this.components.connectionManager.addEventListener("peer:connect",(e=>{const t=e.detail;this.identify(t).catch(t$.error)})),this.components.peerStore.addEventListener("change:multiaddrs",(e=>{const{peerId:t}=e.detail;this.components.peerId.equals(t)&&this.pushToPeerStore().catch((e=>t$.error(e)))})),this.components.peerStore.addEventListener("change:protocols",(e=>{const{peerId:t}=e.detail;this.components.peerId.equals(t)&&this.pushToPeerStore().catch((e=>t$.error(e)))}))}isStarted(){return this.started}async start(){this.started||(await this.components.peerStore.metadataBook.setValue(this.components.peerId,"AgentVersion",An(this.host.agentVersion)),await this.components.peerStore.metadataBook.setValue(this.components.peerId,"ProtocolVersion",An(this.host.protocolVersion)),await this.components.registrar.handle(this.identifyProtocolStr,(e=>{this._handleIdentify(e).catch((e=>{t$.error(e)}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),await this.components.registrar.handle(this.identifyPushProtocolStr,(e=>{this._handlePush(e).catch((e=>{t$.error(e)}))}),{maxInboundStreams:this.init.maxPushIncomingStreams,maxOutboundStreams:this.init.maxPushOutgoingStreams}),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.identifyProtocolStr),await this.components.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async push(e){const t=await this.components.peerStore.addressBook.getRawEnvelope(this.components.peerId),n=this.components.addressManager.getAddresses().map((e=>e.bytes)),r=await this.components.peerStore.protoBook.get(this.components.peerId),s=e.map((async e=>{let s;const i=new Tn.TimeoutController(this.init.timeout);try{(0,oj.setMaxListeners)?.(1/0,i.signal)}catch{}try{s=await e.newStream([this.identifyPushProtocolStr],{signal:i.signal});const o=GO(s,i.signal);await o.sink(dd([qz.encode({listenAddrs:n,signedPeerRecord:t,protocols:r})],XO()))}catch(rb){t$.error("could not push identify update to peer",rb)}finally{null!=s&&s.close(),i.clear()}}));await Promise.all(s)}async pushToPeerStore(){if(!this.isStarted())return;const e=[];for(const t of this.components.connectionManager.getConnections()){const n=t.remotePeer,r=await this.components.peerStore.get(n);r.protocols.includes(this.identifyPushProtocolStr)&&e.push(t)}await this.push(e)}async _identify(e,t={}){let n,r,s=t.signal;if(null==s){n=new Tn.TimeoutController(this.init.timeout),s=n.signal;try{(0,oj.setMaxListeners)?.(1/0,n.signal)}catch{}}try{r=await e.newStream([this.identifyProtocolStr],{signal:s});const t=GO(r,s),i=await dd([],t,nD({maxDataLength:this.init.maxIdentifyMessageSize??n$}),(async e=>await QS(e)));if(null==i)throw B(new Error("No data could be retrieved"),tj.ERR_CONNECTION_ENDED);try{return qz.decode(i)}catch(rb){throw B(rb,tj.ERR_INVALID_MESSAGE)}}finally{null!=n&&n.clear(),null!=r&&r.close()}}async identify(e,t={}){const n=await this._identify(e,t),{publicKey:r,listenAddrs:s,protocols:i,observedAddr:o,signedPeerRecord:a,agentVersion:c,protocolVersion:l}=n;if(null==r)throw B(new Error("public key was missing from identify message"),tj.ERR_MISSING_PUBLIC_KEY);const u=await ko(r);if(!e.remotePeer.equals(u))throw B(new Error("identified peer does not match the expected peer"),tj.ERR_INVALID_PEER);if(this.components.peerId.equals(u))throw B(new Error("identified peer is our own peer id?"),tj.ERR_INVALID_PEER);const h=r$.getCleanMultiaddr(o);if(null!=a){t$("received signed peer record from %p",u);try{const e=await HP.openAndCertify(a,XP.DOMAIN);if(!e.peerId.equals(u))throw B(new Error("identified peer does not match the expected peer"),tj.ERR_INVALID_PEER);if(await this.components.peerStore.addressBook.consumePeerRecord(e))return await this.components.peerStore.protoBook.set(u,i),null!=c&&await this.components.peerStore.metadataBook.setValue(u,"AgentVersion",An(c)),null!=l&&await this.components.peerStore.metadataBook.setValue(u,"ProtocolVersion",An(l)),void t$("identify completed for peer %p and protocols %o",u,i)}catch(rb){t$("received invalid envelope, discard it and fallback to listenAddrs is available",rb)}}else t$("no signed peer record received from %p",u);t$("falling back to legacy addresses from %p",u);try{await this.components.peerStore.addressBook.set(u,s.map((e=>Hr(e))))}catch(rb){t$.error("received invalid addrs",rb)}await this.components.peerStore.protoBook.set(u,i),null!=c&&await this.components.peerStore.metadataBook.setValue(u,"AgentVersion",An(c)),null!=l&&await this.components.peerStore.metadataBook.setValue(u,"ProtocolVersion",An(l)),t$("identify completed for peer %p and protocols %o",u,i),t$("received observed address of %s",h?.toString())}async _handleIdentify(e){const{connection:t,stream:n}=e,r=new Tn.TimeoutController(this.init.timeout);try{(0,oj.setMaxListeners)?.(1/0,r.signal)}catch{}try{const e=this.components.peerId.publicKey??new Uint8Array(0),s=await this.components.peerStore.get(this.components.peerId),i=this.components.addressManager.getAddresses().map((e=>e.decapsulateCode(Yn("p2p").code)));let o=s.peerRecordEnvelope;if(i.length>0&&null==o){const e=new XP({peerId:this.components.peerId,multiaddrs:i}),t=await HP.seal(e,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(t),o=t.marshal().subarray()}const a=qz.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:e,listenAddrs:i.map((e=>e.bytes)),signedPeerRecord:o,observedAddr:t.remoteAddr.bytes,protocols:s.protocols}),c=GO(n,r.signal),l=dd([a],XO());await c.sink(l)}catch(rb){t$.error("could not respond to identify request",rb)}finally{n.close(),r.clear()}}async _handlePush(e){const{connection:t,stream:n}=e,r=new Tn.TimeoutController(this.init.timeout);try{(0,oj.setMaxListeners)?.(1/0,r.signal)}catch{}let s;try{const e=GO(n,r.signal),t=await dd([],e,nD({maxDataLength:this.init.maxIdentifyMessageSize??n$}),(async e=>await QS(e)));null!=t&&(s=qz.decode(t))}catch(rb){return t$.error("received invalid message",rb)}finally{n.close(),r.clear()}if(null==s)return t$.error("received invalid message");const i=t.remotePeer;if(this.components.peerId.equals(i))t$("received push from ourselves?");else{if(t$("received push from %p",i),null!=s.signedPeerRecord){t$("received signedPeerRecord in push");try{const e=await HP.openAndCertify(s.signedPeerRecord,XP.DOMAIN);if(await this.components.peerStore.addressBook.consumePeerRecord(e))return t$("consumed signedPeerRecord sent in push"),void await this.components.peerStore.protoBook.set(i,s.protocols);t$("failed to consume signedPeerRecord sent in push")}catch(rb){t$("received invalid envelope, discard it and fallback to listenAddrs is available",rb)}}else t$("did not receive signedPeerRecord in push");try{await this.components.peerStore.addressBook.set(i,s.listenAddrs.map((e=>Hr(e))))}catch(rb){t$.error("received invalid addrs",rb)}try{await this.components.peerStore.protoBook.set(i,s.protocols)}catch(rb){t$.error("received invalid protocols",rb)}t$("handled push from %p",i)}}static getCleanMultiaddr(e){if(null!=e&&e.length>0)try{return Hr(e)}catch{}}}var s$,i$;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),!0!==n.writeDefaults&&""===e.identifier||(t.uint32(10),t.string(e.identifier)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identifier:""},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.identifier=e.string();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(s$||(s$={})),function(e){let t,n,r;(function(e){e["OK"]="OK",e["NOT_FOUND"]="NOT_FOUND",e["ERROR"]="ERROR"})(t=e.StatusCode||(e.StatusCode={})),function(e){e[e["OK"]=0]="OK",e[e["NOT_FOUND"]=1]="NOT_FOUND",e[e["ERROR"]=2]="ERROR"}(n||(n={})),function(e){e.codec=()=>ha(n)}(t=e.StatusCode||(e.StatusCode={})),e.codec=()=>(null==r&&(r=da(((t,r,s={})=>{!1!==s.lengthDelimited&&r.fork(),(!0===s.writeDefaults||null!=t.status&&0!==n[t.status])&&(r.uint32(8),e.StatusCode.codec().encode(t.status,r)),(!0===s.writeDefaults||null!=t.data&&t.data.byteLength>0)&&(r.uint32(18),r.bytes(t.data)),!1!==s.lengthDelimited&&r.ldelim()}),((n,r)=>{const s={status:t.OK,data:new Uint8Array(0)},i=null==r?n.len:n.pos+r;while(n.pos<i){const t=n.uint32();switch(t>>>3){case 1:s.status=e.StatusCode.codec().decode(n);break;case 2:s.data=n.bytes();break;default:n.skipType(7&t);break}}return s}))),r),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(i$||(i$={}));const o$="0.0.1",a$="fetch",c$=x("libp2p:fetch");class l${constructor(e,t){this.started=!1,this.components=e,this.protocol=`/${t.protocolPrefix??"libp2p"}/${a$}/${o$}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this),this.init=t}async start(){await this.components.registrar.handle(this.protocol,(e=>{this.handleMessage(e).catch((e=>{c$.error(e)})).finally((()=>{e.stream.close()}))}),{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(e,t,n={}){c$("dialing %s to %p",this.protocol,e);const r=await this.components.connectionManager.openConnection(e,n);let s,i,o=n.signal;if(null==o){c$("using default timeout of %d ms",this.init.timeout),s=new Tn.TimeoutController(this.init.timeout),o=s.signal;try{(0,oj.setMaxListeners)?.(1/0,s.signal)}catch{}}try{i=await r.newStream(this.protocol,{signal:o});const e=GO(i,o);c$("fetch %s",t);const n=await dd([s$.encode({identifier:t})],XO(),e,nD(),(async function(e){const n=await QS(e);if(null==n)throw B(new Error("No data received"),tj.ERR_INVALID_MESSAGE);const r=i$.decode(n);switch(r.status){case i$.StatusCode.OK:return c$("received status for %s ok",t),r.data;case i$.StatusCode.NOT_FOUND:return c$("received status for %s not found",t),null;case i$.StatusCode.ERROR:{c$("received status for %s error",t);const e=Fn(r.data);throw B(new Error("Error in fetch protocol response: "+e),tj.ERR_INVALID_PARAMETERS)}default:throw c$("received status for %s unknown",t),B(new Error("Unknown response status"),tj.ERR_INVALID_MESSAGE)}}));return n??null}finally{null!=s&&s.clear(),null!=i&&i.close()}}async handleMessage(e){const{stream:t}=e,n=this;await dd(t,nD(),(async function*(e){const t=await QS(e);if(null==t)throw B(new Error("No data received"),tj.ERR_INVALID_MESSAGE);const r=s$.decode(t);let s;const i=n._getLookupFunction(r.identifier);if(null!=i){c$("look up data with identifier %s",r.identifier);const e=await i(r.identifier);null!=e?(c$("sending status for %s ok",r.identifier),s={status:i$.StatusCode.OK,data:e}):(c$("sending status for %s not found",r.identifier),s={status:i$.StatusCode.NOT_FOUND,data:new Uint8Array(0)})}else{c$("sending status for %s error",r.identifier);const e=An(`No lookup function registered for key: ${r.identifier}`);s={status:i$.StatusCode.ERROR,data:e}}yield i$.encode(s)}),XO(),t)}_getLookupFunction(e){for(const t of this.lookupFunctions.keys())if(e.startsWith(t))return this.lookupFunctions.get(t)}registerLookupFunction(e,t){if(this.lookupFunctions.has(e))throw B(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),tj.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,t)}unregisterLookupFunction(e,t){if(null!=t){const n=this.lookupFunctions.get(e);if(n!==t)return}this.lookupFunctions.delete(e)}}const u$=32,h$="1.0.0",d$="ping",f$=x("libp2p:ping");class p${constructor(e,t){this.components=e,this.started=!1,this.protocol=`/${t.protocolPrefix}/${d$}/${h$}`,this.init=t}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.init.maxInboundStreams,maxOutboundStreams:this.init.maxOutboundStreams}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){const{stream:t}=e;dd(t,t).catch((e=>{f$.error(e)}))}async ping(e,t={}){f$("dialing %s to %p",this.protocol,e);const n=Date.now(),r=Bc(u$),s=await this.components.connectionManager.openConnection(e,t);let i,o,a=t.signal;if(null==a){i=new Tn.TimeoutController(this.init.timeout),a=i.signal;try{(0,oj.setMaxListeners)?.(1/0,i.signal)}catch{}}try{o=await s.newStream([this.protocol],{signal:a});const e=GO(o,a),t=await dd([r],e,(async e=>await QS(e))),c=Date.now();if(null==t||!Pr(r,t.subarray()))throw B(new Error("Received wrong ping ack"),tj.ERR_WRONG_PING_ACK);return c-n}finally{null!=i&&i.clear(),null!=o&&o.close()}}}async function g$(){throw new Error("Not supported in browsers")}var y$=n(4024);const m$="object"===typeof window&&"object"===typeof document&&9===document.nodeType,w$=y$(),b$=m$&&!w$,v$=w$&&!m$,_$=w$&&m$,E$="undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.release&&"node"===globalThis.process.release.name&&!w$,S$="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,k$=("undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.env&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"],"undefined"!==typeof navigator&&"ReactNative"===navigator.product);function I$(e){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^::1$/.test(e)}function A$(e){const{address:t}=e.nodeAddress();return I$(t)}const T$=x("libp2p:nat"),R$=7200;function C$(e=1024,t=65535){return Math.floor(Math.random()*(t-e+1)+e)}class P${constructor(e,t){if(this.components=e,this.started=!1,this.enabled=t.enabled,this.externalAddress=t.externalAddress,this.localAddress=t.localAddress,this.description=t.description??`${Gz}@${Wz} ${this.components.peerId.toString()}`,this.ttl=t.ttl??R$,this.keepAlive=t.keepAlive??!0,this.gateway=t.gateway,this.ttl<R$)throw B(new Error(`NatManager ttl should be at least ${R$} seconds`),tj.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){b$||!this.enabled||this.started||(this.started=!0,this._start().catch((e=>{T$.error(e)})))}async _start(){const e=this.components.transportManager.getAddrs();for(const t of e){const{family:e,host:n,port:r,transport:s}=t.toOptions();if(!t.isThinWaistAddress()||"tcp"!==s)continue;if(A$(t))continue;if(4!==e)continue;const i=await this._getClient(),o=this.externalAddress??await i.externalIp(),a=RV(o);if(!0===a)throw new Error(`${o} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);if(null==a)throw new Error(`${o} is not an IP address`);const c=C$();T$(`opening uPnP connection from ${o}:${c} to ${n}:${r}`),await i.map({publicPort:c,localPort:r,localAddress:this.localAddress,protocol:"TCP"===s.toUpperCase()?"TCP":"UDP"}),this.components.addressManager.addObservedAddr(Vr({family:4,address:o,port:c},s))}}async _getClient(){return null!=this.client||(this.client=await g$({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway})),this.client}async stop(){if(!b$&&null!=this.client)try{await this.client.close(),this.client=void 0}catch(rb){T$.error(rb)}}}const N$=x("libp2p:peer-record-updater");class O${constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.transportManager.addEventListener("listener:listening",this.update),this.components.transportManager.addEventListener("listener:close",this.update),this.components.addressManager.addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.transportManager.removeEventListener("listener:listening",this.update),this.components.transportManager.removeEventListener("listener:close",this.update),this.components.addressManager.removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then((async()=>{const e=new XP({peerId:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode(Yn("p2p").code)))}),t=await HP.seal(e,this.components.peerId);await this.components.peerStore.addressBook.consumePeerRecord(t)})).catch((e=>{N$.error("Could not update self peer record: %o",e)}))}}class D${constructor(e){this.dht=e}async findPeer(e,t={}){for await(const n of this.dht.findPeer(e,t))if("FINAL_PEER"===n.name)return n.peer;throw B(new Error(ej.NOT_FOUND),tj.ERR_NOT_FOUND)}async*getClosestPeers(e,t={}){for await(const n of this.dht.getClosestPeers(e,t))"FINAL_PEER"===n.name&&(yield n.peer)}}const L$={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"};async function*x$(e,t){for await(const n of e)await t(n),yield n}const B$=x("libp2p:peer-store:address-book"),M$="change:multiaddrs";async function U$(){return!0}class F${constructor(e,t,n){this.dispatchEvent=e,this.store=t,this.addressFilter=n??U$}async consumePeerRecord(e){B$.trace("consumePeerRecord await write lock");const t=await this.store.lock.writeLock();let n,r,s;B$.trace("consumePeerRecord got write lock");try{let i;try{i=XP.createFromProtobuf(e.payload)}catch(rb){return B$.error("invalid peer record received"),!1}n=i.peerId;const o=i.multiaddrs;if(!n.equals(e.peerId))return B$("signing key does not match PeerId in the PeerRecord"),!1;if(null==o||0===o.length)return!1;if(await this.store.has(n)&&(r=await this.store.load(n),null!=r.peerRecordEnvelope)){const e=await HP.createFromProtobuf(r.peerRecordEnvelope),t=XP.createFromProtobuf(e.payload);if(t.seqNumber>=i.seqNumber)return B$("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,i.seqNumber),!1}const a=await j$(n,o,this.addressFilter,!0);s=await this.store.patchOrCreate(n,{addresses:a,peerRecordEnvelope:e.marshal().subarray()}),B$("stored provided peer record for %p",i.peerId)}finally{B$.trace("consumePeerRecord release write lock"),t()}return this.dispatchEvent(new aN(M$,{detail:{peerId:n,multiaddrs:s.addresses.map((({multiaddr:e})=>e)),oldMultiaddrs:null==r?[]:r.addresses.map((({multiaddr:e})=>e))}})),!0}async getRawEnvelope(e){B$.trace("getRawEnvelope await read lock");const t=await this.store.lock.readLock();B$.trace("getRawEnvelope got read lock");try{const n=await this.store.load(e);return n.peerRecordEnvelope}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{B$.trace("getRawEnvelope release read lock"),t()}}async getPeerRecord(e){const t=await this.getRawEnvelope(e);if(null!=t)return await HP.createFromProtobuf(t)}async get(e){e=vo(e),B$.trace("get wait for read lock");const t=await this.store.lock.readLock();B$.trace("get got read lock");try{const n=await this.store.load(e);return n.addresses}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{B$.trace("get release read lock"),t()}return[]}async set(e,t){if(e=vo(e),!Array.isArray(t))throw B$.error("multiaddrs must be an array of Multiaddrs"),B(new Error("multiaddrs must be an array of Multiaddrs"),L$.ERR_INVALID_PARAMETERS);B$.trace("set await write lock");const n=await this.store.lock.writeLock();B$.trace("set got write lock");let r,s,i=!1;try{const o=await j$(e,t,this.addressFilter);if(0===o.length)return;try{if(r=await this.store.load(e),i=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...r.addresses.map((({multiaddr:e})=>e.toString()))]).size===r.addresses.length&&o.length===r.addresses.length)return}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}s=await this.store.patchOrCreate(e,{addresses:o}),B$("set multiaddrs for %p",e)}finally{B$.trace("set multiaddrs for %p",e),B$("set release write lock"),n()}this.dispatchEvent(new aN(M$,{detail:{peerId:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==r?[]:r.addresses.map((({multiaddr:e})=>e))}})),i||this.dispatchEvent(new aN("peer",{detail:{id:e,multiaddrs:s.addresses.map((e=>e.multiaddr)),protocols:s.protocols}}))}async add(e,t){if(e=vo(e),!Array.isArray(t))throw B$.error("multiaddrs must be an array of Multiaddrs"),B(new Error("multiaddrs must be an array of Multiaddrs"),L$.ERR_INVALID_PARAMETERS);B$.trace("add await write lock");const n=await this.store.lock.writeLock();let r,s,i;B$.trace("add got write lock");try{const o=await j$(e,t,this.addressFilter);if(0===o.length)return;try{if(s=await this.store.load(e),r=!0,new Set([...o.map((({multiaddr:e})=>e.toString())),...s.addresses.map((({multiaddr:e})=>e.toString()))]).size===s.addresses.length)return}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}i=await this.store.mergeOrCreate(e,{addresses:o}),B$("added multiaddrs for %p",e)}finally{B$.trace("set release write lock"),n()}this.dispatchEvent(new aN(M$,{detail:{peerId:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),oldMultiaddrs:null==s?[]:s.addresses.map((({multiaddr:e})=>e))}})),!0===r&&this.dispatchEvent(new aN("peer",{detail:{id:e,multiaddrs:i.addresses.map((e=>e.multiaddr)),protocols:i.protocols}}))}async delete(e){e=vo(e),B$.trace("delete await write lock");const t=await this.store.lock.writeLock();let n;B$.trace("delete got write lock");try{try{n=await this.store.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}await this.store.patchOrCreate(e,{addresses:[]})}finally{B$.trace("delete release write lock"),t()}null!=n&&this.dispatchEvent(new aN(M$,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:null==n?[]:n.addresses.map((({multiaddr:e})=>e))}}))}}async function j$(e,t,n,r=!1){return await dd(t,(e=>x$(e,(e=>{if(!$r(e))throw B$.error("multiaddr must be an instance of Multiaddr"),B(new Error("multiaddr must be an instance of Multiaddr"),L$.ERR_INVALID_PARAMETERS)}))),(t=>qh(t,(async t=>await n(e,t)))),(e=>_f(e,(e=>({multiaddr:e,isCertified:r})))),(async e=>await $h(e)))}const V$=x("libp2p:peer-store:key-book"),z$="change:pubkey";class $${constructor(e,t){this.dispatchEvent=e,this.store=t}async set(e,t){if(e=vo(e),!(t instanceof Uint8Array))throw V$.error("publicKey must be an instance of Uint8Array to store data"),B(new Error("publicKey must be an instance of PublicKey"),L$.ERR_INVALID_PARAMETERS);V$.trace("set await write lock");const n=await this.store.lock.writeLock();V$.trace("set got write lock");let r,s=!1;try{try{if(r=await this.store.load(e),null!=r.pubKey&&Pr(r.pubKey,t))return}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}await this.store.patchOrCreate(e,{pubKey:t}),s=!0}finally{V$.trace("set release write lock"),n()}s&&this.dispatchEvent(new aN(z$,{detail:{peerId:e,publicKey:t,oldPublicKey:null==r?void 0:r.pubKey}}))}async get(e){e=vo(e),V$.trace("get await write lock");const t=await this.store.lock.readLock();V$.trace("get got write lock");try{const n=await this.store.load(e);return n.pubKey}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{V$("get release write lock"),t()}}async delete(e){e=vo(e),V$.trace("delete await write lock");const t=await this.store.lock.writeLock();let n;V$.trace("delete got write lock");try{try{n=await this.store.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}await this.store.patchOrCreate(e,{pubKey:void 0})}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{V$.trace("delete release write lock"),t()}this.dispatchEvent(new aN(z$,{detail:{peerId:e,publicKey:void 0,oldPublicKey:null==n?void 0:n.pubKey}}))}}const K$=x("libp2p:peer-store:metadata-book"),H$="change:metadata";class q${constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){e=vo(e),K$.trace("get await read lock");const t=await this.store.lock.readLock();K$.trace("get got read lock");try{const n=await this.store.load(e);return n.metadata}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{K$.trace("get release read lock"),t()}return new Map}async getValue(e,t){e=vo(e),K$.trace("getValue await read lock");const n=await this.store.lock.readLock();K$.trace("getValue got read lock");try{const r=await this.store.load(e);return r.metadata.get(t)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{K$.trace("getValue release write lock"),n()}}async set(e,t){if(e=vo(e),!(t instanceof Map))throw K$.error("valid metadata must be provided to store data"),B(new Error("valid metadata must be provided"),L$.ERR_INVALID_PARAMETERS);K$.trace("set await write lock");const n=await this.store.lock.writeLock();let r;K$.trace("set got write lock");try{try{r=await this.store.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}await this.store.mergeOrCreate(e,{metadata:t})}finally{K$.trace("set release write lock"),n()}this.dispatchEvent(new aN(H$,{detail:{peerId:e,metadata:t,oldMetadata:null==r?new Map:r.metadata}}))}async setValue(e,t,n){if(e=vo(e),"string"!==typeof t||!(n instanceof Uint8Array))throw K$.error("valid key and value must be provided to store data"),B(new Error("valid key and value must be provided"),L$.ERR_INVALID_PARAMETERS);K$.trace("setValue await write lock");const r=await this.store.lock.writeLock();let s,i;K$.trace("setValue got write lock");try{try{s=await this.store.load(e);const r=s.metadata.get(t);if(null!=r&&Pr(n,r))return}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}i=await this.store.mergeOrCreate(e,{metadata:new Map([[t,n]])})}finally{K$.trace("setValue release write lock"),r()}this.dispatchEvent(new aN(H$,{detail:{peerId:e,metadata:i.metadata,oldMetadata:null==s?new Map:s.metadata}}))}async delete(e){e=vo(e),K$.trace("delete await write lock");const t=await this.store.lock.writeLock();let n;K$.trace("delete got write lock");try{try{n=await this.store.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}null!=n&&await this.store.patch(e,{metadata:new Map})}finally{K$.trace("delete release write lock"),t()}null!=n&&this.dispatchEvent(new aN(H$,{detail:{peerId:e,metadata:new Map,oldMetadata:n.metadata}}))}async deleteValue(e,t){e=vo(e),K$.trace("deleteValue await write lock");const n=await this.store.lock.writeLock();let r,s;K$.trace("deleteValue got write lock");try{s=await this.store.load(e),r=s.metadata,r.delete(t),await this.store.patch(e,{metadata:r})}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{K$.trace("deleteValue release write lock"),n()}null!=r&&this.dispatchEvent(new aN(H$,{detail:{peerId:e,metadata:r,oldMetadata:null==s?new Map:s.metadata}}))}}const W$=x("libp2p:peer-store:proto-book"),G$="change:protocols";class Y${constructor(e,t){this.dispatchEvent=e,this.store=t}async get(e){W$.trace("get wait for read lock");const t=await this.store.lock.readLock();W$.trace("get got read lock");try{const n=await this.store.load(e);return n.protocols}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}finally{W$.trace("get release read lock"),t()}return[]}async set(e,t){if(e=vo(e),!Array.isArray(t))throw W$.error("protocols must be provided to store data"),B(new Error("protocols must be provided"),L$.ERR_INVALID_PARAMETERS);W$.trace("set await write lock");const n=await this.store.lock.writeLock();let r,s;W$.trace("set got write lock");try{try{if(r=await this.store.load(e),new Set([...t]).size===r.protocols.length)return}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}s=await this.store.patchOrCreate(e,{protocols:t}),W$("stored provided protocols for %p",e)}finally{W$.trace("set release write lock"),n()}this.dispatchEvent(new aN(G$,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==r?[]:r.protocols}}))}async add(e,t){if(e=vo(e),!Array.isArray(t))throw W$.error("protocols must be provided to store data"),B(new Error("protocols must be provided"),L$.ERR_INVALID_PARAMETERS);W$.trace("add await write lock");const n=await this.store.lock.writeLock();let r,s;W$.trace("add got write lock");try{try{if(r=await this.store.load(e),new Set([...r.protocols,...t]).size===r.protocols.length)return}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}s=await this.store.mergeOrCreate(e,{protocols:t}),W$("added provided protocols for %p",e)}finally{W$.trace("add release write lock"),n()}this.dispatchEvent(new aN(G$,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==r?[]:r.protocols}}))}async remove(e,t){if(e=vo(e),!Array.isArray(t))throw W$.error("protocols must be provided to store data"),B(new Error("protocols must be provided"),L$.ERR_INVALID_PARAMETERS);W$.trace("remove await write lock");const n=await this.store.lock.writeLock();let r,s;W$.trace("remove got write lock");try{try{r=await this.store.load(e);const n=new Set(r.protocols);for(const e of t)n.delete(e);if(r.protocols.length===n.size)return;t=Array.from(n)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}s=await this.store.patchOrCreate(e,{protocols:t})}finally{W$.trace("remove release write lock"),n()}this.dispatchEvent(new aN(G$,{detail:{peerId:e,protocols:s.protocols,oldProtocols:null==r?[]:r.protocols}}))}async delete(e){e=vo(e),W$.trace("delete await write lock");const t=await this.store.lock.writeLock();let n;W$.trace("delete got write lock");try{try{n=await this.store.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb}await this.store.patchOrCreate(e,{protocols:[]})}finally{W$.trace("delete release write lock"),t()}null!=n&&this.dispatchEvent(new aN(G$,{detail:{peerId:e,protocols:[],oldProtocols:n.protocols}}))}}var Q$,X$,J$;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.addresses)for(const r of e.addresses)t.uint32(10),X$.codec().encode(r,t,{writeDefaults:!0});if(null!=e.protocols)for(const r of e.protocols)t.uint32(18),t.string(r);if(null!=e.metadata)for(const r of e.metadata)t.uint32(26),J$.codec().encode(r,t,{writeDefaults:!0});null!=e.pubKey&&(t.uint32(34),t.bytes(e.pubKey)),null!=e.peerRecordEnvelope&&(t.uint32(42),t.bytes(e.peerRecordEnvelope)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={addresses:[],protocols:[],metadata:[]},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.addresses.push(X$.codec().decode(e,e.uint32()));break;case 2:n.protocols.push(e.string());break;case 3:n.metadata.push(J$.codec().decode(e,e.uint32()));break;case 4:n.pubKey=e.bytes();break;case 5:n.peerRecordEnvelope=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(Q$||(Q$={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.multiaddr&&e.multiaddr.byteLength>0)&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={multiaddr:new Uint8Array(0)},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(X$||(X$={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),!0!==n.writeDefaults&&""===e.key||(t.uint32(10),t.string(e.key)),(!0===n.writeDefaults||null!=e.value&&e.value.byteLength>0)&&(t.uint32(18),t.bytes(e.value)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={key:"",value:new Uint8Array(0)},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(J$||(J$={}));const Z$=x("libp2p:peer-store:store"),eK="/peers/";class tK{constructor(e){this.components=e,this.lock=Wk({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(e){if(null==e.type)throw Z$.error("peerId must be an instance of peer-id to store data"),B(new Error("peerId must be an instance of peer-id"),L$.ERR_INVALID_PARAMETERS);const t=e.toCID().toString();return new Bs(`${eK}${t}`)}async has(e){return await this.components.datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this.components.datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){const t=await this.components.datastore.get(this._peerIdToDatastoreKey(e)),n=Q$.decode(t),r=new Map;for(const s of n.metadata)r.set(s.key,s.value);return{...n,id:e,addresses:n.addresses.map((({multiaddr:e,isCertified:t})=>({multiaddr:Hr(e),isCertified:t??!1}))),metadata:r,pubKey:n.pubKey??void 0,peerRecordEnvelope:n.peerRecordEnvelope??void 0}}async save(e){if(null!=e.pubKey&&null!=e.id.publicKey&&!Pr(e.pubKey,e.id.publicKey))throw Z$.error("peer publicKey bytes do not match peer id publicKey bytes"),B(new Error("publicKey bytes do not match peer id publicKey bytes"),L$.ERR_INVALID_PARAMETERS);const t=new Set,n=e.addresses.filter((e=>!t.has(e.multiaddr.toString())&&(t.add(e.multiaddr.toString()),!0))).sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((({multiaddr:e,isCertified:t})=>({multiaddr:e.bytes,isCertified:t}))),r=[];[...e.metadata.keys()].sort().forEach((t=>{const n=e.metadata.get(t);null!=n&&r.push({key:t,value:n})}));const s=Q$.encode({addresses:n,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:r,peerRecordEnvelope:e.peerRecordEnvelope});return await this.components.datastore.put(this._peerIdToDatastoreKey(e.id),s.subarray()),await this.load(e.id)}async patch(e,t){const n=await this.load(e);return await this._patch(e,t,n)}async patchOrCreate(e,t){let n;try{n=await this.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,t,n)}async _patch(e,t,n){return await this.save({...n,...t,id:e})}async merge(e,t){const n=await this.load(e);return await this._merge(e,t,n)}async mergeOrCreate(e,t){let n;try{n=await this.load(e)}catch(rb){if(rb.code!==L$.ERR_NOT_FOUND)throw rb;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,t,n)}async _merge(e,t,n){const r=new Map;return n.addresses.forEach((e=>{r.set(e.multiaddr.toString(),e.isCertified)})),(t.addresses??[]).forEach((e=>{const t=e.multiaddr.toString(),n=Boolean(r.get(t)),s=n||e.isCertified;r.set(t,s)})),await this.save({id:e,addresses:Array.from(r.entries()).map((([e,t])=>({multiaddr:Hr(e),isCertified:t}))),protocols:Array.from(new Set([...n.protocols??[],...t.protocols??[]])),metadata:new Map([...n.metadata?.entries()??[],...t.metadata?.entries()??[]]),pubKey:t.pubKey??(null!=n?n.pubKey:void 0),peerRecordEnvelope:t.peerRecordEnvelope??(null!=n?n.peerRecordEnvelope:void 0)})}async*all(){for await(const e of this.components.datastore.queryKeys({prefix:eK})){const t=e.toString().split("/")[2],n=C.base32.decode(t);yield this.load(Eo(n))}}}var nK,rK;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.tags)for(const r of e.tags)t.uint32(10),rK.codec().encode(r,t,{writeDefaults:!0});!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={tags:[]},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.tags.push(rK.codec().decode(e,e.uint32()));break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(nK||(nK={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),!0!==n.writeDefaults&&""===e.name||(t.uint32(10),t.string(e.name)),null!=e.value&&(t.uint32(16),t.uint32(e.value)),null!=e.expiry&&(t.uint32(24),t.uint64(e.expiry)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={name:""},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.value=e.uint32();break;case 3:n.expiry=e.uint64();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(rK||(rK={}));const sK=x("libp2p:peer-store");class iK extends iN{constructor(e,t={}){super(),this.components=e,this.store=new tK(e),this.addressBook=new F$(this.dispatchEvent.bind(this),this.store,t.addressFilter),this.keyBook=new $$(this.dispatchEvent.bind(this),this.store),this.metadataBook=new q$(this.dispatchEvent.bind(this),this.store),this.protoBook=new Y$(this.dispatchEvent.bind(this),this.store)}async forEach(e){sK.trace("getPeers await read lock");const t=await this.store.lock.readLock();sK.trace("getPeers got read lock");try{for await(const t of this.store.all())t.id.equals(this.components.peerId)||e(t)}finally{sK.trace("getPeers release read lock"),t()}}async all(){const e=[];return await this.forEach((t=>{e.push(t)})),e}async delete(e){sK.trace("delete await write lock");const t=await this.store.lock.writeLock();sK.trace("delete got write lock");try{await this.store.delete(e)}finally{sK.trace("delete release write lock"),t()}}async get(e){sK.trace("get await read lock");const t=await this.store.lock.readLock();sK.trace("get got read lock");try{return await this.store.load(e)}finally{sK.trace("get release read lock"),t()}}async has(e){sK.trace("has await read lock");const t=await this.store.lock.readLock();sK.trace("has got read lock");try{return await this.store.has(e)}finally{sK.trace("has release read lock"),t()}}async tagPeer(e,t,n={}){const r=n.value??0,s=Math.round(r),i=n.ttl??void 0;if(s!==r||s<0||s>100)throw B(new Error("Tag value must be between 0-100"),"ERR_TAG_VALUE_OUT_OF_BOUNDS");const o=await this.metadataBook.getValue(e,"tags");let a=[];null!=o&&(a=nK.decode(o).tags);for(const c of a)if(c.name===t)throw B(new Error("Peer already tagged"),"ERR_DUPLICATE_TAG");a.push({name:t,value:s,expiry:null==i?void 0:BigInt(Date.now()+i)}),await this.metadataBook.setValue(e,"tags",nK.encode({tags:a}).subarray())}async unTagPeer(e,t){const n=await this.metadataBook.getValue(e,"tags");let r=[];null!=n&&(r=nK.decode(n).tags),r=r.filter((e=>e.name!==t)),await this.metadataBook.setValue(e,"tags",nK.encode({tags:r}).subarray())}async getTags(e){const t=await this.metadataBook.getValue(e,"tags");let n=[];null!=t&&(n=nK.decode(t).tags);const r=BigInt(Date.now()),s=n.filter((e=>null==e.expiry||e.expiry>r));return s.length!==n.length&&await this.metadataBook.setValue(e,"tags",nK.encode({tags:s}).subarray()),s.map((e=>({name:e.name,value:e.value??0})))}}class oK{constructor(e){this.dht=e}async provide(e){await Hh(this.dht.provide(e))}async*findProviders(e,t={}){for await(const n of this.dht.findProviders(e,t))"PROVIDER"===n.name&&(yield*n.providers)}async put(e,t,n){await Hh(this.dht.put(e,t,n))}async get(e,t){for await(const n of this.dht.get(e,t))if("VALUE"===n.name)return n.value;throw B(new Error("Not found"),"ERR_NOT_FOUND")}}class aK{constructor(e={}){this._started=!1,this._peerId=e.peerId,this._addressManager=e.addressManager,this._peerStore=e.peerStore,this._upgrader=e.upgrader,this._metrics=e.metrics,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._connectionGater=e.connectionGater,this._contentRouting=e.contentRouting,this._peerRouting=e.peerRouting,this._datastore=e.datastore,this._connectionProtector=e.connectionProtector,this._dht=e.dht,this._pubsub=e.pubsub,this._dialer=e.dialer}isStarted(){return this._started}async beforeStart(){await Promise.all(Object.values(this).filter((e=>ZF(e))).map((async e=>{null!=e.beforeStart&&await e.beforeStart()})))}async start(){await Promise.all(Object.values(this).filter((e=>ZF(e))).map((async e=>{await e.start()}))),this._started=!0}async afterStart(){await Promise.all(Object.values(this).filter((e=>ZF(e))).map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async beforeStop(){await Promise.all(Object.values(this).filter((e=>ZF(e))).map((async e=>{null!=e.beforeStop&&await e.beforeStop()})))}async stop(){await Promise.all(Object.values(this).filter((e=>ZF(e))).map((async e=>{await e.stop()}))),this._started=!1}async afterStop(){await Promise.all(Object.values(this).filter((e=>ZF(e))).map((async e=>{null!=e.afterStop&&await e.afterStop()})))}get peerId(){if(null==this._peerId)throw B(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this._peerId}set peerId(e){this._peerId=e}get addressManager(){if(null==this._addressManager)throw B(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this._addressManager}set addressManager(e){this._addressManager=e}get peerStore(){if(null==this._peerStore)throw B(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this._peerStore}set peerStore(e){this._peerStore=e}get upgrader(){if(null==this._upgrader)throw B(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this._upgrader}set upgrader(e){this._upgrader=e}get registrar(){if(null==this._registrar)throw B(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this._registrar}set registrar(e){this._registrar=e}get connectionManager(){if(null==this._connectionManager)throw B(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this._connectionManager}set connectionManager(e){this._connectionManager=e}get transportManager(){if(null==this._transportManager)throw B(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this._transportManager}set transportManager(e){this._transportManager=e}get connectionGater(){if(null==this._connectionGater)throw B(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this._connectionGater}set connectionGater(e){this._connectionGater=e}get contentRouting(){if(null==this._contentRouting)throw B(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this._contentRouting}set contentRouting(e){this._contentRouting=e}get peerRouting(){if(null==this._peerRouting)throw B(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this._peerRouting}set peerRouting(e){this._peerRouting=e}get datastore(){if(null==this._datastore)throw B(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this._datastore}set datastore(e){this._datastore=e}get connectionProtector(){return this._connectionProtector}set connectionProtector(e){this._connectionProtector=e}get dialer(){if(null==this._dialer)throw B(new Error("dialer not set"),"ERR_SERVICE_MISSING");return this._dialer}set dialer(e){this._dialer=e}get metrics(){return this._metrics}set metrics(e){this._metrics=e}get dht(){return this._dht}set dht(e){this._dht=e}get pubsub(){return this._pubsub}set pubsub(e){this._pubsub=e}}var cK=n(3061);const lK=globalThis.fetch,uK=globalThis.Headers;globalThis.Request,globalThis.Response;function hK(e,t,n){return`${e}?name=${t}&type=${n}`}async function dK(e,t){const n=await lK(e,{headers:new uK({accept:"application/dns-json"}),signal:t}),r=await n.json();return r}function fK(e,t){return`${t}_${e}`}const pK=Object.assign(T("dns-over-http-resolver"),{error:T("dns-over-http-resolver:error")});class gK{constructor(e={}){this._cache=new cK({max:e?.maxCache??100}),this._TXTcache=new cK({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??dK,this._abortControllers=[]}cancel(){this._abortControllers.forEach((e=>e.abort()))}getServers(){return this._servers}_getShuffledServers(){const e=[...this._servers];for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*t),r=e[t];e[t]=e[n],e[n]=r}return e}setServers(e){this._servers=e}async resolve(e,t="A"){switch(t){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){const t="A",n=this._cache.get(fK(e,t));if(null!=n)return n;let r=!1;for(const s of this._getShuffledServers()){const n=new AbortController;this._abortControllers.push(n);try{const r=await this._request(hK(s,e,t),n.signal),i=r.Answer.map((e=>e.data)),o=Math.min(...r.Answer.map((e=>e.TTL)));return this._cache.set(fK(e,t),i,{ttl:o}),i}catch(rb){n.signal.aborted&&(r=!0),pK.error(`${s} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==n))}}if(r)throw Object.assign(new Error("queryA ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){const t="AAAA",n=this._cache.get(fK(e,t));if(null!=n)return n;let r=!1;for(const s of this._getShuffledServers()){const n=new AbortController;this._abortControllers.push(n);try{const r=await this._request(hK(s,e,t),n.signal),i=r.Answer.map((e=>e.data)),o=Math.min(...r.Answer.map((e=>e.TTL)));return this._cache.set(fK(e,t),i,{ttl:o}),i}catch(rb){n.signal.aborted&&(r=!0),pK.error(`${s} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==n))}}if(r)throw Object.assign(new Error("queryAaaa ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){const t="TXT",n=this._TXTcache.get(fK(e,t));if(null!=n)return n;let r=!1;for(const s of this._getShuffledServers()){const n=new AbortController;this._abortControllers.push(n);try{const r=await this._request(hK(s,e,t),n.signal),i=r.Answer.map((e=>[e.data.replace(/['"]+/g,"")])),o=Math.min(...r.Answer.map((e=>e.TTL)));return this._TXTcache.set(fK(e,t),i,{ttl:o}),i}catch(rb){n.signal.aborted&&(r=!0),pK.error(`${s} could not resolve ${e} record ${t}`)}finally{this._abortControllers=this._abortControllers.filter((e=>e!==n))}}if(r)throw Object.assign(new Error("queryTxt ECANCELLED"),{code:"ECANCELLED"});throw new Error(`Could not resolve ${e} record ${t}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}}var yK=gK,mK=yK;const{code:wK}=Yn("dnsaddr");async function bK(e,t={}){const n=new mK;null!=t.signal&&t.signal.addEventListener("abort",(()=>{n.cancel()}));const r=e.getPeerId(),[,s]=e.stringTuples().find((([e])=>e===wK))??[];if(null==s)throw new Error("No hostname found in multiaddr");const i=await n.resolveTxt(`_dnsaddr.${s}`);let o=i.flat().map((e=>e.split("=")[1]));return null!=r&&(o=o.filter((e=>e.includes(r)))),o}const vK=3e4,_K=3e4,EK=100,SK=4,kK=25,IK={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:EK,maxDialsPerPeer:SK,dialTimeout:vK,inboundUpgradeTimeout:_K,resolvers:{dnsaddr:bK},addressSorter:PV},connectionGater:{},transportManager:{faultTolerance:KF.FATAL_ALL},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:rV,enabled:!1,ttl:sV},hop:{enabled:!1,active:!1,timeout:3e4},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:Yz},timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1},ping:{protocolPrefix:"ipfs",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4},fetch:{protocolPrefix:"libp2p",maxInboundStreams:1,maxOutboundStreams:1,timeout:1e4}};function AK(e){const t=I(IK,e);if(null==t.transports||t.transports.length<1)throw B(new Error(ej.ERR_TRANSPORTS_REQUIRED),tj.ERR_TRANSPORTS_REQUIRED);if(null==t.connectionEncryption||0===t.connectionEncryption.length)throw B(new Error(ej.CONN_ENCRYPTION_REQUIRED),tj.CONN_ENCRYPTION_REQUIRED);if(null===t.connectionProtector&&null!=globalThis.process?.env?.LIBP2P_FORCE_PNET)throw B(new Error(ej.ERR_PROTECTOR_REQUIRED),tj.ERR_PROTECTOR_REQUIRED);return t.identify.host.agentVersion===Yz&&(E$||v$?t.identify.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(b$||S$||_$||k$)&&(t.identify.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`)),t}var TK;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.id&&e.id.byteLength>0)&&(t.uint32(10),t.bytes(e.id)),null!=e.pubKey&&(t.uint32(18),t.bytes(e.pubKey)),null!=e.privKey&&(t.uint32(26),t.bytes(e.privKey)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={id:new Uint8Array(0)},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.id=e.bytes();break;case 2:n.pubKey=e.bytes();break;case 3:n.privKey=e.bytes();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(TK||(TK={}));const RK=async()=>{const e=await Uu("Ed25519"),t=await PK(e);if("Ed25519"===t.type)return t;throw new Error(`Generated unexpected PeerId type "${t.type}"`)},CK=async e=>{const t=await Uu("RSA",e?.bits??2048),n=await PK(t);if("RSA"===n.type)return n;throw new Error(`Generated unexpected PeerId type "${n.type}"`)};async function PK(e){return await ko(ju(e.public),zu(e))}class NK extends iN{get[HF](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}get lan(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}get(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}findProviders(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}findPeer(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}getClosestPeers(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}provide(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}put(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}async getMode(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}async setMode(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}async refreshRoutingTable(){throw B(new Error(ej.DHT_DISABLED),tj.DHT_DISABLED)}}class OK extends iN{constructor(){super(...arguments),this.topicValidators=new Map}isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}get multicodecs(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}getPeers(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}getTopics(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}subscribe(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}unsubscribe(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}getSubscribers(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}async publish(){throw B(new Error(ej.PUBSUB_DISABLED),tj.ERR_PUBSUB_DISABLED)}}var DK=n(1838);const LK=x("libp2p:dialer:dial-request");class xK{constructor(e){const{addrs:t,dialAction:n,dialer:r}=e;this.addrs=t,this.dialer=r,this.dialAction=n}async run(e={}){const t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw B(new Error("No dial tokens available"),tj.ERR_NO_DIAL_TOKENS);const n=new DK;for(const o of t)n.push(o).catch((e=>{LK.error(e)}));const r=this.addrs.map((()=>{const e=new AbortController;try{(0,oj.setMaxListeners)?.(1/0,e.signal)}catch{}return e}));if(null!=e.signal)try{(0,oj.setMaxListeners)?.(1/0,e.signal)}catch{}let s=0,i=!1;try{return await Promise.any(this.addrs.map((async(o,a)=>{const c=await n.shift();if(i)throw this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0]),B(new Error("dialAction already succeeded"),tj.ERR_ALREADY_SUCCEEDED);const l=r[a];if(null==l)throw B(new Error("dialAction did not come with an AbortController"),tj.ERR_INVALID_PARAMETERS);let u;try{const i=l.signal;u=await this.dialAction(o,{...e,signal:null!=e.signal?(0,js.anySignal)([i,e.signal]):i}),r[a]=void 0}finally{s++,this.addrs.length-s>=t.length?n.push(c).catch((e=>{LK.error(e)})):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}if(null==u)throw B(new Error("dialAction led to empty object"),tj.ERR_TRANSPORT_DIAL_FAILED);return i=!0,u})))}finally{r.forEach((e=>{void 0!==e&&e.abort()})),t.forEach((e=>this.dialer.releaseToken(e)))}}}const BK=x("libp2p:dialer");class MK{constructor(e,t={}){this.started=!1,this.addressSorter=t.addressSorter??PV,this.maxAddrsToDial=t.maxAddrsToDial??kK,this.timeout=t.dialTimeout??vK,this.maxDialsPerPeer=t.maxDialsPerPeer??SK,this.tokens=[...new Array(t.maxParallelDials??EK)].map(((e,t)=>t)),this.components=e,this.pendingDials=mz({name:"libp2p_dialler_pending_dials",metrics:e.metrics}),this.pendingDialTargets=mz({name:"libp2p_dialler_pending_dial_targets",metrics:e.metrics});for(const[n,r]of Object.entries(t.resolvers??{}))Fr.set(n,r)}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(const e of this.pendingDials.values())try{e.controller.abort()}catch(rb){BK.error(rb)}this.pendingDials.clear();for(const e of this.pendingDialTargets.values())e.abort();this.pendingDialTargets.clear()}async dial(e,t={}){const{peerId:n,multiaddr:r}=Aj(e);if(null!=n){if(this.components.peerId.equals(n))throw B(new Error("Tried to dial self"),tj.ERR_DIALED_SELF);if(null!=r&&(BK("storing multiaddrs %p",n,r),await this.components.peerStore.addressBook.add(n,[r])),await this.components.connectionGater.denyDialPeer(n))throw B(new Error("The dial request is blocked by gater.allowDialPeer"),tj.ERR_PEER_DIAL_INTERCEPTED)}BK("creating dial target for %p",n);const s=new AbortController,i=FK();this.pendingDialTargets.set(i,s);let o,a=s.signal;null!=t.signal&&(a=(0,js.anySignal)([a,t.signal]));try{o=await this._createDialTarget({peerId:n,multiaddr:r},{...t,signal:a})}finally{this.pendingDialTargets.delete(i)}if(0===o.addrs.length)throw B(new Error("The dial request has no valid addresses"),tj.ERR_NO_VALID_ADDRESSES);const c=this.pendingDials.get(o.id)??this._createPendingDial(o,t);try{const e=await c.promise;return BK("dial succeeded to %s",o.id),e}catch(rb){throw BK("dial failed to %s",o.id,rb),c.controller.signal.aborted&&(rb.code=tj.ERR_TIMEOUT),BK.error(rb),rb}finally{c.destroy()}}async _createDialTarget(e,t){let n=[];if($r(e.multiaddr)&&n.push(e.multiaddr),!$r(e.multiaddr)&&lo(e.peerId)&&n.push(...await this._loadAddresses(e.peerId)),n=(await Promise.all(n.map((async e=>await this._resolve(e,t))))).flat().filter((e=>Boolean(this.components.transportManager.transportForMultiaddr(e)))),n=[...new Set(n.map((e=>e.toString())))].map((e=>Hr(e))),n.length>this.maxAddrsToDial)throw B(new Error("dial with more addresses than allowed"),tj.ERR_TOO_MANY_ADDRESSES);const r=lo(e.peerId)?e.peerId:void 0;if(null!=r){const e=`/p2p/${r.toString()}`;n=n.map((t=>{const n=t.getPeerId();return null!=n&&r.equals(n)?t:t.encapsulate(e)}))}return{id:null==r?FK():r.toString(),addrs:n}}async _loadAddresses(e){const t=await this.components.peerStore.addressBook.get(e);return(await Promise.all(t.map((async t=>{const n=await this.components.connectionGater.denyDialMultiaddr(e,t.multiaddr);return!n&&t})))).filter(UK).sort(this.addressSorter).map((e=>e.multiaddr))}_createPendingDial(e,t={}){const n=async(e,t={})=>{if(!0===t.signal?.aborted)throw B(new Error("already aborted"),tj.ERR_ALREADY_ABORTED);return await this.components.transportManager.dial(e,t).catch((t=>{throw BK.error("dial to %s failed",e,t),t}))},r=new xK({addrs:e.addrs,dialAction:n,dialer:this}),s=new Tn.TimeoutController(this.timeout),i=[s.signal];null!=t.signal&&i.push(t.signal);const o=(0,js.anySignal)(i);try{(0,oj.setMaxListeners)?.(1/0,o)}catch{}const a={dialRequest:r,controller:s,promise:r.run({...t,signal:o}),destroy:()=>{s.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,a),a}getTokens(e){const t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,t);return BK("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),n}releaseToken(e){this.tokens.includes(e)||(BK("token %d released",e),this.tokens.push(e))}async _resolve(e,t){const n=e.protoNames().includes("dnsaddr");if(!n)return[e];const r=await this._resolveRecord(e,t),s=await Promise.all(r.map((async e=>await this._resolve(e,t)))),i=s.flat();return i.reduce(((e,t)=>(null==e.find((e=>e.equals(t)))&&e.push(t),e)),[])}async _resolveRecord(e,t){try{e=Hr(e.toString());const n=await e.resolve(t);return n}catch(rb){return BK.error(`multiaddr ${e.toString()} could not be resolved`,rb),[]}}}function UK(e){return Boolean(e)}function FK(){return`${parseInt(String(1e9*Math.random()),10).toString()}${Date.now()}`}const jK=x("libp2p");class VK extends iN{constructor(e){super(),this.started=!1,this.peerId=e.peerId;const t=this.components=new aK({peerId:e.peerId,datastore:e.datastore??new od,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...e.connectionGater}});t.peerStore=new iK(t,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...e.peerStore}),this.services=[t],null!=e.metrics&&(this.metrics=this.components.metrics=this.configureComponent(e.metrics(this.components))),this.peerStore=this.components.peerStore,this.peerStore.addEventListener("peer",(e=>{const{detail:t}=e;this.dispatchEvent(new aN("peer:discovery",{detail:t}))})),null!=e.connectionProtector&&(this.components.connectionProtector=e.connectionProtector(t)),this.components.upgrader=new Hz(this.components,{connectionEncryption:(e.connectionEncryption??[]).map((e=>this.configureComponent(e(this.components)))),muxers:(e.streamMuxers??[]).map((e=>this.configureComponent(e(this.components)))),inboundUpgradeTimeout:e.connectionManager.inboundUpgradeTimeout}),this.components.dialer=new MK(this.components,e.connectionManager),this.connectionManager=this.components.connectionManager=new Pj(this.components,e.connectionManager),this.components.connectionManager.addEventListener("peer:disconnect",(e=>{this.dispatchEvent(new aN("peer:disconnect",{detail:e.detail}))})),this.components.connectionManager.addEventListener("peer:connect",(e=>{this.dispatchEvent(new aN("peer:connect",{detail:e.detail}))})),this.registrar=this.components.registrar=new jz(this.components),this.components.transportManager=new bz(this.components,e.transportManager),this.components.addressManager=new hj(this.components,e.addresses),this.configureComponent(new O$(this.components)),this.configureComponent(new Lj(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));const n=ZV.generateOptions();this.keychain=this.configureComponent(new ZV(this.components,{...n,...e.keychain})),this.services.push(new P$(this.components,e.nat)),e.transports.forEach((e=>{this.components.transportManager.add(this.configureComponent(e(this.components)))})),this.identifyService=new r$(this.components,{...e.identify}),this.configureComponent(this.identifyService),null!=e.dht?this.dht=this.components.dht=e.dht(this.components):this.dht=new NK,null!=e.pubsub?this.pubsub=this.components.pubsub=e.pubsub(this.components):this.pubsub=new OK;const r=(e.peerRouters??[]).map((e=>this.configureComponent(e(this.components))));null!=e.dht&&(r.push(this.configureComponent(new D$(this.dht))),this.dht.addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))),this.peerRouting=this.components.peerRouting=this.configureComponent(new cj(this.components,{...e.peerRouting,routers:r}));const s=(e.contentRouters??[]).map((e=>this.configureComponent(e(this.components))));null!=e.dht&&s.push(this.configureComponent(new oK(this.dht))),this.contentRouting=this.components.contentRouting=this.configureComponent(new lj(this.components,{routers:s})),e.relay.enabled&&(this.components.transportManager.add(this.configureComponent(new eV(this.components,e.relay))),this.configureComponent(new xV(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new l$(this.components,{...e.fetch})),this.pingService=this.configureComponent(new p$(this.components,{...e.ping}));for(const i of e.peerDiscovery??[]){const e=this.configureComponent(i(this.components));e.addEventListener("peer",(e=>{this.onDiscoveryPeer(e)}))}}configureComponent(e){return ZF(e)&&this.services.push(e),e}async start(){if(!this.started){this.started=!0,jK("libp2p is starting");try{await Promise.all(this.services.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(this.services.map((e=>e.start()))),await Promise.all(this.services.map((async e=>{null!=e.afterStart&&await e.afterStart()}))),jK("libp2p has started")}catch(rb){throw jK.error("An error occurred starting libp2p",rb),await this.stop(),rb}}}async stop(){this.started&&(jK("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(this.services.map((e=>e.stop()))),await Promise.all(this.services.map((async e=>{null!=e.afterStop&&await e.afterStop()}))),jK("libp2p has stopped"))}isStarted(){return this.started}getConnections(e){return this.components.connectionManager.getConnections(e)}getPeers(){const e=new Ej;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e,t={}){return await this.components.connectionManager.openConnection(e,t)}async dialProtocol(e,t,n={}){if(null==t)throw B(new Error("no protocols were provided to open a stream"),tj.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(t=Array.isArray(t)?t:[t],0===t.length)throw B(new Error("no protocols were provided to open a stream"),tj.ERR_INVALID_PROTOCOLS_FOR_STREAM);const r=await this.dial(e,n);return await r.newStream(t,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e){$r(e)&&(e=_o(e.getPeerId()??"")),await this.components.connectionManager.closeConnections(e)}async getPublicKey(e,t={}){if(jK("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;const n=await this.peerStore.get(e);if(null!=n.pubKey)return n.pubKey;if(null==this.dht)throw B(new Error("Public key was not in the peer store and the DHT is not enabled"),tj.ERR_NO_ROUTERS_AVAILABLE);const r=Xn([An("/pk/"),e.multihash.digest]);for await(const s of this.dht.get(r,t))if("VALUE"===s.name){const t=Fu(s.value);return await this.peerStore.keyBook.set(e,s.value),t.bytes}throw B(new Error(`Node not responding with its public key: ${e.toString()}`),tj.ERR_INVALID_RECORD)}async fetch(e,t,n={}){if($r(e)){const t=_o(e.getPeerId()??"");await this.components.peerStore.addressBook.add(t,[e]),e=t}return await this.fetchService.fetch(e,t,n)}async ping(e,t={}){if($r(e)){const t=_o(e.getPeerId()??"");await this.components.peerStore.addressBook.add(t,[e]),e=t}return await this.pingService.ping(e,t)}async handle(e,t,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,n)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return await this.registrar.register(e,t)}unregister(e){this.registrar.unregister(e)}onDiscoveryPeer(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?(t.multiaddrs.length>0&&this.components.peerStore.addressBook.add(t.id,t.multiaddrs).catch((e=>jK.error(e))),t.protocols.length>0&&this.components.peerStore.protoBook.set(t.id,t.protocols).catch((e=>jK.error(e))),this.dispatchEvent(new aN("peer:discovery",{detail:t}))):jK.error(new Error(tj.ERR_DISCOVERED_SELF))}}async function zK(e){if(null==e.peerId){const t=e.datastore;if(null!=t)try{const n=new ZV({datastore:t},{...ZV.generateOptions(),...e.keychain??{}});e.peerId=await n.exportPeerId("self")}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}}return null==e.peerId&&(e.peerId=await RK()),new VK(AK(e))}async function $K(e){const t=await zK(e);return!1!==e.start&&await t.start(),t}var KK=n(6657);const HK=1e3,qK=60*HK,WK=60*qK,GK=36*WK,YK="/lan",QK="/ipfs",XK="/kad/1.0.0",JK="/dht/record",ZK="/dht/provider",eH=256,tH=24*WK,nH=WK,rH=20,sH=3,iH=Number(5*qK),oH=Number(30*HK),aH=Number(5*qK),cH=Number(30*HK),lH=Number(30*HK),uH=An("/pk/");function hH(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if(53===t||54===t||55===t)return"localhost"!==n;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=RV(n);return null==r||!r}))}}function dH(e){return{...e,multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if("localhost"===n)return!0;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=RV(n);return null!=r&&r}))}}async function fH(e){const t=await Gt.digest(e);return t.digest}async function pH(e){return await fH(e.toBytes())}function gH(e){return new Bs(`${JK}/${Fn(e,"base32")}`,!1)}function yH(e){return Xn([uH,e.toBytes()])}function mH(e){return"/pk/"===Fn(e.subarray(0,4))}function wH(e){return Eo(e.subarray(4))}function bH(e,t){const n=new Date,r=new kd(e,t,n);return r.serialize()}function vH(e,t=100){let n;return()=>{clearTimeout(n),n=setTimeout((()=>e()),t)}}const _H="kad-close",EH=50,SH=20,kH=1e4,IH=10;class AH{constructor(e,t){const{kBucketSize:n,pingTimeout:r,lan:s,pingConcurrency:i,protocol:o,tagName:a,tagValue:c}=t;this.components=e,this.log=x(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table`),this.kBucketSize=n??SH,this.pingTimeout=r??kH,this.pingConcurrency=i??IH,this.lan=s,this.running=!1,this.protocol=o,this.tagName=a??_H,this.tagValue=c??EH;const l=()=>{this.metrics?.pingQueueSize.update(this.pingQueue.size),this.metrics?.pingRunning.update(this.pingQueue.pending)};this.pingQueue=new Yi({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",l),this.pingQueue.addListener("next",l),this._onPing=this._onPing.bind(this)}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_routing_table_size`),pingQueueSize:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_queue_size`),pingRunning:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_ping_running`)});const e=new KK({localNodeId:await pH(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=e,e.on("ping",this._onPing),this._tagPeers(e)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(e){let t=new Ej;const n=vH((()=>{const n=new Ej(e.closest(e.localNodeId,SH).map((e=>e.peer))),r=n.difference(t),s=t.difference(n);Promise.resolve().then((async()=>{for(const e of r)await this.components.peerStore.tagPeer(e,this.tagName,{value:this.tagValue});for(const e of s)await this.components.peerStore.unTagPeer(e,this.tagName)})).catch((e=>{this.log.error("Could not update peer tags",e)})),t=n}));e.on("added",(()=>{n()})),e.on("removed",(()=>{n()}))}_onPing(e,t){this.pingQueue.add((async()=>{if(!this.running)return;let n=0;try{await Promise.all(e.map((async e=>{let t;try{t=new Tn.TimeoutController(this.pingTimeout);const r={signal:t.signal};this.log("pinging old contact %p",e.peer);const s=await this.components.connectionManager.openConnection(e.peer,r),i=await s.newStream(this.protocol,r);i.close(),n++}catch(rb){this.running&&null!=this.kb&&(this.log.error("could not ping peer %p",e.peer,rb),this.log("evicting old contact after ping failed %p",e),this.kb.remove(e.id))}finally{null!=t&&t.clear(),this.metrics?.routingTableSize.update(this.size)}}))),this.running&&n<e.length&&null!=this.kb&&(this.log("adding new contact %p",t.peer),this.kb.add(t))}catch(rb){this.log.error("could not process k-bucket ping event",rb)}})).catch((e=>{this.log.error("could not process k-bucket ping event",e)}))}get size(){return null==this.kb?0:this.kb.count()}async find(e){const t=await pH(e),n=this.closestPeer(t);if(null!=n&&e.equals(n))return n}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t=this.kBucketSize){if(null==this.kb)return[];const n=this.kb.closest(e,t);return n.map((e=>e.peer))}async add(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await pH(e);this.kb.add({id:t,peer:e}),this.log("added %p with kad id %b",e,t),this.metrics?.routingTableSize.update(this.size)}async remove(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await pH(e);this.kb.remove(t),this.metrics?.routingTableSize.update(this.size)}}function TH(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const n=vn(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return wn(n)}var RH=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];const CH=15;class PH{constructor(e){const{peerRouting:t,routingTable:n,refreshInterval:r,refreshQueryTimeout:s,lan:i}=e;this.log=x(`libp2p:kad-dht:${i?"lan":"wan"}:routing-table:refresh`),this.peerRouting=t,this.routingTable=n,this.refreshInterval=r??aH,this.refreshQueryTimeout=s??cH,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");const t=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log(`max common prefix length ${t}`),this.log(`tracked CPLs [ ${n.map((e=>e.toISOString())).join(", ")} ]`),Promise.all(n.map((async(r,s)=>{try{if(await this._refreshCommonPrefixLength(s,r,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(s+1),n.length-1);for(let n=s+1;n<t+1;n++)try{await this._refreshCommonPrefixLength(n,r,e)}catch(rb){this.log.error(rb)}}}catch(rb){this.log.error(rb)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,n){if(!n&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const r=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,r,this.routingTable.size);const s=new Tn.TimeoutController(this.refreshQueryTimeout);try{const t=await RT(this.peerRouting.getClosestPeers(r.toBytes(),{signal:s.signal}));this.log(`found ${t} peers that were close to imaginary peer %p`,r),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,r,this.routingTable.size)}finally{s.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>CH&&(e=CH);const t=[];for(let n=0;n<=e;n++)t[n]=this.commonPrefixLengthRefreshedAt[n]??new Date;return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");const t=Bc(2),n=(t[1]<<8)+t[0],r=await this._makePeerId(this.routingTable.kb.localNodeId,n,e);return Eo(r)}async _makePeerId(e,t,n){if(n>CH)throw new Error(`Cannot generate peer ID for common prefix length greater than ${CH}`);const r=new DataView(e.buffer,e.byteOffset,e.byteLength),s=r.getUint16(0,!1),i=s^32768>>n,o=65535<<16-(n+1),a=i&o|t&~o,c=RH[a],l=new ArrayBuffer(34),u=new DataView(l,0,l.byteLength);return u.setUint8(0,Gt.code),u.setUint8(1,32),u.setUint32(2,c,!1),new Uint8Array(u.buffer,u.byteOffset,u.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const n of this._prefixLengths())n===e&&t++;return t}*_prefixLengths(){if(null!=this.routingTable.kb)for(const{id:e}of this.routingTable.kb.toIterable()){const t=TH(this.routingTable.kb.localNodeId,e);let n=0;for(const e of t){if(0!==e)break;n++}yield n}}}var NH,OH;(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 3:n.author=e.bytes();break;case 4:n.signature=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(NH||(NH={})),function(e){let t,n,r,s,i,o;(function(e){e["PUT_VALUE"]="PUT_VALUE",e["GET_VALUE"]="GET_VALUE",e["ADD_PROVIDER"]="ADD_PROVIDER",e["GET_PROVIDERS"]="GET_PROVIDERS",e["FIND_NODE"]="FIND_NODE",e["PING"]="PING"})(t=e.MessageType||(e.MessageType={})),function(e){e[e["PUT_VALUE"]=0]="PUT_VALUE",e[e["GET_VALUE"]=1]="GET_VALUE",e[e["ADD_PROVIDER"]=2]="ADD_PROVIDER",e[e["GET_PROVIDERS"]=3]="GET_PROVIDERS",e[e["FIND_NODE"]=4]="FIND_NODE",e[e["PING"]=5]="PING"}(n||(n={})),function(e){e.codec=()=>ha(n)}(t=e.MessageType||(e.MessageType={})),function(e){e["NOT_CONNECTED"]="NOT_CONNECTED",e["CONNECTED"]="CONNECTED",e["CAN_CONNECT"]="CAN_CONNECT",e["CANNOT_CONNECT"]="CANNOT_CONNECT"}(r=e.ConnectionType||(e.ConnectionType={})),function(e){e[e["NOT_CONNECTED"]=0]="NOT_CONNECTED",e[e["CONNECTED"]=1]="CONNECTED",e[e["CAN_CONNECT"]=2]="CAN_CONNECT",e[e["CANNOT_CONNECT"]=3]="CANNOT_CONNECT"}(s||(s={})),function(e){e.codec=()=>ha(s)}(r=e.ConnectionType||(e.ConnectionType={})),function(t){let n;t.codec=()=>(null==n&&(n=da(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.id&&(n.uint32(10),n.bytes(t.id)),null==t.addrs)throw new Error('Protocol error: required field "addrs" was not found in object');for(const e of t.addrs)n.uint32(18),n.bytes(e);null!=t.connection&&(n.uint32(24),e.ConnectionType.codec().encode(t.connection,n)),!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={addrs:[]},s=null==n?t.len:t.pos+n;while(t.pos<s){const n=t.uint32();switch(n>>>3){case 1:r.id=t.bytes();break;case 2:r.addrs.push(t.bytes());break;case 3:r.connection=e.ConnectionType.codec().decode(t);break;default:t.skipType(7&n);break}}return r}))),n),t.encode=e=>sa(e,t.codec()),t.decode=e=>ra(e,t.codec())}(i=e.Peer||(e.Peer={})),e.codec=()=>(null==o&&(o=da(((t,n,r={})=>{if(!1!==r.lengthDelimited&&n.fork(),null!=t.type&&(n.uint32(8),e.MessageType.codec().encode(t.type,n)),null!=t.clusterLevelRaw&&(n.uint32(80),n.int32(t.clusterLevelRaw)),null!=t.key&&(n.uint32(18),n.bytes(t.key)),null!=t.record&&(n.uint32(26),n.bytes(t.record)),null==t.closerPeers)throw new Error('Protocol error: required field "closerPeers" was not found in object');for(const s of t.closerPeers)n.uint32(66),e.Peer.codec().encode(s,n);if(null==t.providerPeers)throw new Error('Protocol error: required field "providerPeers" was not found in object');for(const s of t.providerPeers)n.uint32(74),e.Peer.codec().encode(s,n);!1!==r.lengthDelimited&&n.ldelim()}),((t,n)=>{const r={closerPeers:[],providerPeers:[]},s=null==n?t.len:t.pos+n;while(t.pos<s){const n=t.uint32();switch(n>>>3){case 1:r.type=e.MessageType.codec().decode(t);break;case 10:r.clusterLevelRaw=t.int32();break;case 2:r.key=t.bytes();break;case 3:r.record=t.bytes();break;case 8:r.closerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;case 9:r.providerPeers.push(e.Peer.codec().decode(t,t.uint32()));break;default:t.skipType(7&n);break}}return r}))),o),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(OH||(OH={}));const DH=OH.MessageType,LH=OH.ConnectionType,xH=Object.keys(DH);class BH{constructor(e,t,n){if(!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this.clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){const e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return OH.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(MH),providerPeers:this.providerPeers.map(MH),record:null==this.record?void 0:this.record.serialize().subarray()})}static deserialize(e){const t=OH.decode(e),n=new BH(t.type??OH.MessageType.PUT_VALUE,t.key??Uint8Array.from([]),t.clusterLevelRaw??0);return n.closerPeers=t.closerPeers.map(UH),n.providerPeers=t.providerPeers.map(UH),null!=t.record?.length&&(n.record=kd.deserialize(t.record)),n}}function MH(e){const t={id:e.id.toBytes(),addrs:(e.multiaddrs??[]).map((e=>e.bytes)),connection:LH.CONNECTED};return t}function UH(e){if(null==e.id)throw new Error("Invalid peer in message");return{id:Eo(e.id),multiaddrs:(e.addrs??[]).map((e=>Hr(e))),protocols:[]}}function FH(e){return{...e,name:"SENDING_QUERY",type:0,messageName:e.type,messageType:xH.indexOf(e.type.toString())}}function jH(e){return{...e,name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!=e.closer?e.closer:[],providers:null!=e.providers?e.providers:[]}}function VH(e){return{...e,name:"FINAL_PEER",type:2}}function zH(e){return{...e,name:"QUERY_ERROR",type:3}}function $H(e){return{...e,name:"PROVIDER",type:4}}function KH(e){return{...e,name:"VALUE",type:5}}function HH(e){return{...e,name:"DIALING_PEER",type:7}}class qH extends iN{constructor(e,t){super();const{protocol:n,lan:r}=t;this.components=e,this.log=x(`libp2p:kad-dht:${r?"lan":"wan"}:network`),this.running=!1,this.protocol=n}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,t,n={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield HH({peer:e}),yield FH({to:e,type:t.type});try{const r=await this.components.connectionManager.openConnection(e,n),s=await r.newStream(this.protocol,n),i=await this._writeReadMessage(s,t.serialize(),n);yield jH({from:e,messageType:i.type,closer:i.closerPeers,providers:i.providerPeers,record:i.record})}catch(rb){yield zH({from:e,error:rb})}finally{null!=s&&s.close()}}async*sendMessage(e,t,n={}){if(!this.running)return;this.log("sending %s to %p",t.type,e),yield HH({peer:e}),yield FH({to:e,type:t.type});try{const r=await this.components.connectionManager.openConnection(e,n),s=await r.newStream(this.protocol,n);await this._writeMessage(s,t.serialize(),n),yield jH({from:e,messageType:t.type})}catch(rb){yield zH({from:e,error:rb})}finally{null!=s&&s.close()}}async _writeMessage(e,t,n){null!=n.signal&&(e=GO(e,n.signal)),await dd([t],XO(),e,Hh)}async _writeReadMessage(e,t,n){null!=n.signal&&(e=GO(e,n.signal));const r=await dd([t],XO(),e,nD(),(async e=>{const t=await QS(e);if(null!=t)return t;throw B(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")})),s=BH.deserialize(r);return s.closerPeers.forEach((e=>{this.dispatchEvent(new aN("peer",{detail:e}))})),s.providerPeers.forEach((e=>{this.dispatchEvent(new aN("peer",{detail:e}))})),s}}function WH(e,t){const n=t.key,r=Fn(n),s=r.split("/");if(s.length<3)return;const i=e[s[1].toString()];if(null==i){const e="Invalid record keytype";throw B(new Error(e),"ERR_INVALID_RECORD_KEY_TYPE")}return i(n,t.value)}const GH=async(e,t)=>{if(!(e instanceof Uint8Array))throw B(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(e.byteLength<5)throw B(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");const n=Fn(e.subarray(0,4));if("/pk/"!==n)throw B(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");const r=e.slice(4),s=await Gt.digest(t);if(!Pr(r,s.bytes))throw B(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},YH={pk:GH};function QH(e,t,n){if(0===n.length){const e="No records given";throw B(new Error(e),"ERR_NO_RECORDS_RECEIVED")}const r=Fn(t),s=r.split("/");if(s.length<3){const e="Record key does not have a selector function";throw B(new Error(e),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const i=e[s[1].toString()];if(null==i){const e=`Unrecognized key prefix: ${s[1]}`;throw B(new Error(e),"ERR_UNRECOGNIZED_KEY_PREFIX")}return 1===n.length?0:i(t,n)}function XH(e,t){return 0}const JH={pk:XH};class ZH{constructor(e,t){const{validators:n,selectors:r,peerRouting:s,queryManager:i,routingTable:o,network:a,lan:c}=t;this.components=e,this.log=x(`libp2p:kad-dht:${c?"lan":"wan"}:content-fetching`),this.validators=n,this.selectors=r,this.peerRouting=s,this.queryManager=i,this.routingTable=o,this.network=a}async putLocal(e,t){const n=gH(e);await this.components.datastore.put(n,t)}async getLocal(e){this.log("getLocal %b",e);const t=gH(e);this.log("fetching record for key %k",t);const n=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const r=kd.deserialize(n);return await WH(this.validators,r),r}async*sendCorrectionRecord(e,t,n,r={}){this.log("sendCorrection for %b",e);const s=await bH(e,n);for(const{value:i,from:o}of t){if(Pr(i,n)){this.log("record was ok");continue}if(this.components.peerId.equals(o)){try{const t=gH(e);this.log(`Storing corrected record for key ${t.toString()}`),await this.components.datastore.put(t,s.subarray())}catch(rb){this.log.error("Failed error correcting self",rb)}continue}let t=!1;const a=new BH(DH.PUT_VALUE,e,0);a.record=kd.deserialize(s);for await(const e of this.network.sendRequest(o,a,r))"PEER_RESPONSE"===e.name&&null!=e.record&&Pr(e.record.value,kd.deserialize(s).value)&&(t=!0),yield e;t||(yield zH({from:o,error:B(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(e,t,n={}){this.log("put key %b value %b",e,t);const r=await bH(e,t),s=gH(e);this.log(`storing record for key ${s.toString()}`),await this.components.datastore.put(s,r.subarray()),yield*dd(this.peerRouting.getClosestPeers(e,{signal:n.signal}),(t=>_f(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const s=[],i=new BH(DH.PUT_VALUE,e,0);i.record=kd.deserialize(r),this.log("send put to %p",t.peer.id);for await(const e of this.network.sendRequest(t.peer.id,i,n))s.push(e),"PEER_RESPONSE"===e.name&&(null!=e.record&&Pr(e.record.value,kd.deserialize(r).value)||s.push(zH({from:t.peer.id,error:B(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return s}))),(e=>vf(e,{ordered:!1,concurrency:sH})),(async function*(e){for await(const t of e)yield*t}))}async*get(e,t={}){this.log("get %b",e);const n=[];for await(const o of this.getMany(e,t))"VALUE"===o.name&&n.push(o),yield o;if(0===n.length)return;const r=n.map((e=>e.value));let s=0;try{s=QH(this.selectors,e,r)}catch(rb){if("ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY"!==rb.code)throw rb}const i=r[s];if(this.log("GetValue %b %b",e,i),null==i)throw B(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,n,i,t),yield n[s]}async*getMany(e,t={}){this.log("getMany values for %b",e);try{const t=await this.getLocal(e);yield KH({value:t.value,from:this.components.peerId})}catch(rb){this.log("error getting local value for %b",e,rb)}const n=await fH(e),r=this.routingTable.closestPeers(n);this.log("found %d peers in routing table",r.length);const s=this,i=async function*({peer:t,signal:n}){for await(const r of s.peerRouting.getValueOrPeers(t,e,{signal:n}))yield r,"PEER_RESPONSE"===r.name&&null!=r.record&&(yield KH({from:t,value:r.record.value}))};yield*this.queryManager.run(e,r,i,t)}}class eq{constructor(e,t){const{network:n,peerRouting:r,queryManager:s,routingTable:i,providers:o,lan:a}=t;this.components=e,this.log=x(`libp2p:kad-dht:${a?"lan":"wan"}:content-routing`),this.network=n,this.peerRouting=r,this.queryManager=s,this.routingTable=i,this.providers=o}async*provide(e,t,n={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.peerId);const r=new BH(DH.ADD_PROVIDER,e.multihash.bytes,0);r.providerPeers=[{id:this.components.peerId,multiaddrs:t,protocols:[]}];let s=0;const i=t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const i=[];this.log("putProvider %s to %p",e,t.peer.id);try{this.log("sending provider record for %s to %p",e,t.peer.id);for await(const o of this.network.sendMessage(t.peer.id,r,n))"PEER_RESPONSE"===o.name&&(this.log("sent provider record for %s to %p",e,t.peer.id),s++),i.push(o)}catch(rb){this.log.error("error sending provide record to peer %p",t.peer.id,rb),i.push(zH({from:t.peer.id,error:rb}))}return i};yield*dd(this.peerRouting.getClosestPeers(e.multihash.bytes,n),(e=>_f(e,(e=>i(e)))),(e=>vf(e,{ordered:!1,concurrency:sH})),(async function*(e){for await(const t of e)yield*t})),this.log("sent provider records to %d peers",s)}async*findProviders(e,t){const n=this.routingTable.kBucketSize,r=e.multihash.bytes,s=await fH(r),i=this;this.log("findProviders %c",e);const o=await this.providers.getProviders(e);if(o.length>0){const e=[];for(const t of o.slice(0,n))e.push({id:t,multiaddrs:(await this.components.peerStore.addressBook.get(t)??[]).map((e=>e.multiaddr)),protocols:[]});yield jH({from:this.components.peerId,messageType:DH.GET_PROVIDERS,providers:e}),yield $H({from:this.components.peerId,providers:e})}if(o.length>=n)return;const a=async function*({peer:e,signal:t}){const n=new BH(DH.GET_PROVIDERS,r,0);yield*i.network.sendRequest(e,n,{signal:t})},c=new Set(o.map((e=>e.toString())));for await(const l of this.queryManager.run(r,this.routingTable.closestPeers(s),a,t))if(yield l,"PEER_RESPONSE"===l.name){this.log("Found %d provider entries for %c and %d closer peers",l.providers.length,e,l.closer.length);const t=[];for(const e of l.providers)c.has(e.id.toString())||(c.add(e.id.toString()),t.push(e));if(t.length>0&&(yield $H({from:l.from,providers:t})),c.size===n)return}}}class tq{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map((e=>e.peerId))}async add(e){if(null!=this.peerDistances.find((t=>t.peerId.equals(e))))return;const t=await pH(e),n={peerId:e,distance:TH(this.originDhtKey,t)};this.peerDistances.push(n),this.peerDistances.sort(((e,t)=>qT(e.distance,t.distance))),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(0===e.length)return!1;if(0===this.length)return!0;const t=await Promise.all(e.map(pH)),n=this.peerDistances[this.peerDistances.length-1].distance;for(const r of t){const e=TH(this.originDhtKey,r);if(qT(e,n)<0)return!0}return!1}}class nq{constructor(e,t){const{routingTable:n,network:r,validators:s,queryManager:i,lan:o}=t;this.components=e,this.routingTable=n,this.network=r,this.validators=s,this.queryManager=i,this.log=x(`libp2p:kad-dht:${o?"lan":"wan"}:peer-routing`)}async findPeerLocal(e){let t;const n=await this.routingTable.find(e);if(null!=n){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.peerStore.get(n)}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}}if(null==t)try{t=await this.components.peerStore.get(e)}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}async*_getValueSingle(e,t,n={}){const r=new BH(DH.GET_VALUE,t,0);yield*this.network.sendRequest(e,r,n)}async*getPublicKeyFromNode(e,t={}){const n=yH(e);for await(const r of this._getValueSingle(e,n,t))if(yield r,"PEER_RESPONSE"===r.name&&null!=r.record){const t=await ko(ju({bytes:r.record.value}));if(!t.equals(e))throw B(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(null==t.publicKey)throw B(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield KH({from:e,value:t.publicKey})}throw B(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(e,t={}){this.log("findPeer %p",e);const n=await this.findPeerLocal(e);if(null!=n)return this.log("found local"),void(yield VH({from:this.components.peerId,peer:n}));const r=await pH(e),s=this.routingTable.closestPeers(r),i=s.find((t=>t.equals(e)));if(null!=i)try{const t=await this.components.peerStore.get(e);return this.log("found in peerStore"),void(yield VH({from:this.components.peerId,peer:{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr)),protocols:[]}}))}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}const o=this,a=async function*({peer:t,signal:n}){const r=new BH(DH.FIND_NODE,e.toBytes(),0);for await(const s of o.network.sendRequest(t,r,{signal:n}))if(yield s,"PEER_RESPONSE"===s.name){const t=s.closer.find((t=>t.id.equals(e)));null!=t&&(yield VH({from:s.from,peer:t}))}};let c=!1;for await(const l of this.queryManager.run(e.toBytes(),s,a,t))"FINAL_PEER"===l.name&&(c=!0),yield l;c||(yield zH({from:this.components.peerId,error:B(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,t={}){this.log("getClosestPeers to %b",e);const n=await fH(e),r=this.routingTable.closestPeers(n),s=this,i=new tq(n,this.routingTable.kBucketSize);await Promise.all(r.map((async e=>await i.add(e))));const o=async function*({peer:t,signal:n}){s.log("closerPeersSingle %s from %p",Fn(e,"base32"),t);const r=new BH(DH.FIND_NODE,e,0);yield*s.network.sendRequest(t,r,{signal:n})};for await(const a of this.queryManager.run(e,r,o,t))yield a,"PEER_RESPONSE"===a.name&&await Promise.all(a.closer.map((async e=>await i.add(e.id))));this.log("found %d peers close to %b",i.length,e);for(const a of i.peers)yield VH({from:this.components.peerId,peer:{id:a,multiaddrs:(await this.components.peerStore.addressBook.get(a)??[]).map((e=>e.multiaddr)),protocols:[]}})}async*getValueOrPeers(e,t,n={}){for await(const r of this._getValueSingle(e,t,n)){if("PEER_RESPONSE"===r.name&&null!=r.record)try{await this._verifyRecordOnline(r.record)}catch(rb){const t="invalid record received, discarded";this.log(t),yield zH({from:r.from,error:B(new Error(t),"ERR_INVALID_RECORD")});continue}yield r}}async _verifyRecordOnline(e){if(null==e.timeReceived)throw B(new Error("invalid record received"),"ERR_INVALID_RECORD");await WH(this.validators,new kd(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const n=await fH(e),r=this.routingTable.closestPeers(n),s=[];for(const i of r)if(!i.equals(t))try{const e=await this.components.peerStore.addressBook.get(i),t=await this.components.peerStore.protoBook.get(i);s.push({id:i,multiaddrs:e.map((e=>e.multiaddr)),protocols:t})}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}return s.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",s.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,t),s}}const rq=x("libp2p:kad-dht:providers");class sq{constructor(e,t={}){const{cacheSize:n,cleanupInterval:r,provideValidity:s}=t;this.components=e,this.cleanupInterval=r??nH,this.provideValidity=s??tH,this.cache=ci(n??eH),this.syncQueue=new Yi({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval((()=>{this._cleanup().catch((e=>{rq.error(e)}))}),this.cleanupInterval))}async stop(){this.started=!1,null!=this.cleaner&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add((async()=>{const e=Date.now();let t=0,n=0;const r=new Map,s=this.components.datastore.batch(),i=this.components.datastore.query({prefix:ZK});for await(const o of i)try{const{cid:e,peerId:i}=aq(o.key),a=lq(o.value).getTime(),c=Date.now(),l=c-a,u=l>this.provideValidity;if(rq("comparing: %d - %d = %d > %d %s",c,a,l,this.provideValidity,u?"(expired)":""),u){n++,s.delete(o.key);const t=r.get(e)??new Set;t.add(i),r.set(e,t)}t++}catch(rb){rq.error(rb.message)}r.size>0?(rq("deleting %d / %d entries",n,t),await s.commit()):rq("nothing to delete");for(const[o,a]of r){const e=iq(o),t=this.cache.get(e);if(null!=t){for(const e of a)t.delete(e);0===t.size?this.cache.remove(e):this.cache.set(e,t)}}rq("Cleanup successful (%dms)",Date.now()-e)}))}async _getProvidersMap(e){const t=iq(e);let n=this.cache.get(t);return null==n&&(n=await cq(this.components.datastore,e),this.cache.set(t,n)),n}async addProvider(e,t){return await this.syncQueue.add((async()=>{rq("%p provides %s",t,e);const n=await this._getProvidersMap(e);rq("loaded %s provs",n.size);const r=new Date;n.set(t.toString(),r);const s=iq(e);this.cache.set(s,n),await oq(this.components.datastore,e,t,r)}))}async getProviders(e){return await this.syncQueue.add((async()=>{rq("get providers for %s",e);const t=await this._getProvidersMap(e);return[...t.keys()].map((e=>_o(e)))}))}}function iq(e){const t="string"===typeof e?e:Fn(e.multihash.bytes,"base32");return`${ZK}/${t}`}async function oq(e,t,n,r){const s=[iq(t),"/",n.toString()].join(""),i=new Bs(s),o=Uint8Array.from(Qn.encode(r.getTime()));return await e.put(i,o)}function aq(e){const t=e.toString().split("/");if(5!==t.length)throw new Error(`incorrectly formatted provider entry key in datastore: ${e.toString()}`);return{cid:t[3],peerId:t[4]}}async function cq(e,t){const n=new Map,r=e.query({prefix:iq(t)});for await(const s of r){const{peerId:e}=aq(s.key);n.set(e,lq(s.value))}return n}function lq(e){return new Date(Qn.decode(e))}const uq=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*hq(e){const{key:t,startingPeer:n,ourPeerId:r,signal:s,query:i,alpha:o,pathIndex:a,numPaths:c,cleanUp:l,queryFuncTimeout:u,log:h,peersSeen:d}=e,f=new Yi({concurrency:o}),p=await fH(t);function g(e,n){if(null==e)return;d.add(e);const o=BigInt("0x"+Fn(TH(n,p),"base16"));f.add((async()=>{let n;const l=[s];null!=u&&(n=new Tn.TimeoutController(u),l.push(n.signal));const y=(0,js.anySignal)(l);try{for await(const n of i({key:t,peer:e,signal:y,pathIndex:a,numPaths:c})){if(y.aborted)return;if("PEER_RESPONSE"===n.name)for(const s of n.closer){if(d.has(s.id)){h("already seen %p in query",s.id);continue}if(r.equals(s.id)){h("not querying ourselves");continue}const n=await pH(s.id),i=BigInt("0x"+Fn(TH(n,p),"base16"));i>o?h("skipping %p as they are not closer to %b than %p",s.id,t,e):(h("querying closer peer %p",s.id),g(s.id,n))}f.emit("completed",n)}n?.clear()}catch(rb){s.aborted?f.emit("error",rb):f.emit("completed",zH({from:e,error:rb}))}finally{n?.clear()}}),{priority:uq-o}).catch((e=>{h.error(e)}))}g(n,await pH(n)),yield*dq(f,s,l,h)}async function*dq(e,t,n,r){let s=wf(),i=!0;const o=[],a=()=>{i&&(r("clean up queue, results %d, queue size %d, pending tasks %d",o.length,e.size,e.pending),i=!1,e.clear(),o.splice(0,o.length))};e.on("completed",(e=>{o.push(e),s.resolve()})),e.on("error",(e=>{r("queue error",e),a(),s.reject(e)})),e.on("idle",(()=>{r("queue idle"),i=!1,s.resolve()})),t.addEventListener("abort",(()=>{r("abort queue");const e=i;a(),e&&s.reject(B(new Error("Query aborted"),"ERR_QUERY_ABORTED"))})),n.addEventListener("cleanup",(()=>{a(),s.resolve()}));while(i){await s.promise,s=wf();while(o.length>0){const e=o.shift();null!=e&&(yield e)}}yield*o}class fq{constructor(e,t){const{lan:n=!1,disjointPaths:r=rH,alpha:s=sH}=t;this.components=e,this.disjointPaths=r??rH,this.controllers=new Set,this.running=!1,this.alpha=s??sH,this.lan=n,this.queries=0}isStarted(){return this.running}async start(){this.running=!0,null!=this.components.metrics&&null==this.metrics&&(this.metrics={runningQueries:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_running_queries`),queryTime:this.components.metrics.registerMetric(`libp2p_kad_dht_${this.lan?"lan":"wan"}_query_time_seconds`)})}async stop(){this.running=!1;for(const e of this.controllers)e.abort();this.controllers.clear()}async*run(e,t,n,r={}){if(!this.running)throw new Error("QueryManager not started");const s=this.metrics?.queryTime.timer();let i;if(null==r.signal){i=new Tn.TimeoutController(lH),r.signal=i.signal;try{null!=oj.setMaxListeners&&(0,oj.setMaxListeners)(1/0,i.signal)}catch{}}const o=new AbortController;this.controllers.add(o);const a=[o.signal];null!=r.signal&&a.push(r.signal);const c=(0,js.anySignal)(a);try{null!=oj.setMaxListeners&&(0,oj.setMaxListeners)(1/0,c)}catch{}const l=x(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+Fn(e,"base58btc")),u=t.slice(0,Math.min(this.disjointPaths,t.length)),h=Date.now(),d=new iN;try{if(l("query:start"),this.queries++,this.metrics?.runningQueries.update(this.queries),0===t.length)return void l.error("Running query with no peers");const a=new Ej,f=u.map(((t,s)=>hq({key:e,startingPeer:t,ourPeerId:this.components.peerId,signal:c,query:n,pathIndex:s,numPaths:u.length,alpha:this.alpha,cleanUp:d,queryFuncTimeout:r.queryFuncTimeout,log:l,peersSeen:a})));for await(const e of ad(...f))yield e,"QUERY_ERROR"===e.name&&l("error",e.error)}catch(rb){if(this.running||"ERR_QUERY_ABORTED"!==rb.code)throw rb}finally{this.controllers.delete(o),null!=i&&i.clear(),this.queries--,this.metrics?.runningQueries.update(this.queries),null!=s&&s(),d.dispatchEvent(new aN("cleanup")),l("query:done in %dms",Date.now()-h)}}}const pq=x("libp2p:kad-dht:rpc:handlers:add-provider");class gq{constructor(e){const{providers:t}=e;this.providers=t}async handle(e,t){if(pq("start"),null==t.key||0===t.key.length)throw B(new Error("Missing key"),"ERR_MISSING_KEY");let n;try{n=X.k0.decode(t.key)}catch(rb){throw B(new Error("Invalid CID"),"ERR_INVALID_CID")}null!=t.providerPeers&&0!==t.providerPeers.length||pq.error("no providers found in message"),await Promise.all(t.providerPeers.map((async t=>{t.id.equals(e)?t.multiaddrs.length<1?pq("no valid addresses for provider %p. Ignore",e):(pq("received provider %p for %s (addrs %s)",e,n,t.multiaddrs.map((e=>e.toString()))),await this.providers.addProvider(n,t.id)):pq("invalid provider peer %p from %p",t.id,e)})))}}const yq=x("libp2p:kad-dht:rpc:handlers:find-node");class mq{constructor(e,t){const{peerRouting:n,lan:r}=t;this.components=e,this.peerRouting=n,this.lan=Boolean(r)}async handle(e,t){yq("incoming request from %p for peers closer to %b",e,t.key);let n=[];n=Pr(this.components.peerId.toBytes(),t.key)?[{id:this.components.peerId,multiaddrs:this.components.addressManager.getAddresses().map((e=>e.decapsulateCode(Yn("p2p").code))),protocols:[]}]:await this.peerRouting.getCloserPeersOffline(t.key,e),n=n.map(this.lan?dH:hH).filter((({multiaddrs:e})=>e.length));const r=new BH(t.type,new Uint8Array(0),t.clusterLevel);return n.length>0?r.closerPeers=n:yq("could not find any peers closer to %b than %p",t.key,e),r}}const wq=x("libp2p:kad-dht:rpc:handlers:get-providers");class bq{constructor(e,t){const{peerRouting:n,providers:r,lan:s}=t;this.components=e,this.peerRouting=n,this.providers=r,this.lan=Boolean(s)}async handle(e,t){let n;try{n=X.k0.decode(t.key)}catch(rb){throw B(new Error("Invalid CID"),"ERR_INVALID_CID")}wq("%p asking for providers for %s",e,n);const[r,s]=await Promise.all([this.providers.getProviders(n),this.peerRouting.getCloserPeersOffline(t.key,e)]),i=await this._getPeers(r),o=await this._getPeers(s.map((({id:e})=>e))),a=new BH(t.type,t.key,t.clusterLevel);return i.length>0&&(a.providerPeers=i),o.length>0&&(a.closerPeers=o),wq("got %s providers %s closerPeers",i.length,o.length),a}async _getAddresses(e){const t=await this.components.peerStore.addressBook.get(e);return t.map((e=>e.multiaddr))}async _getPeers(e){const t=[],n=this.lan?dH:hH;for(const r of e){const e=n({id:r,multiaddrs:await this._getAddresses(r),protocols:[]});e.multiaddrs.length>0&&t.push(e)}return t}}const vq=x("libp2p:kad-dht:rpc:handlers:get-value");class _q{constructor(e,t){const{peerRouting:n}=t;this.components=e,this.peerRouting=n}async handle(e,t){const n=t.key;if(vq("%p asked for key %b",e,n),null==n||0===n.length)throw B(new Error("Invalid key"),"ERR_INVALID_KEY");const r=new BH(DH.GET_VALUE,n,t.clusterLevel);if(mH(n)){vq("is public key");const e=wH(n);let t;try{const n=await this.components.peerStore.keyBook.get(e);if(null==n)throw B(new Error("No public key found in key book"),"ERR_NOT_FOUND");t=n}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}if(null!=t)return vq("returning found public key"),r.record=new kd(n,t,new Date),r}const[s,i]=await Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(t.key,e)]);return null!=s&&(vq("had record for %b in local datastore",n),r.record=s),i.length>0&&(vq("had %s closer peers in routing table",i.length),r.closerPeers=i),r}async _checkLocalDatastore(e){vq("checkLocalDatastore looking for %b",e);const t=gH(e);let n;try{n=await this.components.datastore.get(t)}catch(rb){if("ERR_NOT_FOUND"===rb.code)return;throw rb}const r=kd.deserialize(n);if(null==r)throw B(new Error("Invalid record"),"ERR_INVALID_RECORD");if(!(null==r.timeReceived||Date.now()-r.timeReceived.getTime()>GK))return r;await this.components.datastore.delete(t)}}const Eq=x("libp2p:kad-dht:rpc:handlers:ping");class Sq{async handle(e,t){return Eq("ping from %p",e),t}}class kq{constructor(e,t){const{validators:n}=t;this.components=e,this.log=x("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=n}async handle(e,t){const n=t.key;this.log("%p asked us to store value for key %b",e,n);const r=t.record;if(null==r){const t=`Empty record from: ${e.toString()}`;throw this.log.error(t),B(new Error(t),"ERR_EMPTY_RECORD")}try{await WH(this.validators,r),r.timeReceived=new Date;const e=gH(r.key);await this.components.datastore.put(e,r.serialize().subarray()),this.log("put record for %b into datastore under key %k",n,e)}catch(rb){this.log("did not put record for key %b into datastore %o",n,rb)}return t}}class Iq{constructor(e,t){const{providers:n,peerRouting:r,validators:s,lan:i}=t;this.log=x("libp2p:kad-dht:rpc"),this.routingTable=t.routingTable,this.handlers={[DH.GET_VALUE]:new _q(e,{peerRouting:r}),[DH.PUT_VALUE]:new kq(e,{validators:s}),[DH.FIND_NODE]:new mq(e,{peerRouting:r,lan:i}),[DH.ADD_PROVIDER]:new gq({providers:n}),[DH.GET_PROVIDERS]:new bq(e,{peerRouting:r,providers:n,lan:i}),[DH.PING]:new Sq}}async handleMessage(e,t){try{await this.routingTable.add(e)}catch(rb){this.log.error("Failed to update the kbucket store",rb)}const n=this.handlers[t.type];if(null!=n)return await n.handle(e,t);this.log.error(`no handler found for message type: ${t.type}`)}onIncomingStream(e){Promise.resolve().then((async()=>{const{stream:t,connection:n}=e,r=n.remotePeer;try{await this.routingTable.add(r)}catch(rb){this.log.error(rb)}const s=this;await dd(t,nD(),(async function*(e){for await(const t of e){const e=BH.deserialize(t);s.log("incoming %s from %p",e.type,r);const n=await s.handleMessage(r,e);null!=n&&(yield n.serialize())}}),XO(),t)})).catch((e=>{this.log.error(e)}))}}class Aq extends iN{constructor(e,t){super();const{protocol:n,lan:r}=t;this.components=e,this.log=x("libp2p:kad-dht:topology-listener:"+(r?"lan":"wan")),this.running=!1,this.protocol=n}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;const e=nN({onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new aN("peer",{detail:e}))}});this.registrarId=await this.components.registrar.register(this.protocol,e)}stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class Tq{constructor(e,t){const{peerRouting:n,lan:r,count:s,interval:i,queryTimeout:o}=t;this.components=e,this.log=x(`libp2p:kad-dht:${r?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=n,this.count=s??rH,this.interval=i??iH,this.queryTimeout=o??oH}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}_querySelf(){Promise.resolve().then((async()=>{const e=new Tn.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;const t=(0,js.anySignal)([this.controller.signal,e.signal]);try{null!=oj.setMaxListeners&&(0,oj.setMaxListeners)(1/0,t)}catch{}const n=await dd(this.peerRouting.getClosestPeers(this.components.peerId.toBytes(),{signal:t}),(e=>Wh(e,this.count)),(async e=>await RT(e)));this.log("query ran successfully - found %d peers",n)}catch(rb){this.log("query error",rb)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),e.clear()}})).catch((e=>{this.log("query error",e)}))}}const Rq=32,Cq=64;class Pq extends iN{constructor(e,t){super();const{kBucketSize:n,clientMode:r,validators:s,selectors:i,querySelfInterval:o,lan:a,protocolPrefix:c,pingTimeout:l,pingConcurrency:u,maxInboundStreams:h,maxOutboundStreams:d,providers:f}=t;this.running=!1,this.components=e,this.lan=Boolean(a),this.log=x("libp2p:kad-dht:"+(!0===a?"lan":"wan")),this.protocol=`${c??QK}${!0===a?YK:""}${XK}`,this.kBucketSize=n??20,this.clientMode=r??!0,this.maxInboundStreams=h??Rq,this.maxOutboundStreams=d??Cq,this.routingTable=new AH(e,{kBucketSize:n,lan:this.lan,pingTimeout:l,pingConcurrency:u,protocol:this.protocol}),this.providers=new sq(e,f??{}),this.validators={...YH,...s},this.selectors={...JH,...i},this.network=new qH(e,{protocol:this.protocol,lan:this.lan}),this.queryManager=new fq(e,{disjointPaths:Math.ceil(this.kBucketSize/2),lan:a}),this.peerRouting=new nq(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new ZH(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new eq(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new PH({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new Iq(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new Aq(e,{protocol:this.protocol,lan:this.lan}),this.querySelf=new Tq(e,{peerRouting:this.peerRouting,interval:o,lan:this.lan}),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new aN("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.addressBook.get(t),n={id:t,multiaddrs:e.map((e=>e.multiaddr)),protocols:[]};await this.onPeerConnect(n)})).catch((e=>{this.log.error("could not add %p to routing table",t,e)}))}))}get[HF](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}async onPeerConnect(e){if(this.log("peer %p connected with protocols %s",e.id,e.protocols),e=this.lan?dH(e):hH(e),0!==e.multiaddrs.length)try{await this.routingTable.add(e.id)}catch(rb){this.log.error("could not add %p to routing table",e.id,rb)}else this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.registrar.unhandle(this.protocol),"client"===e?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(e,t,n={}){yield*this.contentFetching.put(e,t,n)}async*get(e,t={}){yield*this.contentFetching.get(e,t)}async*provide(e,t={}){yield*this.contentRouting.provide(e,this.components.addressManager.getAddresses(),t)}async*findProviders(e,t={}){yield*this.contentRouting.findProviders(e,t)}async*findPeer(e,t={}){yield*this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={}){yield*this.peerRouting.getClosestPeers(e,t)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}}const Nq=x("libp2p:kad-dht");class Oq extends iN{constructor(e,t,n){super(),this.components=e,this.wan=t,this.lan=n,this.wan.addEventListener("peer",(e=>{this.dispatchEvent(new aN("peer",{detail:e.detail}))})),this.lan.addEventListener("peer",(e=>{this.dispatchEvent(new aN("peer",{detail:e.detail}))}))}get[HF](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,t,n={}){for await(const r of ad(this.lan.put(e,t,n),this.wan.put(e,t,n)))yield r}async*get(e,t={}){let n=!1,r=!1;for await(const s of ad(this.lan.get(e,t),this.wan.get(e,t)))yield s,"DIALING_PEER"===s.name&&(n=!0),"VALUE"===s.name&&(n=!0,null!=s.value&&(r=!0)),"SENDING_QUERY"===s.name&&(n=!0);if(!n)throw B(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");r||(yield zH({from:this.components.peerId,error:B(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,t={}){let n=0,r=0;const s=[],i=[this.lan];"server"===await this.wan.getMode()&&i.push(this.wan);for await(const o of ad(...i.map((n=>n.provide(e,t)))))yield o,"SENDING_QUERY"===o.name&&n++,"QUERY_ERROR"===o.name&&s.push(o.error),"PEER_RESPONSE"===o.name&&"ADD_PROVIDER"===o.messageName&&(Nq("sent provider record for %s to %p",e,o.from),r++);if(0===r){if(s.length>0)throw B(new Error(`Failed to provide to ${s.length} of ${n} peers`),"ERR_PROVIDES_FAILED",{errors:s});throw B(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}}async*findProviders(e,t={}){yield*ad(this.lan.findProviders(e,t),this.wan.findProviders(e,t))}async*findPeer(e,t={}){let n=!1;for await(const r of ad(this.lan.findPeer(e,t),this.wan.findPeer(e,t)))yield r,"SENDING_QUERY"!==r.name&&"FINAL_PEER"!==r.name||(n=!0);if(!n)throw B(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,t={}){yield*ad(this.lan.getClosestPeers(e,t),this.wan.getClosestPeers(e,t))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}}class Dq extends Oq{constructor(e,t){super(e,new Pq(e,{protocolPrefix:"/ipfs",...t,lan:!1}),new Pq(e,{protocolPrefix:"/ipfs",...t,clientMode:!1,lan:!0}))}}function Lq(e){return t=>new Dq(t,e)}const xq=x("libp2p:bootstrap"),Bq="bootstrap",Mq=50,Uq=12e4,Fq=1e3;class jq extends iN{constructor(e,t={list:[]}){if(null==t.list||0===t.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=e,this.timeout=t.timeout??Fq,this.list=[];for(const n of t.list){if(!ds.matches(n)){xq.error("Invalid multiaddr");continue}const e=Hr(n),t=e.getPeerId();if(null==t){xq.error("Invalid bootstrap multiaddr without peer id");continue}const r={id:_o(t),multiaddrs:[e],protocols:[]};this.list.push(r)}this._init=t}get[HF](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(xq("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{xq.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const e of this.list){if(await this.components.peerStore.tagPeer(e.id,this._init.tagName??Bq,{value:this._init.tagValue??Mq,ttl:this._init.tagTTL??Uq}),null==this.timer)return;this.dispatchEvent(new aN("peer",{detail:e}))}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}function Vq(e){return t=>new jq(t,e)}jq.tag="bootstrap";var zq=WebSocket,$q=n(4772);function Kq(e){return e instanceof ArrayBuffer||"ArrayBuffer"===e?.constructor?.name&&"number"===typeof e?.byteLength}var Hq=e=>{e.binaryType="arraybuffer";const t=async()=>await new Promise(((t,n)=>{if(s)return t();if(null!=r)return n(r);const i=t=>{e.removeEventListener("open",o),e.removeEventListener("error",a),t()},o=()=>i(t),a=t=>{i((()=>n(t.error??new Error(`connect ECONNREFUSED ${e.url}`))))};e.addEventListener("open",o),e.addEventListener("error",a)})),n=async function*(){const n=new $q.zN((({push:t,stop:n,fail:r})=>{const s=e=>{let n=null;"string"===typeof e.data&&(n=An(e.data)),Kq(e.data)&&(n=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(n=e.data),null!=n&&t(n)},i=e=>r(e.error??new Error("Socket error"));return e.addEventListener("message",s),e.addEventListener("error",i),e.addEventListener("close",n),()=>{e.removeEventListener("message",s),e.removeEventListener("error",i),e.removeEventListener("close",n)}}),{highWaterMark:1/0});await t();for await(const e of n)yield Kq(e)?new Uint8Array(e):e}();let r,s=1===e.readyState;return e.addEventListener("open",(()=>{s=!0,r=null})),e.addEventListener("close",(()=>{s=!1,r=null})),e.addEventListener("error",(t=>{s||(r=t.error??new Error(`connect ECONNREFUSED ${e.url}`))})),Object.assign(n,{connected:t})},qq=e=>{if(e.readyState>=2)throw new Error("socket closed");if(1!==e.readyState)return new Promise(((t,n)=>{function r(){e.removeEventListener("open",s),e.removeEventListener("error",i)}function s(){r(),t()}function i(t){r(),n(t.error??new Error(`connect ECONNREFUSED ${e.url}`))}e.addEventListener("open",s),e.addEventListener("error",i)}))},Wq=(e,t)=>{t=t??{},t.closeOnEnd=!1!==t.closeOnEnd;const n=async n=>{for await(const t of n){try{await qq(e)}catch(rb){if("socket closed"===rb.message)break;throw rb}e.send(t)}if(null!=t.closeOnEnd&&e.readyState<=1)return await new Promise(((t,n)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});n(t)}})),setTimeout((()=>e.close()))}))};return n},Gq=(e,t)=>{t=t??{};const n=Hq(e);let r=t.remoteAddress,s=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);r=t.hostname,s=parseInt(t.port,10)}catch{}if(null==r||null==s)throw new Error("Remote connection did not have address and/or port");const i={sink:Wq(e,t),source:n,connected:async()=>await n.connected(),close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:r,remotePort:s,socket:e};return i};const Yq={http:"ws",https:"wss"},Qq="ws";var Xq=(e,t)=>(0,ws.relative)(e,t,Yq,Qq);function Jq(e,t){const n="undefined"===typeof window?"":window.location;t=t??{};const r=Xq(e,n.toString()),s=new zq(r,t.websocket);return Gq(s,t)}function Zq(){throw new Error("WebSocket Servers can not be created in the browser!")}const eW=421,tW=290,nW=6,rW=478,sW=2e3,iW=x("libp2p:websockets:socket");function oW(e,t,n){n=n??{};const r={async sink(t){null!=n?.signal&&(t=qO(t,n.signal));try{await e.sink(t)}catch(rb){"aborted"!==rb.type&&iW.error(rb)}},source:null!=n.signal?qO(e.source,n.signal):e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){const t=Date.now();try{await Tk(e.close(),{milliseconds:sW})}catch(rb){const{host:s,port:i}=r.remoteAddr.toOptions();iW("timeout closing stream to %s:%s after %dms, destroying it manually",s,i,Date.now()-t),e.destroy()}finally{r.timeline.close=Date.now()}}};return e.socket.addEventListener("close",(()=>{null==r.timeline.close&&(r.timeline.close=Date.now())}),{once:!0}),r}function aW(e){return e.filter((e=>{if(e.protoCodes().includes(tW))return!1;const t=e.decapsulateCode(eW);return ts.matches(t)||ns.matches(t)}))}function cW(e){return e.filter((e=>{if(e.protoCodes().includes(tW))return!1;const t=e.decapsulateCode(eW);return ns.matches(t)&&Yr.matches(t.decapsulateCode(nW).decapsulateCode(rW))}))}const lW=x("libp2p:websockets");class uW{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[$F](){return!0}async dial(e,t){lW("dialing %s",e),t=t??{};const n=await this._connect(e,t),r=oW(n,e);lW("new outbound connection %s",r.remoteAddr);const s=await t.upgrader.upgradeOutbound(r);return lW("outbound connection %s upgraded",r.remoteAddr),s}async _connect(e,t){if(!0===t?.signal?.aborted)throw new oo;const n=e.toOptions();lW("dialing %s:%s",n.host,n.port);const r=wf(),s=e=>{lW.error("connection error:",e),r.reject(e)},i=Jq(fk(e),this.init);if(null!=i.socket.on?i.socket.on("error",s):i.socket.onerror=s,null==t.signal)return await Promise.race([i.connected(),r.promise]),lW("connected %s",e),i;let o;const a=new Promise(((e,n)=>{if(o=()=>{n(new oo),i.close().catch((e=>{lW.error("error closing raw socket",e)}))},!0===t?.signal?.aborted)return o();t?.signal?.addEventListener("abort",o)}));try{await Promise.race([a,r.promise,i.connected()])}finally{null!=o&&t?.signal?.removeEventListener("abort",o)}return lW("connected %s",e),i}createListener(e){return Zq({...this.init,...e})}filter(e){return e=Array.isArray(e)?e:[e],null!=this.init?.filter?this.init?.filter(e):b$||S$?cW(e):aW(e)}}function hW(e={}){return()=>new uW(e)}function dW(e){return new Uint8Array(e)}var fW;(function(e){e[e["NEW_STREAM"]=0]="NEW_STREAM",e[e["MESSAGE_RECEIVER"]=1]="MESSAGE_RECEIVER",e[e["MESSAGE_INITIATOR"]=2]="MESSAGE_INITIATOR",e[e["CLOSE_RECEIVER"]=3]="CLOSE_RECEIVER",e[e["CLOSE_INITIATOR"]=4]="CLOSE_INITIATOR",e[e["RESET_RECEIVER"]=5]="RESET_RECEIVER",e[e["RESET_INITIATOR"]=6]="RESET_INITIATOR"})(fW||(fW={}));const pW=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),gW=Object.freeze({NEW_STREAM:fW.NEW_STREAM,MESSAGE:fW.MESSAGE_INITIATOR,CLOSE:fW.CLOSE_INITIATOR,RESET:fW.RESET_INITIATOR}),yW=Object.freeze({MESSAGE:fW.MESSAGE_RECEIVER,CLOSE:fW.CLOSE_RECEIVER,RESET:fW.RESET_RECEIVER}),mW=1048576,wW=(e,t)=>t.append(e);async function*bW(e,t={}){let n=new wp,r=!1,s=wf(),i=Number(t.size??mW);(isNaN(i)||0===i||i<0)&&(i=mW);const o=t.yieldAfter??0,a=t.serialize??wW;Promise.resolve().then((async()=>{try{let t;for await(const r of e)a(r,n),n.byteLength>=i?(clearTimeout(t),s.resolve()):t=setTimeout((()=>{s.resolve()}),o);clearTimeout(t),s.resolve()}catch(rb){s.reject(rb)}finally{r=!0}}));while(!r)if(await s.promise,s=wf(),n.byteLength>0){const e=n;n=new wp,yield e.subarray()}}var vW=bW;const _W=10240;class EW{constructor(){this._pool=dW(_W),this._poolOffset=0}write(e,t){const n=this._pool;let r=this._poolOffset;Qn.encode(e.id<<3|e.type,n,r),r+=Qn.encode.bytes??0,e.type!==fW.NEW_STREAM&&e.type!==fW.MESSAGE_INITIATOR&&e.type!==fW.MESSAGE_RECEIVER||null==e.data?Qn.encode(0,n,r):Qn.encode(e.data.length,n,r),r+=Qn.encode.bytes??0;const s=n.subarray(this._poolOffset,r);_W-r<100?(this._pool=dW(_W),this._poolOffset=0):this._poolOffset=r,t.append(s),e.type!==fW.NEW_STREAM&&e.type!==fW.MESSAGE_INITIATOR&&e.type!==fW.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}}const SW=new EW;async function*kW(e,t=0){if(null!=t&&0!==t)yield*vW(e,{size:t,serialize:(e,t)=>{for(const n of e)SW.write(n,t)}});else for await(const n of e){const e=new wp;for(const t of n)SW.write(t,e);yield e.subarray()}}const IW=1<<20,AW=4<<20;class TW{constructor(e=IW,t=AW){this._buffer=new wp,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const t=[];while(0!==this._buffer.length){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(rb){if("ERR_MSG_TOO_BIG"===rb.code)throw rb;break}const{id:e,type:n,length:r,offset:s}=this._headerInfo,i=this._buffer.length-s;if(i<r)break;const o={id:e,type:n};n!==fW.NEW_STREAM&&n!==fW.MESSAGE_INITIATOR&&n!==fW.MESSAGE_RECEIVER||(o.data=this._buffer.sublist(s,s+r)),t.push(o),this._buffer.consume(s+r),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:n}=PW(e),{value:r,offset:s}=PW(e,n),i=7&t;if(null==pW[i])throw new Error(`Invalid type received: ${i}`);if(r>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:t>>3,type:i,offset:n+s,length:r}}}const RW=128,CW=127;function PW(e,t=0){let n,r=0,s=0,i=t;const o=e.length;do{if(i>=o||s>49)throw t=0,new RangeError("Could not decode varint");n=e.get(i++),r+=s<28?(n&CW)<<s:(n&CW)*Math.pow(2,s),s+=7}while(n>=RW);return t=i-t,{value:r,offset:t}}const NW=x("libp2p:mplex:stream"),OW="ERR_STREAM_RESET",DW="ERR_STREAM_ABORT",LW="ERR_SINK_ENDED",xW="ERR_DOUBLE_SINK";function BW(e){const{id:t,name:n,send:r,onEnd:s,type:i="initiator",maxMsgSize:o=IW}=e,a=new AbortController,c=new AbortController,l=new AbortController,u="initiator"===i?gW:yW,h="initiator"===i?`i${t}`:`r${t}`,d=`${null==n?t:n}`;let f,p=!1,g=!1,y=!1;const m={open:Date.now()},w=e=>{p||(p=!0,NW.trace("%s stream %s source end - err: %o",i,d,e),null!=e&&null==f&&(f=e),g&&(_.stat.timeline.close=Date.now(),null!=s&&s(f)))},b=e=>{g||(g=!0,NW.trace("%s stream %s sink end - err: %o",i,d,e),null!=e&&null==f&&(f=e),p&&(m.close=Date.now(),null!=s&&s(f)))},v=Xh({onEnd:w}),_={close:()=>{NW.trace("%s stream %s close",i,d),_.closeRead(),_.closeWrite()},closeRead:()=>{NW.trace("%s stream %s closeRead",i,d),p||v.end()},closeWrite:()=>{if(NW.trace("%s stream %s closeWrite",i,d),!g){l.abort();try{r({id:t,type:u.CLOSE})}catch(rb){NW.trace("%s stream %s error sending close",i,n,rb)}b()}},abort:e=>{NW.trace("%s stream %s abort",i,d,e),v.end(e),a.abort(),b(e)},reset:()=>{const e=B(new Error("stream reset"),OW);c.abort(),v.end(e),b(e)},sink:async e=>{if(y)throw B(new Error("sink already called on stream"),xW);if(y=!0,g)throw B(new Error("stream closed for writing"),LW);e=qO(e,(0,js.anySignal)([a.signal,c.signal,l.signal]));try{"initiator"===i&&r({id:t,type:gW.NEW_STREAM,data:new wp(An(d))});for await(let n of e)while(n.length>0){if(n.length<=o){r({id:t,type:u.MESSAGE,data:n instanceof Uint8Array?new wp(n):n});break}n=n instanceof Uint8Array?new wp(n):n,r({id:t,type:u.MESSAGE,data:n.sublist(0,o)}),n.consume(o)}}catch(rb){if("aborted"===rb.type&&"The operation was aborted"===rb.message){if(l.signal.aborted)return;c.signal.aborted&&(rb.message="stream reset",rb.code=OW),a.signal.aborted&&(rb.message="stream aborted",rb.code=DW)}if(rb.code===OW)NW.trace("%s stream %s reset",i,n);else{NW.trace("%s stream %s error",i,n,rb);try{r({id:t,type:u.RESET})}catch(rb){NW.trace("%s stream %s error sending reset",i,n,rb)}}return v.end(rb),void b(rb)}try{r({id:t,type:u.CLOSE})}catch(rb){NW.trace("%s stream %s error sending close",i,n,rb)}b()},source:v,sourcePush:e=>{v.push(e)},sourceReadableLength(){return v.readableLength},stat:{direction:"initiator"===i?"outbound":"inbound",timeline:m},metadata:{},id:h};return _}const MW=x("libp2p:mplex"),UW=1024,FW=1024,jW=4194304,VW=5;function zW(e){const t={...e,type:`${pW[e.type]} (${e.type})`};return e.type===fW.NEW_STREAM&&(t.data=Fn(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==fW.MESSAGE_INITIATOR&&e.type!==fW.MESSAGE_RECEIVER||(t.data=Fn(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class $W{constructor(e){this.protocol="/mplex/6.7.0",e=e??{},this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=e,this.sink=this._createSink();const t=this._createSource();this._source=t,this.source=t,this.closeController=new AbortController,this.rateLimiter=new Ij.RateLimiterMemory({points:e.disconnectThreshold??VW,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const n=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:n})}close(e){this.closeController.signal.aborted||(null!=e?this.streams.forEach((t=>t.abort(e))):this.streams.forEach((e=>e.close())),this.closeController.abort())}_newReceiverStream(e){const{id:t,name:n}=e,r=this._streams.receivers;return this._newStream({id:t,name:n,type:"receiver",registry:r})}_newStream(e){const{id:t,name:n,type:r,registry:s}=e;if(MW("new %s stream %s",r,t),"initiator"===r&&this._streams.initiators.size===(this._init.maxOutboundStreams??FW))throw B(new Error("Too many outbound streams open"),"ERR_TOO_MANY_OUTBOUND_STREAMS");if(s.has(t))throw new Error(`${r} stream ${t} already exists!`);const i=e=>{MW.enabled&&MW.trace("%s stream %s send",r,t,zW(e)),this._source.push(e)},o=()=>{MW("%s stream with id %s and protocol %s ended",r,t,a.stat.protocol),s.delete(t),null!=this._init.onStreamEnd&&this._init.onStreamEnd(a)},a=BW({id:t,name:n,send:i,type:r,onEnd:o,maxMsgSize:this._init.maxMsgSize});return s.set(t,a),a}_createSink(){const e=async e=>{const t=[this.closeController.signal];null!=this._init.signal&&t.push(this._init.signal),e=qO(e,js(t));try{const t=new TW(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const n of e)for(const e of t.write(n))await this._handleIncoming(e);this._source.end()}catch(rb){MW("error in sink",rb),this._source.end(rb)}};return e}_createSource(){const e=e=>{this.close(e)},t=Jh({objectMode:!0,onEnd:e});return Object.assign(kW(t,this._init.minSendBytes),{push:t.push,end:t.end,return:t.return})}async _handleIncoming(e){const{id:t,type:n}=e;if(MW.enabled&&MW.trace("incoming message",zW(e)),e.type===fW.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??UW)){MW("too many inbound streams open"),this._source.push({id:t,type:fW.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{return MW("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this._source.end(new Error("Too many open streams"))}return}const n=this._newReceiverStream({id:t,name:Fn(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(n))}const r=1===(1&n)?this._streams.initiators:this._streams.receivers,s=r.get(t);if(null==s)return void MW("missing stream %s for message type %s",t,pW[n]);const i=this._init.maxStreamBufferSize??jW;switch(n){case fW.MESSAGE_INITIATOR:case fW.MESSAGE_RECEIVER:if(s.sourceReadableLength()>i){this._source.push({id:e.id,type:n===fW.MESSAGE_INITIATOR?fW.RESET_RECEIVER:fW.RESET_INITIATOR});const t=B(new Error("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");return void s.abort(t)}s.sourcePush(e.data);break;case fW.CLOSE_INITIATOR:case fW.CLOSE_RECEIVER:s.closeRead();break;case fW.RESET_INITIATOR:case fW.RESET_RECEIVER:s.reset();break;default:MW("unknown message type %s",n)}}}class KW{constructor(e={}){this.protocol="/mplex/6.7.0",this._init=e}createStreamMuxer(e={}){return new $W({...e,...this._init})}}function HW(e={}){return()=>new KW(e)}function qW(e,t={}){const n=zj(e),r=nD.fromReader(n.reader,t),s={read:async e=>{const{value:t}=await n.reader.next(e);if(null==t)throw new Error("Value is null");return t},readLP:async()=>{const{value:e}=await r.next();if(null==e)throw new Error("Value is null");return e},readPB:async e=>{const t=await s.readLP();if(null==t)throw new Error("Value is null");const n=t instanceof Uint8Array?t:t.subarray();return e.decode(n)},write:e=>{e instanceof Uint8Array?n.writer.push(e):n.writer.push(e.subarray())},writeLP:e=>{s.write(XO.single(e,t))},writePB:(e,t)=>{s.writeLP(t.encode(e))},pb:e=>({read:async()=>await s.readPB(e),write:t=>s.writePB(t,e)}),unwrap:()=>(n.rest(),n.stream)};return s}function WW(){const e=wf();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:async function*(){const t=await e.promise;yield*t}()}}function GW(){const e=WW(),t=WW();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}const YW=65535,QW=YW-16,XW=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);var JW=n(6711),ZW=n(2982),eG=n(4185),tG=n(2130);const nG={hashSHA256(e){return(0,eG.vp)(e)},getHKDF(e,t){const n=new JW.t(eG.mE,t,e),r=n.expand(96),s=r,i=s.subarray(0,32),o=s.subarray(32,64),a=s.subarray(64,96);return[i,o,a]},generateX25519KeyPair(){const e=ZW.Au();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){const t=ZW._w(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return ZW.gi(e,t)},chaCha20Poly1305Encrypt(e,t,n,r){const s=new tG.OK(r);return s.seal(t,e,n)},chaCha20Poly1305Decrypt(e,t,n,r,s){const i=new tG.OK(r);return i.open(t,e,n,s)}},rG=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),sG=e=>{const t=rG(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};sG.bytes=2;const iG=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};function oG(e){return Xn([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function aG(e){return Xn([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function cG(e){return Xn([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function lG(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function uG(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function hG(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}function dG(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=QW){let s=n+QW;s>r.length&&(s=r.length);const i=e.encrypt(r.subarray(n,s),e.session);t?.encryptedPackets.increment(),yield sG(i.byteLength),yield i}}}function fG(e,t){return async function*(n){for await(const r of n)for(let n=0;n<r.length;n+=YW){let s=n+YW;if(s>r.length&&(s=r.length),s-tG.pg<n)throw new Error("Invalid chunk");const i=r.subarray(n,s),o=r.subarray(n,s-tG.pg),{plaintext:a,valid:c}=e.decrypt(i,e.session,o);if(!c)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield a}}}iG.bytes=2;class pG extends Error{constructor(e="Unexpected Peer"){super(e),this.code=pG.code}static get code(){return"ERR_UNEXPECTED_PEER"}}class gG extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=gG.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}}class yG extends Error{constructor(e="Invalid crypto transmission"){super(e),this.code=yG.code}static get code(){return"ERR_INVALID_CRYPTO_TRANSMISSION"}}var mG,wG;async function bG(e,t,n){const r=await _G(e,kG(t));if(null==e.publicKey)throw new Error("PublicKey was missing from local PeerId");return vG(e.publicKey,r,n)}function vG(e,t,n){return wG.encode({identityKey:e,identitySig:t,extensions:n??{webtransportCerthashes:[]}}).subarray()}async function _G(e,t){if(null==e.privateKey)throw new Error("PrivateKey was missing from PeerId");const n=await Vu(e.privateKey);return await n.sign(t)}async function EG(e){return await ko(e.identityKey)}function SG(e){return wG.decode(e)}function kG(e){const t=An("noise-libp2p-static-key:");return Xn([t,e],t.length+e.length)}async function IG(e,t,n){const r=await ko(t.identityKey);if(!r.equals(n))throw new Error("Peer ID doesn't match libp2p public key.");const s=kG(e);if(null==r.publicKey)throw new Error("PublicKey was missing from PeerId");if(null==t.identitySig)throw new Error("Signature was missing from message");const i=Fu(r.publicKey),o=await i.verify(s,t.identitySig);if(!o)throw new Error("Static key doesn't match to peer that signed payload!");return r}function AG(e){return e instanceof Uint8Array&&32===e.length}(function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={webtransportCerthashes:[]},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.webtransportCerthashes.push(e.bytes());break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())})(mG||(mG={})),function(e){let t;e.codec=()=>(null==t&&(t=da(((e,t,n={})=>{!1!==n.lengthDelimited&&t.fork(),(!0===n.writeDefaults||null!=e.identityKey&&e.identityKey.byteLength>0)&&(t.uint32(10),t.bytes(e.identityKey)),(!0===n.writeDefaults||null!=e.identitySig&&e.identitySig.byteLength>0)&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),mG.codec().encode(e.extensions,t,{writeDefaults:!1})),!1!==n.lengthDelimited&&t.ldelim()}),((e,t)=>{const n={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},r=null==t?e.len:e.pos+t;while(e.pos<r){const t=e.uint32();switch(t>>>3){case 1:n.identityKey=e.bytes();break;case 2:n.identitySig=e.bytes();break;case 4:n.extensions=mG.codec().decode(e,e.uint32());break;default:e.skipType(7&t);break}}return n}))),t),e.encode=t=>sa(t,e.codec()),e.decode=t=>ra(t,e.codec())}(wG||(wG={}));const TG=x("libp2p:noise");let RG;function CG(e){RG(`LOCAL_STATIC_PUBLIC_KEY ${Fn(e.publicKey,"hex")}`),RG(`LOCAL_STATIC_PRIVATE_KEY ${Fn(e.privateKey,"hex")}`)}function PG(e){e?(RG(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Fn(e.publicKey,"hex")}`),RG(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Fn(e.privateKey,"hex")}`)):RG("Missing local ephemeral keys.")}function NG(e){RG(`REMOTE_STATIC_PUBLIC_KEY ${Fn(e,"hex")}`)}function OG(e){RG(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Fn(e,"hex")}`)}function DG(e){e.cs1&&e.cs2?(RG(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${Fn(e.cs1.k,"hex")}`),RG(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${Fn(e.cs2.k,"hex")}`)):RG("Missing cipher state.")}RG=XW?TG:Object.assign((()=>{}),{enabled:!1,trace:()=>{},error:()=>{}});const LG=0,xG=4294967295,BG="Cipherstate has reached maximum n, a new handshake must be performed";class MG{constructor(e=LG){this.n=e,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>xG)throw new Error(BG)}}class UG{constructor(e){this.crypto=e}encryptWithAd(e,t,n){const r=this.encrypt(e.k,e.n,t,n);return e.n.increment(),r}decryptWithAd(e,t,n,r){const{plaintext:s,valid:i}=this.decrypt(e.k,e.n,t,n,r);return i&&e.n.increment(),{plaintext:s,valid:i}}hasKey(e){return!this.isEmptyKey(e.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){const t=this.createEmptyKey();return Pr(t,e)}encrypt(e,t,n,r){return t.assertValue(),this.crypto.chaCha20Poly1305Encrypt(r,t.getBytes(),n,e)}encryptAndHash(e,t){let n;return n=this.hasKey(e.cs)?this.encryptWithAd(e.cs,e.h,t):t,this.mixHash(e,n),n}decrypt(e,t,n,r,s){t.assertValue();const i=this.crypto.chaCha20Poly1305Decrypt(r,t.getBytes(),n,e,s);return i?{plaintext:i,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,t){let n,r=!0;return this.hasKey(e.cs)?({plaintext:n,valid:r}=this.decryptWithAd(e.cs,e.h,t)):n=t,this.mixHash(e,t),{plaintext:n,valid:r}}dh(e,t){try{const n=this.crypto.generateX25519SharedKey(e,t);return 32===n.length?n:n.subarray(0,32)}catch(n){const e=n;return TG(e.message),new Uint8Array(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){const n=this.crypto.hashSHA256(Xn([e,t],e.length+t.length));return n}mixKey(e,t){const[n,r]=this.crypto.getHKDF(e.ck,t);e.cs=this.initializeKey(r),e.ck=n}initializeKey(e){return{k:e,n:new MG}}initializeSymmetric(e){const t=An(e,"utf-8"),n=this.hashProtocolName(t),r=n,s=this.createEmptyKey(),i=this.initializeKey(s);return{cs:i,ck:r,h:n}}hashProtocolName(e){if(e.length<=32){const t=new Uint8Array(32);return t.set(e),t}return this.getHash(e,new Uint8Array(0))}split(e){const[t,n]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),r=this.initializeKey(t),s=this.initializeKey(n);return{cs1:r,cs2:s}}writeMessageRegular(e,t){const n=this.encryptWithAd(e,new Uint8Array(0),t),r=this.createEmptyKey(),s=new Uint8Array(0);return{ne:r,ns:s,ciphertext:n}}readMessageRegular(e,t){return this.decryptWithAd(e,new Uint8Array(0),t.ciphertext)}}class FG extends UG{initializeInitiator(e,t,n,r){const s="Noise_XX_25519_ChaChaPoly_SHA256",i=this.initializeSymmetric(s);this.mixHash(i,e);const o=new Uint8Array(32);return{ss:i,s:t,rs:n,psk:r,re:o}}initializeResponder(e,t,n,r){const s="Noise_XX_25519_ChaChaPoly_SHA256",i=this.initializeSymmetric(s);this.mixHash(i,e);const o=new Uint8Array(32);return{ss:i,s:t,rs:n,psk:r,re:o}}writeMessageA(e,t,n){const r=new Uint8Array(0);e.e=void 0!==n?n:this.crypto.generateX25519KeyPair();const s=e.e.publicKey;this.mixHash(e.ss,s);const i=this.encryptAndHash(e.ss,t);return{ne:s,ns:r,ciphertext:i}}writeMessageB(e,t){e.e=this.crypto.generateX25519KeyPair();const n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const r=e.s.publicKey,s=this.encryptAndHash(e.ss,r);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const i=this.encryptAndHash(e.ss,t);return{ne:n,ns:s,ciphertext:i}}writeMessageC(e,t){const n=e.s.publicKey,r=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));const s=this.encryptAndHash(e.ss,t),i=this.createEmptyKey(),o={ne:i,ns:r,ciphertext:s},{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,messageBuffer:o,cs1:a,cs2:c}}readMessageA(e,t){return AG(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(AG(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);r&&AG(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:s,valid:i}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:r&&i}}readMessageC(e,t){const{plaintext:n,valid:r}=this.decryptAndHash(e.ss,t.ns);if(r&&AG(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));const{plaintext:s,valid:i}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:o,cs2:a}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:r&&i,cs1:o,cs2:a}}initSession(e,t,n){const r=this.createEmptyKey(),s=new Uint8Array(32);let i;return i=e?this.initializeInitiator(t,n,s,r):this.initializeResponder(t,n,s,r),{hs:i,i:e,mc:0}}sendMessage(e,t,n){let r;if(0===e.mc)r=this.writeMessageA(e.hs,t,n);else if(1===e.mc)r=this.writeMessageB(e.hs,t);else if(2===e.mc){const{h:n,messageBuffer:s,cs1:i,cs2:o}=this.writeMessageC(e.hs,t);r=s,e.h=n,e.cs1=i,e.cs2=o}else{if(!(e.mc>2))throw new Error("Session invalid.");if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");r=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");r=this.writeMessageRegular(e.cs2,t)}}return e.mc++,r}recvMessage(e,t){let n=new Uint8Array(0),r=!1;if(0===e.mc)({plaintext:n,valid:r}=this.readMessageA(e.hs,t));else if(1===e.mc)({plaintext:n,valid:r}=this.readMessageB(e.hs,t));else if(2===e.mc){const{h:s,plaintext:i,valid:o,cs1:a,cs2:c}=this.readMessageC(e.hs,t);n=i,r=o,e.h=s,e.cs1=a,e.cs2=c}return e.mc++,{plaintext:n,valid:r}}}class jG{constructor(e,t,n,r,s,i,o,a){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=e,this.payload=t,this.prologue=n,this.staticKeypair=s,this.connection=i,o&&(this.remotePeer=o),this.xx=a??new FG(r),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(CG(this.session.hs.s),this.isInitiator){TG("Stage 0 - Initiator starting to send first message.");const e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(oG(e)),TG("Stage 0 - Initiator finished sending first message."),PG(this.session.hs.e)}else{TG("Stage 0 - Responder waiting to receive first message...");const e=lG((await this.connection.readLP()).subarray()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new gG("xx handshake stage 0 validation fail");TG("Stage 0 - Responder received first message."),OG(this.session.hs.re)}}async exchange(){if(this.isInitiator){TG("Stage 1 - Initiator waiting to receive first message from responder...");const t=uG((await this.connection.readLP()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new gG("xx handshake stage 1 validation fail");TG("Stage 1 - Initiator received the message."),OG(this.session.hs.re),NG(this.session.hs.rs),TG("Initiator going to check remote's signature...");try{const e=SG(n);this.remotePeer=this.remotePeer||await EG(e),await IG(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){const t=e;throw new pG(`Error occurred while verifying signed payload: ${t.message}`)}TG("All good with the signature!")}else{TG("Stage 1 - Responder sending out first message with signed payload and static key.");const e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(aG(e)),TG("Stage 1 - Responder sent the second handshake message with signed payload."),PG(this.session.hs.e)}}async finish(){if(this.isInitiator){TG("Stage 2 - Initiator sending third handshake message.");const e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(cG(e)),TG("Stage 2 - Initiator sent message with signed payload.")}else{TG("Stage 2 - Responder waiting for third handshake message...");const t=hG((await this.connection.readLP()).subarray()),{plaintext:n,valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new gG("xx handshake stage 2 validation fail");TG("Stage 2 - Responder received the message, finished handshake.");try{const e=SG(n);this.remotePeer=this.remotePeer||await EG(e),await IG(this.session.hs.rs,e,this.remotePeer),this.setRemoteNoiseExtension(e.extensions)}catch(e){const t=e;throw new pG(`Error occurred while verifying signed payload: ${t.message}`)}}DG(this.session)}encrypt(e,t){const n=this.getCS(t);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,t,n){const r=this.getCS(t,!1);return this.xx.decryptWithAd(r,new Uint8Array(0),e,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new gG("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteNoiseExtension(e){e&&(this.remoteExtensions=e)}}function VG(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}class zG{constructor(e={}){this.protocol="/noise";const{staticNoiseKey:t,extensions:n,crypto:r,prologueBytes:s,metrics:i}=e;this.crypto=r??nG,this.extensions=n,this.metrics=i?VG(i):void 0,this.staticKeys=t?this.crypto.generateX25519KeyPairFromSeed(t):this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(e,t,n){const r=qW(t,{lengthEncoder:sG,lengthDecoder:iG,maxDataLength:YW}),s=await this.performHandshake({connection:r,isInitiator:!0,localPeer:e,remotePeer:n}),i=await this.createSecureConnection(r,s);return{conn:i,remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(e,t,n){const r=qW(t,{lengthEncoder:sG,lengthDecoder:iG,maxDataLength:YW}),s=await this.performHandshake({connection:r,isInitiator:!1,localPeer:e,remotePeer:n}),i=await this.createSecureConnection(r,s);return{conn:i,remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(e){const t=await bG(e.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(e,t)}async performXXHandshake(e,t){const{isInitiator:n,remotePeer:r,connection:s}=e,i=new jG(n,t,this.prologue,this.crypto,this.staticKeys,s,r);try{await i.propose(),await i.exchange(),await i.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(o){if(this.metrics?.xxHandshakeErrors.increment(),o instanceof Error)throw o.message=`Error occurred during XX handshake: ${o.message}`,o}return i}async createSecureConnection(e,t){const[n,r]=GW(),s=e.unwrap();return await dd(n,dG(t,this.metrics),s,nD({lengthDecoder:iG}),fG(t,this.metrics),n),r}}function $G(e={}){return()=>new zG(e)}const KG=I.bind({ignoreUndefined:!0,concatArrays:!0});function HG({options:e={},peerId:t,multiaddrs:n=[],repo:r,keychainConfig:s={},config:i={}}){const{datastore:o}=r,a=qG({options:e,config:i,datastore:o,keychainConfig:s,peerId:t,multiaddrs:n});return"function"===typeof e.libp2p?e.libp2p({libp2pOptions:a,options:e,config:i,datastore:o,peerId:t}):(a.start=!1,$K(a))}function qG({options:e,config:t,datastore:n,keychainConfig:r,peerId:s,multiaddrs:i}){const o=()=>{const e=nd(t,"Pubsub.Router")||"gossipsub",n=_D();if(!n[e])throw B(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${e} router.`),"ERR_NOT_SUPPORTED");return n[e]},a={datastore:n,peerId:s},c={addresses:{listen:i.map((e=>e.toString())),announce:nd(e,"addresses.announce",nd(t,"Addresses.Announce",[])),noAnnounce:nd(e,"addresses.noAnnounce",nd(t,"Addresses.NoAnnounce",[]))},connectionManager:nd(e,"connectionManager",{maxConnections:nd(e,"config.Swarm.ConnMgr.HighWater",nd(t,"Swarm.ConnMgr.HighWater")),minConnections:nd(e,"config.Swarm.ConnMgr.LowWater",nd(t,"Swarm.ConnMgr.LowWater"))}),keychain:r,identify:{host:{agentVersion:`js-ipfs/${QE}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[],streamMuxers:[HW({maxInboundStreams:256,maxOutboundStreams:1024})],connectionEncryption:[$G()],relay:{enabled:nd(e,"relay.enabled",nd(t,"relay.enabled",!0)),hop:{enabled:nd(e,"relay.hop.enabled",nd(t,"relay.hop.enabled",!1)),active:nd(e,"relay.hop.active",nd(t,"relay.hop.active",!1))}},nat:{enabled:!nd(t,"Swarm.DisableNatPortMap",!1)}};nd(e,"config.Pubsub.Enabled",nd(t,"Pubsub.Enabled",!0))&&(c.pubsub=o()),"none"!==nd(t,"Routing.Type","dhtclient")&&(c.dht=Lq({clientMode:"dhtserver"!==nd(t,"Routing.Type","dht"),kBucketSize:nd(e,"dht.kBucketSize",20),validators:{ipns:Lh},selectors:{ipns:rd}}));const l=nd(e,"config.Bootstrap",nd(t,"Bootstrap",[]));l.length>0&&c.peerDiscovery?.push(Vq({list:l}));let u=nd(e,"libp2p",void 0);"function"===typeof u&&(u=void 0);const h=KG(a,JF(),c,u),d=nd(e,"config.Addresses.Delegates",nd(t,"Addresses.Delegates",[]));if(d.length>0){const e=d[Math.floor(Math.random()*d.length)],t=Hr(e).toOptions(),n={host:t.host,protocol:443===parseInt(t.port)?"https":"http",port:t.port},r=AM(n);h.contentRouters?.push(BD(r)),h.peerRouters?.push(RD(r))}return nd(e,"config.Discovery.MDNS.Enabled",nd(t,"Discovery.MDNS.Enabled",!0))||(h.peerDiscovery=h.peerDiscovery?.filter((e=>{try{if("function"===typeof e)return"@libp2p/mdns"!==e({})[Symbol.toStringTag]}catch{}return!0}))),null==h.transports&&(h.transports=[]),null==h.transports.find((e=>{try{if("function"===typeof e)return"@libp2p/websockets"===e({})[Symbol.toStringTag]}catch{}return!1}))&&h.transports.push(hW()),h}const WG=I.bind({ignoreUndefined:!0}),GG=x("ipfs:components:peer:storage");class YG{constructor(e,t,n,r,s){this.print=r,this.peerId=e,this.keychain=t,this.repo=n,this.print=r,this.isNew=s}static async start(e,t,n){const{repoAutoMigrate:r,repo:s,onMigrationProgress:i}=n,o="string"===typeof s||null==s?CP(e,t,{path:s,autoMigrate:r,onMigrationProgress:i}):s,{peerId:a,keychain:c,isNew:l}=await QG(e,o,n);return new YG(a,c,o,e,l)}}const QG=async(e,t,n)=>{if(!t.closed)return{...await tY(t,n),isNew:!1};try{return await t.open(),{...await tY(t,n),isNew:!1}}catch(rb){if(rb.code!==yC)throw rb;if(n.init&&!1===n.init.allowNew)throw new mn("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await XG(e,t,n),isNew:!0}}},XG=async(e,t,n)=>{const r=n.init||{},s=await t.exists();if(GG("repo exists?",s),!0===s)throw new Error("repo already exists");const i=r.privateKey?await JG(r.privateKey):await ZG(e,r),o=eY(i);GG("peer identity: %s",o.PeerID);const a={...WG(rY(df(),r.profiles),n.config),Identity:o};await t.init(a),await t.open(),GG("repo opened");const c={pass:n.pass};try{c.dek=await t.config.get("Keychain.DEK")}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb}const l=await HG({options:void 0,multiaddrs:void 0,peerId:i,repo:t,config:a,keychainConfig:c});return await t.datastore.has(new Bs("/info/self"))||await l.keychain.importPeer("self",i),await t.config.set("Keychain",{DEK:l.keychain.init.dek}),{peerId:i,keychain:l.keychain}},JG=async e=>{if(GG("using user-supplied private-key"),lo(e))return e;const t=An(e,"base64pad"),n=await Vu(t);return await ko(n.public.bytes,n.bytes)},ZG=(e,{algorithm:t="Ed25519",bits:n=2048})=>{if(e("generating %s keypair...",t),"Ed25519"===t)return RK();if("RSA"===t)return CK({bits:n});throw B(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},eY=e=>{if(null==e.privateKey)throw B(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:e.toString(),PrivKey:Fn(e.privateKey,"base64pad")}},tY=async(e,t)=>{const n=t.config,r=t.init&&t.init.profiles||[],s=t.pass,i=await e.config.getAll(),o=nY(rY(i,r),n);if(i!==o&&await e.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new hn("No private key was found in the config, please intialize the repo");const a=An(o.Identity.PrivKey,"base64pad"),c=await Vu(a),l=await ko(c.public.bytes,c.bytes),u=await HG({options:void 0,multiaddrs:void 0,peerId:l,repo:e,config:o,keychainConfig:{pass:s,...o.Keychain}});return{peerId:l,keychain:u.keychain}},nY=(e,t)=>t?WG(e,t):e,rY=(e,t)=>(t||[]).reduce(((e,t)=>{const n=aS[t];if(!n)throw new Error(`Could not find profile with name '${t}'`);return GG("applying profile %s",t),n.transform(e)}),e);var sY=n(7691);function iY(e){let t=new Uint8Array(e.reduce(((e,t)=>e+Qn.encodingLength(t)),0)),n=0;for(const r of e)t=Qn.encode(r,t,n),n+=Qn.encodingLength(r);return t}var oY=iY;class aY{constructor(e,t,n){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){const e=this.cid.toString(R.base58btc);return`WantlistEntry <key: ${e}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}}const cY=M.Reader,lY=M.Writer,uY=M.util,hY=M.roots["ipfs-bitswap"]||(M.roots["ipfs-bitswap"]={}),dY=hY.Message=(()=>{function e(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.wantlist=null,e.prototype.blocks=uY.emptyArray,e.prototype.payload=uY.emptyArray,e.prototype.blockPresences=uY.emptyArray,e.prototype.pendingBytes=0,e.encode=function(e,t){if(t||(t=lY.create()),null!=e.wantlist&&Object.hasOwnProperty.call(e,"wantlist")&&hY.Message.Wantlist.encode(e.wantlist,t.uint32(10).fork()).ldelim(),null!=e.blocks&&e.blocks.length)for(var n=0;n<e.blocks.length;++n)t.uint32(18).bytes(e.blocks[n]);if(null!=e.payload&&e.payload.length)for(n=0;n<e.payload.length;++n)hY.Message.Block.encode(e.payload[n],t.uint32(26).fork()).ldelim();if(null!=e.blockPresences&&e.blockPresences.length)for(n=0;n<e.blockPresences.length;++n)hY.Message.BlockPresence.encode(e.blockPresences[n],t.uint32(34).fork()).ldelim();return null!=e.pendingBytes&&Object.hasOwnProperty.call(e,"pendingBytes")&&t.uint32(40).int32(e.pendingBytes),t},e.decode=function(e,t){e instanceof cY||(e=cY.create(e));var n=void 0===t?e.len:e.pos+t,r=new hY.Message;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.wantlist=hY.Message.Wantlist.decode(e,e.uint32());break;case 2:r.blocks&&r.blocks.length||(r.blocks=[]),r.blocks.push(e.bytes());break;case 3:r.payload&&r.payload.length||(r.payload=[]),r.payload.push(hY.Message.Block.decode(e,e.uint32()));break;case 4:r.blockPresences&&r.blockPresences.length||(r.blockPresences=[]),r.blockPresences.push(hY.Message.BlockPresence.decode(e,e.uint32()));break;case 5:r.pendingBytes=e.int32();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof hY.Message)return e;var t=new hY.Message;if(null!=e.wantlist){if("object"!==typeof e.wantlist)throw TypeError(".Message.wantlist: object expected");t.wantlist=hY.Message.Wantlist.fromObject(e.wantlist)}if(e.blocks){if(!Array.isArray(e.blocks))throw TypeError(".Message.blocks: array expected");t.blocks=[];for(var n=0;n<e.blocks.length;++n)"string"===typeof e.blocks[n]?uY.base64.decode(e.blocks[n],t.blocks[n]=uY.newBuffer(uY.base64.length(e.blocks[n])),0):e.blocks[n].length>=0&&(t.blocks[n]=e.blocks[n])}if(e.payload){if(!Array.isArray(e.payload))throw TypeError(".Message.payload: array expected");t.payload=[];for(n=0;n<e.payload.length;++n){if("object"!==typeof e.payload[n])throw TypeError(".Message.payload: object expected");t.payload[n]=hY.Message.Block.fromObject(e.payload[n])}}if(e.blockPresences){if(!Array.isArray(e.blockPresences))throw TypeError(".Message.blockPresences: array expected");t.blockPresences=[];for(n=0;n<e.blockPresences.length;++n){if("object"!==typeof e.blockPresences[n])throw TypeError(".Message.blockPresences: object expected");t.blockPresences[n]=hY.Message.BlockPresence.fromObject(e.blockPresences[n])}}return null!=e.pendingBytes&&(t.pendingBytes=0|e.pendingBytes),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),t.defaults&&(n.wantlist=null,n.pendingBytes=0),null!=e.wantlist&&e.hasOwnProperty("wantlist")&&(n.wantlist=hY.Message.Wantlist.toObject(e.wantlist,t)),e.blocks&&e.blocks.length){n.blocks=[];for(var r=0;r<e.blocks.length;++r)n.blocks[r]=t.bytes===String?uY.base64.encode(e.blocks[r],0,e.blocks[r].length):t.bytes===Array?Array.prototype.slice.call(e.blocks[r]):e.blocks[r]}if(e.payload&&e.payload.length){n.payload=[];for(r=0;r<e.payload.length;++r)n.payload[r]=hY.Message.Block.toObject(e.payload[r],t)}if(e.blockPresences&&e.blockPresences.length){n.blockPresences=[];for(r=0;r<e.blockPresences.length;++r)n.blockPresences[r]=hY.Message.BlockPresence.toObject(e.blockPresences[r],t)}return null!=e.pendingBytes&&e.hasOwnProperty("pendingBytes")&&(n.pendingBytes=e.pendingBytes),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message"},e.Wantlist=function(){function e(e){if(this.entries=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.entries=uY.emptyArray,e.prototype.full=!1,e.encode=function(e,t){if(t||(t=lY.create()),null!=e.entries&&e.entries.length)for(var n=0;n<e.entries.length;++n)hY.Message.Wantlist.Entry.encode(e.entries[n],t.uint32(10).fork()).ldelim();return null!=e.full&&Object.hasOwnProperty.call(e,"full")&&t.uint32(16).bool(e.full),t},e.decode=function(e,t){e instanceof cY||(e=cY.create(e));var n=void 0===t?e.len:e.pos+t,r=new hY.Message.Wantlist;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.entries&&r.entries.length||(r.entries=[]),r.entries.push(hY.Message.Wantlist.Entry.decode(e,e.uint32()));break;case 2:r.full=e.bool();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof hY.Message.Wantlist)return e;var t=new hY.Message.Wantlist;if(e.entries){if(!Array.isArray(e.entries))throw TypeError(".Message.Wantlist.entries: array expected");t.entries=[];for(var n=0;n<e.entries.length;++n){if("object"!==typeof e.entries[n])throw TypeError(".Message.Wantlist.entries: object expected");t.entries[n]=hY.Message.Wantlist.Entry.fromObject(e.entries[n])}}return null!=e.full&&(t.full=Boolean(e.full)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.entries=[]),t.defaults&&(n.full=!1),e.entries&&e.entries.length){n.entries=[];for(var r=0;r<e.entries.length;++r)n.entries[r]=hY.Message.Wantlist.Entry.toObject(e.entries[r],t)}return null!=e.full&&e.hasOwnProperty("full")&&(n.full=e.full),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist"},e.WantType=function(){const e={},t=Object.create(e);return t[e[0]="Block"]=0,t[e[1]="Have"]=1,t}(),e.Entry=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.block=uY.newBuffer([]),e.prototype.priority=0,e.prototype.cancel=!1,e.prototype.wantType=0,e.prototype.sendDontHave=!1,e.encode=function(e,t){return t||(t=lY.create()),null!=e.block&&Object.hasOwnProperty.call(e,"block")&&t.uint32(10).bytes(e.block),null!=e.priority&&Object.hasOwnProperty.call(e,"priority")&&t.uint32(16).int32(e.priority),null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(24).bool(e.cancel),null!=e.wantType&&Object.hasOwnProperty.call(e,"wantType")&&t.uint32(32).int32(e.wantType),null!=e.sendDontHave&&Object.hasOwnProperty.call(e,"sendDontHave")&&t.uint32(40).bool(e.sendDontHave),t},e.decode=function(e,t){e instanceof cY||(e=cY.create(e));var n=void 0===t?e.len:e.pos+t,r=new hY.Message.Wantlist.Entry;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.block=e.bytes();break;case 2:r.priority=e.int32();break;case 3:r.cancel=e.bool();break;case 4:r.wantType=e.int32();break;case 5:r.sendDontHave=e.bool();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof hY.Message.Wantlist.Entry)return e;var t=new hY.Message.Wantlist.Entry;switch(null!=e.block&&("string"===typeof e.block?uY.base64.decode(e.block,t.block=uY.newBuffer(uY.base64.length(e.block)),0):e.block.length>=0&&(t.block=e.block)),null!=e.priority&&(t.priority=0|e.priority),null!=e.cancel&&(t.cancel=Boolean(e.cancel)),e.wantType){case"Block":case 0:t.wantType=0;break;case"Have":case 1:t.wantType=1;break}return null!=e.sendDontHave&&(t.sendDontHave=Boolean(e.sendDontHave)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.block="":(n.block=[],t.bytes!==Array&&(n.block=uY.newBuffer(n.block))),n.priority=0,n.cancel=!1,n.wantType=t.enums===String?"Block":0,n.sendDontHave=!1),null!=e.block&&e.hasOwnProperty("block")&&(n.block=t.bytes===String?uY.base64.encode(e.block,0,e.block.length):t.bytes===Array?Array.prototype.slice.call(e.block):e.block),null!=e.priority&&e.hasOwnProperty("priority")&&(n.priority=e.priority),null!=e.cancel&&e.hasOwnProperty("cancel")&&(n.cancel=e.cancel),null!=e.wantType&&e.hasOwnProperty("wantType")&&(n.wantType=t.enums===String?hY.Message.Wantlist.WantType[e.wantType]:e.wantType),null!=e.sendDontHave&&e.hasOwnProperty("sendDontHave")&&(n.sendDontHave=e.sendDontHave),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Wantlist.Entry"},e}(),e}(),e.Block=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.prefix=uY.newBuffer([]),e.prototype.data=uY.newBuffer([]),e.encode=function(e,t){return t||(t=lY.create()),null!=e.prefix&&Object.hasOwnProperty.call(e,"prefix")&&t.uint32(10).bytes(e.prefix),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof cY||(e=cY.create(e));var n=void 0===t?e.len:e.pos+t,r=new hY.Message.Block;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.prefix=e.bytes();break;case 2:r.data=e.bytes();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof hY.Message.Block)return e;var t=new hY.Message.Block;return null!=e.prefix&&("string"===typeof e.prefix?uY.base64.decode(e.prefix,t.prefix=uY.newBuffer(uY.base64.length(e.prefix)),0):e.prefix.length>=0&&(t.prefix=e.prefix)),null!=e.data&&("string"===typeof e.data?uY.base64.decode(e.data,t.data=uY.newBuffer(uY.base64.length(e.data)),0):e.data.length>=0&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.prefix="":(n.prefix=[],t.bytes!==Array&&(n.prefix=uY.newBuffer(n.prefix))),t.bytes===String?n.data="":(n.data=[],t.bytes!==Array&&(n.data=uY.newBuffer(n.data)))),null!=e.prefix&&e.hasOwnProperty("prefix")&&(n.prefix=t.bytes===String?uY.base64.encode(e.prefix,0,e.prefix.length):t.bytes===Array?Array.prototype.slice.call(e.prefix):e.prefix),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?uY.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.Block"},e}(),e.BlockPresenceType=function(){const e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),e.BlockPresence=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.cid=uY.newBuffer([]),e.prototype.type=0,e.encode=function(e,t){return t||(t=lY.create()),null!=e.cid&&Object.hasOwnProperty.call(e,"cid")&&t.uint32(10).bytes(e.cid),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),t},e.decode=function(e,t){e instanceof cY||(e=cY.create(e));var n=void 0===t?e.len:e.pos+t,r=new hY.Message.BlockPresence;while(e.pos<n){var s=e.uint32();switch(s>>>3){case 1:r.cid=e.bytes();break;case 2:r.type=e.int32();break;default:e.skipType(7&s);break}}return r},e.fromObject=function(e){if(e instanceof hY.Message.BlockPresence)return e;var t=new hY.Message.BlockPresence;switch(null!=e.cid&&("string"===typeof e.cid?uY.base64.decode(e.cid,t.cid=uY.newBuffer(uY.base64.length(e.cid)),0):e.cid.length>=0&&(t.cid=e.cid)),e.type){case"Have":case 0:t.type=0;break;case"DontHave":case 1:t.type=1;break}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(t.bytes===String?n.cid="":(n.cid=[],t.bytes!==Array&&(n.cid=uY.newBuffer(n.cid))),n.type=t.enums===String?"Have":0),null!=e.cid&&e.hasOwnProperty("cid")&&(n.cid=t.bytes===String?uY.base64.encode(e.cid,0,e.cid.length):t.bytes===Array?Array.prototype.slice.call(e.cid):e.cid),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?hY.Message.BlockPresenceType[e.type]:e.type),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,M.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/Message.BlockPresence"},e}(),e})(),fY={Block:dY.Wantlist.WantType.Block,Have:dY.Wantlist.WantType.Have},pY=(e,t)=>Array.prototype.slice.call(t,0).sort(((t,n)=>{const r=e(t),s=e(n);return r<s?-1:r>s?1:0}));class gY{constructor(e,t){this.set=t?mz({name:"ipfs_bitswap_wantlist",metrics:t.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,t,n){const r=e.toString(R.base58btc),s=this.set.get(r);s?(s.inc(),s.priority=t,s.wantType===fY.Have&&n===fY.Block&&(s.wantType=n)):(this.set.set(r,new aY(e,t,n)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){const t=e.toString(R.base58btc),n=this.set.get(t);n&&(n.dec(),n.hasRefs()||(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(pY((e=>e[1].key),Array.from(this.set.entries())))}contains(e){const t=e.toString(R.base58btc);return this.set.has(t)}get(e){const t=e.toString(R.base58btc);return this.set.get(t)}}gY.Entry=aY;const yY=gY.Entry;class mY{constructor(e,t,n,r,s){this.entry=new yY(e,t,n),this.cancel=Boolean(r),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){const e=this.cid.toString(R.base58btc);return`BitswapMessageEntry ${e} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}const wY=(e,t)=>{const n=["bitswap"];return t&&n.push(t),e&&n.push(`${e.toString().slice(0,8)}`),x(n.join(":"))},bY=(e,t)=>{if(e.size!==t.size)return!1;for(const[n,r]of e){const e=t.get(n);if(void 0===e)return!1;if(r instanceof Uint8Array&&e instanceof Uint8Array&&!Pr(r,e))return!1;if(r instanceof mY&&e instanceof mY&&!r.equals(e))return!1}return!0};class vY{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return 0===this.blocks.size&&0===this.wantlist.size&&0===this.blockPresences.size}addEntry(e,t,n,r,s){null==n&&(n=vY.WantType.Block);const i=e.toString(R.base58btc),o=this.wantlist.get(i);o?(o.wantType===n&&(o.priority=t),r&&(o.cancel=Boolean(r)),s&&(o.sendDontHave=Boolean(s)),n===vY.WantType.Block&&o.wantType===vY.WantType.Have&&(o.wantType=n)):this.wantlist.set(i,new mY(e,t,n,r,s))}addBlock(e,t){const n=e.toString(R.base58btc);this.blocks.set(n,t)}addHave(e){const t=e.toString(R.base58btc);this.blockPresences.has(t)||this.blockPresences.set(t,vY.BlockPresenceType.Have)}addDontHave(e){const t=e.toString(R.base58btc);this.blockPresences.has(t)||this.blockPresences.set(t,vY.BlockPresenceType.DontHave)}cancel(e){const t=e.toString(R.base58btc);this.wantlist.delete(t),this.addEntry(e,0,vY.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),cancel:Boolean(e.cancel)}))),full:!!this.full||void 0},blocks:Array.from(this.blocks.values())};return dY.encode(e).finish()}serializeToBitswap110(){const e={wantlist:{entries:Array.from(this.wantlist.values()).map((e=>({block:e.cid.bytes,priority:Number(e.priority),wantType:e.wantType,cancel:Boolean(e.cancel),sendDontHave:Boolean(e.sendDontHave)}))),full:!!this.full||void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[t,n]of this.blocks.entries()){const r=X.k0.parse(t),s=r.version,i=r.code,o=r.multihash.code,a=r.multihash.digest.length,c=oY([s,i,o,a]);e.payload.push(new dY.Block({prefix:c,data:n}))}for(const[t,n]of this.blockPresences)e.blockPresences.push(new dY.BlockPresence({cid:X.k0.parse(t).bytes,type:n}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),dY.encode(e).finish()}equals(e){return!!(this.full===e.full&&this.pendingBytes===e.pendingBytes&&bY(this.wantlist,e.wantlist)&&bY(this.blocks,e.blocks)&&bY(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){const e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}}vY.deserialize=async(e,t)=>{const n=dY.decode(e),r=n.wantlist&&n.wantlist.full||!1,s=new vY(r);return n.wantlist&&n.wantlist.entries&&n.wantlist.entries.forEach((e=>{if(!e.block)return;const t=X.k0.decode(e.block);s.addEntry(t,e.priority||0,e.wantType,Boolean(e.cancel),Boolean(e.sendDontHave))})),n.blockPresences&&n.blockPresences.forEach((e=>{if(!e.cid)return;const t=X.k0.decode(e.cid);e.type===vY.BlockPresenceType.Have?s.addHave(t):s.addDontHave(t)})),n.blocks.length>0?(await Promise.all(n.blocks.map((async e=>{const t=await Gt.digest(e),n=X.k0.createV0(t);s.addBlock(n,e)}))),s):n.payload.length>0?(await Promise.all(n.payload.map((async e=>{if(!e.prefix||!e.data)return;const n=sY(e.prefix),r=n[0],i=n[1],o=n[2],a=o===Gt.code?Gt:t&&await t.getHasher(o);if(!a)throw new ao("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");const c=await a.digest(e.data),l=X.k0.create(r,i,c);s.addBlock(l,e.data)}))),s.setPendingBytes(n.pendingBytes),s):s},vY.blockPresenceSize=e=>e.bytes.length+1,vY.Entry=mY,vY.WantType={Block:dY.Wantlist.WantType.Block,Have:dY.Wantlist.WantType.Have},vY.BlockPresenceType={Have:dY.BlockPresenceType.Have,DontHave:dY.BlockPresenceType.DontHave};const _Y=3,EY=Math.pow(2,31)-1,SY=1e3,kY=1;var IY=AY;function AY(e,t,n){var r=null,s=null,i=function(){r&&(clearTimeout(r),s=null,r=null)},o=function(){var e=s;i(),e&&e()},a=function(){if(!t)return e.apply(this,arguments);var o=this,a=arguments,c=n&&!r;return i(),s=function(){e.apply(o,a)},r=setTimeout((function(){if(r=null,!c){var e=s;return s=null,e()}}),t),c?s():void 0};return a.cancel=i,a.flush=o,a}class TY{constructor(e,t,n){this.peerId=t,this.network=n,this.refcnt=1,this._entries=[],this._log=wY(e,"msgqueue"),this.sendEntries=IY(this._sendEntries.bind(this),kY)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;const e=new vY(!1);this._entries.forEach((t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)})),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(rb){return void this._log.error("cant connect to peer %s: %s",this.peerId.toString(),rb.message)}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,e).catch((e=>{this._log.error("send error: %s",e.message)}))}}class RY{constructor(e,t,n,r){this.peers=mz({name:"ipfs_bitswap_want_manager_peers",metrics:r.metrics}),this.wantlist=new gY(n,r),this.network=t,this._stats=n,this._peerId=e,this._log=wY(e,"want")}_addEntries(e,t,n){const r=e.map(((e,n)=>new vY.Entry(e,EY-n,vY.WantType.Block,t)));r.forEach((e=>{e.cancel?n?this.wantlist.removeForce(e.cid.toString(R.base58btc)):this.wantlist.remove(e.cid):(this._log("adding to wl"),this.wantlist.add(e.cid,e.priority))}));for(const s of this.peers.values())s.addEntries(r)}_startPeerHandler(e){let t=this.peers.get(e.toString());if(t)return void t.refcnt++;t=new TY(this._peerId,e,this.network);const n=new vY(!0);for(const r of this.wantlist.entries())n.addEntry(r[1].cid,r[1].priority);return t.addMessage(n),this.peers.set(e.toString(),t),t}_stopPeerHandler(e){const t=this.peers.get(e.toString());t&&(t.refcnt--,t.refcnt>0||this.peers.delete(e.toString()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.cancelWants(e)}))}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach((e=>this.disconnected(e.peerId)))}}const CY="/ipfs/bitswap/1.0.0",PY="/ipfs/bitswap/1.1.0",NY="/ipfs/bitswap/1.2.0",OY=32,DY=128,LY=3e4;class xY{constructor(e,t,n,r={}){this._log=wY(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[CY],r.b100Only||(this._protocols.unshift(PY),this._protocols.unshift(NY)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=r.hashLoader,this._maxInboundStreams=r.maxInboundStreams??OY,this._maxOutboundStreams=r.maxOutboundStreams??DY,this._incomingStreamTimeout=r.incomingStreamTimeout??LY}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const e=nN({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarIds=[];for(const t of this._protocols)this._registrarIds.push(await this._libp2p.register(t,e));this._libp2p.getConnections().forEach((e=>{this._onPeerConnect(e.remotePeer)}))}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),null!=this._registrarIds){for(const e of this._registrarIds)this._libp2p.unregister(e);this._registrarIds=[]}}_onConnection({stream:e,connection:t}){if(!this._running)return;const n=new Tn.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then((async()=>{this._log("incoming new bitswap %s connection from %p",e.stat.protocol,t.remotePeer),await dd(qO(e.source,n.signal),nD(),(async e=>{for await(const r of e){try{const e=await vY.deserialize(r.subarray(),this._hashLoader);await this._bitswap._receiveMessage(t.remotePeer,e)}catch(rb){this._bitswap._receiveError(rb);break}n.reset()}}))})).catch((t=>{this._log(t),e.abort(t)})).finally((()=>{n.clear(),e.close()}))}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t={}){return this._libp2p.contentRouting.findProviders(e,t)}async findAndConnect(e,t){const n=[];let r=0;for await(const s of this.findProviders(e,t))if(this._log(`connecting to provider ${s.id}`),n.push(this.connectTo(s.id,t).catch((e=>{this._log.error(e)}))),r++,r===_Y)break;await Promise.all(n)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");const n=e.toString();this._log("sendMessage to %s",n,t);const r=await this._libp2p.dial(e),s=await r.newStream([NY,PY,CY]);await BY(s,t,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){const n=e.toString();if(this._stats){for(const e of t.values())this._stats.push(n,"dataSent",e.length);this._stats.push(n,"blocksSent",t.size)}}}async function BY(e,t,n){try{let n;switch(e.stat.protocol){case CY:n=t.serializeToBitswap100();break;case PY:case NY:n=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+e.stat.protocol)}await dd([n],XO(),e)}catch(rb){n(rb)}finally{e.close()}}class MY{constructor(e){this.partner=e,this.wantlist=new gY,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=(new Date).getTime(),this.accounting.bytesRecv+=e}wants(e,t,n){this.wantlist.add(e,t,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class UY extends Map{constructor(e,t){super(),this._cmp=t||this._defaultSort,this._keys=[];for(const[n,r]of e||[])this.set(n,r)}update(e){if(e<0||e>=this._keys.length)return;const t=this._keys[e];this._keys.splice(e,1);const n=this._find(t);this._keys.splice(n,0,t)}set(e,t){if(this.has(e)){const t=this.indexOf(e);this._keys.splice(t,1)}super.set(e,t);const n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;const t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;const t=this._find(e);if(this._keys[t]===e)return t;for(let n=1;n<this._keys.length;n++){if(this._keys[t+n]===e)return t+n;if(this._keys[t-n]===e)return t-n}return-1}_find(e){let t=0,n=this._keys.length;while(t<n){const r=t+n>>>1,s=this._kCmp(this._keys[r],e);if(s<0)t=r+1;else{if(!(s>0))return r;n=r}}return t}*keys(){for(const e of this._keys)yield e}*values(){for(const e of this._keys)yield this.get(e)}*entries(){for(const e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(e)for(const n of this._keys)e.apply(t,[[n,this.get(n)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}}const FY={hasNewInfo(){return!1},merge(){}};class jY{constructor(e=FY){this._taskMerger=e,this._byPeer=new UY([],VY.compare)}pushTasks(e,t){let n=this._byPeer.get(e.toString());n||(n=new VY(e,this._taskMerger)),n.pushTasks(t),this._byPeer.set(e.toString(),n)}popTasks(e){const t=this._head();if(void 0===t)return{tasks:[],pendingSize:0};const{tasks:n,pendingSize:r}=t.popTasks(e);if(0===n.length)return{tasks:n,pendingSize:r};const s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toString()):this._byPeer.update(0),{peerId:s,tasks:n,pendingSize:r}}_head(){if(0!==this._byPeer.size)for(const[,e]of this._byPeer)return e}remove(e,t){const n=this._byPeer.get(t.toString());n&&n.remove(e)}tasksDone(e,t){const n=this._byPeer.get(e.toString());if(!n)return;const r=this._byPeer.indexOf(e.toString());for(const s of t)n.taskDone(s);this._byPeer.update(r)}}class VY{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new zY,this._active=new Set}pushTasks(e){for(const t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;const t=this._pending.get(e.topic);if(t)return e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),void this._taskMerger.merge(e,t);this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){const t=[];for(const n of this._active)n.topic===e.topic&&t.push(n);return 0===t.length||this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0;const n=[],r=this._pending.tasks();for(let s=0;s<r.length&&t<e;s++){const e=r[s];n.push(e),t+=e.size,this._pending.delete(e.topic),this._activeTotalSize+=e.size,this._active.add(e)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return 0===this._pending.length&&0===this._active.size}static compare(e,t){return 0===e[1]._pending.length?1:0===t[1]._pending.length?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}}class zY{constructor(){this._tasks=new UY([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce(((e,t)=>e+t.task.size),0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map((e=>e.task))}updatePriority(e,t){const n=this._tasks.get(e);if(!n)return;const r=this._tasks.indexOf(e);n.task.priority=t,this._tasks.update(r)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}}const $Y={hasNewInfo(e,t){let n=!1,r=!1;for(const s of t)s.data.haveBlock&&(n=!0),s.data.isWantBlock&&(r=!0);return!(r||!e.data.isWantBlock)||!(n||!e.data.haveBlock)},merge(e,t){const n=e.data,r=t.data;!r.haveBlock&&n.haveBlock&&(r.haveBlock=n.haveBlock,r.blockSize=n.blockSize),!r.isWantBlock&&n.isWantBlock&&(r.isWantBlock=!0,r.haveBlock&&!n.haveBlock||(r.haveBlock=n.haveBlock,t.size=e.size)),r.isWantBlock&&r.haveBlock&&(t.size=r.blockSize)}},KY=vY.WantType,HY=16384,qY=1024;class WY{constructor(e,t,n,r,s,i={}){this._log=wY(e,"engine"),this.blockstore=t,this.network=n,this._stats=r,this._opts=this._processOpts(i),this.ledgerMap=mz({name:"ipfs_bitswap_ledger_map",metrics:s.metrics}),this._running=!1,this._requestQueue=new jY($Y)}_processOpts(e){return{maxSizeReplaceHasWithBlock:qY,targetMessageSize:HY,...e}}_scheduleProcessTasks(){setTimeout((()=>{this._processTasks()}))}async _processTasks(){if(!this._running)return;const{peerId:e,tasks:t,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(0===t.length)return;const r=new vY(!1);r.setPendingBytes(n);const s=[],i=new Map;for(const a of t){const e=X.k0.parse(a.topic);a.data.haveBlock?a.data.isWantBlock?(s.push(e),i.set(a.topic,a.data)):r.addHave(e):r.addDontHave(e)}const o=await this._getBlocks(s);for(const[a,c]of i){const e=X.k0.parse(a),t=o.get(a);t?r.addBlock(e,t):c.sendDontHave&&r.addDontHave(e)}if(r.empty)return e&&this._requestQueue.tasksDone(e,t),void this._scheduleProcessTasks();try{e&&await this.network.sendMessage(e,r);for(const[t,n]of o.entries())e&&this.messageSent(e,X.k0.parse(t),n)}catch(rb){this._log.error(rb)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){const t=e.toString(),n=this.ledgerMap.get(t);return n?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){const t=e.toString(),n=this.ledgerMap.get(t);return n?{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map((e=>e.partner))}receivedBlocks(e){if(e.length){for(const t of this.ledgerMap.values())for(const n of e){const e=t.wantlistContains(n.cid);if(!e)continue;const r=n.data.length,s=this._sendAsBlock(e.wantType,r);let i=r;s||(i=vY.blockPresenceSize(e.cid)),this._requestQueue.pushTasks(t.partner,[{topic:e.cid.toString(R.base58btc),priority:e.priority,size:i,data:{blockSize:r,isWantBlock:s,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){const n=this._findOrCreate(e);if(t.empty)return;if(t.full&&(n.wantlist=new gY),this._updateBlockAccounting(t.blocks,n),0===t.wantlist.size)return void this._scheduleProcessTasks();const r=[],s=[];t.wantlist.forEach((e=>{e.cancel?(n.cancelWant(e.cid),r.push(e.cid)):(n.wants(e.cid,e.priority,e.wantType),s.push(e))})),this._cancelWants(e,r),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(const n of t)this._requestQueue.remove(n.toString(R.base58btc),e)}async _addWants(e,t){const n=await this._getBlockSizes(t.map((e=>e.cid))),r=[];for(const s of t){const t=s.cid.toString(R.base58btc),i=n.get(t);if(null==i)s.sendDontHave&&r.push({topic:t,priority:s.priority,size:vY.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===KY.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{const e=this._sendAsBlock(s.wantType,i);let n=i;e||(n=vY.blockPresenceSize(s.cid)),r.push({topic:t,priority:s.priority,size:n,data:{isWantBlock:e,blockSize:i,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,r)}}_sendAsBlock(e,t){return e===KY.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){const t=await this._getBlocks(e);return new Map([...t].map((([e,t])=>[e,t.length])))}async _getBlocks(e){const t=new Map;return await Promise.all(e.map((async e=>{try{const n=await this.blockstore.get(e);t.set(e.toString(R.base58btc),n)}catch(n){"ERR_NOT_FOUND"!==n.code&&this._log.error("failed to query blockstore for %s: %s",e,n)}}))),t}_updateBlockAccounting(e,t){for(const n of e.values())this._log("got block (%s bytes)",n.length),t.receivedBytes(n.length)}messageSent(e,t,n){const r=this._findOrCreate(e);r.sentBytes(n.length),r.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){const t=e.toString(),n=this.ledgerMap.get(t);if(n)return n;const r=new MY(e);return this.ledgerMap.set(t,r),this._stats&&this._stats.push(t,"peerCount",1),r}start(){this._running=!0}stop(){this._running=!1}}const GY=e=>`unwant:${Fn(e.multihash.bytes,"base64")}`,YY=e=>`block:${Fn(e.multihash.bytes,"base64")}`;class QY extends oj.EventEmitter{constructor(e){super(),this.setMaxListeners(SY),this._log=wY(e,"notif")}hasBlock(e,t){const n=YY(e);this._log(n),this.emit(n,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");const n=YY(e),r=GY(e);return this._log(`wantBlock:${e}`),new Promise(((s,i)=>{const o=()=>{this.removeListener(n,a),i(new Error(`Block for ${e} unwanted`))},a=e=>{this.removeListener(r,o),s(e)};this.once(r,o),this.once(n,a),t&&t.signal&&t.signal.addEventListener("abort",(()=>{this.removeListener(n,a),this.removeListener(r,o),i(new Error(`Want for ${e} aborted`))}))}))}unwantBlock(e){const t=GY(e);this._log(t),this.emit(t)}}var XY=n(5670);class JY extends oj.EventEmitter{constructor(e,t){super(),this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach((e=>{this._stats[e]=BigInt(0),this._movingAverages[e]={},this._options.movingAverageIntervals.forEach((t=>{const n=this._movingAverages[e][t]=XY(t);n.push(this._frequencyLastTime,0)}))})),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;while(this._queue.length){const t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){const t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach((n=>{this._updateFrequencyFor(n,t,e)})),this._frequencyLastTime=e}_updateFrequencyFor(e,t,n){const r=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;const s=r/t*1e3;let i=this._movingAverages[e];i||(i=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach((e=>{let t=i[e];t||(t=i[e]=XY(e)),t.push(n,s)}))}_applyOp(e){const t=e[0],n=e[1];if("number"!==typeof n)throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(n),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=n}}const ZY={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[6e4,3e5,9e5]};class eQ extends oj.EventEmitter{constructor(e,t=[],n=ZY){super();const r=Object.assign({},ZY,n);if("number"!==typeof r.computeThrottleTimeout)throw new Error("need computeThrottleTimeout");if("number"!==typeof r.computeThrottleMaxQueueSize)throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=t,this._options=r,this._enabled=this._options.enabled,this._global=new JY(t,r),this._global.on("update",(e=>this.emit("update",e))),this._peers=mz({name:"ipfs_bitswap_stats_peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){const t="string"!==typeof e&&e.toString?e.toString():`${e}`;return this._peers.get(t)}push(e,t,n){if(this._enabled&&(this._global.push(t,n),e)){let r=this._peers.get(e);r||(r=new JY(this._initialCounters,this._options),this._peers.set(e,r)),r.push(t,n)}}disconnected(e){const t=e.toString(),n=this._peers.get(t);n&&(n.stop(),this._peers.delete(t))}}const tQ={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},nQ=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class rQ extends EP{constructor(e,t,n={}){super(),this._libp2p=e,this._log=wY(this.peerId),this._options=Object.assign({},tQ,n),this._stats=new eQ(e,nQ,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new xY(e,this,this._stats,{hashLoader:n.hashLoader,maxInboundStreams:n.maxInboundStreams,maxOutboundStreams:n.maxOutboundStreams,incomingStreamTimeout:n.incomingStreamTimeout}),this.blockstore=t,this.engine=new WY(this.peerId,t,this.network,this._stats,e),this.wm=new RY(this.peerId,this.network,this._stats,e),this.notifications=new QY(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(rb){this._log("failed to receive message",t)}if(0===t.blocks.size)return;const n=[];for(const[r,s]of t.blocks.entries()){const e=X.k0.parse(r);n.push({wasWanted:this.wm.wantlist.contains(e),cid:e,data:s})}this.wm.cancelWants(n.filter((({wasWanted:e})=>e)).map((({cid:e})=>e))),await Promise.all(n.map((({cid:t,wasWanted:n,data:r})=>this._handleReceivedBlock(e,t,r,n))))}async _handleReceivedBlock(e,t,n,r){this._log("received block");const s=await this.blockstore.has(t);this._updateReceiveCounters(e.toString(),t,n,s),r&&await this.put(t,n)}_updateReceiveCounters(e,t,n,r){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",n.length),r&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){const n=(e,t)=>(this.wm.wantBlocks([e],t),this.notifications.wantBlock(e,t));let r=!1;const s=async(e,t)=>{try{const n=await this.blockstore.get(e,t);return n}catch(rb){if("ERR_NOT_FOUND"!==rb.code)throw rb;return r||(r=!0,this.network.findAndConnect(e,t).catch((e=>this._log.error(e)))),n(e,t)}},i=new AbortController,o=t.signal?(0,js.anySignal)([t.signal,i.signal]):i.signal;try{const t=await Promise.race([this.notifications.wantBlock(e,{signal:o}),s(e,{signal:o})]);return t}finally{i.abort()}}async*getMany(e,t={}){for await(const n of e)yield this.get(n,t)}unwant(e){const t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach((e=>this.notifications.unwantBlock(e)))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,n){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(const{key:n,value:r}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(n,r),yield{key:n,value:r}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch((e=>{this._log.error("Failed to provide: %s",e.message)}))}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}has(e){return this.blockstore.has(e)}}const sQ=(e,t,n={})=>new rQ(e,t,n);function iQ(e){return e=e||new Error("Not Found"),B(e,"ERR_NOT_FOUND")}function oQ(e){return e=e||new Error("Aborted"),B(e,"ERR_ABORTED")}class aQ extends EP{constructor(e,t){super(),this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,n={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,n):await this.child.put(e,t,n))}async*putMany(e,t={}){const n=qh(e,(async({key:e})=>!await this.has(e)));this.bitswap.isStarted()?yield*this.bitswap.putMany(n,t):yield*this.child.putMany(n,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){const n=Xh({objectMode:!0}),r=Xh({objectMode:!0});Promise.resolve().then((async()=>{for await(const t of e)!await this.has(t)&&this.bitswap.isStarted()?n.push(t):r.push(t);n.end(),r.end()})),yield*ad(this.bitswap.getMany(n,t),this.child.getMany(r,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}}class cQ{constructor(e,t,n,r,s){this.peerId=e,this.libp2p=t,this.bitswap=n,this.repo=r,this.blockstore=s}static async start({peerId:e,repo:t,print:n,hashers:r,options:s}){t.closed&&await t.open();const i=await t.config.getAll(),o=await HG({options:s,repo:t,peerId:e,multiaddrs:lQ(e,i),config:i,keychainConfig:void 0});await o.start();for(const l of o.getMultiaddrs())n(`Swarm listening on ${l.toString()}`);const a=sQ(o,t.blocks,{statsEnabled:!0,hashLoader:r,maxInboundStreams:1024,maxOutboundStreams:1024});await a.start();const c=new aQ(t.blocks,a);return t.blocks=c,t.pins.blockstore=c,new cQ(e,o,a,t,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}}const lQ=(e,t)=>{const n=e.toString(),r=[],s=t.Addresses&&t.Addresses.Swarm||[];for(const i of s){let e=Hr(i);if(e.protoCodes().includes(uQ))throw B(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");const t=e.getPeerId();t&&t!==n&&(e=e.encapsulate(`/p2p/${n}`)),r.push(e)}return r},uQ=479;function hQ({network:e}){async function t(t={}){const n=[],{libp2p:r}=await e.use(t);return await r.peerStore.forEach((e=>{n.push({id:e.id,addrs:e.addresses.map((e=>e.multiaddr))})})),n}return qs(t)}function dQ({network:e}){async function t(t,n={}){const{libp2p:r}=await e.use(n);await r.dial(t,n)}return qs(t)}function fQ({network:e}){async function t(t,n={}){const{libp2p:r}=await e.use(n);await r.hangUp(t)}return qs(t)}function pQ({network:e}){async function t(t={}){const{libp2p:n}=await e.use(t);return n.getMultiaddrs()}return qs(t)}function gQ({network:e}){async function t(t={}){const{libp2p:n}=await e.use(t);if(t.verbose){const e=[];for(const r of n.getConnections()){const n={addr:r.remoteAddr,peer:r.remotePeer};(t.verbose||t.direction)&&(n.direction=r.stat.direction),t.verbose&&(n.muxer=r.stat.multiplexer,n.latency="n/a",n.streams=[]),e.push(n)}return e}const r=new Map;for(const e of n.getConnections()){const t={addr:e.remoteAddr,peer:e.remotePeer};r.set(e.remotePeer.toString(),t)}return Array.from(r.values())}return qs(t)}class yQ{constructor({network:e}){this.addrs=hQ({network:e}),this.connect=dQ({network:e}),this.disconnect=fQ({network:e}),this.localAddrs=pQ({network:e}),this.peers=gQ({network:e})}}const mQ={success:!0,time:0,text:""};function wQ({network:e}){async function*t(t,n={}){const{libp2p:r}=await e.use();n.count=n.count||10;const s=await r.peerStore.get(t);let i=s&&s.id;if(!i){yield{...mQ,text:`Looking up peer ${t}`};const e=await r.peerRouting.findPeer(t);i=e&&e.id}if(!i)throw new Error("Peer was not found");yield{...mQ,text:`PING ${i.toString()}`};let o=0,a=0;for(let e=0;e<n.count;e++)try{const e=await r.ping(i);a+=e,o++,yield{...mQ,time:e}}catch(rb){yield{...mQ,success:!1,text:rb.toString()}}if(o){const e=a/o;yield{...mQ,text:`Average latency: ${e}ms`}}}return qs(t)}const bQ="/ipns/";function vQ(e){let t;if(e.startsWith(bQ)&&(e=e.substring(bQ.length)),"1"!==e[0]&&"Q"!==e[0]||(e=`z${e}`),"z"===e[0]&&(t=R.base58btc.decode(e)),"k"===e[0]&&(t=Ut.decode(e)),!t)throw new Error("Could not parse string");if(1!==t[0]&&114!==t[1]&&(t=Xn([[1,114],t])),40!==t.length)throw new Error("Incorrect length "+t.length);return Xn([An(bQ),t.subarray(2)])}function _Q({network:e,repo:t,peerId:n}){const{get:r,put:s,findProvs:i,findPeer:o,provide:a,query:c}={async*get(t,r={}){const{libp2p:s}=await EQ(e,n,r),i=t instanceof Uint8Array?t:vQ(t);if(null==s.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.get(i,r)},async*put(t,r,s){const{libp2p:i}=await EQ(e,n,s),o=t instanceof Uint8Array?t:vQ(t);if(null==i.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.put(o,r,s)},async*findProvs(t,r={}){const{libp2p:s}=await EQ(e,n,r);if(null==s.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.findProviders(t,{signal:r.signal})},async*findPeer(t,r={}){const{libp2p:s}=await EQ(e,n,r);if(null==s.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.findPeer(t,{signal:r.signal})},async*provide(r,s={recursive:!1}){const{libp2p:i}=await EQ(e,n,s),o=await t.blocks.has(r);if(!o)throw B(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(s.recursive)throw B(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(null==i.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*i.dht.provide(r)},async*query(t,r={}){const{libp2p:s}=await EQ(e,n,r);let i;const o=X.k0.asCID(t);if(i=null!=o?o.multihash.bytes:_o(t.toString()).toBytes(),null==s.dht)throw B(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*s.dht.getClosestPeers(i,r)}};return{get:qs(r),put:qs(s),findProvs:qs(i),findPeer:qs(o),provide:qs(a),query:qs(c)}}const EQ=async(e,t,n)=>{const r=await e.use(n);if(null!=r.libp2p.dht)return r;{const e=async function*(){yield{from:t,name:"QUERY_ERROR",type:3,error:new mn("dht not enabled")}};return{libp2p:{dht:{get:e,put:e,findProviders:e,findPeer:e,provide:e,getClosestPeers:e}}}}};function SQ({network:e,config:t}){const n=nd(t||{},"Pubsub.Enabled",!0),r={};let s;return{subscribe:n?qs(i):kQ,unsubscribe:n?qs(o):kQ,publish:n?qs(a):kQ,ls:n?qs(c):kQ,peers:n?qs(l):kQ};async function i(t,n,i={}){const{libp2p:o}=await e.use(i);o.pubsub.subscribe(t),null==s&&(s=e=>{const t=e.detail;r[t.topic]&&r[t.topic].forEach((e=>{"function"!==typeof e?null!=e&&null!=e.handleEvent&&e.handleEvent(t):e(t)}))},o.pubsub.addEventListener("message",s)),null!=n&&(null==r[t]&&(r[t]=[]),r[t].push(n))}async function o(t,n,i={}){const{libp2p:o}=await e.use(i);null!=n&&null!=r[t]&&(r[t]=r[t].filter((e=>e!==n)),0===r[t].length&&delete r[t]),"function"!==typeof n&&delete r[t],null==r[t]&&o.pubsub.unsubscribe(t),0===Object.keys(r).length&&(o.pubsub.removeEventListener("message",s),s=void 0)}async function a(t,n,r={}){const{libp2p:s}=await e.use(r);if(!n)throw B(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await s.pubsub.publish(t,n)}async function c(t={}){const{libp2p:n}=await e.use(t);return n.pubsub.getTopics()}async function l(t,n={}){const{libp2p:r}=await e.use(n);return r.pubsub.getSubscribers(t)}}const kQ=async()=>{throw new mn("pubsub not enabled")},IQ=I.bind({ignoreUndefined:!0}),AQ=x("ipfs"),TQ=3e4;class RQ{constructor({print:e,storage:t,codecs:n,options:r}){const{peerId:s,repo:i,keychain:o}=t,a=ii.create(cQ),c=vk(r.preload),l=so(),u=io({network:a}),h=new Nd(r),d=Object.values(cn);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach((e=>d.push(e))),this.hashers=new zD({hashers:d,loadHasher:r.ipld&&r.ipld.loadHasher});const f=Object.values(an);(r.ipld&&r.ipld.bases?r.ipld.bases:[]).forEach((e=>f.push(e))),this.bases=new UD({bases:f,loadBase:r.ipld&&r.ipld.loadBase});const p=new jo({repo:i,codecs:n}),g=new Af({codecs:n,hashers:this.hashers,preload:c,repo:i}),y=new Hd({dns:l,ipns:h,repo:i,codecs:n,peerId:s,isOnline:u,keychain:o,options:r}),m=Io({repo:i,codecs:n,bases:this.bases,name:y}),w=new lk({repo:i,codecs:n,hashers:this.hashers,preload:c}),b=Object.assign(Gd({repo:i,codecs:n,resolve:m,preload:c}),{local:tf({repo:t.repo})}),{add:v,addAll:_,cat:E,get:S,ls:k}=new YE({preload:c,repo:i,options:r.EXPERIMENTAL,hashers:this.hashers}),I=WA({repo:i,preload:c,hashers:this.hashers,options:r}),A=Ek({files:I,preload:c,options:r.preload});this.preload=c,this.name=y,this.ipns=h,this.pin=p,this.resolve=m,this.block=g,this.refs=b,this.start=oi({network:a,peerId:s,repo:i,preload:c,ipns:h,mfsPreload:A,print:e,keychain:o,hashers:this.hashers,options:r}),this.stop=ai({network:a,preload:c,mfsPreload:A,ipns:h,repo:i}),this.dht=_Q({network:a,repo:i,peerId:s}),this.pubsub=SQ({network:a,config:r.config}),this.dns=l,this.isOnline=u,this.id=tS({network:a,peerId:s}),this.version=ZE({repo:i}),this.bitswap=new af({network:a}),this.bootstrap=new gf({repo:i}),this.config=lS({repo:i}),this.ping=wQ({network:a}),this.add=v,this.addAll=_,this.cat=E,this.get=S,this.ls=k,this.dag=w,this.files=I,this.key=new rT({keychain:o}),this.object=new yT({preload:c,codecs:n,repo:i}),this.repo=new ET({repo:i,hashers:this.hashers}),this.stats=new IT({repo:i,network:a}),this.swarm=new yQ({network:a}),Object.defineProperty(this,"libp2p",{get(){const e=a.try();return e?e.libp2p:void 0}});const T=()=>Promise.reject(B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),R=async function*(){throw B(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=T,this.diag={cmds:T,net:T,sys:T},this.log={level:T,ls:T,tail:R},this.mount=T,this.codecs=n}async init(){throw new fn}}const CQ=async e=>{const t=Te({Data:new Q({type:"directory"}).marshal(),Links:[]}),n=await e.block.put(t,{mhtype:"sha2-256",format:"dag-pb"});return await e.pin.add(n),n},PQ=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!A.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function NQ(e={}){e=IQ(PQ(),e);const t=e.init||{},n={name:Nt.name,code:Nt.code,encode:e=>e,decode:e=>e},r=Object.values(ln);[s,Ce,i,o,n].concat(e.ipld&&e.ipld.codecs||[]).forEach((e=>r.push(e)));const a=new jD({codecs:r,loadCodec:e.ipld&&e.ipld.loadCodec}),c=e.silent?AQ:console.log;AQ("creating repo");const l=await YG.start(c,a,e);AQ("getting repo config");const u=await l.repo.config.getAll(),h=new RQ({storage:l,print:c,codecs:a,options:{...e,config:u}});if(AQ("starting preload"),await h.preload.start(),AQ("starting storage"),h.ipns.startOffline(l),l.isNew&&!t.emptyRepo){const e=await CQ(h);if(AQ("adding default assets"),await un({addAll:h.addAll,print:c}),AQ("initializing IPNS keyspace"),null==l.peerId.publicKey)throw B(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");const t=new Tn.TimeoutController(TQ);try{await h.ipns.initializeKeyspace(l.peerId,An(`/ipfs/${e}`),{signal:t.signal})}finally{t.clear()}}return!1!==e.start&&(AQ("starting node"),await h.start()),h}n(2596);const OQ=NQ},5989:function(e,t,n){"use strict";n.d(t,{Dp:function(){return i},Z$:function(){return r},s7:function(){return s}});n(7658);const r=e=>e[e.length-1],s=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},i=Array.from;Array.isArray},3388:function(e,t,n){"use strict";n.d(t,{$2:function(){return h},CY:function(){return i},Ko:function(){return o},Qn:function(){return s},RP:function(){return f},Vw:function(){return r},cq:function(){return a},jS:function(){return d},kr:function(){return u},rc:function(){return c},x1:function(){return l}});const r=1,s=2,i=4,o=8,a=32,c=64,l=128,u=31,h=63,d=127,f=2147483647},3425:function(e,t,n){"use strict";n.d(t,{Gh:function(){return f},Te:function(){return o},eh:function(){return a},f9:function(){return p},s3:function(){return d}});n(2801);var r=n(654),s=n(5342);const i=e=>new Uint8Array(e),o=(e,t,n)=>new Uint8Array(e,t,n),a=e=>new Uint8Array(e),c=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=r.IK(e[n]);return btoa(t)},l=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),u=e=>{const t=atob(e),n=i(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n},h=e=>{const t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},d=s.jU?c:l,f=s.jU?u:h,p=e=>{const t=i(e.byteLength);return t.set(e),t}},2294:function(e,t,n){"use strict";n.d(t,{HN:function(){return d},UF:function(){return A},XW:function(){return I},dD:function(){return T},kf:function(){return w},kj:function(){return f},l1:function(){return l},sO:function(){return R},v_:function(){return k},yg:function(){return p}});n(7658);var r=n(3425),s=n(3388),i=n(1383),o=n(4206),a=n(654);class c{constructor(e){this.arr=e,this.pos=0}}const l=e=>new c(e),u=e=>e.pos!==e.arr.length,h=(e,t)=>{const n=r.Te(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},d=e=>h(e,p(e)),f=e=>e.arr[e.pos++],p=e=>{let t=0,n=1;while(1){const r=e.arr[e.pos++];if(t+=(r&s.jS)*n,n*=128,r<s.x1)return t;if(t>o.YM)throw new Error("Integer out of range!")}},g=e=>{let t=e.arr[e.pos++],n=t&s.$2,r=64;const i=(t&s.rc)>0?-1:1;if(0===(t&s.x1))return i*n;while(1){if(t=e.arr[e.pos++],n+=(t&s.jS)*r,r*=128,t<s.x1)return i*n;if(n>o.YM)throw new Error("Integer out of range!")}},y=e=>{let t=p(e);if(0===t)return"";{let n=String.fromCodePoint(f(e));if(--t<100)while(t--)n+=String.fromCodePoint(f(e));else while(t>0){const r=t<1e4?t:1e4,s=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,s),t-=r}return decodeURIComponent(escape(n))}},m=e=>a.CO.decode(d(e)),w=a.CO?m:y,b=(e,t)=>{const n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},v=e=>b(e,4).getFloat32(0,!1),_=e=>b(e,8).getFloat64(0,!1),E=e=>b(e,8).getBigInt64(0,!1),S=[e=>{},e=>null,g,v,_,E,e=>!1,e=>!0,w,e=>{const t=p(e),n={};for(let r=0;r<t;r++){const t=w(e);n[t]=k(e)}return n},e=>{const t=p(e),n=[];for(let r=0;r<t;r++)n.push(k(e));return n},d],k=e=>S[127-f(e)](e);class I extends c{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),u(this)?this.count=p(this)+1:this.count=-1),this.count--,this.s}}class A extends c{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=g(this);const e=i.GR(this.s);this.count=1,e&&(this.s=-this.s,this.count=p(this)+2)}return this.count--,this.s}}class T extends c{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){const e=g(this),t=1&e;this.diff=i.GW(e/2),this.count=1,t&&(this.count=p(this)+2)}return this.s+=this.diff,this.count--,this.s}}class R{constructor(e){this.decoder=new A(e),this.str=w(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}},8148:function(e,t,n){"use strict";n.d(t,{$F:function(){return p},EM:function(){return P},GF:function(){return N},HE:function(){return D},HK:function(){return E},Mf:function(){return l},TS:function(){return B},_f:function(){return h},kE:function(){return u},mP:function(){return S},sX:function(){return x},uE:function(){return g},uw:function(){return _}});n(7658);var r=n(3425),s=n(1383),i=n(4206),o=n(3388),a=n(654);class c{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const l=()=>new c,u=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},h=e=>{const t=new Uint8Array(u(e));let n=0;for(let r=0;r<e.bufs.length;r++){const s=e.bufs[r];t.set(s,n),n+=s.length}return t.set(r.Te(e.cbuf.buffer,0,e.cpos),n),t},d=(e,t)=>{const n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(r.Te(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*s.Fp(n,t)),e.cpos=0)},f=(e,t)=>{const n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},p=f,g=(e,t)=>{while(t>o.jS)f(e,o.x1|o.jS&t),t=s.GW(t/128);f(e,o.jS&t)},y=(e,t)=>{const n=s.GR(t);n&&(t=-t),f(e,(t>o.$2?o.x1:0)|(n?o.rc:0)|o.$2&t),t=s.GW(t/64);while(t>0)f(e,(t>o.jS?o.x1:0)|o.jS&t),t=s.GW(t/128)},m=new Uint8Array(3e4),w=m.length/3,b=(e,t)=>{if(t.length<w){const n=a.YZ.encodeInto(t,m).written||0;g(e,n);for(let t=0;t<n;t++)f(e,m[t])}else S(e,a.lz(t))},v=(e,t)=>{const n=unescape(encodeURIComponent(t)),r=n.length;g(e,r);for(let s=0;s<r;s++)f(e,n.codePointAt(s))},_=a.YZ&&a.YZ.encodeInto?b:v,E=(e,t)=>{const n=e.cbuf.length,r=e.cpos,i=s.VV(n-r,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(s.Fp(2*n,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},S=(e,t)=>{g(e,t.byteLength),E(e,t)},k=(e,t)=>{d(e,t);const n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},I=(e,t)=>k(e,4).setFloat32(0,t,!1),A=(e,t)=>k(e,8).setFloat64(0,t,!1),T=(e,t)=>k(e,8).setBigInt64(0,t,!1),R=new DataView(new ArrayBuffer(4)),C=e=>(R.setFloat32(0,e),R.getFloat32(0)===e),P=(e,t)=>{switch(typeof t){case"string":f(e,119),_(e,t);break;case"number":i.U(t)&&s.Wn(t)<=o.RP?(f(e,125),y(e,t)):C(t)?(f(e,124),I(e,t)):(f(e,123),A(e,t));break;case"bigint":f(e,122),T(e,t);break;case"object":if(null===t)f(e,126);else if(t instanceof Array){f(e,117),g(e,t.length);for(let n=0;n<t.length;n++)P(e,t[n])}else if(t instanceof Uint8Array)f(e,116),S(e,t);else{f(e,118);const n=Object.keys(t);g(e,n.length);for(let r=0;r<n.length;r++){const s=n[r];_(e,s),P(e,t[s])}}break;case"boolean":f(e,t?120:121);break;default:f(e,127)}};class N extends c{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&g(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const O=e=>{e.count>0&&(y(e.encoder,1===e.count?e.s:-e.s),e.count>1&&g(e.encoder,e.count-2))};class D{constructor(){this.encoder=new c,this.s=0,this.count=0}write(e){this.s===e?this.count++:(O(this),this.count=1,this.s=e)}toUint8Array(){return O(this),h(this.encoder)}}const L=e=>{if(e.count>0){const t=2*e.diff+(1===e.count?0:1);y(e.encoder,t),e.count>1&&g(e.encoder,e.count-2)}};class x{constructor(){this.encoder=new c,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(L(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return L(this),h(this.encoder)}}class B{constructor(){this.sarr=[],this.s="",this.lensE=new D}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new c;return this.sarr.push(this.s),this.s="",_(e,this.sarr.join("")),E(e,this.lensE.toUint8Array()),h(e)}}},5342:function(e,t,n){"use strict";n.d(t,{jU:function(){return l},UG:function(){return c},hH:function(){return m}});n(7658);var r=n(7862),s=n(654);const i=e=>void 0===e?null:e;var o=n(9674),a=n(7409);const c="undefined"!==typeof process&&process.release&&/node|io\.js/.test(process.release.name),l="undefined"!==typeof window&&!c;"undefined"!==typeof navigator&&/Mac/.test(navigator.platform);let u;const h=[],d=()=>{if(void 0===u)if(c){u=r.Ue();const e=process.argv;let t=null;for(let n=0;n<e.length;n++){const r=e[n];"-"===r[0]?(null!==t&&u.set(t,""),t=r):null!==t?(u.set(t,r),t=null):h.push(r)}null!==t&&u.set(t,"")}else"object"===typeof location?(u=r.Ue(),(location.search||"?").slice(1).split("&").forEach((e=>{if(0!==e.length){const[t,n]=e.split("=");u.set(`--${s.NF(t,"-")}`,n),u.set(`-${s.NF(t,"-")}`,n)}}))):u=r.Ue();return u},f=e=>d().has(e),p=e=>i(c?{NODE_ENV:"production",BASE_URL:"/ypu/"}[e.toUpperCase()]:o.X.getItem(e)),g=e=>f("--"+e)||null!==p(e),y=(g("production"),c&&a.gB({NODE_ENV:"production",BASE_URL:"/ypu/"}.FORCE_COLOR,["true","1","2"])),m=!f("no-colors")&&(!c||process.stdout.isTTY||y)&&(!c||f("color")||y||null!==p("COLORTERM")||(p("TERM")||"").includes("color"))},7409:function(e,t,n){"use strict";n.d(t,{Hi:function(){return o},PP:function(){return s},gB:function(){return a}});var r=n(1370);const s=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&s(e,t,n+1)}},i=(e,t)=>e===t,o=(e,t)=>{if(null==e||null==t)return i(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;break;case Map:if(e.size!==t.size)return!1;for(const n of e.keys())if(!t.has(n)||!o(e.get(n),t.get(n)))return!1;break;case Object:if(r.kE(e)!==r.kE(t))return!1;for(const n in e)if(!r.l$(e,n)||!o(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!o(e[n],t[n]))return!1;break;default:return!1}return!0},a=(e,t)=>t.includes(e)},7862:function(e,t,n){"use strict";n.d(t,{JG:function(){return s},UI:function(){return o},Ue:function(){return r},Yj:function(){return a},Yu:function(){return i}});n(7658);const r=()=>new Map,s=e=>{const t=r();return e.forEach(((e,n)=>{t.set(n,e)})),t},i=(e,t,n)=>{let r=e.get(t);return void 0===r&&e.set(t,r=n()),r},o=(e,t)=>{const n=[];for(const[r,s]of e)n.push(t(s,r));return n},a=(e,t)=>{for(const[n,r]of e)if(t(r,n))return!0;return!1}},1383:function(e,t,n){"use strict";n.d(t,{Fp:function(){return o},GR:function(){return c},GW:function(){return r},VV:function(){return i},Wn:function(){return s},sQ:function(){return a}});const r=Math.floor,s=(Math.ceil,Math.abs),i=(Math.imul,Math.round,Math.log10,Math.log2,Math.log,Math.sqrt,(e,t)=>e<t?e:t),o=(e,t)=>e>t?e:t,a=(Number.isNaN,Math.pow),c=(Math.sign,e=>0!==e?e<0:1/e<0)},4206:function(e,t,n){"use strict";n.d(t,{U:function(){return o},YM:function(){return i}});var r=n(1383),s=n(3388);const i=Number.MAX_SAFE_INTEGER,o=(Number.MIN_SAFE_INTEGER,s.RP,Number.isInteger||(e=>"number"===typeof e&&isFinite(e)&&r.GW(e)===e));Number.isNaN,Number.parseInt},1370:function(e,t,n){"use strict";n.d(t,{$m:function(){return c},UI:function(){return s},kE:function(){return i},l$:function(){return a}});n(7658);Object.assign;const r=Object.keys,s=(e,t)=>{const n=[];for(const r in e)n.push(t(e[r],r));return n},i=e=>r(e).length,o=(e,t)=>{for(const n in e)if(!t(e[n],n))return!1;return!0},a=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c=(e,t)=>e===t||i(e)===i(t)&&o(e,((e,n)=>(void 0!==e||a(t,n))&&t[n]===e))},6055:function(e,t,n){"use strict";n.d(t,{y:function(){return o}});var r=n(7862),s=n(893),i=n(5989);class o{constructor(){this._observers=r.Ue()}on(e,t){r.Yu(this._observers,e,s.Ue).add(t)}once(e,t){const n=(...r)=>{this.off(e,n),t(...r)};this.on(e,n)}off(e,t){const n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return i.Dp((this._observers.get(e)||r.Ue()).values()).forEach((e=>e(...t)))}destroy(){this._observers=r.Ue()}}},893:function(e,t,n){"use strict";n.d(t,{Ue:function(){return r}});const r=()=>new Set},9674:function(e,t,n){"use strict";n.d(t,{X:function(){return o},z:function(){return a}});class r{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let s=new r,i=!0;try{"undefined"!==typeof localStorage&&(s=localStorage,i=!1)}catch(c){}const o=s,a=e=>i||addEventListener("storage",e)},654:function(e,t,n){"use strict";n.d(t,{CO:function(){return f},IK:function(){return r},NF:function(){return c},YZ:function(){return u},lz:function(){return d}});const r=String.fromCharCode,s=(String.fromCodePoint,e=>e.toLowerCase()),i=/^\s*/g,o=e=>e.replace(i,""),a=/([A-Z])/g,c=(e,t)=>o(e.replace(a,(e=>`${t}${s(e)}`))),l=e=>{const t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.codePointAt(s);return r},u="undefined"!==typeof TextEncoder?new TextEncoder:null,h=e=>u.encode(e),d=u?h:l;let f="undefined"===typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});f&&1===f.decode(new Uint8Array).length&&(f=null)},313:function(e,t,n){"use strict";n.d(t,{ZG:function(){return r}});const r=Date.now},7082:function(e,t,n){"use strict";function r(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(255!==n[o])throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";var n=0,r=0,s=0,i=t.length;while(s!==i&&0===t[s])s++,n++;var o=(i-s)*u+1>>>0,l=new Uint8Array(o);while(s!==i){for(var h=t[s],d=0,f=o-1;(0!==h||d<r)&&-1!==f;f--,d++)h+=256*l[f]>>>0,l[f]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=d,s++}var p=o-r;while(p!==o&&0===l[p])p++;for(var g=c.repeat(n);p<o;++p)g+=e.charAt(l[p]);return g}function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){var r=0,s=0;while(e[t]===c)r++,t++;var i=(e.length-t)*l+1>>>0,o=new Uint8Array(i);while(e[t]){var u=n[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=i-1;(0!==u||h<s)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");s=h,t++}if(" "!==e[t]){var f=i-s;while(f!==i&&0===o[f])f++;var p=new Uint8Array(r+(i-f)),g=r;while(f!==i)p[g++]=o[f++];return p}}}function f(e){var n=d(e);if(n)return n;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:d,decode:f}}n.d(t,{kU:function(){return p},Dp:function(){return f},ET:function(){return m}});var s=r,i=s,o=i,a=n(9481);class c{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class l{constructor(e,t,n){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return h(this,e)}}class u{constructor(e){this.decoders=e}or(e){return h(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const h=(e,t)=>new u({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class d{constructor(e,t,n,r){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new c(e,t,n),this.decoder=new l(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const f=({name:e,prefix:t,encode:n,decode:r})=>new d(e,t,n,r),p=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=o(n,t);return f({prefix:e,name:t,encode:r,decode:e=>(0,a.coerce)(s(e))})},g=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;while("="===e[i-1])--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const t=s[e[u]];if(void 0===t)throw new SyntaxError(`Non-${r} character`);c=c<<n|t,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},y=(e,t,n)=>{const r="="===t[t.length-1],s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c){a=a<<8|e[c],o+=8;while(o>n)o-=n,i+=t[s&a>>o]}if(o&&(i+=t[s&a<<n-o]),r)while(i.length*n&7)i+="=";return i},m=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>f({prefix:t,name:e,encode(e){return y(e,r,n)},decode(t){return g(t,r,n,e)}})},248:function(e,t,n){"use strict";n.r(t),n.d(t,{base32:function(){return s},base32hex:function(){return c},base32hexpad:function(){return u},base32hexpadupper:function(){return h},base32hexupper:function(){return l},base32pad:function(){return o},base32padupper:function(){return a},base32upper:function(){return i},base32z:function(){return d}});var r=n(7082);const s=(0,r.ET)({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),i=(0,r.ET)({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),o=(0,r.ET)({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),a=(0,r.ET)({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),c=(0,r.ET)({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),l=(0,r.ET)({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),u=(0,r.ET)({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),h=(0,r.ET)({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),d=(0,r.ET)({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})},1780:function(e,t,n){"use strict";n.r(t),n.d(t,{base58btc:function(){return s},base58flickr:function(){return i}});var r=n(7082);const s=(0,r.kU)({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),i=(0,r.kU)({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})},9481:function(e,t,n){"use strict";n.r(t),n.d(t,{coerce:function(){return a},empty:function(){return r},equals:function(){return o},fromHex:function(){return i},fromString:function(){return l},isBinary:function(){return c},toHex:function(){return s},toString:function(){return u}});const r=new Uint8Array(0),s=e=>e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""),i=e=>{const t=e.match(/../g);return t?new Uint8Array(t.map((e=>parseInt(e,16)))):r},o=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0},a=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},c=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),l=e=>(new TextEncoder).encode(e),u=e=>(new TextDecoder).decode(e)},608:function(e,t,n){"use strict";n.d(t,{k0:function(){return h}});var r=n(6043),s=n(7880),i=n(1780),o=n(248),a=n(9481);const c=(e,t)=>{const{bytes:n,version:r}=e;switch(r){case 0:return f(n,u(e),t||i.base58btc.encoder);default:return p(n,u(e),t||o.base32.encoder)}},l=new WeakMap,u=e=>{const t=l.get(e);if(null==t){const t=new Map;return l.set(e,t),t}return t};class h{constructor(e,t,n,r){this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==g)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==y)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=s.Ue(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return h.equals(this,e)}static equals(e,t){const n=t;return n&&e.code===n.code&&e.version===n.version&&s.fS(e.multihash,n.multihash)}toString(e){return c(this,e)}toJSON(){return{"/":c(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(null==e)return null;const t=e;if(t instanceof h)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:s}=t;return new h(e,n,r,s||m(e,n,r.bytes))}if(!0===t[w]){const{version:e,multihash:n,code:r}=t,i=s.Jx(n);return h.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==g)throw new Error(`Version 0 CID must use dag-pb (code: ${g}) block encoding`);return new h(e,t,n,n.bytes);case 1:{const r=m(e,t,n.bytes);return new h(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,g,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){const[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=h.inspectBytes(e),n=t.size-t.multihashSize,r=(0,a.coerce)(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new s.zZ(t.multihashCode,t.digestSize,i,r),c=0===t.version?h.createV0(o):h.createV1(t.codec,o);return[c,e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,s]=r.Jx(e.subarray(t));return t+=s,n};let s=n(),i=g;if(18===s?(s=0,t=0):i=n(),0!==s&&1!==s)throw new RangeError(`Invalid CID version ${s}`);const o=t,a=n(),c=n(),l=t+c,u=l-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:l}}static parse(e,t){const[n,r]=d(e,t),s=h.decode(r);if(0===s.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return u(s).set(n,e),s}}const d=(e,t)=>{switch(e[0]){case"Q":{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(`${i.base58btc.prefix}${e}`)]}case i.base58btc.prefix:{const n=t||i.base58btc;return[i.base58btc.prefix,n.decode(e)]}case o.base32.prefix:{const n=t||o.base32;return[o.base32.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},f=(e,t,n)=>{const{prefix:r}=n;if(r!==i.base58btc.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const s=t.get(r);if(null==s){const s=n.encode(e).slice(1);return t.set(r,s),s}return s},p=(e,t,n)=>{const{prefix:r}=n,s=t.get(r);if(null==s){const s=n.encode(e);return t.set(r,s),s}return s},g=112,y=18,m=(e,t,n)=>{const s=r.P$(e),i=s+r.P$(t),o=new Uint8Array(i+n.byteLength);return r.mL(e,o,0),r.mL(t,o,s),o.set(n,i),o},w=Symbol.for("@ipld/js-cid/CID")},7880:function(e,t,n){"use strict";n.d(t,{Jx:function(){return o},Ue:function(){return i},fS:function(){return a},zZ:function(){return c}});var r=n(9481),s=n(6043);const i=(e,t)=>{const n=t.byteLength,r=s.P$(e),i=r+s.P$(n),o=new Uint8Array(i+n);return s.mL(e,o,0),s.mL(n,o,r),o.set(t,i),new c(e,n,t,o)},o=e=>{const t=(0,r.coerce)(e),[n,i]=s.Jx(t),[o,a]=s.Jx(t.subarray(i)),l=t.subarray(i+a);if(l.byteLength!==o)throw new Error("Incorrect length");return new c(n,o,l,t)},a=(e,t)=>{if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&(0,r.equals)(e.bytes,n.bytes)}};class c{constructor(e,t,n,r){this.code=e,this.size=t,this.digest=n,this.bytes=r}}},5040:function(e,t,n){"use strict";n.d(t,{D:function(){return s}});var r=n(7880);const s=({name:e,code:t,encode:n})=>new i(e,t,n);class i{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?r.Ue(this.code,t):t.then((e=>r.Ue(this.code,e)))}throw Error("Unknown type, must be binary type")}}},7985:function(e,t,n){"use strict";n.d(t,{aI:function(){return s},k0:function(){return r.k0}});var r=n(608),s=(n(6043),n(9481));n(5040),n(7880)},6043:function(e,t,n){"use strict";n.d(t,{Jx:function(){return A},mL:function(){return T},P$:function(){return R}});var r=c,s=128,i=127,o=~i,a=Math.pow(2,31);function c(e,t,n){t=t||[],n=n||0;var r=n;while(e>=a)t[n++]=255&e|s,e/=128;while(e&o)t[n++]=255&e|s,e>>>=7;return t[n]=0|e,c.bytes=n-r+1,t}var l=d,u=128,h=127;function d(e,t){var n,r=0,s=(t=t||0,0),i=t,o=e.length;do{if(i>=o)throw d.bytes=0,new RangeError("Could not decode varint");n=e[i++],r+=s<28?(n&h)<<s:(n&h)*Math.pow(2,s),s+=7}while(n>=u);return d.bytes=i-t,r}var f=Math.pow(2,7),p=Math.pow(2,14),g=Math.pow(2,21),y=Math.pow(2,28),m=Math.pow(2,35),w=Math.pow(2,42),b=Math.pow(2,49),v=Math.pow(2,56),_=Math.pow(2,63),E=function(e){return e<f?1:e<p?2:e<g?3:e<y?4:e<m?5:e<w?6:e<b?7:e<v?8:e<_?9:10},S={encode:r,decode:l,encodingLength:E},k=S,I=k;const A=(e,t=0)=>{const n=I.decode(e,t);return[n,I.decode.bytes]},T=(e,t,n=0)=>(I.encode(e,t,n),t),R=e=>I.encodingLength(e)},2483:function(e,t,n){"use strict";n.d(t,{PO:function(){return F},p7:function(){return tt}});n(7658),n(541);var r=n(3396),s=n(4870);
/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */
const i="undefined"!==typeof window;function o(e){return e.__esModule||"Module"===e[Symbol.toStringTag]}const a=Object.assign;function c(e,t){const n={};for(const r in t){const s=t[r];n[r]=u(s)?s.map(e):e(s)}return n}const l=()=>{},u=Array.isArray;const h=/\/$/,d=e=>e.replace(h,"");function f(e,t,n="/"){let r,s={},i="",o="";const a=t.indexOf("#");let c=t.indexOf("?");return a<c&&a>=0&&(c=-1),c>-1&&(r=t.slice(0,c),i=t.slice(c+1,a>-1?a:t.length),s=e(i)),a>-1&&(r=r||t.slice(0,a),o=t.slice(a,t.length)),r=_(null!=r?r:t,n),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:o}}function p(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function g(e,t){return t&&e.toLowerCase().startsWith(t.toLowerCase())?e.slice(t.length)||"/":e}function y(e,t,n){const r=t.matched.length-1,s=n.matched.length-1;return r>-1&&r===s&&m(t.matched[r],n.matched[s])&&w(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function m(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function w(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!b(e[n],t[n]))return!1;return!0}function b(e,t){return u(e)?v(e,t):u(t)?v(t,e):e===t}function v(e,t){return u(t)?e.length===t.length&&e.every(((e,n)=>e===t[n])):1===e.length&&e[0]===t}function _(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),r=e.split("/");let s,i,o=n.length-1;for(s=0;s<r.length;s++)if(i=r[s],"."!==i){if(".."!==i)break;o>1&&o--}return n.slice(0,o).join("/")+"/"+r.slice(s-(s===r.length?1:0)).join("/")}var E,S;(function(e){e["pop"]="pop",e["push"]="push"})(E||(E={})),function(e){e["back"]="back",e["forward"]="forward",e["unknown"]=""}(S||(S={}));function k(e){if(!e)if(i){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return"/"!==e[0]&&"#"!==e[0]&&(e="/"+e),d(e)}const I=/^[^#]+#/;function A(e,t){return e.replace(I,"#")+t}function T(e,t){const n=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-n.left-(t.left||0),top:r.top-n.top-(t.top||0)}}const R=()=>({left:window.pageXOffset,top:window.pageYOffset});function C(e){let t;if("el"in e){const n=e.el,r="string"===typeof n&&n.startsWith("#");0;const s="string"===typeof n?r?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!s)return;t=T(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(null!=t.left?t.left:window.pageXOffset,null!=t.top?t.top:window.pageYOffset)}function P(e,t){const n=history.state?history.state.position-t:-1;return n+e}const N=new Map;function O(e,t){N.set(e,t)}function D(e){const t=N.get(e);return N.delete(e),t}let L=()=>location.protocol+"//"+location.host;function x(e,t){const{pathname:n,search:r,hash:s}=t,i=e.indexOf("#");if(i>-1){let t=s.includes(e.slice(i))?e.slice(i).length:1,n=s.slice(t);return"/"!==n[0]&&(n="/"+n),g(n,"")}const o=g(n,e);return o+r+s}function B(e,t,n,r){let s=[],i=[],o=null;const c=({state:i})=>{const a=x(e,location),c=n.value,l=t.value;let u=0;if(i){if(n.value=a,t.value=i,o&&o===c)return void(o=null);u=l?i.position-l.position:0}else r(a);s.forEach((e=>{e(n.value,c,{delta:u,type:E.pop,direction:u?u>0?S.forward:S.back:S.unknown})}))};function l(){o=n.value}function u(e){s.push(e);const t=()=>{const t=s.indexOf(e);t>-1&&s.splice(t,1)};return i.push(t),t}function h(){const{history:e}=window;e.state&&e.replaceState(a({},e.state,{scroll:R()}),"")}function d(){for(const e of i)e();i=[],window.removeEventListener("popstate",c),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",c),window.addEventListener("beforeunload",h),{pauseListeners:l,listen:u,destroy:d}}function M(e,t,n,r=!1,s=!1){return{back:e,current:t,forward:n,replaced:r,position:window.history.length,scroll:s?R():null}}function U(e){const{history:t,location:n}=window,r={value:x(e,n)},s={value:t.state};function i(r,i,o){const a=e.indexOf("#"),c=a>-1?(n.host&&document.querySelector("base")?e:e.slice(a))+r:L()+e+r;try{t[o?"replaceState":"pushState"](i,"",c),s.value=i}catch(l){console.error(l),n[o?"replace":"assign"](c)}}function o(e,n){const o=a({},t.state,M(s.value.back,e,s.value.forward,!0),n,{position:s.value.position});i(e,o,!0),r.value=e}function c(e,n){const o=a({},s.value,t.state,{forward:e,scroll:R()});i(o.current,o,!0);const c=a({},M(r.value,e,null),{position:o.position+1},n);i(e,c,!1),r.value=e}return s.value||i(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0),{location:r,state:s,push:c,replace:o}}function F(e){e=k(e);const t=U(e),n=B(e,t.state,t.location,t.replace);function r(e,t=!0){t||n.pauseListeners(),history.go(e)}const s=a({location:"",base:e,go:r,createHref:A.bind(null,e)},t,n);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function j(e){return"string"===typeof e||e&&"object"===typeof e}function V(e){return"string"===typeof e||"symbol"===typeof e}const z={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},$=Symbol("");var K;(function(e){e[e["aborted"]=4]="aborted",e[e["cancelled"]=8]="cancelled",e[e["duplicated"]=16]="duplicated"})(K||(K={}));function H(e,t){return a(new Error,{type:e,[$]:!0},t)}function q(e,t){return e instanceof Error&&$ in e&&(null==t||!!(e.type&t))}const W="[^/]+?",G={sensitive:!1,strict:!1,start:!0,end:!0},Y=/[.+*?^${}()[\]/\\]/g;function Q(e,t){const n=a({},G,t),r=[];let s=n.start?"^":"";const i=[];for(const a of e){const e=a.length?[]:[90];n.strict&&!a.length&&(s+="/");for(let t=0;t<a.length;t++){const r=a[t];let o=40+(n.sensitive?.25:0);if(0===r.type)t||(s+="/"),s+=r.value.replace(Y,"\\$&"),o+=40;else if(1===r.type){const{value:e,repeatable:n,optional:c,regexp:l}=r;i.push({name:e,repeatable:n,optional:c});const u=l||W;if(u!==W){o+=10;try{new RegExp(`(${u})`)}catch(h){throw new Error(`Invalid custom RegExp for param "${e}" (${u}): `+h.message)}}let d=n?`((?:${u})(?:/(?:${u}))*)`:`(${u})`;t||(d=c&&a.length<2?`(?:/${d})`:"/"+d),c&&(d+="?"),s+=d,o+=20,c&&(o+=-8),n&&(o+=-20),".*"===u&&(o+=-50)}e.push(o)}r.push(e)}if(n.strict&&n.end){const e=r.length-1;r[e][r[e].length-1]+=.7000000000000001}n.strict||(s+="/?"),n.end?s+="$":n.strict&&(s+="(?:/|$)");const o=new RegExp(s,n.sensitive?"":"i");function c(e){const t=e.match(o),n={};if(!t)return null;for(let r=1;r<t.length;r++){const e=t[r]||"",s=i[r-1];n[s.name]=e&&s.repeatable?e.split("/"):e}return n}function l(t){let n="",r=!1;for(const s of e){r&&n.endsWith("/")||(n+="/"),r=!1;for(const e of s)if(0===e.type)n+=e.value;else if(1===e.type){const{value:i,repeatable:o,optional:a}=e,c=i in t?t[i]:"";if(u(c)&&!o)throw new Error(`Provided param "${i}" is an array but it is not repeatable (* or + modifiers)`);const l=u(c)?c.join("/"):c;if(!l){if(!a)throw new Error(`Missing required param "${i}"`);s.length<2&&(n.endsWith("/")?n=n.slice(0,-1):r=!0)}n+=l}}return n||"/"}return{re:o,score:r,keys:i,parse:c,stringify:l}}function X(e,t){let n=0;while(n<e.length&&n<t.length){const r=t[n]-e[n];if(r)return r;n++}return e.length<t.length?1===e.length&&80===e[0]?-1:1:e.length>t.length?1===t.length&&80===t[0]?1:-1:0}function J(e,t){let n=0;const r=e.score,s=t.score;while(n<r.length&&n<s.length){const e=X(r[n],s[n]);if(e)return e;n++}if(1===Math.abs(s.length-r.length)){if(Z(r))return 1;if(Z(s))return-1}return s.length-r.length}function Z(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const ee={type:0,value:""},te=/[a-zA-Z0-9_]/;function ne(e){if(!e)return[[]];if("/"===e)return[[ee]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(e){throw new Error(`ERR (${n})/"${l}": ${e}`)}let n=0,r=n;const s=[];let i;function o(){i&&s.push(i),i=[]}let a,c=0,l="",u="";function h(){l&&(0===n?i.push({type:0,value:l}):1===n||2===n||3===n?(i.length>1&&("*"===a||"+"===a)&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:"*"===a||"+"===a,optional:"*"===a||"?"===a})):t("Invalid state to consume buffer"),l="")}function d(){l+=a}while(c<e.length)if(a=e[c++],"\\"!==a||2===n)switch(n){case 0:"/"===a?(l&&h(),o()):":"===a?(h(),n=1):d();break;case 4:d(),n=r;break;case 1:"("===a?n=2:te.test(a)?d():(h(),n=0,"*"!==a&&"?"!==a&&"+"!==a&&c--);break;case 2:")"===a?"\\"==u[u.length-1]?u=u.slice(0,-1)+a:n=3:u+=a;break;case 3:h(),n=0,"*"!==a&&"?"!==a&&"+"!==a&&c--,u="";break;default:t("Unknown state");break}else r=n,n=4;return 2===n&&t(`Unfinished custom RegExp for param "${l}"`),h(),o(),s}function re(e,t,n){const r=Q(ne(e.path),n);const s=a(r,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf===!t.record.aliasOf&&t.children.push(s),s}function se(e,t){const n=[],r=new Map;function s(e){return r.get(e)}function i(e,n,r){const s=!r,c=oe(e);c.aliasOf=r&&r.record;const h=ue(t,e),d=[c];if("alias"in e){const t="string"===typeof e.alias?[e.alias]:e.alias;for(const e of t)d.push(a({},c,{components:r?r.record.components:c.components,path:e,aliasOf:r?r.record:c}))}let f,p;for(const t of d){const{path:a}=t;if(n&&"/"!==a[0]){const e=n.record.path,r="/"===e[e.length-1]?"":"/";t.path=n.record.path+(a&&r+a)}if(f=re(t,n,h),r?r.alias.push(f):(p=p||f,p!==f&&p.alias.push(f),s&&e.name&&!ce(f)&&o(e.name)),c.children){const e=c.children;for(let t=0;t<e.length;t++)i(e[t],f,r&&r.children[t])}r=r||f,(f.record.components&&Object.keys(f.record.components).length||f.record.name||f.record.redirect)&&u(f)}return p?()=>{o(p)}:l}function o(e){if(V(e)){const t=r.get(e);t&&(r.delete(e),n.splice(n.indexOf(t),1),t.children.forEach(o),t.alias.forEach(o))}else{const t=n.indexOf(e);t>-1&&(n.splice(t,1),e.record.name&&r.delete(e.record.name),e.children.forEach(o),e.alias.forEach(o))}}function c(){return n}function u(e){let t=0;while(t<n.length&&J(e,n[t])>=0&&(e.record.path!==n[t].record.path||!he(e,n[t])))t++;n.splice(t,0,e),e.record.name&&!ce(e)&&r.set(e.record.name,e)}function h(e,t){let s,i,o,c={};if("name"in e&&e.name){if(s=r.get(e.name),!s)throw H(1,{location:e});0,o=s.record.name,c=a(ie(t.params,s.keys.filter((e=>!e.optional)).map((e=>e.name))),e.params&&ie(e.params,s.keys.map((e=>e.name)))),i=s.stringify(c)}else if("path"in e)i=e.path,s=n.find((e=>e.re.test(i))),s&&(c=s.parse(i),o=s.record.name);else{if(s=t.name?r.get(t.name):n.find((e=>e.re.test(t.path))),!s)throw H(1,{location:e,currentLocation:t});o=s.record.name,c=a({},t.params,e.params),i=s.stringify(c)}const l=[];let u=s;while(u)l.unshift(u.record),u=u.parent;return{name:o,path:i,params:c,matched:l,meta:le(l)}}return t=ue({strict:!1,end:!0,sensitive:!1},t),e.forEach((e=>i(e))),{addRoute:i,resolve:h,removeRoute:o,getRoutes:c,getRecordMatcher:s}}function ie(e,t){const n={};for(const r of t)r in e&&(n[r]=e[r]);return n}function oe(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:ae(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function ae(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const r in e.components)t[r]="boolean"===typeof n?n:n[r];return t}function ce(e){while(e){if(e.record.aliasOf)return!0;e=e.parent}return!1}function le(e){return e.reduce(((e,t)=>a(e,t.meta)),{})}function ue(e,t){const n={};for(const r in e)n[r]=r in t?t[r]:e[r];return n}function he(e,t){return t.children.some((t=>t===e||he(e,t)))}const de=/#/g,fe=/&/g,pe=/\//g,ge=/=/g,ye=/\?/g,me=/\+/g,we=/%5B/g,be=/%5D/g,ve=/%5E/g,_e=/%60/g,Ee=/%7B/g,Se=/%7C/g,ke=/%7D/g,Ie=/%20/g;function Ae(e){return encodeURI(""+e).replace(Se,"|").replace(we,"[").replace(be,"]")}function Te(e){return Ae(e).replace(Ee,"{").replace(ke,"}").replace(ve,"^")}function Re(e){return Ae(e).replace(me,"%2B").replace(Ie,"+").replace(de,"%23").replace(fe,"%26").replace(_e,"`").replace(Ee,"{").replace(ke,"}").replace(ve,"^")}function Ce(e){return Re(e).replace(ge,"%3D")}function Pe(e){return Ae(e).replace(de,"%23").replace(ye,"%3F")}function Ne(e){return null==e?"":Pe(e).replace(pe,"%2F")}function Oe(e){try{return decodeURIComponent(""+e)}catch(t){}return""+e}function De(e){const t={};if(""===e||"?"===e)return t;const n="?"===e[0],r=(n?e.slice(1):e).split("&");for(let s=0;s<r.length;++s){const e=r[s].replace(me," "),n=e.indexOf("="),i=Oe(n<0?e:e.slice(0,n)),o=n<0?null:Oe(e.slice(n+1));if(i in t){let e=t[i];u(e)||(e=t[i]=[e]),e.push(o)}else t[i]=o}return t}function Le(e){let t="";for(let n in e){const r=e[n];if(n=Ce(n),null==r){void 0!==r&&(t+=(t.length?"&":"")+n);continue}const s=u(r)?r.map((e=>e&&Re(e))):[r&&Re(r)];s.forEach((e=>{void 0!==e&&(t+=(t.length?"&":"")+n,null!=e&&(t+="="+e))}))}return t}function xe(e){const t={};for(const n in e){const r=e[n];void 0!==r&&(t[n]=u(r)?r.map((e=>null==e?null:""+e)):null==r?r:""+r)}return t}const Be=Symbol(""),Me=Symbol(""),Ue=Symbol(""),Fe=Symbol(""),je=Symbol("");function Ve(){let e=[];function t(t){return e.push(t),()=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)}}function n(){e=[]}return{add:t,list:()=>e,reset:n}}function ze(e,t,n,r,s){const i=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise(((o,a)=>{const c=e=>{!1===e?a(H(4,{from:n,to:t})):e instanceof Error?a(e):j(e)?a(H(2,{from:t,to:e})):(i&&r.enterCallbacks[s]===i&&"function"===typeof e&&i.push(e),o())},l=e.call(r&&r.instances[s],t,n,c);let u=Promise.resolve(l);e.length<3&&(u=u.then(c)),u.catch((e=>a(e)))}))}function $e(e,t,n,r){const s=[];for(const i of e){0;for(const e in i.components){let a=i.components[e];if("beforeRouteEnter"===t||i.instances[e])if(Ke(a)){const o=a.__vccOpts||a,c=o[t];c&&s.push(ze(c,n,r,i,e))}else{let c=a();0,s.push((()=>c.then((s=>{if(!s)return Promise.reject(new Error(`Couldn't resolve component "${e}" at "${i.path}"`));const a=o(s)?s.default:s;i.components[e]=a;const c=a.__vccOpts||a,l=c[t];return l&&ze(l,n,r,i,e)()}))))}}}return s}function Ke(e){return"object"===typeof e||"displayName"in e||"props"in e||"__vccOpts"in e}function He(e){const t=(0,r.f3)(Ue),n=(0,r.f3)(Fe),i=(0,r.Fl)((()=>t.resolve((0,s.SU)(e.to)))),o=(0,r.Fl)((()=>{const{matched:e}=i.value,{length:t}=e,r=e[t-1],s=n.matched;if(!r||!s.length)return-1;const o=s.findIndex(m.bind(null,r));if(o>-1)return o;const a=Qe(e[t-2]);return t>1&&Qe(r)===a&&s[s.length-1].path!==a?s.findIndex(m.bind(null,e[t-2])):o})),a=(0,r.Fl)((()=>o.value>-1&&Ye(n.params,i.value.params))),c=(0,r.Fl)((()=>o.value>-1&&o.value===n.matched.length-1&&w(n.params,i.value.params)));function u(n={}){return Ge(n)?t[(0,s.SU)(e.replace)?"replace":"push"]((0,s.SU)(e.to)).catch(l):Promise.resolve()}return{route:i,href:(0,r.Fl)((()=>i.value.href)),isActive:a,isExactActive:c,navigate:u}}const qe=(0,r.aZ)({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:He,setup(e,{slots:t}){const n=(0,s.qj)(He(e)),{options:i}=(0,r.f3)(Ue),o=(0,r.Fl)((()=>({[Xe(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[Xe(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive})));return()=>{const s=t.default&&t.default(n);return e.custom?s:(0,r.h)("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:o.value},s)}}}),We=qe;function Ge(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&(void 0===e.button||0===e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Ye(e,t){for(const n in t){const r=t[n],s=e[n];if("string"===typeof r){if(r!==s)return!1}else if(!u(s)||s.length!==r.length||r.some(((e,t)=>e!==s[t])))return!1}return!0}function Qe(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Xe=(e,t,n)=>null!=e?e:null!=t?t:n,Je=(0,r.aZ)({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=(0,r.f3)(je),o=(0,r.Fl)((()=>e.route||i.value)),c=(0,r.f3)(Me,0),l=(0,r.Fl)((()=>{let e=(0,s.SU)(c);const{matched:t}=o.value;let n;while((n=t[e])&&!n.components)e++;return e})),u=(0,r.Fl)((()=>o.value.matched[l.value]));(0,r.JJ)(Me,(0,r.Fl)((()=>l.value+1))),(0,r.JJ)(Be,u),(0,r.JJ)(je,o);const h=(0,s.iH)();return(0,r.YP)((()=>[h.value,u.value,e.name]),(([e,t,n],[r,s,i])=>{t&&(t.instances[n]=e,s&&s!==t&&e&&e===r&&(t.leaveGuards.size||(t.leaveGuards=s.leaveGuards),t.updateGuards.size||(t.updateGuards=s.updateGuards))),!e||!t||s&&m(t,s)&&r||(t.enterCallbacks[n]||[]).forEach((t=>t(e)))}),{flush:"post"}),()=>{const s=o.value,i=e.name,c=u.value,l=c&&c.components[i];if(!l)return Ze(n.default,{Component:l,route:s});const d=c.props[i],f=d?!0===d?s.params:"function"===typeof d?d(s):d:null,p=e=>{e.component.isUnmounted&&(c.instances[i]=null)},g=(0,r.h)(l,a({},f,t,{onVnodeUnmounted:p,ref:h}));return Ze(n.default,{Component:g,route:s})||g}}});function Ze(e,t){if(!e)return null;const n=e(t);return 1===n.length?n[0]:n}const et=Je;function tt(e){const t=se(e.routes,e),n=e.parseQuery||De,o=e.stringifyQuery||Le,h=e.history;const d=Ve(),g=Ve(),m=Ve(),w=(0,s.XI)(z);let b=z;i&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const v=c.bind(null,(e=>""+e)),_=c.bind(null,Ne),S=c.bind(null,Oe);function k(e,n){let r,s;return V(e)?(r=t.getRecordMatcher(e),s=n):s=e,t.addRoute(s,r)}function I(e){const n=t.getRecordMatcher(e);n&&t.removeRoute(n)}function A(){return t.getRoutes().map((e=>e.record))}function T(e){return!!t.getRecordMatcher(e)}function N(e,r){if(r=a({},r||w.value),"string"===typeof e){const s=f(n,e,r.path),i=t.resolve({path:s.path},r),o=h.createHref(s.fullPath);return a(s,i,{params:S(i.params),hash:Oe(s.hash),redirectedFrom:void 0,href:o})}let s;if("path"in e)s=a({},e,{path:f(n,e.path,r.path).path});else{const t=a({},e.params);for(const e in t)null==t[e]&&delete t[e];s=a({},e,{params:_(e.params)}),r.params=_(r.params)}const i=t.resolve(s,r),c=e.hash||"";i.params=v(S(i.params));const l=p(o,a({},e,{hash:Te(c),path:i.path})),u=h.createHref(l);return a({fullPath:l,hash:c,query:o===Le?xe(e.query):e.query||{}},i,{redirectedFrom:void 0,href:u})}function L(e){return"string"===typeof e?f(n,e,w.value.path):a({},e)}function x(e,t){if(b!==e)return H(8,{from:t,to:e})}function B(e){return F(e)}function M(e){return B(a(L(e),{replace:!0}))}function U(e){const t=e.matched[e.matched.length-1];if(t&&t.redirect){const{redirect:n}=t;let r="function"===typeof n?n(e):n;return"string"===typeof r&&(r=r.includes("?")||r.includes("#")?r=L(r):{path:r},r.params={}),a({query:e.query,hash:e.hash,params:"path"in r?{}:e.params},r)}}function F(e,t){const n=b=N(e),r=w.value,s=e.state,i=e.force,c=!0===e.replace,l=U(n);if(l)return F(a(L(l),{state:"object"===typeof l?a({},s,l.state):s,force:i,replace:c}),t||n);const u=n;let h;return u.redirectedFrom=t,!i&&y(o,r,n)&&(h=H(16,{to:u,from:r}),ne(r,r,!0,!1)),(h?Promise.resolve(h):$(u,r)).catch((e=>q(e)?q(e,2)?e:te(e):Z(e,u,r))).then((e=>{if(e){if(q(e,2))return F(a({replace:c},L(e.to),{state:"object"===typeof e.to?a({},s,e.to.state):s,force:i}),t||u)}else e=W(u,r,!0,c,s);return K(u,r,e),e}))}function j(e,t){const n=x(e,t);return n?Promise.reject(n):Promise.resolve()}function $(e,t){let n;const[r,s,i]=rt(e,t);n=$e(r.reverse(),"beforeRouteLeave",e,t);for(const a of r)a.leaveGuards.forEach((r=>{n.push(ze(r,e,t))}));const o=j.bind(null,e,t);return n.push(o),nt(n).then((()=>{n=[];for(const r of d.list())n.push(ze(r,e,t));return n.push(o),nt(n)})).then((()=>{n=$e(s,"beforeRouteUpdate",e,t);for(const r of s)r.updateGuards.forEach((r=>{n.push(ze(r,e,t))}));return n.push(o),nt(n)})).then((()=>{n=[];for(const r of e.matched)if(r.beforeEnter&&!t.matched.includes(r))if(u(r.beforeEnter))for(const s of r.beforeEnter)n.push(ze(s,e,t));else n.push(ze(r.beforeEnter,e,t));return n.push(o),nt(n)})).then((()=>(e.matched.forEach((e=>e.enterCallbacks={})),n=$e(i,"beforeRouteEnter",e,t),n.push(o),nt(n)))).then((()=>{n=[];for(const r of g.list())n.push(ze(r,e,t));return n.push(o),nt(n)})).catch((e=>q(e,8)?e:Promise.reject(e)))}function K(e,t,n){for(const r of m.list())r(e,t,n)}function W(e,t,n,r,s){const o=x(e,t);if(o)return o;const c=t===z,l=i?history.state:{};n&&(r||c?h.replace(e.fullPath,a({scroll:c&&l&&l.scroll},s)):h.push(e.fullPath,s)),w.value=e,ne(e,t,n,c),te()}let G;function Y(){G||(G=h.listen(((e,t,n)=>{if(!ae.listening)return;const r=N(e),s=U(r);if(s)return void F(a(s,{replace:!0}),r).catch(l);b=r;const o=w.value;i&&O(P(o.fullPath,n.delta),R()),$(r,o).catch((e=>q(e,12)?e:q(e,2)?(F(e.to,r).then((e=>{q(e,20)&&!n.delta&&n.type===E.pop&&h.go(-1,!1)})).catch(l),Promise.reject()):(n.delta&&h.go(-n.delta,!1),Z(e,r,o)))).then((e=>{e=e||W(r,o,!1),e&&(n.delta&&!q(e,8)?h.go(-n.delta,!1):n.type===E.pop&&q(e,20)&&h.go(-1,!1)),K(r,o,e)})).catch(l)})))}let Q,X=Ve(),J=Ve();function Z(e,t,n){te(e);const r=J.list();return r.length?r.forEach((r=>r(e,t,n))):console.error(e),Promise.reject(e)}function ee(){return Q&&w.value!==z?Promise.resolve():new Promise(((e,t)=>{X.add([e,t])}))}function te(e){return Q||(Q=!e,Y(),X.list().forEach((([t,n])=>e?n(e):t())),X.reset()),e}function ne(t,n,s,o){const{scrollBehavior:a}=e;if(!i||!a)return Promise.resolve();const c=!s&&D(P(t.fullPath,0))||(o||!s)&&history.state&&history.state.scroll||null;return(0,r.Y3)().then((()=>a(t,n,c))).then((e=>e&&C(e))).catch((e=>Z(e,t,n)))}const re=e=>h.go(e);let ie;const oe=new Set,ae={currentRoute:w,listening:!0,addRoute:k,removeRoute:I,hasRoute:T,getRoutes:A,resolve:N,options:e,push:B,replace:M,go:re,back:()=>re(-1),forward:()=>re(1),beforeEach:d.add,beforeResolve:g.add,afterEach:m.add,onError:J.add,isReady:ee,install(e){const t=this;e.component("RouterLink",We),e.component("RouterView",et),e.config.globalProperties.$router=t,Object.defineProperty(e.config.globalProperties,"$route",{enumerable:!0,get:()=>(0,s.SU)(w)}),i&&!ie&&w.value===z&&(ie=!0,B(h.location).catch((e=>{0})));const n={};for(const s in z)n[s]=(0,r.Fl)((()=>w.value[s]));e.provide(Ue,t),e.provide(Fe,(0,s.qj)(n)),e.provide(je,w);const o=e.unmount;oe.add(e),e.unmount=function(){oe.delete(e),oe.size<1&&(b=z,G&&G(),G=null,w.value=z,ie=!1,Q=!1),o()}}};return ae}function nt(e){return e.reduce(((e,t)=>e.then((()=>t()))),Promise.resolve())}function rt(e,t){const n=[],r=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let o=0;o<i;o++){const i=t.matched[o];i&&(e.matched.find((e=>m(e,i)))?r.push(i):n.push(i));const a=e.matched[o];a&&(t.matched.find((e=>m(e,a)))||s.push(a))}return[n,r,s]}},114:function(e,t,n){"use strict";n.d(t,{Ag:function(){return h},GL:function(){return u},oy:function(){return f},xq:function(){return d}});n(7658);var r=n(8148),s=n(2294),i=n(313),o=n(1383),a=n(6055),c=n(7409);const l=3e4;class u extends a.y{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const e=i.ZG();null!==this.getLocalState()&&l/2<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach(((n,r)=>{r!==this.clientID&&l<=e-n.lastUpdated&&this.states.has(r)&&t.push(r)})),t.length>0&&h(this,t,"timeout")}),o.GW(l/10)),e.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,n=this.meta.get(t),r=void 0===n?0:n.clock+1,s=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:r,lastUpdated:i.ZG()});const o=[],a=[],l=[],u=[];null===e?u.push(t):null==s?null!=e&&o.push(t):(a.push(t),c.Hi(s,e)||l.push(t)),(o.length>0||l.length>0||u.length>0)&&this.emit("change",[{added:o,updated:l,removed:u},"local"]),this.emit("update",[{added:o,updated:a,removed:u},"local"])}setLocalStateField(e,t){const n=this.getLocalState();null!==n&&this.setLocalState({...n,[e]:t})}getStates(){return this.states}}const h=(e,t,n)=>{const r=[];for(let s=0;s<t.length;s++){const n=t[s];if(e.states.has(n)){if(e.states.delete(n),n===e.clientID){const t=e.meta.get(n);e.meta.set(n,{clock:t.clock+1,lastUpdated:i.ZG()})}r.push(n)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},d=(e,t,n=e.states)=>{const s=t.length,i=r.Mf();r.uE(i,s);for(let o=0;o<s;o++){const s=t[o],a=n.get(s)||null,c=e.meta.get(s).clock;r.uE(i,s),r.uE(i,c),r.uw(i,JSON.stringify(a))}return r._f(i)},f=(e,t,n)=>{const r=s.l1(t),o=i.ZG(),a=[],l=[],u=[],h=[],d=s.yg(r);for(let i=0;i<d;i++){const t=s.yg(r);let n=s.yg(r);const i=JSON.parse(s.kf(r)),d=e.meta.get(t),f=e.states.get(t),p=void 0===d?0:d.clock;(p<n||p===n&&null===i&&e.states.has(t))&&(null===i?t===e.clientID&&null!=e.getLocalState()?n++:e.states.delete(t):e.states.set(t,i),e.meta.set(t,{clock:n,lastUpdated:o}),void 0===d&&null!==i?a.push(t):void 0!==d&&null===i?h.push(t):null!==i&&(c.Hi(i,f)||u.push(t),l.push(t)))}(a.length>0||u.length>0||h.length>0)&&e.emit("change",[{added:a,updated:u,removed:h},n]),(a.length>0||l.length>0||h.length>0)&&e.emit("update",[{added:a,updated:l,removed:h},n])}},2942:function(e,t,n){"use strict";n.d(t,{QP:function(){return Ut},mJ:function(){return rn},QW:function(){return ue},GC:function(){return Un},D5:function(){return an},xv:function(){return kn},lt:function(){return Cn},sI:function(){return Tn},yP:function(){return On},eI:function(){return Ln},NG:function(){return Ae},D$:function(){return Ce},gJ:function(){return xe},g4:function(){return Ze}});n(7658),n(541);var r=n(6055),s=n(5989),i=n(1383),o=n(7862),a=n(8148),c=n(2294);"undefined"===typeof window||"undefined"!==typeof window.performance&&window.performance;const l="undefined"===typeof crypto?null:crypto,u=null!==l?e=>{const t=new ArrayBuffer(e),n=new Uint8Array(t);return l.getRandomValues(n),t}:e=>{const t=new ArrayBuffer(e),n=new Uint8Array(t);for(let r=0;r<e;r++)n[r]=Math.ceil(4294967295*Math.random()>>>0);return t},h=(Math.random,()=>new Uint32Array(u(4))[0]),d=[1e7]+-1e3+-4e3+-8e3+-1e11,f=()=>d.replace(/[018]/g,(e=>(e^h()&15>>e/4).toString(16))),p=e=>new Promise(e);var g=n(3425);const y=e=>new Error(e),m=()=>{throw y("Method unimplemented")},w=()=>{throw y("Unexpected case")};var b=n(3388),v=n(7409),_=n(893),E=n(5342);const S=Symbol;class k{constructor(e,t){this.left=e,this.right=t}}const I=(e,t)=>new k(e,t),A="undefined"!==typeof document?document:{},T=("undefined"!==typeof DOMParser&&new DOMParser,e=>o.UI(e,((e,t)=>`${t}:${e};`)).join(""));A.ELEMENT_NODE,A.TEXT_NODE,A.CDATA_SECTION_NODE,A.COMMENT_NODE,A.DOCUMENT_NODE,A.DOCUMENT_TYPE_NODE,A.DOCUMENT_FRAGMENT_NODE;var R=n(313);const C=S(),P=S(),N=S(),O=S(),D=S(),L=S(),x=S(),B=S(),M=S(),U={[C]:I("font-weight","bold"),[P]:I("font-weight","normal"),[N]:I("color","blue"),[D]:I("color","green"),[O]:I("color","grey"),[L]:I("color","red"),[x]:I("color","purple"),[B]:I("color","orange"),[M]:I("color","black")},F={[C]:"[1m",[P]:"[2m",[N]:"[34m",[D]:"[32m",[O]:"[37m",[L]:"[31m",[x]:"[35m",[B]:"[38;5;208m",[M]:"[0m"},j=e=>{const t=[],n=[],r=o.Ue();let s=[],i=0;for(;i<e.length;i++){const s=e[i],o=U[s];if(void 0!==o)r.set(o.left,o.right);else{if(s.constructor!==String&&s.constructor!==Number)break;{const e=T(r);i>0||e.length>0?(t.push("%c"+s),n.push(e)):t.push(s)}}}for(i>0&&(s=n,s.unshift(t.join("")));i<e.length;i++){const t=e[i];t instanceof Symbol||s.push(t)}return s},V=e=>{const t=[],n=[];let r=0;for(;r<e.length;r++){const n=e[r],s=F[n];if(void 0===s){if(n.constructor!==String&&n.constructor!==Number)break;t.push(n)}}for(r>0&&n.push(t.join(""));r<e.length;r++){const t=e[r];t instanceof Symbol||(t.constructor===Object?n.push(JSON.stringify(t)):n.push(t))}return n},z=e=>{const t=[],n=[];let r=0;for(;r<e.length;r++){const n=e[r],s=F[n];if(void 0!==s)t.push(s);else{if(n.constructor!==String&&n.constructor!==Number)break;t.push(n)}}for(r>0&&(t.push("[0m"),n.push(t.join("")));r<e.length;r++){const t=e[r];t instanceof Symbol||n.push(t)}return n},$=E.hH?E.UG?z:j:V,K=(...e)=>{console.log(...$(e)),H.forEach((t=>t.print(e)))},H=new Set;R.ZG();const q=e=>({[Symbol.iterator](){return this},next:e}),W=(e,t)=>q((()=>{let n;do{n=e.next()}while(!n.done&&!t(n.value));return n})),G=(e,t)=>q((()=>{const{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}}));var Y=n(1370);class Q{constructor(e,t){this.clock=e,this.len=t}}class X{constructor(){this.clients=new Map}}const J=(e,t,n)=>t.clients.forEach(((t,r)=>{const s=e.doc.store.clients.get(r);for(let i=0;i<t.length;i++){const r=t[i];ot(e,s,r.clock,r.len,n)}})),Z=(e,t)=>{let n=0,r=e.length-1;while(n<=r){const s=i.GW((n+r)/2),o=e[s],a=o.clock;if(a<=t){if(t<a+o.len)return s;n=s+1}else r=s-1}return null},ee=(e,t)=>{const n=e.clients.get(t.client);return void 0!==n&&null!==Z(n,t.clock)},te=e=>{e.clients.forEach((e=>{let t,n;for(e.sort(((e,t)=>e.clock-t.clock)),t=1,n=1;t<e.length;t++){const r=e[n-1],s=e[t];r.clock+r.len>=s.clock?r.len=i.Fp(r.len,s.clock+s.len-r.clock):(n<t&&(e[n]=s),n++)}e.length=n}))},ne=e=>{const t=new X;for(let n=0;n<e.length;n++)e[n].clients.forEach(((r,i)=>{if(!t.clients.has(i)){const o=r.slice();for(let t=n+1;t<e.length;t++)s.s7(o,e[t].clients.get(i)||[]);t.clients.set(i,o)}}));return te(t),t},re=(e,t,n,r)=>{o.Yu(e.clients,t,(()=>[])).push(new Q(n,r))},se=()=>new X,ie=e=>{const t=se();return e.clients.forEach(((e,n)=>{const r=[];for(let t=0;t<e.length;t++){const n=e[t];if(n.deleted){const s=n.id.clock;let i=n.length;if(t+1<e.length)for(let n=e[t+1];t+1<e.length&&n.deleted;n=e[1+ ++t])i+=n.length;r.push(new Q(s,i))}}r.length>0&&t.clients.set(n,r)})),t},oe=(e,t)=>{a.uE(e.restEncoder,t.clients.size),t.clients.forEach(((t,n)=>{e.resetDsCurVal(),a.uE(e.restEncoder,n);const r=t.length;a.uE(e.restEncoder,r);for(let s=0;s<r;s++){const n=t[s];e.writeDsClock(n.clock),e.writeDsLen(n.len)}}))},ae=e=>{const t=new X,n=c.yg(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();const n=c.yg(e.restDecoder),r=c.yg(e.restDecoder);if(r>0){const s=o.Yu(t.clients,n,(()=>[]));for(let t=0;t<r;t++)s.push(new Q(e.readDsClock(),e.readDsLen()))}}return t},ce=(e,t,n)=>{const r=new X,s=c.yg(e.restDecoder);for(let i=0;i<s;i++){e.resetDsCurVal();const s=c.yg(e.restDecoder),i=c.yg(e.restDecoder),o=n.clients.get(s)||[],a=Xe(n,s);for(let n=0;n<i;n++){const n=e.readDsClock(),i=n+e.readDsLen();if(n<a){a<i&&re(r,s,a,i-a);let e=Ze(o,n),c=o[e];!c.deleted&&c.id.clock<n&&(o.splice(e+1,0,dr(t,c,n-c.id.clock)),e++);while(e<o.length){if(c=o[e++],!(c.id.clock<i))break;c.deleted||(i<c.id.clock+c.length&&o.splice(e,0,dr(t,c,i-c.id.clock)),c.delete(t))}}else re(r,s,n,i-n)}}if(r.clients.size>0){const e=new we;return a.uE(e.restEncoder,0),oe(e,r),e.toUint8Array()}return null},le=h;class ue extends r.y{constructor({guid:e=f(),collectionid:t=null,gc:n=!0,gcFilter:r=(()=>!0),meta:s=null,autoLoad:i=!1,shouldLoad:o=!0}={}){super(),this.gc=n,this.gcFilter=r,this.clientID=le(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new Ye,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=i,this.meta=s,this.isLoaded=!1,this.whenLoaded=p((e=>{this.on("load",(()=>{this.isLoaded=!0,e(this)}))}))}load(){const e=this._item;null===e||this.shouldLoad||pt(e.parent.doc,(e=>{e.subdocsLoaded.add(this)}),null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map((e=>e.guid)))}transact(e,t=null){pt(this,e,t)}get(e,t=Ut){const n=o.Yu(this.share,e,(()=>{const e=new t;return e._integrate(this,null),e})),r=n.constructor;if(t!==Ut&&r!==t){if(r===Ut){const r=new t;r._map=n._map,n._map.forEach((e=>{for(;null!==e;e=e.left)e.parent=r})),r._start=n._start;for(let e=r._start;null!==e;e=e.right)e.parent=r;return r._length=n._length,this.share.set(e,r),r._integrate(this,null),r}throw new Error(`Type with the name ${e} has already been defined with a different constructor`)}return n}getArray(e=""){return this.get(e,rn)}getText(e=""){return this.get(e,kn)}getMap(e=""){return this.get(e,an)}getXmlFragment(e=""){return this.get(e,Tn)}toJSON(){const e={};return this.share.forEach(((t,n)=>{e[n]=t.toJSON()})),e}destroy(){s.Dp(this.subdocs).forEach((e=>e.destroy()));const e=this._item;if(null!==e){this._item=null;const t=e.content;t.doc=new ue({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,pt(e.parent.doc,(n=>{const r=t.doc;e.deleted||n.subdocsAdded.add(r),n.subdocsRemoved.add(this)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(e,t){super.on(e,t)}off(e,t){super.off(e,t)}}class he{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return c.yg(this.restDecoder)}readDsLen(){return c.yg(this.restDecoder)}}class de extends he{readLeftID(){return $e(c.yg(this.restDecoder),c.yg(this.restDecoder))}readRightID(){return $e(c.yg(this.restDecoder),c.yg(this.restDecoder))}readClient(){return c.yg(this.restDecoder)}readInfo(){return c.kj(this.restDecoder)}readString(){return c.kf(this.restDecoder)}readParentInfo(){return 1===c.yg(this.restDecoder)}readTypeRef(){return c.yg(this.restDecoder)}readLen(){return c.yg(this.restDecoder)}readAny(){return c.v_(this.restDecoder)}readBuf(){return g.f9(c.HN(this.restDecoder))}readJSON(){return JSON.parse(c.kf(this.restDecoder))}readKey(){return c.kf(this.restDecoder)}}class fe{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=c.yg(this.restDecoder),this.dsCurrVal}readDsLen(){const e=c.yg(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class pe extends fe{constructor(e){super(e),this.keys=[],c.yg(e),this.keyClockDecoder=new c.dD(c.HN(e)),this.clientDecoder=new c.UF(c.HN(e)),this.leftClockDecoder=new c.dD(c.HN(e)),this.rightClockDecoder=new c.dD(c.HN(e)),this.infoDecoder=new c.XW(c.HN(e),c.kj),this.stringDecoder=new c.sO(c.HN(e)),this.parentInfoDecoder=new c.XW(c.HN(e),c.kj),this.typeRefDecoder=new c.UF(c.HN(e)),this.lenDecoder=new c.UF(c.HN(e))}readLeftID(){return new Ve(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Ve(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return c.v_(this.restDecoder)}readBuf(){return c.HN(this.restDecoder)}readJSON(){return c.v_(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const e=this.stringDecoder.read();return this.keys.push(e),e}}}class ge{constructor(){this.restEncoder=a.Mf()}toUint8Array(){return a._f(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){a.uE(this.restEncoder,e)}writeDsLen(e){a.uE(this.restEncoder,e)}}class ye extends ge{writeLeftID(e){a.uE(this.restEncoder,e.client),a.uE(this.restEncoder,e.clock)}writeRightID(e){a.uE(this.restEncoder,e.client),a.uE(this.restEncoder,e.clock)}writeClient(e){a.uE(this.restEncoder,e)}writeInfo(e){a.$F(this.restEncoder,e)}writeString(e){a.uw(this.restEncoder,e)}writeParentInfo(e){a.uE(this.restEncoder,e?1:0)}writeTypeRef(e){a.uE(this.restEncoder,e)}writeLen(e){a.uE(this.restEncoder,e)}writeAny(e){a.EM(this.restEncoder,e)}writeBuf(e){a.mP(this.restEncoder,e)}writeJSON(e){a.uw(this.restEncoder,JSON.stringify(e))}writeKey(e){a.uw(this.restEncoder,e)}}class me{constructor(){this.restEncoder=a.Mf(),this.dsCurrVal=0}toUint8Array(){return a._f(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,a.uE(this.restEncoder,t)}writeDsLen(e){0===e&&w(),a.uE(this.restEncoder,e-1),this.dsCurrVal+=e}}class we extends me{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new a.sX,this.clientEncoder=new a.HE,this.leftClockEncoder=new a.sX,this.rightClockEncoder=new a.sX,this.infoEncoder=new a.GF(a.$F),this.stringEncoder=new a.TS,this.parentInfoEncoder=new a.GF(a.$F),this.typeRefEncoder=new a.HE,this.lenEncoder=new a.HE}toUint8Array(){const e=a.Mf();return a.uE(e,0),a.mP(e,this.keyClockEncoder.toUint8Array()),a.mP(e,this.clientEncoder.toUint8Array()),a.mP(e,this.leftClockEncoder.toUint8Array()),a.mP(e,this.rightClockEncoder.toUint8Array()),a.mP(e,a._f(this.infoEncoder)),a.mP(e,this.stringEncoder.toUint8Array()),a.mP(e,a._f(this.parentInfoEncoder)),a.mP(e,this.typeRefEncoder.toUint8Array()),a.mP(e,this.lenEncoder.toUint8Array()),a.HK(e,a._f(this.restEncoder)),a._f(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){a.EM(this.restEncoder,e)}writeBuf(e){a.mP(this.restEncoder,e)}writeJSON(e){a.EM(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const be=(e,t,n,r)=>{r=i.Fp(r,t[0].id.clock);const s=Ze(t,r);a.uE(e.restEncoder,t.length-s),e.writeClient(n),a.uE(e.restEncoder,r);const o=t[s];o.write(e,r-o.id.clock);for(let i=s+1;i<t.length;i++)t[i].write(e,0)},ve=(e,t,n)=>{const r=new Map;n.forEach(((e,n)=>{Xe(t,n)>e&&r.set(n,e)})),Qe(t).forEach(((e,t)=>{n.has(t)||r.set(t,0)})),a.uE(e.restEncoder,r.size),Array.from(r.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([n,r])=>{be(e,t.clients.get(n),n,r)}))},_e=(e,t)=>{const n=o.Ue(),r=c.yg(e.restDecoder);for(let s=0;s<r;s++){const r=c.yg(e.restDecoder),s=new Array(r),i=e.readClient();let o=c.yg(e.restDecoder);n.set(i,{i:0,refs:s});for(let n=0;n<r;n++){const r=e.readInfo();switch(b.kr&r){case 0:{const t=e.readLen();s[n]=new Un($e(i,o),t),o+=t;break}case 10:{const t=c.yg(e.restDecoder);s[n]=new mr($e(i,o),t),o+=t;break}default:{const a=0===(r&(b.rc|b.x1)),c=new fr($e(i,o),null,(r&b.x1)===b.x1?e.readLeftID():null,null,(r&b.rc)===b.rc?e.readRightID():null,a?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,a&&(r&b.cq)===b.cq?e.readString():null,pr(e,r));s[n]=c,o+=c.length}}}}return n},Ee=(e,t,n)=>{const r=[];let s=Array.from(n.keys()).sort(((e,t)=>e-t));if(0===s.length)return null;const i=()=>{if(0===s.length)return null;let e=n.get(s[s.length-1]);while(e.refs.length===e.i){if(s.pop(),!(s.length>0))return null;e=n.get(s[s.length-1])}return e};let c=i();if(null===c&&0===r.length)return null;const l=new Ye,u=new Map,h=(e,t)=>{const n=u.get(e);(null==n||n>t)&&u.set(e,t)};let d=c.refs[c.i++];const f=new Map,p=()=>{for(const e of r){const t=e.id.client,r=n.get(t);r?(r.i--,l.clients.set(t,r.refs.slice(r.i)),n.delete(t),r.i=0,r.refs=[]):l.clients.set(t,[e]),s=s.filter((e=>e!==t))}r.length=0};while(1){if(d.constructor!==mr){const s=o.Yu(f,d.id.client,(()=>Xe(t,d.id.client))),i=s-d.id.clock;if(i<0)r.push(d),h(d.id.client,d.id.clock-1),p();else{const s=d.getMissing(e,t);if(null!==s){r.push(d);const e=n.get(s)||{refs:[],i:0};if(e.refs.length!==e.i){d=e.refs[e.i++];continue}h(s,Xe(t,s)),p()}else(0===i||i<d.length)&&(d.integrate(e,i),f.set(d.id.client,d.id.clock+d.length))}}if(r.length>0)d=r.pop();else if(null!==c&&c.i<c.refs.length)d=c.refs[c.i++];else{if(c=i(),null===c)break;d=c.refs[c.i++]}}if(l.clients.size>0){const e=new we;return ve(e,l,new Map),a.uE(e.restEncoder,0),{missing:u,update:e.toUint8Array()}}return null},Se=(e,t)=>ve(e,t.doc.store,t.beforeState),ke=(e,t,n,r=new pe(e))=>pt(t,(e=>{e.local=!1;let t=!1;const n=e.doc,s=n.store,i=_e(r,n),o=Ee(e,s,i),a=s.pendingStructs;if(a){for(const[e,n]of a.missing)if(n<Xe(s,e)){t=!0;break}if(o){for(const[e,t]of o.missing){const n=a.missing.get(e);(null==n||n>t)&&a.missing.set(e,t)}a.update=vt([a.update,o.update])}}else s.pendingStructs=o;const l=ce(r,e,s);if(s.pendingDs){const t=new pe(c.l1(s.pendingDs));c.yg(t.restDecoder);const n=ce(t,e,s);s.pendingDs=l&&n?vt([l,n]):l||n}else s.pendingDs=l;if(t){const t=s.pendingStructs.update;s.pendingStructs=null,Ie(e.doc,t)}}),n,!1),Ie=(e,t,n,r=pe)=>{const s=c.l1(t);ke(s,e,n,new r(s))},Ae=(e,t,n)=>Ie(e,t,n,de),Te=(e,t,n=new Map)=>{ve(e,t.store,n),oe(e,ie(t.store))},Re=(e,t=new Uint8Array([0]),n=new we)=>{const r=Ne(t);Te(n,e,r);const s=[n.toUint8Array()];if(e.store.pendingDs&&s.push(e.store.pendingDs),e.store.pendingStructs&&s.push(_t(e.store.pendingStructs.update,t)),s.length>1){if(n.constructor===ye)return wt(s.map(((e,t)=>0===t?e:At(e))));if(n.constructor===we)return vt(s)}return s[0]},Ce=(e,t)=>Re(e,t,new ye),Pe=e=>{const t=new Map,n=c.yg(e.restDecoder);for(let r=0;r<n;r++){const n=c.yg(e.restDecoder),r=c.yg(e.restDecoder);t.set(n,r)}return t},Ne=e=>Pe(new he(c.l1(e))),Oe=(e,t)=>(a.uE(e.restEncoder,t.size),Array.from(t.entries()).sort(((e,t)=>t[0]-e[0])).forEach((([t,n])=>{a.uE(e.restEncoder,t),a.uE(e.restEncoder,n)})),e),De=(e,t)=>Oe(e,Qe(t.store)),Le=(e,t=new me)=>(e instanceof Map?Oe(t,e):De(t,e),t.toUint8Array()),xe=e=>Le(e,new ge);class Be{constructor(){this.l=[]}}const Me=()=>new Be,Ue=(e,t)=>e.l.push(t),Fe=(e,t)=>{const n=e.l,r=n.length;e.l=n.filter((e=>t!==e)),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},je=(e,t,n)=>v.PP(e.l,[t,n]);class Ve{constructor(e,t){this.client=e,this.clock=t}}const ze=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,$e=(e,t)=>new Ve(e,t),Ke=e=>{for(const[t,n]of e.doc.share.entries())if(n===e)return t;throw w()};class He{constructor(e,t){this.ds=e,this.sv=t}}const qe=(e,t)=>new He(e,t),We=(qe(se(),new Map),(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!ee(t.ds,e.id)),Ge=(e,t)=>{const n=o.Yu(e.meta,Ge,_.Ue),r=e.doc.store;n.has(t)||(t.sv.forEach(((t,n)=>{t<Xe(r,n)&&rt(e,$e(n,t))})),J(e,t.ds,(e=>{})),n.add(t))};class Ye{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Qe=e=>{const t=new Map;return e.clients.forEach(((e,n)=>{const r=e[e.length-1];t.set(n,r.id.clock+r.length)})),t},Xe=(e,t)=>{const n=e.clients.get(t);if(void 0===n)return 0;const r=n[n.length-1];return r.id.clock+r.length},Je=(e,t)=>{let n=e.clients.get(t.id.client);if(void 0===n)n=[],e.clients.set(t.id.client,n);else{const e=n[n.length-1];if(e.id.clock+e.length!==t.id.clock)throw w()}n.push(t)},Ze=(e,t)=>{let n=0,r=e.length-1,s=e[r],o=s.id.clock;if(o===t)return r;let a=i.GW(t/(o+s.length-1)*r);while(n<=r){if(s=e[a],o=s.id.clock,o<=t){if(t<o+s.length)return a;n=a+1}else r=a-1;a=i.GW((n+r)/2)}throw w()},et=(e,t)=>{const n=e.clients.get(t.client);return n[Ze(n,t.clock)]},tt=et,nt=(e,t,n)=>{const r=Ze(t,n),s=t[r];return s.id.clock<n&&s instanceof fr?(t.splice(r+1,0,dr(e,s,n-s.id.clock)),r+1):r},rt=(e,t)=>{const n=e.doc.store.clients.get(t.client);return n[nt(e,n,t.clock)]},st=(e,t,n)=>{const r=t.clients.get(n.client),s=Ze(r,n.clock),i=r[s];return n.clock!==i.id.clock+i.length-1&&i.constructor!==Un&&r.splice(s+1,0,dr(e,i,n.clock-i.id.clock+1)),i},it=(e,t,n)=>{const r=e.clients.get(t.id.client);r[Ze(r,t.id.clock)]=n},ot=(e,t,n,r,s)=>{if(0===r)return;const i=n+r;let o,a=nt(e,t,n);do{o=t[a++],i<o.id.clock+o.length&&nt(e,t,i),s(o)}while(a<t.length&&t[a].id.clock<i)};class at{constructor(e,t,n){this.doc=e,this.deleteSet=new X,this.beforeState=Qe(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const ct=(e,t)=>!(0===t.deleteSet.clients.size&&!o.Yj(t.afterState,((e,n)=>t.beforeState.get(n)!==e)))&&(te(t.deleteSet),Se(e,t),oe(e,t.deleteSet),!0),lt=(e,t,n)=>{const r=t._item;(null===r||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&o.Yu(e.changed,t,_.Ue).add(n)},ut=(e,t)=>{const n=e[t-1],r=e[t];n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)&&(e.splice(t,1),r instanceof fr&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n))},ht=(e,t,n)=>{for(const[r,s]of e.clients.entries()){const e=t.clients.get(r);for(let r=s.length-1;r>=0;r--){const i=s[r],o=i.clock+i.len;for(let r=Ze(e,i.clock),s=e[r];r<e.length&&s.id.clock<o;s=e[++r]){const s=e[r];if(i.clock+i.len<=s.id.clock)break;s instanceof fr&&s.deleted&&!s.keep&&n(s)&&s.gc(t,!1)}}}},dt=(e,t)=>{e.clients.forEach(((e,n)=>{const r=t.clients.get(n);for(let t=e.length-1;t>=0;t--){const n=e[t],s=i.VV(r.length-1,1+Ze(r,n.clock+n.len-1));for(let e=s,t=r[e];e>0&&t.id.clock>=n.clock;t=r[--e])ut(r,e)}}))},ft=(e,t)=>{if(t<e.length){const n=e[t],r=n.doc,s=r.store,o=n.deleteSet,a=n._mergeStructs;try{te(o),n.afterState=Qe(n.doc.store),r._transaction=null,r.emit("beforeObserverCalls",[n,r]);const c=[];n.changed.forEach(((e,t)=>c.push((()=>{null!==t._item&&t._item.deleted||t._callObserver(n,e)})))),c.push((()=>{n.changedParentTypes.forEach(((e,t)=>c.push((()=>{null!==t._item&&t._item.deleted||(e=e.filter((e=>null===e.target._item||!e.target._item.deleted)),e.forEach((e=>{e.currentTarget=t})),e.sort(((e,t)=>e.path.length-t.path.length)),je(t._dEH,e,n))})))),c.push((()=>r.emit("afterTransaction",[n,r])))})),(0,v.PP)(c,[])}finally{r.gc&&ht(o,s,r.gcFilter),dt(o,s),n.afterState.forEach(((e,t)=>{const r=n.beforeState.get(t)||0;if(r!==e){const e=s.clients.get(t),n=i.Fp(Ze(e,r),1);for(let t=e.length-1;t>=n;t--)ut(e,t)}}));for(let e=0;e<a.length;e++){const{client:t,clock:n}=a[e].id,r=s.clients.get(t),i=Ze(r,n);i+1<r.length&&ut(r,i+1),i>0&&ut(r,i)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(K(B,C,"[yjs] ",P,L,"Changed the client-id because another client seems to be using it."),r.clientID=le()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){const e=new ye,t=ct(e,n);t&&r.emit("update",[e.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){const e=new we,t=ct(e,n);t&&r.emit("updateV2",[e.toUint8Array(),n.origin,r,n])}const{subdocsAdded:c,subdocsLoaded:l,subdocsRemoved:u}=n;(c.size>0||u.size>0||l.size>0)&&(c.forEach((e=>{e.clientID=r.clientID,null==e.collectionid&&(e.collectionid=r.collectionid),r.subdocs.add(e)})),u.forEach((e=>r.subdocs.delete(e))),r.emit("subdocs",[{loaded:l,added:c,removed:u},r,n]),u.forEach((e=>e.destroy()))),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):ft(e,t+1)}}},pt=(e,t,n=null,r=!0)=>{const s=e._transactionCleanups;let i=!1;null===e._transaction&&(i=!0,e._transaction=new at(e,n,r),s.push(e._transaction),1===s.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{t(e._transaction)}finally{i&&s[0]===e._transaction&&ft(s,0)}};function*gt(e){const t=c.yg(e.restDecoder);for(let n=0;n<t;n++){const t=c.yg(e.restDecoder),n=e.readClient();let r=c.yg(e.restDecoder);for(let s=0;s<t;s++){const t=e.readInfo();if(10===t){const t=c.yg(e.restDecoder);yield new mr($e(n,r),t),r+=t}else if(0!==(b.kr&t)){const s=0===(t&(b.rc|b.x1)),i=new fr($e(n,r),null,(t&b.x1)===b.x1?e.readLeftID():null,null,(t&b.rc)===b.rc?e.readRightID():null,s?e.readParentInfo()?e.readString():e.readLeftID():null,s&&(t&b.cq)===b.cq?e.readString():null,pr(e,t));yield i,r+=i.length}else{const t=e.readLen();yield new Un($e(n,r),t),r+=t}}}}class yt{constructor(e,t){this.gen=gt(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===mr);return this.curr}}class mt{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const wt=e=>vt(e,de,ye),bt=(e,t)=>{if(e.constructor===Un){const{client:n,clock:r}=e.id;return new Un($e(n,r+t),e.length-t)}if(e.constructor===mr){const{client:n,clock:r}=e.id;return new mr($e(n,r+t),e.length-t)}{const n=e,{client:r,clock:s}=n.id;return new fr($e(r,s+t),null,$e(r,s+t-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(t))}},vt=(e,t=pe,n=we)=>{if(1===e.length)return e[0];const r=e.map((e=>new t(c.l1(e))));let s=r.map((e=>new yt(e,!0))),i=null;const o=new n,a=new mt(o);while(1){if(s=s.filter((e=>null!==e.curr)),s.sort(((e,t)=>{if(e.curr.id.client===t.curr.id.client){const n=e.curr.id.clock-t.curr.id.clock;return 0===n?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===mr?1:-1:n}return t.curr.id.client-e.curr.id.client})),0===s.length)break;const e=s[0],t=e.curr.id.client;if(null!==i){let n=e.curr,r=!1;while(null!==n&&n.id.clock+n.length<=i.struct.id.clock+i.struct.length&&n.id.client>=i.struct.id.client)n=e.next(),r=!0;if(null===n||n.id.client!==t||r&&n.id.clock>i.struct.id.clock+i.struct.length)continue;if(t!==i.struct.id.client)St(a,i.struct,i.offset),i={struct:n,offset:0},e.next();else if(i.struct.id.clock+i.struct.length<n.id.clock)if(i.struct.constructor===mr)i.struct.length=n.id.clock+n.length-i.struct.id.clock;else{St(a,i.struct,i.offset);const e=n.id.clock-i.struct.id.clock-i.struct.length,r=new mr($e(t,i.struct.id.clock+i.struct.length),e);i={struct:r,offset:0}}else{const t=i.struct.id.clock+i.struct.length-n.id.clock;t>0&&(i.struct.constructor===mr?i.struct.length-=t:n=bt(n,t)),i.struct.mergeWith(n)||(St(a,i.struct,i.offset),i={struct:n,offset:0},e.next())}}else i={struct:e.curr,offset:0},e.next();for(let n=e.curr;null!==n&&n.id.client===t&&n.id.clock===i.struct.id.clock+i.struct.length&&n.constructor!==mr;n=e.next())St(a,i.struct,i.offset),i={struct:n,offset:0}}null!==i&&(St(a,i.struct,i.offset),i=null),kt(a);const l=r.map((e=>ae(e))),u=ne(l);return oe(o,u),o.toUint8Array()},_t=(e,t,n=pe,r=we)=>{const s=Ne(t),o=new r,a=new mt(o),l=new n(c.l1(e)),u=new yt(l,!1);while(u.curr){const e=u.curr,t=e.id.client,n=s.get(t)||0;if(u.curr.constructor!==mr)if(e.id.clock+e.length>n){St(a,e,i.Fp(n-e.id.clock,0)),u.next();while(u.curr&&u.curr.id.client===t)St(a,u.curr,0),u.next()}else while(u.curr&&u.curr.id.client===t&&u.curr.id.clock+u.curr.length<=n)u.next();else u.next()}kt(a);const h=ae(l);return oe(o,h),o.toUint8Array()},Et=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:a._f(e.encoder.restEncoder)}),e.encoder.restEncoder=a.Mf(),e.written=0)},St=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&Et(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),a.uE(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},kt=e=>{Et(e);const t=e.encoder.restEncoder;a.uE(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){const r=e.clientStructs[n];a.uE(t,r.written),a.HK(t,r.restEncoder)}},It=(e,t,n)=>{const r=new t(c.l1(e)),s=new yt(r,!1),i=new n,o=new mt(i);for(let c=s.curr;null!==c;c=s.next())St(o,c,0);kt(o);const a=ae(r);return oe(i,a),i.toUint8Array()},At=e=>It(e,pe,ye);class Tt{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null}get path(){return Rt(this.currentTarget,this.target)}deletes(e){return ee(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){const e=new Map,t=this.target,n=this.transaction.changed.get(t);n.forEach((n=>{if(null!==n){const r=t._map.get(n);let i,o;if(this.adds(r)){let e=r.left;while(null!==e&&this.adds(e))e=e.left;if(this.deletes(r)){if(null===e||!this.deletes(e))return;i="delete",o=s.Z$(e.content.getContent())}else null!==e&&this.deletes(e)?(i="update",o=s.Z$(e.content.getContent())):(i="add",o=void 0)}else{if(!this.deletes(r))return;i="delete",o=s.Z$(r.content.getContent())}e.set(n,{action:i,oldValue:o})}})),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){const t=this.target,n=_.Ue(),r=_.Ue(),s=[];e={added:n,deleted:r,delta:s,keys:this.keys};const i=this.transaction.changed.get(t);if(i.has(null)){let e=null;const i=()=>{e&&s.push(e)};for(let s=t._start;null!==s;s=s.right)s.deleted?this.deletes(s)&&!this.adds(s)&&(null!==e&&void 0!==e.delete||(i(),e={delete:0}),e.delete+=s.length,r.add(s)):this.adds(s)?(null!==e&&void 0!==e.insert||(i(),e={insert:[]}),e.insert=e.insert.concat(s.content.getContent()),n.add(s)):(null!==e&&void 0!==e.retain||(i(),e={retain:0}),e.retain+=s.length);null!==e&&void 0===e.retain&&i()}this._changes=e}return e}}const Rt=(e,t)=>{const n=[];while(null!==t._item&&t!==e){if(null!==t._item.parentSub)n.unshift(t._item.parentSub);else{let e=0,r=t._item.parent._start;while(r!==t._item&&null!==r)r.deleted||e++,r=r.right;n.unshift(e)}t=t._item.parent}return n},Ct=80;let Pt=0;class Nt{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=Pt++}}const Ot=e=>{e.timestamp=Pt++},Dt=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Pt++},Lt=(e,t,n)=>{if(e.length>=Ct){const r=e.reduce(((e,t)=>e.timestamp<t.timestamp?e:t));return Dt(r,t,n),r}{const r=new Nt(t,n);return e.push(r),r}},xt=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;const n=0===e._searchMarker.length?null:e._searchMarker.reduce(((e,n)=>i.Wn(t-e.index)<i.Wn(t-n.index)?e:n));let r=e._start,s=0;null!==n&&(r=n.p,s=n.index,Ot(n));while(null!==r.right&&s<t){if(!r.deleted&&r.countable){if(t<s+r.length)break;s+=r.length}r=r.right}while(null!==r.left&&s>t)r=r.left,!r.deleted&&r.countable&&(s-=r.length);while(null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock)r=r.left,!r.deleted&&r.countable&&(s-=r.length);return null!==n&&i.Wn(n.index-s)<r.parent.length/Ct?(Dt(n,r,s),n):Lt(e._searchMarker,r,s)},Bt=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){const s=e[r];if(n>0){let t=s.p;t.marker=!1;while(t&&(t.deleted||!t.countable))t=t.left,t&&!t.deleted&&t.countable&&(s.index-=t.length);if(null===t||!0===t.marker){e.splice(r,1);continue}s.p=t,t.marker=!0}(t<s.index||n>0&&t===s.index)&&(s.index=i.Fp(t,s.index+n))}},Mt=(e,t,n)=>{const r=e,s=t.changedParentTypes;while(1){if(o.Yu(s,e,(()=>[])).push(n),null===e._item)break;e=e._item.parent}je(r._eH,n,t)};class Ut{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Me(),this._dEH=Me(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw m()}clone(){throw m()}_write(e){}get _first(){let e=this._start;while(null!==e&&e.deleted)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){Ue(this._eH,e)}observeDeep(e){Ue(this._dEH,e)}unobserve(e){Fe(this._eH,e)}unobserveDeep(e){Fe(this._dEH,e)}toJSON(){}}const Ft=(e,t,n)=>{t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t;const s=[];let i=e._start;while(null!==i&&r>0){if(i.countable&&!i.deleted){const e=i.content.getContent();if(e.length<=t)t-=e.length;else{for(let n=t;n<e.length&&r>0;n++)s.push(e[n]),r--;t=0}}i=i.right}return s},jt=e=>{const t=[];let n=e._start;while(null!==n){if(n.countable&&!n.deleted){const e=n.content.getContent();for(let n=0;n<e.length;n++)t.push(e[n])}n=n.right}return t},Vt=(e,t)=>{let n=0,r=e._start;while(null!==r){if(r.countable&&!r.deleted){const s=r.content.getContent();for(let r=0;r<s.length;r++)t(s[r],n++,e)}r=r.right}},zt=(e,t)=>{const n=[];return Vt(e,((r,s)=>{n.push(t(r,s,e))})),n},$t=e=>{let t=e._start,n=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(null===n){while(null!==t&&t.deleted)t=t.right;if(null===t)return{done:!0,value:void 0};n=t.content.getContent(),r=0,t=t.right}const e=n[r++];return n.length<=r&&(n=null),{done:!1,value:e}}}},Kt=(e,t)=>{const n=xt(e,t);let r=e._start;for(null!==n&&(r=n.p,t-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},Ht=(e,t,n,r)=>{let s=n;const i=e.doc,o=i.clientID,a=i.store,c=null===n?t._start:n.right;let l=[];const u=()=>{l.length>0&&(s=new fr($e(o,Xe(a,o)),s,s&&s.lastId,c,c&&c.id,t,null,new Jn(l)),s.integrate(e,0),l=[])};r.forEach((n=>{if(null===n)l.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(n);break;default:switch(u(),n.constructor){case Uint8Array:case ArrayBuffer:s=new fr($e(o,Xe(a,o)),s,s&&s.lastId,c,c&&c.id,t,null,new Fn(new Uint8Array(n))),s.integrate(e,0);break;case ue:s=new fr($e(o,Xe(a,o)),s,s&&s.lastId,c,c&&c.id,t,null,new Kn(n)),s.integrate(e,0);break;default:if(!(n instanceof Ut))throw new Error("Unexpected content type in insert operation");s=new fr($e(o,Xe(a,o)),s,s&&s.lastId,c,c&&c.id,t,null,new ur(n)),s.integrate(e,0)}}})),u()},qt=y("Length exceeded!"),Wt=(e,t,n,r)=>{if(n>t._length)throw qt;if(0===n)return t._searchMarker&&Bt(t._searchMarker,n,r.length),Ht(e,t,null,r);const s=n,i=xt(t,n);let o=t._start;for(null!==i&&(o=i.p,n-=i.index,0===n&&(o=o.prev,n+=o&&o.countable&&!o.deleted?o.length:0));null!==o;o=o.right)if(!o.deleted&&o.countable){if(n<=o.length){n<o.length&&rt(e,$e(o.id.client,o.id.clock+n));break}n-=o.length}return t._searchMarker&&Bt(t._searchMarker,s,r.length),Ht(e,t,o,r)},Gt=(e,t,n)=>{const r=(t._searchMarker||[]).reduce(((e,t)=>t.index>e.index?t:e),{index:0,p:t._start});let s=r.p;if(s)while(s.right)s=s.right;return Ht(e,t,s,n)},Yt=(e,t,n,r)=>{if(0===r)return;const s=n,i=r,o=xt(t,n);let a=t._start;for(null!==o&&(a=o.p,n-=o.index);null!==a&&n>0;a=a.right)!a.deleted&&a.countable&&(n<a.length&&rt(e,$e(a.id.client,a.id.clock+n)),n-=a.length);while(r>0&&null!==a)a.deleted||(r<a.length&&rt(e,$e(a.id.client,a.id.clock+r)),a.delete(e),r-=a.length),a=a.right;if(r>0)throw qt;t._searchMarker&&Bt(t._searchMarker,s,-i+r)},Qt=(e,t,n)=>{const r=t._map.get(n);void 0!==r&&r.delete(e)},Xt=(e,t,n,r)=>{const s=t._map.get(n)||null,i=e.doc,o=i.clientID;let a;if(null==r)a=new Jn([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a=new Jn([r]);break;case Uint8Array:a=new Fn(r);break;case ue:a=new Kn(r);break;default:if(!(r instanceof Ut))throw new Error("Unexpected content type");a=new ur(r)}new fr($e(o,Xe(i.store,o)),s,s&&s.lastId,null,null,t,n,a).integrate(e,0)},Jt=(e,t)=>{const n=e._map.get(t);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},Zt=e=>{const t={};return e._map.forEach(((e,n)=>{e.deleted||(t[n]=e.content.getContent()[e.length-1])})),t},en=(e,t)=>{const n=e._map.get(t);return void 0!==n&&!n.deleted},tn=e=>W(e.entries(),(e=>!e[1].deleted));class nn extends Tt{constructor(e,t){super(e,t),this._transaction=t}}class rn extends Ut{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new rn;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new rn}clone(){const e=new rn;return e.insert(0,this.toArray().map((e=>e instanceof Ut?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}_callObserver(e,t){super._callObserver(e,t),Mt(this,e,new nn(this,e))}insert(e,t){null!==this.doc?pt(this.doc,(n=>{Wt(n,this,e,t)})):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?pt(this.doc,(t=>{Gt(t,this,e)})):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?pt(this.doc,(n=>{Yt(n,this,e,t)})):this._prelimContent.splice(e,t)}get(e){return Kt(this,e)}toArray(){return jt(this)}slice(e=0,t=this.length){return Ft(this,e,t)}toJSON(){return this.map((e=>e instanceof Ut?e.toJSON():e))}map(e){return zt(this,e)}forEach(e){Vt(this,e)}[Symbol.iterator](){return $t(this)}_write(e){e.writeTypeRef(rr)}}const sn=e=>new rn;class on extends Tt{constructor(e,t,n){super(e,t),this.keysChanged=n}}class an extends Ut{constructor(e){super(),this._prelimContent=null,this._prelimContent=void 0===e?new Map:new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach(((e,t)=>{this.set(t,e)})),this._prelimContent=null}_copy(){return new an}clone(){const e=new an;return this.forEach(((t,n)=>{e.set(n,t instanceof Ut?t.clone():t)})),e}_callObserver(e,t){Mt(this,e,new on(this,e,t))}toJSON(){const e={};return this._map.forEach(((t,n)=>{if(!t.deleted){const r=t.content.getContent()[t.length-1];e[n]=r instanceof Ut?r.toJSON():r}})),e}get size(){return[...tn(this._map)].length}keys(){return G(tn(this._map),(e=>e[0]))}values(){return G(tn(this._map),(e=>e[1].content.getContent()[e[1].length-1]))}entries(){return G(tn(this._map),(e=>[e[0],e[1].content.getContent()[e[1].length-1]]))}forEach(e){this._map.forEach(((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)}))}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?pt(this.doc,(t=>{Qt(t,this,e)})):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?pt(this.doc,(n=>{Xt(n,this,e,t)})):this._prelimContent.set(e,t),t}get(e){return Jt(this,e)}has(e){return en(this,e)}clear(){null!==this.doc?pt(this.doc,(e=>{this.forEach((function(t,n,r){Qt(e,r,n)}))})):this._prelimContent.clear()}_write(e){e.writeTypeRef(sr)}}const cn=e=>new an,ln=(e,t)=>e===t||"object"===typeof e&&"object"===typeof t&&e&&t&&Y.$m(e,t);class un{constructor(e,t,n,r){this.left=e,this.right=t,this.index=n,this.currentAttributes=r}forward(){switch(null===this.right&&w(),this.right.content.constructor){case Gn:this.right.deleted||pn(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const hn=(e,t,n)=>{while(null!==t.right&&n>0){switch(t.right.content.constructor){case Gn:t.right.deleted||pn(t.currentAttributes,t.right.content);break;default:t.right.deleted||(n<t.right.length&&rt(e,$e(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},dn=(e,t,n)=>{const r=new Map,s=xt(t,n);if(s){const t=new un(s.p.left,s.p,s.index,r);return hn(e,t,n-s.index)}{const s=new un(null,t._start,0,r);return hn(e,s,n)}},fn=(e,t,n,r)=>{while(null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===Gn&&ln(r.get(n.right.content.key),n.right.content.value)))n.right.deleted||r.delete(n.right.content.key),n.forward();const s=e.doc,i=s.clientID;r.forEach(((r,o)=>{const a=n.left,c=n.right,l=new fr($e(i,Xe(s.store,i)),a,a&&a.lastId,c,c&&c.id,t,null,new Gn(o,r));l.integrate(e,0),n.right=l,n.forward()}))},pn=(e,t)=>{const{key:n,value:r}=t;null===r?e.delete(n):e.set(n,r)},gn=(e,t)=>{while(1){if(null===e.right)break;if(!(e.right.deleted||e.right.content.constructor===Gn&&ln(t[e.right.content.key]||null,e.right.content.value)))break;e.forward()}},yn=(e,t,n,r)=>{const s=e.doc,i=s.clientID,o=new Map;for(const a in r){const c=r[a],l=n.currentAttributes.get(a)||null;if(!ln(l,c)){o.set(a,l);const{left:r,right:u}=n;n.right=new fr($e(i,Xe(s.store,i)),r,r&&r.lastId,u,u&&u.id,t,null,new Gn(a,c)),n.right.integrate(e,0),n.forward()}}return o},mn=(e,t,n,r,s)=>{n.currentAttributes.forEach(((e,t)=>{void 0===s[t]&&(s[t]=null)}));const i=e.doc,o=i.clientID;gn(n,s);const a=yn(e,t,n,s),c=r.constructor===String?new er(r):r instanceof Ut?new ur(r):new qn(r);let{left:l,right:u,index:h}=n;t._searchMarker&&Bt(t._searchMarker,n.index,c.getLength()),u=new fr($e(o,Xe(i.store,o)),l,l&&l.lastId,u,u&&u.id,t,null,c),u.integrate(e,0),n.right=u,n.index=h,n.forward(),fn(e,t,n,a)},wn=(e,t,n,r,s)=>{const i=e.doc,o=i.clientID;gn(n,s);const a=yn(e,t,n,s);e:while(null!==n.right&&(r>0||a.size>0&&(n.right.deleted||n.right.content.constructor===Gn))){if(!n.right.deleted)switch(n.right.content.constructor){case Gn:{const{key:t,value:i}=n.right.content,o=s[t];if(void 0!==o){if(ln(o,i))a.delete(t);else{if(0===r)break e;a.set(t,i)}n.right.delete(e)}else n.currentAttributes.set(t,i);break}default:r<n.right.length&&rt(e,$e(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;break}n.forward()}if(r>0){let s="";for(;r>0;r--)s+="\n";n.right=new fr($e(o,Xe(i.store,o)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new er(s)),n.right.integrate(e,0),n.forward()}fn(e,t,n,a)},bn=(e,t,n,r,s)=>{let i=n;const a=o.JG(s);while(i&&(!i.countable||i.deleted))i.deleted||i.content.constructor!==Gn||pn(a,i.content),i=i.right;let c=0,l=!1;while(t!==i){if(n===t&&(l=!0),!t.deleted){const n=t.content;switch(n.constructor){case Gn:{const{key:i,value:o}=n;(a.get(i)||null)===o&&(r.get(i)||null)!==o||(t.delete(e),c++,l||(s.get(i)||null)!==o||(r.get(i)||null)===o||s.delete(i));break}}}t=t.right}return c},vn=(e,t)=>{while(t&&t.right&&(t.right.deleted||!t.right.countable))t=t.right;const n=new Set;while(t&&(t.deleted||!t.countable)){if(!t.deleted&&t.content.constructor===Gn){const r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}},_n=e=>{let t=0;return pt(e.doc,(n=>{let r=e._start,s=e._start,i=o.Ue();const a=o.JG(i);while(s){if(!1===s.deleted)switch(s.content.constructor){case Gn:pn(a,s.content);break;default:t+=bn(n,r,s,i,a),i=o.JG(a),r=s;break}s=s.right}})),t},En=(e,t,n)=>{const r=n,s=o.JG(t.currentAttributes),i=t.right;while(n>0&&null!==t.right){if(!1===t.right.deleted)switch(t.right.content.constructor){case ur:case qn:case er:n<t.right.length&&rt(e,$e(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e);break}t.forward()}i&&bn(e,i,t.right,s,t.currentAttributes);const a=(t.left||t.right).parent;return a._searchMarker&&Bt(a._searchMarker,t.index,-r+n),t};class Sn extends Tt{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach((e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)}))}get changes(){if(null===this._changes){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){const e=this.target.doc,t=[];pt(e,(e=>{const n=new Map,r=new Map;let s=this.target._start,i=null;const o={};let a="",c=0,l=0;const u=()=>{if(null!==i){let e;switch(i){case"delete":e={delete:l},l=0;break;case"insert":e={insert:a},n.size>0&&(e.attributes={},n.forEach(((t,n)=>{null!==t&&(e.attributes[n]=t)}))),a="";break;case"retain":if(e={retain:c},Object.keys(o).length>0){e.attributes={};for(const t in o)e.attributes[t]=o[t]}c=0;break}t.push(e),i=null}};while(null!==s){switch(s.content.constructor){case ur:case qn:this.adds(s)?this.deletes(s)||(u(),i="insert",a=s.content.getContent()[0],u()):this.deletes(s)?("delete"!==i&&(u(),i="delete"),l+=1):s.deleted||("retain"!==i&&(u(),i="retain"),c+=1);break;case er:this.adds(s)?this.deletes(s)||("insert"!==i&&(u(),i="insert"),a+=s.content.str):this.deletes(s)?("delete"!==i&&(u(),i="delete"),l+=s.length):s.deleted||("retain"!==i&&(u(),i="retain"),c+=s.length);break;case Gn:{const{key:t,value:a}=s.content;if(this.adds(s)){if(!this.deletes(s)){const c=n.get(t)||null;ln(c,a)?null!==a&&s.delete(e):("retain"===i&&u(),ln(a,r.get(t)||null)?delete o[t]:o[t]=a)}}else if(this.deletes(s)){r.set(t,a);const e=n.get(t)||null;ln(e,a)||("retain"===i&&u(),o[t]=e)}else if(!s.deleted){r.set(t,a);const n=o[t];void 0!==n&&(ln(n,a)?null!==n&&s.delete(e):("retain"===i&&u(),null===a?delete o[t]:o[t]=a))}s.deleted||("insert"===i&&u(),pn(n,s.content));break}}s=s.right}u();while(t.length>0){const e=t[t.length-1];if(void 0===e.retain||void 0!==e.attributes)break;t.pop()}})),this._delta=t}return this._delta}}class kn extends Ut{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach((e=>e()))}catch(n){console.error(n)}this._pending=null}_copy(){return new kn}clone(){const e=new kn;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const n=new Sn(this,e,t),r=e.doc;if(Mt(this,e,n),!e.local){let t=!1;for(const[n,s]of e.afterState.entries()){const i=e.beforeState.get(n)||0;if(s!==i&&(ot(e,r.store.clients.get(n),i,s,(e=>{e.deleted||e.content.constructor!==Gn||(t=!0)})),t))break}t||J(e,e.deleteSet,(e=>{e instanceof Un||t||e.parent===this&&e.content.constructor===Gn&&(t=!0)})),pt(r,(e=>{t?_n(this):J(e,e.deleteSet,(t=>{t instanceof Un||t.parent===this&&vn(e,t)}))}))}}toString(){let e="",t=this._start;while(null!==t)!t.deleted&&t.countable&&t.content.constructor===er&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?pt(this.doc,(n=>{const r=new un(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const i=e[s];if(void 0!==i.insert){const o=t||"string"!==typeof i.insert||s!==e.length-1||null!==r.right||"\n"!==i.insert.slice(-1)?i.insert:i.insert.slice(0,-1);("string"!==typeof o||o.length>0)&&mn(n,this,r,o,i.attributes||{})}else void 0!==i.retain?wn(n,this,r,i.retain,i.attributes||{}):void 0!==i.delete&&En(n,r,i.delete)}})):this._pending.push((()=>this.applyDelta(e)))}toDelta(e,t,n){const r=[],s=new Map,i=this.doc;let o="",a=this._start;function c(){if(o.length>0){const e={};let t=!1;s.forEach(((n,r)=>{t=!0,e[r]=n}));const n={insert:o};t&&(n.attributes=e),r.push(n),o=""}}return pt(i,(i=>{e&&Ge(i,e),t&&Ge(i,t);while(null!==a){if(We(a,e)||void 0!==t&&We(a,t))switch(a.content.constructor){case er:{const r=s.get("ychange");void 0===e||We(a,e)?void 0===t||We(a,t)?void 0!==r&&(c(),s.delete("ychange")):void 0!==r&&r.user===a.id.client&&"added"===r.type||(c(),s.set("ychange",n?n("added",a.id):{type:"added"})):void 0!==r&&r.user===a.id.client&&"removed"===r.type||(c(),s.set("ychange",n?n("removed",a.id):{type:"removed"})),o+=a.content.str;break}case ur:case qn:{c();const e={insert:a.content.getContent()[0]};if(s.size>0){const t={};e.attributes=t,s.forEach(((e,n)=>{t[n]=e}))}r.push(e);break}case Gn:We(a,e)&&(c(),pn(s,a.content));break}a=a.right}c()}),Ge),r}insert(e,t,n){if(t.length<=0)return;const r=this.doc;null!==r?pt(r,(r=>{const s=dn(r,this,e);n||(n={},s.currentAttributes.forEach(((e,t)=>{n[t]=e}))),mn(r,this,s,t,n)})):this._pending.push((()=>this.insert(e,t,n)))}insertEmbed(e,t,n={}){const r=this.doc;null!==r?pt(r,(r=>{const s=dn(r,this,e);mn(r,this,s,t,n)})):this._pending.push((()=>this.insertEmbed(e,t,n)))}delete(e,t){if(0===t)return;const n=this.doc;null!==n?pt(n,(n=>{En(n,dn(n,this,e),t)})):this._pending.push((()=>this.delete(e,t)))}format(e,t,n){if(0===t)return;const r=this.doc;null!==r?pt(r,(r=>{const s=dn(r,this,e);null!==s.right&&wn(r,this,s,t,n)})):this._pending.push((()=>this.format(e,t,n)))}removeAttribute(e){null!==this.doc?pt(this.doc,(t=>{Qt(t,this,e)})):this._pending.push((()=>this.removeAttribute(e)))}setAttribute(e,t){null!==this.doc?pt(this.doc,(n=>{Xt(n,this,e,t)})):this._pending.push((()=>this.setAttribute(e,t)))}getAttribute(e){return Jt(this,e)}getAttributes(e){return Zt(this)}_write(e){e.writeTypeRef(ir)}}const In=e=>new kn;class An{constructor(e,t=(()=>!0)){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==Cn&&t.constructor!==Tn||null===t._start)while(null!==e){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class Tn extends Ut{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new Tn}clone(){const e=new Tn;return e.insert(0,this.toArray().map((e=>e instanceof Ut?e.clone():e))),e}get length(){return null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new An(this,e)}querySelector(e){e=e.toUpperCase();const t=new An(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)),n=t.next();return n.done?null:n.value}querySelectorAll(e){return e=e.toUpperCase(),Array.from(new An(this,(t=>t.nodeName&&t.nodeName.toUpperCase()===e)))}_callObserver(e,t){Mt(this,e,new Nn(this,t,e))}toString(){return zt(this,(e=>e.toString())).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},n){const r=e.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),Vt(this,(s=>{r.insertBefore(s.toDOM(e,t,n),null)})),r}insert(e,t){null!==this.doc?pt(this.doc,(n=>{Wt(n,this,e,t)})):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)pt(this.doc,(n=>{const r=e&&e instanceof Ut?e._item:e;Ht(n,this,r,t)}));else{const n=this._prelimContent,r=null===e?0:n.findIndex((t=>t===e))+1;if(0===r&&null!==e)throw y("Reference item not found");n.splice(r,0,...t)}}delete(e,t=1){null!==this.doc?pt(this.doc,(n=>{Yt(n,this,e,t)})):this._prelimContent.splice(e,t)}toArray(){return jt(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Kt(this,e)}slice(e=0,t=this.length){return Ft(this,e,t)}forEach(e){Vt(this,e)}_write(e){e.writeTypeRef(ar)}}const Rn=e=>new Tn;class Cn extends Tn{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach(((e,t)=>{this.setAttribute(t,e)})),this._prelimAttrs=null}_copy(){return new Cn(this.nodeName)}clone(){const e=new Cn(this.nodeName),t=this.getAttributes();for(const n in t)e.setAttribute(n,t[n]);return e.insert(0,this.toArray().map((e=>e instanceof Ut?e.clone():e))),e}toString(){const e=this.getAttributes(),t=[],n=[];for(const o in e)n.push(o);n.sort();const r=n.length;for(let o=0;o<r;o++){const r=n[o];t.push(r+'="'+e[r]+'"')}const s=this.nodeName.toLocaleLowerCase(),i=t.length>0?" "+t.join(" "):"";return`<${s}${i}>${super.toString()}</${s}>`}removeAttribute(e){null!==this.doc?pt(this.doc,(t=>{Qt(t,this,e)})):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?pt(this.doc,(n=>{Xt(n,this,e,t)})):this._prelimAttrs.set(e,t)}getAttribute(e){return Jt(this,e)}hasAttribute(e){return en(this,e)}getAttributes(e){return Zt(this)}toDOM(e=document,t={},n){const r=e.createElement(this.nodeName),s=this.getAttributes();for(const i in s)r.setAttribute(i,s[i]);return Vt(this,(s=>{r.appendChild(s.toDOM(e,t,n))})),void 0!==n&&n._createAssociation(r,this),r}_write(e){e.writeTypeRef(or),e.writeKey(this.nodeName)}}const Pn=e=>new Cn(e.readKey());class Nn extends Tt{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach((e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)}))}}class On extends an{constructor(e){super(),this.hookName=e}_copy(){return new On(this.hookName)}clone(){const e=new On(this.hookName);return this.forEach(((t,n)=>{e.set(n,t)})),e}toDOM(e=document,t={},n){const r=t[this.hookName];let s;return s=void 0!==r?r.createDom(this):document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(s,this),s}_write(e){e.writeTypeRef(cr),e.writeKey(this.hookName)}}const Dn=e=>new On(e.readKey());class Ln extends kn{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new Ln}clone(){const e=new Ln;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,n){const r=e.createTextNode(this.toString());return void 0!==n&&n._createAssociation(r,this),r}toString(){return this.toDelta().map((e=>{const t=[];for(const r in e.attributes){const n=[];for(const t in e.attributes[r])n.push({key:t,value:e.attributes[r][t]});n.sort(((e,t)=>e.key<t.key?-1:1)),t.push({nodeName:r,attrs:n})}t.sort(((e,t)=>e.nodeName<t.nodeName?-1:1));let n="";for(let r=0;r<t.length;r++){const e=t[r];n+=`<${e.nodeName}`;for(let t=0;t<e.attrs.length;t++){const r=e.attrs[t];n+=` ${r.key}="${r.value}"`}n+=">"}n+=e.insert;for(let r=t.length-1;r>=0;r--)n+=`</${t[r].nodeName}>`;return n})).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(lr)}}const xn=e=>new Ln;class Bn{constructor(e,t){this.id=e,this.length=t}get deleted(){throw m()}mergeWith(e){return!1}write(e,t,n){throw m()}integrate(e,t){throw m()}}const Mn=0;class Un extends Bn{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),Je(e.doc.store,this)}write(e,t){e.writeInfo(Mn),e.writeLen(this.length-t)}getMissing(e,t){return null}}class Fn{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Fn(this.content)}splice(e){throw m()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const jn=e=>new Fn(e.readBuf());class Vn{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Vn(this.len)}splice(e){const t=new Vn(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){re(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const zn=e=>new Vn(e.readLen()),$n=(e,t)=>new ue({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Kn{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Kn($n(this.doc.guid,this.opts))}splice(e){throw m()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const Hn=e=>new Kn($n(e.readString(),e.readAny()));class qn{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new qn(this.embed)}splice(e){throw m()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const Wn=e=>new qn(e.readJSON());class Gn{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new Gn(this.key,this.value)}splice(e){throw m()}mergeWith(e){return!1}integrate(e,t){t.parent._searchMarker=null}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const Yn=e=>new Gn(e.readKey(),e.readJSON());class Qn{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Qn(this.arr)}splice(e){const t=new Qn(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let r=t;r<n;r++){const t=this.arr[r];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}const Xn=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++){const t=e.readString();"undefined"===t?n.push(void 0):n.push(JSON.parse(t))}return new Qn(n)};class Jn{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new Jn(this.arr)}splice(e){const t=new Jn(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const n=this.arr.length;e.writeLen(n-t);for(let r=t;r<n;r++){const t=this.arr[r];e.writeAny(t)}}getRef(){return 8}}const Zn=e=>{const t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new Jn(n)};class er{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new er(this.str)}splice(e){const t=new er(this.str.slice(e));this.str=this.str.slice(0,e);const n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"�",t.str="�"+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}const tr=e=>new er(e.readString()),nr=[sn,cn,In,Pn,Rn,Dn,xn],rr=0,sr=1,ir=2,or=3,ar=4,cr=5,lr=6;class ur{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new ur(this.type._copy())}splice(e){throw m()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;while(null!==t)t.deleted?e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach((t=>{t.deleted?e._mergeStructs.push(t):t.delete(e)})),e.changed.delete(this.type)}gc(e){let t=this.type._start;while(null!==t)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach((t=>{while(null!==t)t.gc(e,!0),t=t.left})),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const hr=e=>new ur(nr[e.readTypeRef()](e)),dr=(e,t,n)=>{const{client:r,clock:s}=t.id,i=new fr($e(r,s+n),t,$e(r,s+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&i.markDeleted(),t.keep&&(i.keep=!0),null!==t.redone&&(i.redone=$e(t.redone.client,t.redone.clock+n)),t.right=i,null!==i.right&&(i.right.left=i),e._mergeStructs.push(i),null!==i.parentSub&&null===i.right&&i.parent._map.set(i.parentSub,i),t.length=n,i};class fr extends Bn{constructor(e,t,n,r,s,i,o,a){super(e,a.getLength()),this.origin=n,this.left=t,this.right=r,this.rightOrigin=s,this.parent=i,this.parentSub=o,this.redone=null,this.content=a,this.info=this.content.isCountable()?b.Qn:0}set marker(e){(this.info&b.Ko)>0!==e&&(this.info^=b.Ko)}get marker(){return(this.info&b.Ko)>0}get keep(){return(this.info&b.Vw)>0}set keep(e){this.keep!==e&&(this.info^=b.Vw)}get countable(){return(this.info&b.Qn)>0}get deleted(){return(this.info&b.CY)>0}set deleted(e){this.deleted!==e&&(this.info^=b.CY)}markDeleted(){this.info|=b.CY}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Xe(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Xe(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Ve&&this.id.client!==this.parent.client&&this.parent.clock>=Xe(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=st(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=rt(e,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===Un||this.right&&this.right.constructor===Un)&&(this.parent=null),this.parent){if(this.parent.constructor===Ve){const e=tt(t,this.parent);e.constructor===Un?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===fr&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===fr&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=st(e,e.doc.store,$e(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,n=this.left;if(null!==n)t=n.right;else if(null!==this.parentSub){t=this.parent._map.get(this.parentSub)||null;while(null!==t&&null!==t.left)t=t.left}else t=this.parent._start;const r=new Set,s=new Set;while(null!==t&&t!==this.right){if(s.add(t),r.add(t),ze(this.origin,t.origin)){if(t.id.client<this.id.client)n=t,r.clear();else if(ze(this.rightOrigin,t.rightOrigin))break}else{if(null===t.origin||!s.has(tt(e.doc.store,t.origin)))break;r.has(tt(e.doc.store,t.origin))||(n=t,r.clear())}t=t.right}this.left=n}if(null!==this.left){const e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub){e=this.parent._map.get(this.parentSub)||null;while(null!==e&&null!==e.left)e=e.left}else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Je(e.doc.store,this),this.content.integrate(e,this),lt(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new Un(this.id,this.length).integrate(e,0)}get next(){let e=this.right;while(null!==e&&e.deleted)e=e.right;return e}get prev(){let e=this.left;while(null!==e&&e.deleted)e=e.left;return e}get lastId(){return 1===this.length?this.id:$e(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&ze(e.origin,this.lastId)&&this.right===e&&ze(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach((t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))})),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),re(e.deleteSet,this.id.client,this.id.clock,this.length),lt(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw w();this.content.gc(e),t?it(e,this,new Un(this.id,this.length)):this.content=new Vn(this.length)}write(e,t){const n=t>0?$e(this.id.client,this.id.clock+t-1):this.origin,r=this.rightOrigin,s=this.parentSub,i=this.content.getRef()&b.kr|(null===n?0:b.x1)|(null===r?0:b.rc)|(null===s?0:b.cq);if(e.writeInfo(i),null!==n&&e.writeLeftID(n),null!==r&&e.writeRightID(r),null===n&&null===r){const t=this.parent;if(void 0!==t._item){const n=t._item;if(null===n){const n=Ke(t);e.writeParentInfo(!0),e.writeString(n)}else e.writeParentInfo(!1),e.writeLeftID(n.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===Ve?(e.writeParentInfo(!1),e.writeLeftID(t)):w();null!==s&&e.writeString(s)}this.content.write(e,t)}}const pr=(e,t)=>gr[t&b.kr](e),gr=[()=>{w()},zn,Xn,jn,tr,Wn,Yn,hr,Zn,Hn,()=>{w()}],yr=10;class mr extends Bn{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){w()}write(e,t){e.writeInfo(yr),a.uE(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const wr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:{},br="__ $YJS$ __";!0===wr[br]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),wr[br]=!0}}]);
//# sourceMappingURL=chunk-vendors.3a250ea6.js.map